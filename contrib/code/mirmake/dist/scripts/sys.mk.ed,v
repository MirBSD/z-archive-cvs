head	1.22;
access;
symbols
	tg-mirmake-dev_BASE:1.16
	tg-mirmake-dev:1.16.0.2
	mirbsd:1.1.7;
locks; strict;
comment	@# @;


1.22
date	2009.11.17.19.10.30;	author tg;	state Exp;
branches;
next	1.21;
commitid	1004B02F5110E928B38;

1.21
date	2008.12.29.20.14.36;	author tg;	state Exp;
branches;
next	1.20;
commitid	10049592FBA0422241C;

1.20
date	2008.12.13.23.29.29;	author tg;	state Exp;
branches;
next	1.19;
commitid	1004944455B2BE258CF;

1.19
date	2008.03.14.14.44.20;	author tg;	state Exp;
branches;
next	1.18;
commitid	10047DA8F5056B8F49A;

1.18
date	2006.11.02.00.50.29;	author tg;	state Exp;
branches;
next	1.17;
commitid	100454940D51A8F9D37;

1.17
date	2006.10.27.15.52.41;	author tg;	state Exp;
branches;
next	1.16;
commitid	10045422B51340FA673;

1.16
date	2005.12.20.19.16.33;	author tg;	state Exp;
branches;
next	1.15;
commitid	10043A858A4415F8607;

1.15
date	2005.12.20.18.54.14;	author tg;	state Exp;
branches;
next	1.14;
commitid	10043A853626076DB0E;

1.14
date	2005.12.20.11.01.04;	author tg;	state Exp;
branches;
next	1.13;
commitid	10043A7E47E4943CB73;

1.13
date	2005.12.15.01.31.27;	author tg;	state Exp;
branches;
next	1.12;
commitid	10043A0C76470961B4A;

1.12
date	2005.10.02.10.41.54;	author tg;	state Exp;
branches;
next	1.11;
commitid	706f433fb981eafd;

1.11
date	2005.09.01.22.27.33;	author tg;	state Exp;
branches;
next	1.10;
commitid	328243178058062c;

1.10
date	2005.08.21.11.35.58;	author tg;	state Exp;
branches;
next	1.9;
commitid	7a9d4308672c9674;

1.9
date	2005.06.09.21.57.46;	author tg;	state Exp;
branches;
next	1.8;
commitid	6e3942a8bb6aa9de;

1.8
date	2005.05.25.23.50.32;	author tg;	state Exp;
branches;
next	1.7;
commitid	715c42950f4ccef2;

1.7
date	2005.05.21.15.48.42;	author tg;	state Exp;
branches;
next	1.6;
commitid	41ea428f586cf90b;

1.6
date	2005.05.21.15.03.01;	author tg;	state Exp;
branches;
next	1.5;
commitid	3620428f4da24d0b;

1.5
date	2005.04.12.10.11.55;	author tg;	state Exp;
branches;
next	1.4;

1.4
date	2005.04.11.15.44.50;	author tg;	state Exp;
branches;
next	1.3;

1.3
date	2005.04.11.15.41.42;	author tg;	state Exp;
branches;
next	1.2;

1.2
date	2005.02.23.21.53.55;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.02.05.02.36.15;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.02.05.02.36.15;	author tg;	state Exp;
branches;
next	;


desc
@@


1.22
log
@hack: define __unused to __unused to prevent mirmake.h from
defining it on GNU/Linux

XXX should do the defines per-compiler better (eg. pcc's)
XXX should wrap the system headers instead
XXX should use mirtoconf instead
@
text
@0a
# $MirOS: contrib/code/mirmake/dist/scripts/sys.mk.ed,v 1.21 2008/12/29 20:14:36 tg Exp $
.
/^.if ..MACHINE_OS/;/^.endif/d
i
OStype=		@@@@ostype@@@@
.
/^OSrev=/d
/^OSrpl=/d
/^OScompat=/d
/^OStriplet?=/s/\(OStriplet?=[	 ]*\).*$/\1@@@@gnuos@@@@/
/^_MIRMAKE_EXE=/s!/usr/bin/make!@@@@binmk@@@@/@@@@bmake@@@@!
/^_MIRMAKE_VER=/s/\(_MIRMAKE_VER=[	 ]*\).*$/\1@@@@vers@@@@/
/^CC?=/s/\(CC?=[	 ]*\).*$/\1@@@@ccom@@@@/
/^HOSTCC?=/s/\(CC?=[	 ]*\).*$/\1@@@@ccom@@@@/
/^CPPFLAGS?=/s!$!	-isystem ${.SYSMK:Q} @@@@dunused@@@@-include ${.SYSMK:Q}/mirmake.h!
/^SHELL=/s/\(SHELL=[	 ]*\).*$/\1@@@@mksh@@@@/
/^MAKE?=/s!make!@@@@bmake@@@@!
/^INSTALL?=/s!install!@@@@binmk@@@@/binstall!
wq
@


1.21
log
@okay, let’s try this again: sync with the real <sys.mk>
@
text
@d2 1
a2 1
# $MirOS: contrib/code/mirmake/dist/scripts/sys.mk.ed,v 1.20 2008/12/13 23:29:29 tg Exp $
d16 1
a16 1
/^CPPFLAGS?=/s!$!	-isystem ${.SYSMK:Q} -include ${.SYSMK:Q}/mirmake.h!
@


1.20
log
@standard path to mksh is /usr/dbin/mksh on MirOS-current
(sometimes I curse myself for giving in to that idea…)
@
text
@d2 1
a2 1
# $MirOS: contrib/code/mirmake/dist/scripts/sys.mk.ed,v 1.19 2008/03/14 14:44:20 tg Exp $
d17 1
a17 1
/^SHELL?=/s/\(SHELL?=[	 ]*\).*$/\1@@@@mksh@@@@/
@


1.19
log
@use the binstall we build by default on bmake install
@
text
@d2 1
a2 1
# $MirOS: contrib/code/mirmake/dist/scripts/sys.mk.ed,v 1.18 2006/11/02 00:50:29 tg Exp $
d17 1
a17 1
/^SHELL=/s!/bin/mksh!@@@@mksh@@@@!
@


1.18
log
@CPPFLAGS could be overridden from command line, restore previous
behaviour but be less invasive and use bsd.sys.mk
@
text
@d2 1
a2 1
# $MirOS: contrib/code/mirmake/dist/scripts/sys.mk.ed,v 1.17 2006/10/27 15:52:41 tg Exp $
d19 1
@


1.17
log
@* sys.mk, param.h: bump OS patchlevel
* sys.mk, sys.mk.ed: simplify CPPFLAGS generation
* limits.h, stdlib.h: crank MB_LEN_MAX to (2*real-MB_LEN_MAX - 1)
  to account for functions such as wcrtomb(3) to process an mbstate_t
* machine/limits.h: do *not* define MB_LEN_MAX=1 unconditionally,
  broke libncursesw(!); protect against multiple inclusion
* bsd.port.mk: default 'mmake uninstall' to pkg_delete -c
@
text
@d2 1
a2 1
# $MirOS: contrib/code/mirmake/dist/scripts/sys.mk.ed,v 1.16 2005/12/20 19:16:33 tg Exp $
d16 1
a16 1
/^CPPFLAGS?=/s!$! -isystem ${.SYSMK:Q} -include ${.SYSMK:Q}/mirmake.h!
@


1.16
log
@I was wrong
@
text
@d2 1
a2 1
# $MirOS: contrib/code/mirmake/dist/scripts/sys.mk.ed,v 1.15 2005/12/20 18:54:14 tg Exp $
d16 1
a16 1
/^CPPFLAGS?=/s!$!	-isystem ${.SYSMK:Q} -include ${.SYSMK:Q}/mirmake.h!
@


1.15
log
@we need the full path in ${_MIRMAKE_EXE}
@
text
@d2 1
a2 1
# $MirOS: contrib/code/mirmake/dist/scripts/sys.mk.ed,v 1.14 2005/12/20 11:01:04 tg Exp $
d12 1
a12 1
/^_MIRMAKE_EXE=/s!\(_MIRMAKE_EXE=[	 ]*\).*$!\1@@@@bmake@@@@!
d18 1
a18 1
/^MAKE?=/s!make!@@@@binmk@@@@/@@@@bmake@@@@!
@


1.14
log
@missing editing of _MIRMAKE_EXE
@
text
@d2 1
a2 1
# $MirOS: contrib/code/mirmake/dist/scripts/sys.mk.ed,v 1.13 2005/12/15 01:31:27 tg Exp $
d18 1
a18 1
/^MAKE?=/s!make!@@@@bmake@@@@!
@


1.13
log
@${.SYSMK:Q} no "${.SYSMK}"

this fix is required for building firesomething-1.5 (a port bsiegert@@ has
already prepared), thus bump MIRMAKE_VERSION in <sys.mk> as well
@
text
@d2 1
a2 1
# $MirOS: contrib/code/mirmake/dist/scripts/sys.mk.ed,v 1.12 2005/10/02 10:41:54 tg Exp $
d12 1
@


1.12
log
@nuke line which did nothing
@
text
@d2 1
a2 1
# $MirOS: contrib/code/mirmake/dist/scripts/sys.mk.ed,v 1.11 2005/09/01 22:27:33 tg Exp $
d15 1
a15 1
/^CPPFLAGS?=/s!$!	-isystem "${.SYSMK}" -include "${.SYSMK}/mirmake.h"!
@


1.11
log
@* include GNU config.guess
* call GNU config.guess; provide appropriate ${OStriplet} default
@
text
@d2 1
a2 1
# $MirOS: contrib/code/mirmake/dist/scripts/sys.mk.ed,v 1.10 2005/08/21 11:35:58 tg Exp $
a10 1
/^OStriplet?=/s/ecce/unknown/
@


1.10
log
@adjust for _MIRMAKE_VER changes
@
text
@d2 1
a2 1
# $MirOS: contrib/code/mirmake/dist/scripts/sys.mk.ed,v 1.9 2005/06/09 21:57:46 tg Exp $
d12 1
@


1.9
log
@distribute mirmake version alongside
@
text
@d2 1
a2 1
# $MirOS: contrib/code/mirmake/dist/scripts/sys.mk.ed,v 1.8 2005/05/25 23:50:32 tg Exp $
d12 1
a17 3
a
_MIRMAKE_VER=	@@@@vers@@@@
.
@


1.8
log
@mksh is pretty mature; switch most of contrib/ to it
@
text
@d2 1
a2 1
# $MirOS: contrib/code/mirmake/dist/scripts/sys.mk.ed,v 1.7 2005/05/21 15:48:42 tg Exp $
d17 3
@


1.7
log
@use ${.SYSMK} instead
@
text
@d2 1
a2 1
# $MirOS: contrib/code/mirmake/dist/scripts/sys.mk.ed,v 1.6 2005/05/21 15:03:01 tg Exp $
d15 1
a15 1
/^SHELL=/s!/bin/ksh!@@@@mksh@@@@!
@


1.6
log
@* getopt_long.c (our compatible getopt) joins libmirmake
* the mirmake dir is now added to the include search path
@
text
@d2 1
a2 1
# $MirOS: contrib/code/mirmake/dist/scripts/sys.mk.ed,v 1.5 2005/04/12 10:11:55 tg Exp $
d14 1
a14 1
/^CPPFLAGS?=/s!$!	-isystem "@@@@shmk@@@@" -include "@@@@shmk@@@@/mirmake.h"!
@


1.5
log
@-imacros wouldn't work, since it believes <sys/types.h> is already in
found on Interix
@
text
@d2 1
a2 1
# $MirOS: contrib/code/mirmake/dist/scripts/sys.mk.ed,v 1.4 2005/04/11 15:44:50 tg Exp $
d14 1
a14 1
/^CPPFLAGS?=/s!$!	-include "@@@@shmk@@@@/mirmake.h"!
@


1.4
log
@default ${CC} and ${HOSTCC} not to "cc"
but to the $CC given to Build.sh (or "gcc" if not given)
@
text
@d2 1
a2 1
# $MirOS: contrib/code/mirmake/dist/scripts/sys.mk.ed,v 1.3 2005/04/11 15:41:42 tg Exp $
d14 1
a14 1
/^CPPFLAGS?=/s!$!	-imacros "@@@@shmk@@@@/mirmake.h"!
@


1.3
log
@as recommended, add mirmake.h to default CPPFLAGS
@
text
@d2 1
a2 1
# $MirOS: contrib/code/mirmake/dist/scripts/sys.mk.ed,v 1.2 2005/02/23 21:53:55 tg Exp $
d12 2
a13 2
/^CC?=/s/\(CC?=[	 ]*\).*$/\1cc/
/^HOSTCC?=/s/\(CC?=[	 ]*\).*$/\1cc/
@


1.2
log
@adapt for a "glitch" in our system makefile includes
@
text
@d2 1
a2 1
# $MirOS: contrib/code/mirmake/dist/scripts/sys.mk.ed,v 1.1.7.1 2005/02/05 02:36:15 tg Exp $
d14 1
@


1.1
log
@Initial revision
@
text
@d2 1
a2 1
# $MirOS$
d12 2
@


1.1.7.1
log
@All the code in the contributed section
@
text
@@
