head	1.24;
access;
symbols
	tg-mirmake-dev_BASE:1.15
	tg-mirmake-dev:1.14.0.2;
locks; strict;
comment	@# @;


1.24
date	2014.12.20.22.32.59;	author tg;	state Exp;
branches;
next	1.23;
commitid	1005495F92C5497A12B;

1.23
date	2010.01.10.13.13.20;	author tg;	state Exp;
branches;
next	1.22;
commitid	1004B49D2853A297860;

1.22
date	2009.11.09.21.36.37;	author tg;	state Exp;
branches;
next	1.21;
commitid	1004AF88B6210E6BBB3;

1.21
date	2008.03.09.14.16.07;	author tg;	state Exp;
branches;
next	1.20;
commitid	10047D3F13463609C08;

1.20
date	2008.03.09.13.42.52;	author tg;	state Exp;
branches;
next	1.19;
commitid	10047D3E95307755B9E;

1.19
date	2008.02.24.12.37.11;	author tg;	state Exp;
branches;
next	1.18;
commitid	10047C164E62DF1061A;

1.18
date	2008.02.17.15.42.17;	author bsiegert;	state Exp;
branches;
next	1.17;
commitid	10047B855F000009936;

1.17
date	2006.10.13.16.41.47;	author tg;	state Exp;
branches;
next	1.16;
commitid	100452FC1E1409E7210;

1.16
date	2006.10.13.16.39.52;	author tg;	state Exp;
branches;
next	1.15;
commitid	100452FC168589F78ED;

1.15
date	2006.10.13.12.44.42;	author tg;	state Exp;
branches;
next	1.14;
commitid	100452F8A391A35EBD2;

1.14
date	2006.08.26.22.50.50;	author tg;	state Exp;
branches;
next	1.13;
commitid	10044F0D05C43C91F8F;

1.13
date	2006.08.26.22.46.44;	author tg;	state Exp;
branches;
next	1.12;
commitid	10044F0CF6A4E28F290;

1.12
date	2006.08.26.16.45.27;	author tg;	state Exp;
branches;
next	1.11;
commitid	10044F07A98434B547D;

1.11
date	2005.11.24.19.30.05;	author tg;	state Exp;
branches;
next	1.10;
commitid	46cd438614ce7411;

1.10
date	2005.11.24.11.41.33;	author tg;	state Exp;
branches;
next	1.9;
commitid	210c4385a6fda971;

1.9
date	2005.11.24.11.36.28;	author tg;	state Exp;
branches;
next	1.8;
commitid	714a4385a5b30f90;

1.8
date	2005.09.19.18.42.18;	author tg;	state Exp;
branches;
next	1.7;
commitid	74ca432f0698d534;

1.7
date	2005.09.18.20.38.05;	author tg;	state Exp;
branches;
next	1.6;
commitid	4478432dd03ea1fe;

1.6
date	2005.08.21.11.56.04;	author tg;	state Exp;
branches;
next	1.5;
commitid	6d4f43086bd9e545;

1.5
date	2005.06.08.10.03.24;	author tg;	state Exp;
branches;
next	1.4;
commitid	513b42a6c2301292;

1.4
date	2005.05.21.17.03.52;	author tg;	state Exp;
branches;
next	1.3;
commitid	4755428f69a27ba8;

1.3
date	2005.05.21.15.38.52;	author tg;	state Exp;
branches;
next	1.2;
commitid	38ce428f5605ec09;

1.2
date	2005.05.21.15.03.01;	author tg;	state Exp;
branches;
next	1.1;
commitid	3620428f4da24d0b;

1.1
date	2005.05.21.14.56.48;	author tg;	state Exp;
branches;
next	;
commitid	6d1d428f4c14e450;


desc
@@


1.24
log
@adjust for miscdata.c move
@
text
@# $MirOS: contrib/code/mirmake/dist/scripts/Makefile.lib,v 1.23 2010/01/10 13:13:20 tg Exp $

LIB=		mirmake
SRCS+=		adh32.c md4.c md5.c rmd160.c sfv.c \
		sha1.c sha2.c tiger.c whirlpool.c \
		adler32hl.c md4hl.c md5hl.c rmd160hl.c sfvhl.c \
		sha1hl.c sha256hl.c sha384hl.c sha512hl.c \
		sumahl.c tigerhl.c whirlpoolhl.c \
		getopt_long.c

UIF_KUSRCS+=	mbsd_digits_dec.c miscdata.c -DL_mbsd_digits_dec
UIF_KUSRCS+=	mbsd_digits_hex.c miscdata.c -DL_mbsd_digits_hex
UIF_KUSRCS+=	mbsd_digits_HEX.c miscdata.c -DL_mbsd_digits_HEX
UIF_KUSRCS+=	mbsd_digits_base64.c miscdata.c -DL_mbsd_digits_base64
UIF_KUSRCS+=	RFC1321_padding.c miscdata.c -DL_RFC1321_padding
UIF_KUSRCS+=	mbsd_digits_md5crypt.c miscdata.c -DL_mbsd_digits_md5crypt
UIF_KUSRCS+=	mbsd_digits_bcrypt.c miscdata.c -DL_mbsd_digits_bcrypt

NOPIC=		yes
CPPFLAGS+=	-D_LIBMIRMAKE

.include <bsd.own.mk>

.if (${OStype} != Darwin) && exists(suma-${MACHINE_ARCH}.S)
SRCS+=		suma-${MACHINE_ARCH}.S
.else
SRCS+=		suma.c
.endif

.if ${OStype} == "Interix"
SRCS+=		asprintf.c mktemp.c strtoll.c vasprintf.c
.endif

.for _z _q _s in ${UIF_KUSRCS}
SRCS+=		${_z}
CLEANFILES+=	${_z}

${_z}: ${_q}
	-unifdef ${_s:S/,/ /g} $> >$@@

beforedepend: ${_z}
.endfor

.include <bsd.lib.mk>
@


1.23
log
@sync with cid 1004B46615B7479BC1B
@
text
@d1 1
a1 1
# $MirOS: contrib/code/mirmake/dist/scripts/Makefile.lib,v 1.22 2009/11/09 21:36:37 tg Exp $
d5 1
a5 1
		sha1.c sha2.c tiger.c whirlpool.c hashpad.c \
d8 1
a8 1
		sumahl.c tigerhl.c whirlpoolhl.c digits.c \
d11 8
d34 10
@


1.22
log
@bump libc minor, to be able to pull in OAAT hash helper functions,
as well as globalise the hashpad things; sync mirmake and kernel
@
text
@d1 1
a1 1
# $MirOS: contrib/code/mirmake/dist/scripts/Makefile.lib,v 1.21 2008/03/09 14:16:07 tg Exp $
d8 1
a8 1
		sumahl.c tigerhl.c whirlpoolhl.c \
@


1.21
log
@provide the other hashes too (sfv, suma, whirlpool)
@
text
@d1 1
a1 1
# $MirOS: contrib/code/mirmake/dist/scripts/Makefile.lib,v 1.20 2008/03/09 13:42:52 tg Exp $
d5 1
a5 1
		sha1.c sha2.c tiger.c whirlpool.c \
@


1.20
log
@fix the Darwin problem by disabling UNIX03 symbol mangling unconditionally;
now we can use our own trusted getopt(3) function suite again

tested on anakin, 10x gecko2@@
@
text
@d1 1
a1 1
# $MirOS: contrib/code/mirmake/dist/scripts/Makefile.lib,v 1.17 2006/10/13 16:41:47 tg Exp $
d4 5
a8 3
SRCS+=		md4.c md5.c rmd160.c sha1.c sha2.c tiger.c \
		md4hl.c md5hl.c rmd160hl.c sha1hl.c \
		sha256hl.c sha384hl.c sha512hl.c tigerhl.c \
d16 6
@


1.19
log
@unify getopt-incompat stuff
XXX this uses native getopt(3) on _all_ Darwin versions, which is NOT what
XXX I intended… we should™ use our own getopt whenever possible
@
text
@d1 1
a1 1
# $MirOS: contrib/code/mirmake/dist/scripts/Makefile.lib,v 1.18 2008/02/17 15:42:17 bsiegert Exp $
d6 2
a7 6
		sha256hl.c sha384hl.c sha512hl.c tigerhl.c

# can be overridden
getopt_long_o=getopt_long.o

SRCS+=		${getopt_long_o:S/.o/.c}
@


1.18
log
@Introduce HAVE_GETOPT and build libmirmake accordingly: don't include
getopt on Mac OS, use the native one
@
text
@d1 1
a1 1
# $MirOS: contrib/code/mirmake/dist/scripts/Makefile.lib,v 1.17 2006/10/13 16:41:47 tg Exp $
d8 5
a12 4
.if !${HAVE_GETOPT:L:Myes}
SRCS+=		getopt_long.c
.endif
 
@


1.17
log
@tiger
@
text
@d1 1
a1 1
# $MirOS: contrib/code/mirmake/dist/scripts/Makefile.lib,v 1.16 2006/10/13 16:39:52 tg Exp $
d6 1
a6 2
		sha256hl.c sha384hl.c sha512hl.c tigerhl.c \
		getopt_long.c
d8 4
@


1.16
log
@arc4random, stdbool
@
text
@d1 1
a1 1
# $MirOS: contrib/code/mirmake/dist/scripts/Makefile.lib,v 1.15 2006/10/13 12:44:42 tg Exp $
d4 1
a4 1
SRCS+=		md4.c md5.c rmd160.c sha1.c sha2.c \
d6 1
a6 1
		sha256hl.c sha384hl.c sha512hl.c \
@


1.15
log
@bring back about mirmake 20060623 but with improved arc4random
(not yet enabled) and keep some of the current changes

doesn't build yet, needs work
@
text
@d1 1
a1 3
# $MirOS: contrib/code/mirmake/dist/scripts/Makefile.lib,v 1.11 2005/11/24 19:30:05 tg Exp $

XXX add arc4random
d4 1
a4 1
SRCS=		md4.c md5.c rmd160.c sha1.c sha2.c \
d7 1
a7 1
		getopt_long.c ${EXTRA_SRCS}
@


1.14
log
@move SRCS into Build.sh
@
text
@d1 3
a3 1
# $MirOS: contrib/code/mirmake/dist/scripts/Makefile.lib,v 1.13 2006/08/26 22:46:44 tg Exp $
d6 6
a11 1
SHLIB_VERSION=	1.0
d14 6
@


1.13
log
@modernize, rewrite
@
text
@d1 1
a1 1
# $MirOS: contrib/code/mirmake/dist/scripts/Makefile.lib,v 1.12 2006/08/26 16:45:27 tg Exp $
a4 5
SRCS+=		md4.c md5.c rmd160.c sha1.c sha2.c \
		md4hl.c md5hl.c rmd160hl.c sha1hl.c \
		sha256hl.c sha384hl.c sha512hl.c \
		getopt_long.c

a6 6
.include <bsd.own.mk>

.if ${OStype} == "Interix"
SRCS+=		asprintf.c mktemp.c strtoll.c vasprintf.c
.endif

@


1.12
log
@experimental:
* add arc4random(3) (all archs) and arc4random_pushb(3) (as wrapper)
  to libmirmake
* provide libmirmake as shared library (to be able to LDADD it)
@
text
@d1 1
a1 1
# $MirOS: contrib/code/mirmake/dist/scripts/Makefile.lib,v 1.11 2005/11/24 19:30:05 tg Exp $
d5 1
a5 1
SRCS=		md4.c md5.c rmd160.c sha1.c sha2.c \
d8 1
a8 1
		getopt_long.c ${EXTRA_SRCS}
@


1.11
log
@bsd.own.mk.ed already sets DEBUGLIBS=no
@
text
@d1 1
a1 1
# $MirOS: contrib/code/mirmake/dist/scripts/Makefile.lib,v 1.10 2005/11/24 11:41:33 tg Exp $
d4 1
a9 1
NOPIC=		yes
@


1.10
log
@convert strlfun.c to autodetected
@
text
@d1 1
a1 1
# $MirOS: contrib/code/mirmake/dist/scripts/Makefile.lib,v 1.9 2005/11/24 11:36:28 tg Exp $
a8 1
DEBUGLIBS=	no
@


1.9
log
@* add testfunc() to check for the existence of functions,
  autoconf-style instead of imake-style
* check for fgetln(3) and replace it with hand-made version
  using GNU getline(3)
@
text
@d1 1
a1 1
# $MirOS: contrib/code/mirmake/dist/scripts/Makefile.lib,v 1.8 2005/09/19 18:42:18 tg Exp $
a14 4
.if ${OStype:NDarwin:N*BSD} != ""
SRCS+=		strlfun.c
.endif

@


1.8
log
@only add strlfun.c if not *BSD or Darwin
@
text
@d1 1
a1 1
# $MirOS: contrib/code/mirmake/dist/scripts/Makefile.lib,v 1.7 2005/09/18 20:38:05 tg Exp $
d7 1
a7 1
		getopt_long.c
@


1.7
log
@we need to define _LIBMIRMAKE
@
text
@d1 1
a1 1
# $MirOS: contrib/code/mirmake/dist/scripts/Makefile.lib,v 1.6 2005/08/21 11:56:04 tg Exp $
d7 1
a7 1
		getopt_long.c strlfun.c
d15 4
@


1.6
log
@add mbcompat stuff from mirports pkgtools to libmirmake (on interix)
@
text
@d1 1
a1 1
# $MirOS: contrib/code/mirmake/dist/scripts/Makefile.lib,v 1.5 2005/06/08 10:03:24 tg Exp $
d11 1
@


1.5
log
@bundle and use {,v}asprintf in libmirmake - Interix only
@
text
@d1 1
a1 1
# $MirOS: contrib/code/mirmake/dist/scripts/Makefile.lib,v 1.4 2005/05/21 17:03:52 tg Exp $
d15 1
a15 1
SRCS+=		asprintf.c vasprintf.c
@


1.4
log
@arc4random suffers from random pool depletion when being used
on systems with /dev/urandom with mksh (being used often)

this must be solved differently, by an arc4randomd
@
text
@d1 1
a1 1
# $MirOS: contrib/code/mirmake/dist/scripts/Makefile.lib,v 1.3 2005/05/21 15:38:52 tg Exp $
d12 6
@


1.3
log
@extend by arc4random() from ports/in*/pkgtools/mbcompat/bsd-arc4random.c
enhanced by arc4random_push() pseudo (which works)
@
text
@d1 1
a1 1
# $MirOS: contrib/code/mirmake/dist/scripts/Makefile.lib,v 1.2 2005/05/21 15:03:01 tg Exp $
d7 1
a7 1
		arc4random.c getopt_long.c strlfun.c
@


1.2
log
@* getopt_long.c (our compatible getopt) joins libmirmake
* the mirmake dir is now added to the include search path
@
text
@d1 1
a1 1
# $MirOS: contrib/code/mirmake/dist/scripts/Makefile.lib,v 1.1 2005/05/21 14:56:48 tg Exp $
d7 1
a7 1
		getopt_long.c strlfun.c
@


1.1
log
@* libhash becomes libmirmake
* strlcpy and strlcat join libmirmake
* libmirmake is built using <bsd.lib.mk>

agreed bsiegert@@
@
text
@d1 1
a1 1
# $MirOS: contrib/code/mirmake/dist/scripts/Makefile.hash,v 1.1 2005/02/26 14:04:59 tg Exp $
d7 1
a7 1
		strlfun.c
@

