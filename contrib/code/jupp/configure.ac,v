head	1.74;
access;
symbols
	joe-3_1jupp38:1.74
	joe-3_1jupp37:1.73
	joe-3_1jupp36:1.72
	joe-3_1jupp35:1.71
	joe-3_1jupp34:1.70
	joe-3_1jupp33:1.69
	joe-3_1jupp32:1.66
	joe-3_1jupp31:1.56
	joe-3_1jupp30:1.54
	joe-3_1jupp29:1.52
	joe-3_1jupp28:1.46
	joe-3_1jupp27:1.45
	joe-3_1jupp26:1.44
	joe-3_1jupp25:1.43
	joe-3_1jupp24:1.42
	joe-3_1jupp23:1.41
	joe-3_1jupp22:1.40
	joe-3_1jupp21:1.39
	joe-3_1jupp20:1.38
	joe-3_1jupp19:1.35
	joe-3_1jupp18:1.29
	joe-3_1jupp17:1.28
	joe-3_1jupp16:1.27
	joe-3_1jupp15:1.25
	joe-3_1jupp14:1.21
	joe-3_1jupp12:1.20
	joe-3_1jupp11:1.12
	joe-3_1jupp10:1.10
	joe-3_1jupp9:1.9
	joe-3_1jupp8:1.8
	joe-3_1jupp7:1.7
	joe-3_1jupp6:1.6
	joe-3_1jupp5:1.5
	joe-3_1jupp4:1.4
	joe-3_1:1.1.201.1
	tg:1.1.201;
locks; strict;
comment	@# @;


1.74
date	2018.11.11.18.20.51;	author tg;	state Exp;
branches;
next	1.73;
commitid	1005BE872F324B3552E;

1.73
date	2018.10.20.16.19.00;	author tg;	state Exp;
branches;
next	1.72;
commitid	1005BCB55874CF40648;

1.72
date	2018.03.15.22.48.00;	author tg;	state Exp;
branches;
next	1.71;
commitid	1005AAAF8233681A885;

1.71
date	2018.02.14.22.28.12;	author tg;	state Exp;
branches;
next	1.70;
commitid	1005A84B80D6E0680C7;

1.70
date	2018.02.14.21.57.20;	author tg;	state Exp;
branches;
next	1.69;
commitid	1005A84B0D072D7B670;

1.69
date	2018.02.13.20.04.11;	author tg;	state Exp;
branches;
next	1.68;
commitid	1005A8344D158B09F23;

1.68
date	2018.02.01.02.36.51;	author tg;	state Exp;
branches;
next	1.67;
commitid	1005A727D595A5F3466;

1.67
date	2018.01.18.21.59.12;	author tg;	state Exp;
branches;
next	1.66;
commitid	1005A6118BD6F94E8BD;

1.66
date	2017.12.16.22.38.03;	author tg;	state Exp;
branches;
next	1.65;
commitid	1005A35A05C32739D94;

1.65
date	2017.12.07.00.48.10;	author tg;	state Exp;
branches;
next	1.64;
commitid	1005A288FDC64406390;

1.64
date	2017.12.06.21.16.55;	author tg;	state Exp;
branches;
next	1.63;
commitid	1005A285E5918D423C7;

1.63
date	2017.12.04.21.46.21;	author tg;	state Exp;
branches;
next	1.62;
commitid	1005A25C24467DA873B;

1.62
date	2017.12.03.01.11.49;	author tg;	state Exp;
branches;
next	1.61;
commitid	1005A234F65657C7FBC;

1.61
date	2017.12.02.05.26.39;	author tg;	state Exp;
branches;
next	1.60;
commitid	1005A22397D0C8A82FF;

1.60
date	2017.12.02.05.15.46;	author tg;	state Exp;
branches;
next	1.59;
commitid	1005A2237171EDF150A;

1.59
date	2017.12.02.04.15.29;	author tg;	state Exp;
branches;
next	1.58;
commitid	1005A2228EC3463D689;

1.58
date	2017.12.01.23.02.14;	author tg;	state Exp;
branches;
next	1.57;
commitid	1005A21DF8723B4002C;

1.57
date	2017.11.18.16.25.07;	author tg;	state Exp;
branches;
next	1.56;
commitid	1005A105EF520A74945;

1.56
date	2017.08.09.01.00.22;	author tg;	state Exp;
branches;
next	1.55;
commitid	100598A5EC16671A274;

1.55
date	2017.08.08.21.30.47;	author tg;	state Exp;
branches;
next	1.54;
commitid	100598A2D911B6F8739;

1.54
date	2017.01.11.22.09.19;	author tg;	state Exp;
branches;
next	1.53;
commitid	1005876AD2622CB6ED4;

1.53
date	2017.01.11.21.34.39;	author tg;	state Exp;
branches;
next	1.52;
commitid	1005876A50311782E22;

1.52
date	2016.10.30.02.47.28;	author tg;	state Exp;
branches;
next	1.51;
commitid	10058155F5A7F6A9A5D;

1.51
date	2016.10.30.00.05.26;	author tg;	state Exp;
branches;
next	1.50;
commitid	10058153959126ADFB7;

1.50
date	2016.10.29.23.51.23;	author tg;	state Exp;
branches;
next	1.49;
commitid	1005815360D5C4C4383;

1.49
date	2016.10.29.23.44.44;	author tg;	state Exp;
branches;
next	1.48;
commitid	1005815347F236258ED;

1.48
date	2016.10.08.17.44.17;	author tg;	state Exp;
branches;
next	1.47;
commitid	10057F9303837FBF229;

1.47
date	2016.10.07.10.57.06;	author tg;	state Exp;
branches;
next	1.46;
commitid	10057F77F8568C4A6DC;

1.46
date	2014.10.23.16.27.26;	author tg;	state Exp;
branches;
next	1.45;
commitid	10054492C813B5FA2F8;

1.45
date	2014.06.29.11.39.51;	author tg;	state Exp;
branches;
next	1.44;
commitid	10053AFFB1F1E30AB4D;

1.44
date	2013.11.07.22.17.43;	author tg;	state Exp;
branches;
next	1.43;
commitid	100527C11A0790B5F87;

1.43
date	2013.08.19.19.23.44;	author tg;	state Exp;
branches;
next	1.42;
commitid	100521270D97530EF66;

1.42
date	2013.01.05.22.16.30;	author tg;	state Exp;
branches;
next	1.41;
commitid	10050E8A62658CA1DDF;

1.41
date	2012.12.19.23.11.41;	author tg;	state Exp;
branches;
next	1.40;
commitid	10050D249C5338D73D2;

1.40
date	2012.09.02.14.46.50;	author tg;	state Exp;
branches;
next	1.39;
commitid	100504371717CC33E24;

1.39
date	2012.07.18.17.07.42;	author tg;	state Exp;
branches;
next	1.38;
commitid	1005006ED6E51131687;

1.38
date	2012.06.08.17.07.22;	author tg;	state Exp;
branches;
next	1.37;
commitid	1004FD231603A11D6E1;

1.37
date	2012.06.08.17.05.12;	author tg;	state Exp;
branches;
next	1.36;
commitid	1004FD230DF587015A2;

1.36
date	2012.06.08.13.44.43;	author tg;	state Exp;
branches;
next	1.35;
commitid	1004FD201A323B7A3AB;

1.35
date	2012.06.07.22.39.53;	author tg;	state Exp;
branches;
next	1.34;
commitid	1004FD12DD10ADFC4F7;

1.34
date	2012.06.07.22.16.09;	author tg;	state Exp;
branches;
next	1.33;
commitid	1004FD12822341B4DF9;

1.33
date	2012.06.07.20.41.24;	author tg;	state Exp;
branches;
next	1.32;
commitid	1004FD1120C0B9F0BE3;

1.32
date	2012.06.07.20.37.40;	author tg;	state Exp;
branches;
next	1.31;
commitid	1004FD1112C4BD11E1E;

1.31
date	2012.06.07.19.01.29;	author tg;	state Exp;
branches;
next	1.30;
commitid	1004FD0FA4D602B1239;

1.30
date	2011.10.05.21.24.29;	author tg;	state Exp;
branches;
next	1.29;
commitid	1004E8CCB1A0BCB07B3;

1.29
date	2011.10.04.22.47.51;	author tg;	state Exp;
branches;
next	1.28;
commitid	1004E8B8D280DB0966B;

1.28
date	2011.07.27.18.43.11;	author tg;	state Exp;
branches;
next	1.27;
commitid	1004E305C5552BB9FCB;

1.27
date	2011.07.16.22.01.28;	author tg;	state Exp;
branches;
next	1.26;
commitid	1004E220A4F356CB704;

1.26
date	2011.07.16.21.57.56;	author tg;	state Exp;
branches;
next	1.25;
commitid	1004E2209506F4A1334;

1.25
date	2011.07.02.23.00.25;	author tg;	state Exp;
branches;
next	1.24;
commitid	1004E0FA31A0C2E17A1;

1.24
date	2011.07.02.22.51.19;	author tg;	state Exp;
branches;
next	1.23;
commitid	1004E0FA0FC54D20543;

1.23
date	2011.07.02.22.50.52;	author tg;	state Exp;
branches;
next	1.22;
commitid	1004E0FA0C8102DBFF8;

1.22
date	2011.07.02.22.49.12;	author tg;	state Exp;
branches;
next	1.21;
commitid	1004E0FA07535C20AF8;

1.21
date	2010.04.08.15.31.01;	author tg;	state Exp;
branches;
next	1.20;
commitid	1004BBDF6C54CC9A0DB;

1.20
date	2009.10.18.17.54.54;	author tg;	state Exp;
branches;
next	1.19;
commitid	1004ADB567B46FA7B95;

1.19
date	2009.10.18.17.38.08;	author tg;	state Exp;
branches;
next	1.18;
commitid	1004ADB52943E222C86;

1.18
date	2009.10.18.17.27.54;	author tg;	state Exp;
branches;
next	1.17;
commitid	1004ADB50276D298069;

1.17
date	2009.10.18.17.04.44;	author tg;	state Exp;
branches;
next	1.16;
commitid	1004ADB4AC0612071CC;

1.16
date	2009.10.06.10.18.03;	author tg;	state Exp;
branches;
next	1.15;
commitid	1004ACB196976E3E916;

1.15
date	2009.10.06.09.54.04;	author tg;	state Exp;
branches;
next	1.14;
commitid	1004ACB13C97E8DE1DB;

1.14
date	2009.10.06.09.07.30;	author tg;	state Exp;
branches;
next	1.13;
commitid	1004ACB08E905F8F83E;

1.13
date	2009.09.19.22.42.41;	author tg;	state Exp;
branches;
next	1.12;
commitid	1004AB55E716077E8C2;

1.12
date	2009.08.02.15.47.31;	author tg;	state Exp;
branches;
next	1.11;
commitid	1004A75B5265F7C4E4F;

1.11
date	2009.07.30.20.15.58;	author tg;	state Exp;
branches;
next	1.10;
commitid	1004A71FF847A92ABE0;

1.10
date	2008.08.25.13.44.40;	author tg;	state Exp;
branches;
next	1.9;
commitid	10048B2B75B167F9B6B;

1.9
date	2008.05.13.13.08.21;	author tg;	state Exp;
branches;
next	1.8;
commitid	100482992BC01EE89A1;

1.8
date	2007.02.18.22.45.56;	author tg;	state Exp;
branches;
next	1.7;
commitid	10045D8D7375EAE09B7;

1.7
date	2006.11.11.00.24.55;	author tg;	state Exp;
branches;
next	1.6;
commitid	1004555186C2FE9365D;

1.6
date	2006.10.16.18.49.43;	author tg;	state Exp;
branches;
next	1.5;
commitid	1004533D4475A549346;

1.5
date	2005.12.22.20.18.35;	author tg;	state Exp;
branches;
next	1.4;
commitid	10043AB0A281C6B5AF7;

1.4
date	2005.08.26.23.10.42;	author tg;	state Exp;
branches;
next	1.3;
commitid	12bc430fa1790090;

1.3
date	2005.02.11.21.37.30;	author tg;	state Exp;
branches;
next	1.2;

1.2
date	2005.02.05.02.42.20;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.02.05.00.37.07;	author tg;	state Exp;
branches
	1.1.201.1;
next	;

1.1.201.1
date	2005.02.05.00.37.07;	author tg;	state Exp;
branches;
next	;


desc
@@


1.74
log
@drop <sys/termios.h> as requested by musl libc;
no complaints from https://stackoverflow.com/q/53200928/2171120

also, don’t check for <termios.h> separately and streamline includes;
bump version while here
@
text
@# $MirOS: contrib/code/jupp/configure.ac,v 1.72 2018/03/15 22:48:00 tg Exp $
#-
# Process this file with autoconf to produce a configure script.

# We need AC_PROG_EGREP
AC_PREREQ(2.54)

#### Here's the only place where to change version number ####
AC_INIT(joe, 3.1jupp38)
#### But see main.c for the Copyright (c) owner and year! ####
AC_CONFIG_SRCDIR([b.c])

AC_CANONICAL_BUILD
AC_CANONICAL_HOST
AC_CANONICAL_TARGET

# Init automake
AM_INIT_AUTOMAKE
AM_MAINTAINER_MODE
AM_CONFIG_HEADER(autoconf.h)

# Checks for programs.
AC_PROG_CC
AC_PROG_CPP
AC_PROG_EGREP
AC_PROG_INSTALL
AC_PROG_LN_S

case $host in
*-*-minix*)
	CPPFLAGS="$CPPFLAGS -D_POSIX_SOURCE -D_POSIX_1_SOURCE=2 -D_MINIX"
	;;
*-gnu*)
	CPPFLAGS="$CPPFLAGS -D_GNU_SOURCE"
	;;
esac

case $host in
*-*-mirbsd* | *-*-openbsd*)
	AC_DEFINE(HAVE_GCC_ATTRIBUTE_BOUNDED, 1, [Define if GCC has Anil's bounds checker])
	;;
esac


# Checks for libraries.

search_libs_selinux="selinux"
search_libs_snprintf="snprintf db"
search_libs_term=""
search_libs_util="util"

AC_ARG_ENABLE(curses,
[  --disable-curses        disable use of curses library],
	curses=$enableval, curses=yes)
test x"$curses" = x"yes" && \
    search_libs_term="$search_libs_term tinfo ncursesw ncurses curses"

AC_ARG_ENABLE(termcap,
[  --disable-termcap       disable use of termcap library],
	termcap=$enableval, termcap=yes)
test x"$termcap" = x"yes" && \
    search_libs_term="$search_libs_term termcap"

AC_ARG_ENABLE(terminfo,
[  --disable-terminfo      disable use of terminfo functions],
	terminfo=$enableval, terminfo=yes)

AC_ARG_ENABLE(selinux,
[  --disable-selinux       disable SELinux context copying],
	selinux=$enableval, selinux=yes)

AC_ARG_ENABLE([search_libs],
[  --disable-search-libs   do not search in any external libraries],
	search_libs=$enableval, search_libs=yes)

if test x"$search_libs" = x"no"; then
	search_libs_selinux=""
	search_libs_snprintf=""
	search_libs_term=""
	search_libs_util=""
fi

AC_SEARCH_LIBS(openpty, $search_libs_util, AC_DEFINE_UNQUOTED(HAVE_OPENPTY, 1, [If we have BSD function openpty()]))
AC_SEARCH_LIBS(login_tty, $search_libs_util, AC_DEFINE_UNQUOTED(HAVE_LOGIN_TTY, 1, [If we have BSD function login_tty()]))
if test x"$terminfo" = x"no"; then
	echo "DISabling looking for terminal libraries entirely!"
else
	AC_SEARCH_LIBS(tgetflag, $search_libs_term, AC_DEFINE_UNQUOTED(TERMINFO, 1, [If we have newer terminfo/termcap capabilities]))
fi
AC_SEARCH_LIBS(snprintf, $search_libs_snprintf, AC_DEFINE_UNQUOTED(HAVE_SNPRINTF, 1, [If we have snprintf]))
if test x"$selinux" = x"no"; then
	echo "DISabling looking for SELinux support"
else
	AC_SEARCH_LIBS(is_selinux_enabled, $search_libs_selinux, AC_DEFINE_UNQUOTED(HAVE_SELINUX_FUN, 1, [We have SELinux functions]))
fi


# other conditionals

AC_ARG_ENABLE([getpwnam],
[  --disable-getpwnam      disable use of getpwnam function],
	getpwnam=$enableval, getpwnam=yes)
test x"$getpwnam" = x"no" && CPPFLAGS="$CPPFLAGS -DJOE_NOPWNAM"

AC_ARG_ENABLE([termidx],
[  --disable-termidx       do not build the termidx binary],
	termidx=$enableval, termidx=yes)
AM_CONDITIONAL([WANT_TERMIDX], [test x"$termidx" != x"no"])

AC_ARG_ENABLE([sysconfjoesubdir],
[  --enable-sysconfjoesubdir=/joe  (default value)],
	[sysconfjoesubdir=$enableval], [sysconfjoesubdir=yes])
if test x"$sysconfjoesubdir" = x"yes"; then
	sysconfjoesubdir=/joe
elif test x"$sysconfjoesubdir" = x"no"; then
	sysconfjoesubdir=
fi
AC_SUBST(sysconfjoesubdir)

AC_ARG_ENABLE([win32reloc],
[  --enable-win32reloc     enable win32 self-relocation],
	[win32reloc=$enableval], [win32reloc=no])
if test x"$win32reloc" = x"yes"; then
	JUPP_WIN32RELOC=1
else
	JUPP_WIN32RELOC=0
fi
AC_DEFINE_UNQUOTED([JUPP_WIN32RELOC], [$JUPP_WIN32RELOC], [Use Win32 argv0-relative paths?])
if test x"$win32reloc" = x"yes"; then
	joeinitfile='\\fBjoerc\\fR in the same directory as the binary resides in'
	joeinitcopy='which resides in the same directory as the binary'
	joeresides='C:\\eProgramme\\ejupp32\\ejoe.exe'
	jrcbefore=''
	jrcafter=' in the same directory as the binary'
elif test x"$win32reloc" = x"old"; then
	joeinitfile='\\fBc:/windows/system32/joe/joerc\\fR'
	joeinitcopy='which resides in \\fBc:/windows/system32/joe/joerc\\fR'
	joeresides='c:/windows/system32/joe.exe'
	jrcbefore='c:/windows/system32/joe/'
	jrcafter=''
else
	joeinitfile='usually \\fB'$sysconfdir$sysconfjoesubdir'/joerc\\fR'
	joeinitcopy='which normally resides in \\fB'$sysconfdir$sysconfjoesubdir'/joerc\\fR'
	joeresides=$bindir'/joe'
	jrcbefore=$sysconfdir$sysconfjoesubdir/
	jrcafter=''
fi
AC_SUBST(joeinitfile)
AC_SUBST(joeinitcopy)
AC_SUBST(joeresides)
AC_SUBST(jrcbefore)
AC_SUBST(jrcafter)


# Checks for header files.

AC_CHECK_HEADERS([ \
	sys/dirent.h sys/ioctl.h sys/param.h sys/stat.h sys/termio.h \
	sys/time.h sys/types.h sys/wait.h errno.h fcntl.h \
	langinfo.h limits.h locale.h paths.h pty.h pwd.h sgtty.h signal.h \
	stdlib.h string.h termio.h time.h unistd.h util.h utime.h \
	utmp.h bsd/string.h selinux/context.h selinux/selinux.h \
])
AC_HEADER_DIRENT
AC_SYS_POSIX_TERMIOS
if test "$ac_cv_sys_posix_termios" = "yes"; then
	AC_DEFINE(HAVE_POSIX_TERMIOS, 1, [We have <termios.h> and maybe <sys/termios.h>])
else
	if test "$ac_cv_header_termio_h" = "yes" -a "$ac_cvs_header_sys_termio_h" = "yes" ]; then
		AC_DEFINE(HAVE_SYSV_TERMIO, 1, [We have <termio.h> and <sys/termio.h>])
	fi
fi
AC_HEADER_TIOCGWINSZ

AC_HEADER_TIME

# Checks for typedefs, structures, and compiler characteristics.

AC_C_CONST
AC_SYS_LARGEFILE
if test "$cross_compiling" = "yes" ; then
	AC_MSG_WARN(cross compiling so assuming defaults for most 32 bit machines)
fi
AC_CHECK_SIZEOF(char, 1)
AC_CHECK_SIZEOF(short, 2)
AC_CHECK_SIZEOF(int, 4)
AC_CHECK_SIZEOF(long, 4)
AC_CHECK_SIZEOF(void *, 4)
AC_CHECK_SIZEOF(long long, 8)
AC_CHECK_SIZEOF(off_t, 8)
AC_CHECK_TYPE([sighandler_t],
	[AC_DEFINE([HAVE_SIGHANDLER_T], 1, [Define if you have the `sighandler_t' type.])],
	,
	[/* if you have signal.h header, include it */
#ifdef HAVE_SIGNAL_H
#include <signal.h>
#endif])

# Checks for library functions.

AC_PROG_GCC_TRADITIONAL
AC_FUNC_FSEEKO
AC_FUNC_LSTAT
joe_SETPGRP
AC_TYPE_PID_T
AC_TYPE_SIZE_T
AC_CHECK_TYPE([ssize_t], [], [
	AC_DEFINE([ssize_t], [int], [Define to `int' if <sys/types.h> does not define.])
	], [])
AC_TYPE_SIGNAL
AC_FUNC_STAT
AC_CHECK_FUNCS([getcwd getwd])
if test x"$ac_cv_func_getcwd" != xyes; then
	if test x"$ac_cv_func_getwd" != xyes; then
		AC_MSG_ERROR([don't know how to get current working directory])
	fi
fi
AC_CHECK_FUNCS([alarm ctime fsync get_current_dir_name isatty mkdir mkstemp])
AC_CHECK_FUNCS([nl_langinfo popen putenv setitimer setlocale setpgid])
AC_CHECK_FUNCS([sigaction siginterrupt sigprocmask sigvec strchr strdup])
AC_CHECK_FUNCS([strlcat strlcpy sync utime])

AC_ARG_ENABLE([fork],
[  --disable-fork          disable use of fork],
	use_fork=$enableval, use_fork=yes)
test x"$use_fork" = x"no" && ac_cv_func_fork=no
AC_CHECK_FUNCS([fork unsetenv])
case $use_fork:$ac_cv_func_fork in
no:*) use_fork=0 ;;
*:yes) use_fork=1 ;;
*) use_fork=0 ;;
esac
AC_DEFINE_UNQUOTED([WANT_FORK], [$use_fork], [We have fork(2) and want to use it])
if test $use_fork = 1; then
	echo "Enabling use of fork(), concurrent subshells, etc."
else
	echo "DISabling use of fork() and concurrent subshells (NOMMU)!"
fi

AC_ARG_ENABLE([fpu],
[  --disable-fpu           disable use of floating point arithmetics],
	use_fpu=$enableval, use_fpu=yes)
if test x"$use_fpu" = x"no"; then
	use_fpu=0
else
	use_fpu=1
fi
AC_DEFINE_UNQUOTED([WANT_MATH], [$use_fpu], [Can we use the FPU?])
if test $use_fpu = 1; then
	echo "Enabling use of floating point arithmetics"
else
	echo "DISabling Math support for lack of an FPU!"
fi

AC_ARG_ENABLE([small],
[  --enable-small          reduce memory footprint by a few KiB],
	use_small=$enableval, use_small=no)
if test x"$use_small" = x"yes"; then
	# for constrained systems (like 8 MiB RAM total) only
	AC_DEFINE([SMALL], [1], [Reduce memory footprint slightly])
fi

AC_CHECK_DECLS([strlcpy, strlcat, popen])
AC_CHECK_DECLS([ctime], [], [], [AC_INCLUDES_DEFAULT
#ifdef TIME_WITH_SYS_TIME
# include <sys/time.h>
# include <time.h>
#else
# ifdef HAVE_SYS_TIME_H
#  include <sys/time.h>
# else
#  include <time.h>
# endif
#endif
])

joe_REINSTALL_SIGHANDLERS

# Check for programs..
AC_CHECK_PROG(SPELL,aspell,aspell,ispell)

# strictly speaking, the .jsf files should have no substitutions,
# as they don’t do what you think they expand, currently it’s more
# expensive however to rename them in CVS, so we keep that until
# jupp has converted to mirtoconf
AC_CONFIG_FILES([Makefile
syntax/c.jsf syntax/perl.jsf syntax/verilog.jsf syntax/sh.jsf syntax/python.jsf
syntax/conf.jsf syntax/php.jsf syntax/mail.jsf syntax/pascal.jsf syntax/html.jsf
syntax/vhdl.jsf syntax/fortran.jsf syntax/java.jsf syntax/xml.jsf syntax/tcl.jsf
charmaps/klingon syntax/lisp.jsf syntax/csh.jsf syntax/mason.jsf syntax/diff.jsf
syntax/asm.jsf syntax/tex.jsf])
AC_OUTPUT
@


1.73
log
@prepare the next release
@
text
@d9 1
a9 1
AC_INIT(joe, 3.1jupp37)
d159 1
a159 1
	sys/termios.h sys/time.h sys/types.h sys/wait.h errno.h fcntl.h \
d161 1
a161 1
	stdlib.h string.h termio.h termios.h time.h unistd.h util.h utime.h \
@


1.72
log
@(try to) fix substitution fuckup

cf. https://www.gnu.org/software/autoconf/manual/autoconf-2.63/html_node/Installation-Directory-Variables.html
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.68 2018/02/01 02:36:51 tg Exp $
d9 1
a9 1
AC_INIT(joe, 3.1jupp36)
@


1.71
log
@ok, let’s take the time to fix another bug that suddenly appeared
@
text
@d9 1
a9 1
AC_INIT(joe, 3.1jupp35)
a126 1
	AC_DEFINE_UNQUOTED([JOERC], ["$sysconfdir$sysconfjoesubdir/"], [Unix absolute paths base])
d282 5
a286 1
AC_CONFIG_FILES([Makefile joerc jmacsrc jstarrc rjoerc jpicorc
@


1.70
log
@prepare tarent-sponsored new almost-brown-paperbag release
@
text
@d9 1
a9 1
AC_INIT(joe, 3.1jupp34)
@


1.69
log
@advent of the new release
@
text
@d9 1
a9 1
AC_INIT(joe, 3.1jupp33)
@


1.68
log
@remove obsolete check
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.64 2017/12/06 21:16:55 tg Exp $
d9 1
a9 1
AC_INIT(joe, 3.1jupp32)
@


1.67
log
@make jupp save a bit more safely
@
text
@a218 4
AC_CHECK_FUNCS([isblank])
if test x"$ac_cv_func_isblank" = xyes; then
	joe_ISBLANK
fi
@


1.66
log
@looks like I fucked up migrating -DJOERC… oops
@
text
@d223 4
a226 3
AC_CHECK_FUNCS([alarm mkdir mkstemp putenv setlocale strchr strdup utime setpgid])
AC_CHECK_FUNCS([setitimer sigaction sigvec siginterrupt sigprocmask isatty])
AC_CHECK_FUNCS([strlcpy strlcat nl_langinfo get_current_dir_name ctime popen])
@


1.65
log
@this is as close to the next jupp release as it can get
@
text
@d127 1
a127 1
	AC_DEFINE_UNQUOTED([JOERC], ["$sysconfdir$sysconfjoesubdir"], [Unix absolute paths base])
@


1.64
log
@begin overhaul for antique/header compat:
• PARAMS begone
• libc4 ustat definition: resolve inline
• ignore HAVE_*_H for headers mksh includes unconditionally
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.63 2017/12/04 21:46:21 tg Exp $
d9 1
a9 1
AC_INIT(joe, 3.1jupp31dev)
d259 7
@


1.63
log
@add --disable-selinux, for wbx
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.51 2016/10/30 00:05:26 tg Exp $
a179 1
AC_C_PROTOTYPES
a275 9
AH_VERBATIM([_PARAMS],[/* Check to see if we can use strict prototypes */
#ifndef PARAMS
#  ifdef PROTOTYPES
#    define PARAMS(protos) protos
#  else
#    define PARAMS(protos) ()
#  endif
#endif])

@


1.62
log
@move extra arguments off the cc(1) command line
@
text
@d68 4
d91 5
a95 1
AC_SEARCH_LIBS(is_selinux_enabled, $search_libs_selinux, AC_DEFINE_UNQUOTED(HAVE_SELINUX_FUN, 1, [We have SELinux functions]))
a177 5
if test "$ac_cv_header_selinux_selinux_h" = "yes" -a "$ac_cv_header_selinux_context_h" = "yes" ; then
	echo "Enabling SELinux context copying!"
	AC_DEFINE(HAVE_SELINUX_HDR, 1, [We have SELinux headers])
fi

@


1.61
log
@skip TERMINFO altogether on Win32 (jupp32 builds)

XXX einklich™ müßten wir sowas für alle Libraries machen
currently, if someone’s got the SELinux functions in libc, they’re fucked
@
text
@d9 1
a9 1
AC_INIT(joe, 3.1jupp31)
d115 7
a121 1
AM_CONDITIONAL([JUPP_WIN32RELOC], [test x"$win32reloc" = x"yes"])
@


1.60
log
@support ncursesw search
@
text
@d64 4
d81 5
a85 1
AC_SEARCH_LIBS(tgetflag, $search_libs_term, AC_DEFINE_UNQUOTED(TERMINFO, 1, [If we have newer terminfo/termcap capabilities]))
@


1.59
log
@first cut at fixing the klibc builds

cf. https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=852327
@
text
@d56 1
a56 1
    search_libs_term="$search_libs_term tinfo ncurses curses"
@


1.58
log
@document loudly whether this is an NOMMU build
@
text
@d228 16
@


1.57
log
@scan for fork (can be disabled), unsetenv
@
text
@d222 5
@


1.56
log
@bump
@
text
@d211 12
@


1.55
log
@make “find … | xargs jupp” work in the absence of BSD xargs -o (e.g. GNU)
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.54 2017/01/11 22:09:19 tg Exp $
d9 1
a9 1
AC_INIT(joe, 3.1jupp30)
@


1.54
log
@prepare for jupp30
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.51 2016/10/30 00:05:26 tg Exp $
d208 1
a208 1
AC_CHECK_FUNCS([setitimer sigaction sigvec siginterrupt sigprocmask])
@


1.53
log
@do not force use of /usr/local on Solaris
@
text
@d9 1
a9 1
AC_INIT(joe, 3.1jupp29)
@


1.52
log
@release
@
text
@a32 4
*-*-solaris*)
	CPPFLAGS="$CPPFLAGS -I/usr/local/include"
	LDFLAGS="$LDFLAGS -L/usr/local/lib -R/usr/local/lib"
	;;
@


1.51
log
@we need to double the backslashes (for sed) now
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.45 2014/06/29 11:39:51 tg Exp $
d9 1
a9 1
AC_INIT(joe, 3.1jupp29~pre2)
@


1.50
log
@generating the manpage is make’s job now
@
text
@d113 1
a113 1
	joeinitfile='\fBjoerc\fR in the same directory as the binary resides in'
d115 1
a115 1
	joeresides='C:\eProgramme\ejupp32\ejoe.exe'
d119 2
a120 2
	joeinitfile='\fBc:/windows/system32/joe/joerc\fR'
	joeinitcopy='which resides in \fBc:/windows/system32/joe/joerc\fR'
d125 2
a126 2
	joeinitfile='usually \fB'$sysconfdir$sysconfjoesubdir'/joerc\fR'
	joeinitcopy='which normally resides in \fB'$sysconfdir$sysconfjoesubdir'/joerc\fR'
@


1.49
log
@first cut at win32 self-relocation
@
text
@d115 1
a115 1
	joeresides='C:\eProgram\ Files\ejupp32\ejoe.exe'
d243 1
a243 1
AC_CONFIG_FILES([Makefile joe.1 joerc jmacsrc jstarrc rjoerc jpicorc
@


1.48
log
@use autoconf to DTRT, bump to ~pre1, prepare things yet to come
@
text
@d9 1
a9 1
AC_INIT(joe, 3.1jupp29~pre1)
d110 2
a111 2
	[win32reloc=$enableval], [win32reloc=auto])
test x"$win32reloc" = x"old" || win32reloc=no # currently not implemented
@


1.47
log
@add syntax file for minimal Teχ; mostly mature

(modulo syntax highlighting addressing octets, not characters)
@
text
@d9 1
a9 1
AC_INIT(joe, 3.1jupp28)
d98 39
@


1.46
log
@bump
@
text
@d209 1
a209 1
syntax/asm.jsf])
@


1.45
log
@bump
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.44 2013/11/07 22:17:43 tg Exp $
d9 1
a9 1
AC_INIT(joe, 3.1jupp27)
@


1.44
log
@bump
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.43 2013/08/19 19:23:44 tg Exp $
d9 1
a9 1
AC_INIT(joe, 3.1jupp26)
@


1.43
log
@this will be jupp25 “FrogLabs Edition, FrOSCon 2013” (unless Eike finds even more bugs…)
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.42 2013/01/05 22:16:30 tg Exp $
d9 1
a9 1
AC_INIT(joe, 3.1jupp25)
@


1.42
log
@BUGFIX: using -guess_indent, which is a global option, in per-file context
leads to… surprises (two-space indentation in asm.h WTF‽); fix and release
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.41 2012/12/19 23:11:41 tg Exp $
d9 1
a9 1
AC_INIT(joe, 3.1jupp24)
@


1.41
log
@harmonise syntax files and take the security improvement as an excuse to release
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.40 2012/09/02 14:46:50 tg Exp $
d9 1
a9 1
AC_INIT(joe, 3.1jupp23)
@


1.40
log
@improve syntax highlighting further and release
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.39 2012/07/18 17:07:42 tg Exp $
d9 1
a9 1
AC_INIT(joe, 3.1jupp22)
@


1.39
log
@prepare new version (critical fixes)
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.38 2012/06/08 17:07:22 tg Exp $
d9 1
a9 1
AC_INIT(joe, 3.1jupp21)
@


1.38
log
@bump
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.36 2012/06/08 13:44:43 tg Exp $
d9 1
a9 1
AC_INIT(joe, 3.1jupp20)
@


1.37
log
@enable Large File Support
@
text
@d9 1
a9 1
AC_INIT(joe, 3.1jupp19)
@


1.36
log
@next time, mira, read the autoconf-2.61(GNU) documentation before using
any funny functions whose syntacēs and semantics you don’t know by heart
yet: AC_CHECK_DECLS wants headers; fixes ctime decl check on GNU/Linux
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.35 2012/06/07 22:39:53 tg Exp $
d130 1
d152 1
@


1.35
log
@bump to 3.1.19
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.34 2012/06/07 22:16:09 tg Exp $
d174 13
a186 1
AC_CHECK_DECLS([strlcpy, strlcat, ctime, popen])
@


1.34
log
@• switch strlfun.c to symlinked strlfun.inc; add symlinked popen.inc
• new compat.c including the *.inc files if needed and providing ctime for klibc
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.33 2012/06/07 20:41:24 tg Exp $
d9 1
a9 1
AC_INIT(joe, 3.1jupp18)
@


1.33
log
@nuke junk, can always resurrect it later
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.31 2012/06/07 19:01:29 tg Exp $
d172 1
a172 1
AC_CHECK_FUNCS([strlcpy strlcat nl_langinfo get_current_dir_name])
d174 1
a174 1
AC_CHECK_DECLS([strlcpy, strlcat])
@


1.32
log
@add --disable-search-libs hack for Debian #676569 workaround
@
text
@a177 11
# check if -liconv is necessary
# if iconv() is in libc, don't bother with -liconv
#AC_CHECK_LIB(c,iconv,
#  [REQRD_LIBS= ],
#  [REQRD_LIBS=-liconv])
#
#AC_SUBST(REQRD_LIBS)

dnl not yet :-)
dnl AM_GNU_GETTEXT

@


1.31
log
@• configure.ac: add -D_GNU_SOURCE on Hurd
• configure.ac: check for get_current_dir_name function
• path.c: if PATH_MAX is not defined, do not complain about that and do
  not define a fallback of 4096 if get_current_dir_name is available
• path.c: second codepath for !PATH_MAX but get_current_dir_name (GNU/Hurd)
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.30 2011/10/05 21:24:29 tg Exp $
d48 1
d50 6
d59 2
a60 4

if test "$curses" = "yes"; then
	search_libs="tinfo ncurses curses"
fi
d65 6
d72 5
a76 2
if test "$termcap" = "yes"; then
	search_libs="$search_libs termcap"
d79 9
d91 1
a91 4

if test x"$getpwnam" = x"no"; then
	CPPFLAGS="$CPPFLAGS -DJOE_NOPWNAM"
fi
a97 5
AC_SEARCH_LIBS(openpty, util, AC_DEFINE_UNQUOTED(HAVE_OPENPTY, 1, [If we have BSD function openpty()]))
AC_SEARCH_LIBS(login_tty, util, AC_DEFINE_UNQUOTED(HAVE_LOGIN_TTY, 1, [If we have BSD function login_tty()]))
AC_SEARCH_LIBS(tgetflag, $search_libs, AC_DEFINE_UNQUOTED(TERMINFO, 1, [If we have newer terminfo/termcap capabilities]))
AC_SEARCH_LIBS(snprintf, snprintf db, AC_DEFINE_UNQUOTED(HAVE_SNPRINTF, 1, [If we have snprintf]))
AC_SEARCH_LIBS(is_selinux_enabled, selinux, AC_DEFINE_UNQUOTED(HAVE_SELINUX_FUN, 1, [We have SELinux functions]))
d100 1
d127 1
d149 1
@


1.30
log
@add patch from Debian to support ncurses tinfo split
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.29 2011/10/04 22:47:51 tg Exp $
d37 3
d154 1
a154 1
AC_CHECK_FUNCS([strlcpy strlcat nl_langinfo])
@


1.29
log
@release this as joe 3.1jupp18
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.28 2011/07/27 18:43:11 tg Exp $
d51 1
a51 1
	search_libs="ncurses curses"
@


1.28
log
@let's call this a release, then
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.27 2011/07/16 22:01:28 tg Exp $
d9 1
a9 1
AC_INIT(joe, 3.1jupp17)
@


1.27
log
@bump
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.26 2011/07/16 21:57:56 tg Exp $
d9 1
a9 1
AC_INIT(joe, 3.1jupp16)
@


1.26
log
@fixes from packages.debian.org/joe are merged; now do a warning cleanup
(although some are only a workaround, and the joe code gives the creeps)
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.25 2011/07/02 23:00:25 tg Exp $
d9 2
a10 2
AC_INIT(joe, 3.1jupp15)
#### But see main.c near use of the CPP macro VERSION for the (c) year
@


1.25
log
@make this jupp15
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.24 2011/07/02 22:51:19 tg Exp $
d153 2
@


1.24
log
@Minix 3 support
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.21 2010/04/08 15:31:01 tg Exp $
d9 1
a9 1
AC_INIT(joe, 3.1jupp14)
@


1.23
log
@autoconf for <langinfo.h>, nl_langinfo() and ifdef for CODESET
to determine whether we are doing posux locales
@
text
@d29 8
a36 5
case "$host" in
	*-*-solaris*)
		CPPFLAGS="$CPPFLAGS -I/usr/local/include"
		LDFLAGS="$LDFLAGS -L/usr/local/lib -R/usr/local/lib"
		;;
@


1.22
log
@mangle bounded attribute as well
@
text
@d82 2
a83 2
	limits.h locale.h paths.h pty.h pwd.h sgtty.h signal.h stdlib.h \
	string.h termio.h termios.h time.h unistd.h util.h utime.h \
d148 1
a148 1
AC_CHECK_FUNCS([strlcpy strlcat])
@


1.21
log
@Add --disable-getpwnam and clean up warnings
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.20 2009/10/18 17:54:54 tg Exp $
d34 6
a39 1
	*)	;;
@


1.20
log
@erm… ok, maybe with newlines backslash-escaped…
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.19 2009/10/18 17:38:08 tg Exp $
d9 1
a9 1
AC_INIT(joe, 3.1jupp12)
d54 8
d110 2
@


1.19
log
@improve header handling
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.18 2009/10/18 17:27:54 tg Exp $
d66 6
a71 6
AC_CHECK_HEADERS([
	sys/dirent.h sys/ioctl.h sys/param.h sys/stat.h sys/termio.h
	sys/termios.h sys/time.h sys/types.h sys/wait.h errno.h fcntl.h
	limits.h locale.h paths.h pty.h pwd.h sgtty.h signal.h stdlib.h
	string.h termio.h termios.h time.h unistd.h util.h utime.h
	utmp.h bsd/string.h selinux/context.h selinux/selinux.h
@


1.18
log
@AIX has no <sys/termios.h> but jupp works fine, I’d say
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.17 2009/10/18 17:04:44 tg Exp $
d66 7
d76 1
a76 1
	AC_DEFINE(HAVE_POSIX_TERMIOS, 1, [We have <termios.h> and <sys/termios.h>])
a77 1
	AC_CHECK_HEADERS([termio.h sys/termio.h])
a82 8
AC_CHECK_HEADERS([errno.h fcntl.h locale.h sgtty.h stdlib.h string.h])
AC_CHECK_HEADERS([sys/ioctl.h sys/param.h sys/time.h unistd.h utime.h])
AC_CHECK_HEADERS([sys/dirent.h time.h pwd.h paths.h pty.h])
AC_CHECK_HEADERS([sys/types.h sys/stat.h sys/wait.h limits.h signal.h])
AC_CHECK_HEADERS([sys/termios.h util.h utmp.h])

# Debian libbsd
AC_CHECK_HEADERS([bsd/string.h])
a85 1
AC_CHECK_HEADERS([selinux/selinux.h selinux/context.h])
@


1.17
log
@jupp12! ☺
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.16 2009/10/06 10:18:03 tg Exp $
d81 1
a81 1
AC_CHECK_HEADERS([util.h utmp.h])
@


1.16
log
@tentatively fix SELinux support
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.15 2009/10/06 09:54:04 tg Exp $
d9 1
a9 1
AC_INIT(joe, 3.1jupp11)
@


1.15
log
@<time.h> is always needed
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.14 2009/10/06 09:07:30 tg Exp $
d63 1
d91 1
a91 1
	AC_DEFINE(HAVE_SELINUX, 1, [We have SELinux headers])
@


1.14
log
@provide hooks for Debian libbsd via autoconf headers
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.13 2009/09/19 22:42:41 tg Exp $
d85 2
@


1.13
log
@scan for <utmp.h> for login_tty on glibc
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.12 2009/08/02 15:47:31 tg Exp $
d82 3
@


1.12
log
@bump to joe 3.1jupp11
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.11 2009/07/30 20:15:58 tg Exp $
d80 1
a80 1
AC_CHECK_HEADERS([util.h])
@


1.11
log
@(untested) allow disabling building and installing the termidx binary
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.10 2008/08/25 13:44:40 tg Exp $
d9 2
a10 1
AC_INIT(joe, 3.1jupp10)
@


1.10
log
@joe-3.1jupp10
@
text
@d1 1
a1 1
# $MirOS: contrib/code/jupp/configure.ac,v 1.9 2008/05/13 13:08:21 tg Exp $
d53 5
@


1.9
log
@prepare for joe-3.1jupp9:
* sync NEWS
* bump vsn in configure.ac
* tag all files with RCS ID
* sync licence template
@
text
@d1 1
a1 1
# $MirOS$
d9 1
a9 1
AC_INIT(joe, 3.1jupp9)
@


1.8
log
@let's call this joe-3.1jupp8
@
text
@d1 2
d9 1
a9 1
AC_INIT(joe, 3.1jupp8)
@


1.7
log
@document
@
text
@d7 1
a7 1
AC_INIT(joe, 3.1jupp7)
@


1.6
log
@sync a few files with upstream; bump to 3.1jupp6; mention gcc glitch
@
text
@d7 1
a7 1
AC_INIT(joe, 3.1jupp6)
@


1.5
log
@sync with upstream sources
@
text
@d7 1
a7 1
AC_INIT(joe, 3.1jupp5)
@


1.4
log
@* bump version
* add comment about locale support in recent obsd
@
text
@d7 1
a7 1
AC_INIT(joe, 3.1jupp4)
@


1.3
log
@bring up to our standards, add strlfun.c from old repo
and the infrastructure files from ncvs2:gnusystem_aux_dir,
also a bit of whitespace fixup
@
text
@d7 1
a7 1
AC_INIT(joe, 3.1jupp3)
@


1.2
log
@Update the non-generated files to joe-3.1jupp2
@
text
@d7 1
a7 1
AC_INIT(joe, 3.1jupp2)
@


1.1
log
@Initial revision
@
text
@d7 1
a7 1
AC_INIT(joe, 3.1)
d72 1
d122 1
@


1.1.201.1
log
@JOE's Own Editor 3.1
@
text
@@
