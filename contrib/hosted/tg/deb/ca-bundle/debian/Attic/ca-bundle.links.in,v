head	1.6;
access;
symbols
	ca-bundle-20120530:1.4;
locks; strict;
comment	@# @;


1.6
date	2014.03.29.23.18.52;	author tg;	state dead;
branches;
next	1.5;
commitid	100533754F34CB8B692;

1.5
date	2013.01.06.00.56.31;	author tg;	state Exp;
branches;
next	1.4;
commitid	10050E8CBD075481954;

1.4
date	2012.05.30.19.56.07;	author tg;	state Exp;
branches;
next	1.3;
commitid	1004FC67B5F47216928;

1.3
date	2012.05.30.19.42.00;	author tg;	state Exp;
branches;
next	1.2;
commitid	1004FC6780B05ACF8E9;

1.2
date	2011.04.24.17.08.16;	author tg;	state Exp;
branches;
next	1.1;
commitid	1004DB459166E62A679;

1.1
date	2011.04.24.17.02.37;	author tg;	state Exp;
branches;
next	;
commitid	1004DB457B22BD86DEB;


desc
@@


1.6
log
@prepare new version
@
text
@#!/bin/sh
# $MirOS: contrib/hosted/tg/deb/ca-bundle/debian/ca-bundle.links.in,v 1.5 2013/01/06 00:56:31 tg Exp $

cd "$(dirname "$0")"
rm -f ca-bundle.links{,~}
cat >ca-bundle.links~ <<'EOF'
etc/java/cacerts-gcj usr/lib/jvm/java-1.5.0-gcj-4.2-1.5.0.0/jre/lib/security/cacerts
etc/java/cacerts-gcj usr/lib/jvm/java-1.5.0-gcj-4.3-1.5.0.0/jre/lib/security/cacerts
etc/java/cacerts-gcj usr/lib/jvm/java-1.5.0-gcj-4.4/jre/lib/cacerts
etc/java/cacerts-gcj usr/lib/jvm/java-1.5.0-gcj-4.5/jre/lib/cacerts
etc/ssl/certs/java/cacerts etc/ia32-java-1.5.0-sun/security/cacerts
etc/ssl/certs/java/cacerts etc/ia32-java-6-sun/security/cacerts
etc/ssl/certs/java/cacerts etc/j2se/1.4/security/cacerts
etc/ssl/certs/java/cacerts etc/java-1.5.0-sun/security/cacerts
etc/ssl/certs/java/cacerts etc/java-6-openjdk/security/cacerts
etc/ssl/certs/java/cacerts etc/java-6-sun/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/j2se/1.4/jre/javaws/cacerts
etc/ssl/certs/java/cacerts usr/lib/j2se/1.4/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/ia32-java-1.5.0-sun-1.5.0.06/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/ia32-java-1.5.0-sun-1.5.0.14/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/ia32-java-1.5.0-sun-1.5.0.15/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/ia32-java-1.5.0-sun-1.5.0.16/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/ia32-java-1.5.0-sun-1.5.0.17/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/ia32-java-1.5.0-sun-1.5.0.18/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/ia32-java-1.5.0-sun-1.5.0.19/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/ia32-java-1.5.0-sun-1.5.0.22/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/ia32-java-6-sun-1.6.0.06/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/ia32-java-6-sun-1.6.0.10/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/ia32-java-6-sun-1.6.0.12/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/ia32-java-6-sun-1.6.0.13/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/ia32-java-6-sun-1.6.0.14/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/ia32-java-6-sun-1.6.0.22/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/j2sdk1.6-oracle/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/j2sdk1.7-oracle/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/java-1.5.0-sun-1.5.0.06/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/java-1.5.0-sun-1.5.0.14/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/java-1.5.0-sun-1.5.0.15/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/java-1.5.0-sun-1.5.0.16/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/java-1.5.0-sun-1.5.0.17/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/java-1.5.0-sun-1.5.0.18/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/java-1.5.0-sun-1.5.0.19/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/java-1.5.0-sun-1.5.0.22/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/java-6-cacao/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/java-6-openjdk/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/java-6-sun-1.6.0.06/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/java-6-sun-1.6.0.10/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/java-6-sun-1.6.0.12/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/java-6-sun-1.6.0.13/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/java-6-sun-1.6.0.14/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/java-6-sun-1.6.0.22/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/share/jxplorer/security/cacerts
usr/share/ca-bundle/ca-certificates.crt etc/apache/ssl.crt/ca-bundle.crt
usr/share/ca-bundle/ca-certificates.crt opt/kde3/share/apps/kssl/ca-bundle.crt
usr/share/ca-bundle/ca-certificates.crt opt/trinity/share/apps/kssl/ca-bundle.crt
usr/share/ca-bundle/ca-certificates.crt usr/lib/kde4/share/kde4/apps/kssl/ca-bundle.crt
usr/share/ca-bundle/ca-certificates.crt usr/share/apps/kssl/ca-bundle.crt
usr/share/ca-bundle/ca-certificates.crt usr/share/gajim/data/other/cacerts.pem
usr/share/ca-bundle/ca-certificates.crt usr/share/sympa/ca-bundle.crt
usr/share/ca-bundle/keystore.jks usr/share/ca-certificates-java/cacerts
usr/share/ca-bundle/ksslcalist etc/kde3/ksslcalist
usr/share/ca-bundle/ksslcalist usr/lib/kde4/etc/kde4/ksslcalist
usr/share/ca-bundle/ksslcalist usr/share/kde4/config/ksslcalist
EOF
while read s d; do
	echo usr/share/ca-bundle/certs/$s usr/share/ca-bundle/certs/$d
done >>ca-bundle.links~ <../bsd/certhash.lnk
mv -f ca-bundle.links~ ca-bundle.links
exit 0
@


1.5
log
@prepare an update and handle horracle java 7
@
text
@d2 1
a2 1
# $MirOS: contrib/hosted/tg/deb/ca-bundle/debian/ca-bundle.links.in,v 1.4 2012/05/30 19:56:07 tg Exp $
@


1.4
log
@we can now generate the .links file at build time, no need to package it
@
text
@d2 1
a2 1
# $MirOS$
d34 1
@


1.3
log
@merge rest of tarent packaging improvements: gcj, conflicts,
move the update-ca-certificates script back to /usr/sbin
@
text
@d1 2
a2 6
#!/bin/mksh
rcsid='$MirOS: contrib/hosted/tg/deb/ca-bundle/debian/ca-bundle.links.in,v 1.2 2011/04/24 17:08:16 tg Exp $'
#-
# Run this on Debian/sid to generate a list of symlinks
# for OpenSSL 1.0.0+ compatibility of hashed directory.
# The package itself can then be built on etch, still.
d5 2
a6 37
rm -rf ca-bundle.links.in.tmp ca-bundle.links
[[ $(openssl version) = 'OpenSSL 1'* ]] || exit 1
mkdir ca-bundle.links.in.tmp
cd ca-bundle.links.in.tmp
mksh ../../bsd/ssl.certs.shar || exit 1
set -A files -- *.*

cat >OUT <<EOF
# generated on $(TZ=UTC date) by
# $rcsid
#-
EOF

for file in "${files[@@]}"; do
	if [[ $file != [0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f].+([0-9]) ]]; then
		print -ru2 "Invalid file '$file'"
		exit 1
	fi
	fbase=${file%.*}
	hash0=$(openssl x509 -subject_hash_old -noout -in $file)
	hash1=$(openssl x509 -subject_hash -noout -in $file)
	if [[ $file != "${hash0}."+([0-9]) ]]; then
		print -ru2 "Invalid hash $file expected $hash0"
		exit 1
	fi
	print -ru2 "Processing $file → $hash1"
	num=0
	while [[ -e $hash1.$num ]]; do
		let num++
	done
	ln -s $file $hash1.$num
	print -r usr/share/ca-bundle/certs/$file \
	    usr/share/ca-bundle/certs/$hash1.$num >>OUT
done

cat >>OUT <<'EOF'
#-
d63 4
a66 4
mv OUT ../ca-bundle.links
cd ..
rm -rf ca-bundle.links.in.tmp
echo All done.
@


1.2
log
@better
@
text
@d2 1
a2 1
rcsid='$MirOS: contrib/hosted/tg/deb/ca-bundle/debian/ca-bundle.links.in,v 1.1 2011/04/24 17:02:37 tg Exp $'
d46 4
d72 1
a72 4
etc/ssl/certs/java/cacerts usr/lib/jvm/java-1.5.0-gcj-4.2-1.5.0.0/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/java-1.5.0-gcj-4.3-1.5.0.0/jre/lib/security/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/java-1.5.0-gcj-4.4/jre/lib/cacerts
etc/ssl/certs/java/cacerts usr/lib/jvm/java-1.5.0-gcj-4.5/jre/lib/cacerts
@


1.1
log
@OpenSSL sucks. I’ve kept so much pain away from MirBSD by sticking with 0.9.7…
@
text
@d2 1
a2 1
rcsid='$MirOS$'
d16 5
a20 3
print -r -- "# $rcsid" >OUT
print -r -- "# generated on $(TZ=UTC date)" >>OUT
print -r -- "#-"
d34 1
@

