head	1.5;
access;
symbols;
locks; strict;
comment	@# @;


1.5
date	2019.05.19.21.48.20;	author tg;	state Exp;
branches;
next	1.4;
commitid	1005CE1CF376A9FAD46;

1.4
date	2019.03.27.16.09.14;	author tg;	state Exp;
branches;
next	1.3;
commitid	1005C9BA02A2C76B958;

1.3
date	2012.05.09.08.58.36;	author tg;	state Exp;
branches;
next	1.2;
commitid	1004FAA31D319B0F5BE;

1.2
date	2011.06.09.20.30.24;	author tg;	state Exp;
branches;
next	1.1;
commitid	1004DF12C4D23BB923D;

1.1
date	2011.05.25.17.46.54;	author tg;	state Exp;
branches;
next	;
commitid	1004DDD409C5C11C801;


desc
@@


1.5
log
@document agus --allow-releaseinfo-change; drop sources.list.$1 copying
@
text
@#!/bin/mksh
# $MirOS: contrib/hosted/tg/deb/aguspeed.sh,v 1.4 2019/03/27 16:09:14 tg Exp $
#-
# From Planet Debian. Not complicated enough for copyright.
#
# Use example:
#  agus -o Acquire::Check-Valid-Until=false   # on jessie
#  agus --allow-releaseinfo-change            # when testing changes

unset LANGUAGE
export LC_ALL=C

(( USER_ID )) && exec sudo mksh "$0" "$@@"

if [[ $1 = -f ]]; then
	fflag=1
	shift
else
	fflag=0
fi

rv=
set -x
apt-get "$@@" update || rv=$?
dpkg --clear-avail || rv=${rv:-$?}
# this emits a harmless warning on squeeze and newer
dpkg --forget-old-unavail || rv=${rv:-$?}
(( fflag )) || if sa=$(whence -p sync-available); then
	# call with mksh due to *buntu bug
	mksh "$sa" || rv=${rv:-$?}
fi
exit $rv
@


1.4
log
@we need the ability to pass options to apt-get

also, update comments a little
@
text
@d2 1
a2 1
# $MirOS: contrib/hosted/tg/deb/aguspeed.sh,v 1.3 2012/05/09 08:58:36 tg Exp $
d8 1
a21 4
if [[ -n $1 && -s /etc/apt/sources.list.$1 ]]; then
	cat "/etc/apt/sources.list.$1" >/etc/apt/sources.list
fi

@


1.3
log
@sync
@
text
@d2 1
a2 2
# $MirOS: contrib/hosted/tg/deb/aguspeed.sh,v 1.2 2011/06/09 20:30:24 tg Exp $
# $Id: agus 2924 2012-05-09 09:00:04Z tglase $
d5 3
d27 1
a27 1
apt-get update || rv=$?
d29 1
a29 1
# this emits a harmless warning on squeeze
@


1.2
log
@update
@
text
@d2 2
a3 2
# $MirOS: contrib/hosted/tg/deb/aguspeed.sh,v 1.1 2011/05/25 17:46:54 tg Exp $
# $Id: agus 2082 2011-06-09 20:31:34Z tglase $
d12 7
d29 1
a29 1
if sa=$(whence -p sync-available); then
@


1.1
log
@utility for apt-get update, dselect update, and some speedup
@
text
@d2 4
a5 2
# $MirOS$
# $Id: agus 1563 2010-11-12 16:27:24Z tglase $
@

