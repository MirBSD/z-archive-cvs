head	1.9;
access;
symbols;
locks; strict;
comment	@# @;


1.9
date	2008.10.05.01.23.49;	author tg;	state dead;
branches;
next	1.8;
commitid	10048E8170C54F5D796;

1.8
date	2008.03.08.19.35.25;	author tg;	state Exp;
branches;
next	1.7;
commitid	10047D2EA7F5F3763FE;

1.7
date	2007.05.12.13.34.31;	author bsiegert;	state Exp;
branches;
next	1.6;
commitid	1004645C24F2DC8352B;

1.6
date	2006.10.14.23.39.36;	author tg;	state Exp;
branches;
next	1.5;
commitid	1004531751E7AA7E1BA;

1.5
date	2006.09.14.00.09.09;	author tg;	state Exp;
branches;
next	1.4;
commitid	10045089C0E234154C3;

1.4
date	2006.06.25.06.26.52;	author tg;	state Exp;
branches;
next	1.3;
commitid	100449E2C915D109F2B;

1.3
date	2006.02.01.20.38.42;	author tg;	state Exp;
branches;
next	1.2;
commitid	10043E11C3B4C8B055B;

1.2
date	2006.01.18.11.24.36;	author tg;	state Exp;
branches;
next	1.1;
commitid	10043CE25867780580E;

1.1
date	2006.01.18.11.16.47;	author tg;	state Exp;
branches;
next	;
commitid	10043CE239959671F68;


desc
@@


1.9
log
@remove redhat and debian emulation in favour of fedora emulation
while probably still not feature-complete, a definitive improvement
if something breaks, tell me and Iâ€™ll fix it ASAP of course
@
text
@# $MirOS: ports/emulators/debian/Makefile,v 1.8 2008/03/08 19:35:25 tg Exp $

ONLY_FOR_PLATFORM=	MirBSD:*:i386 OpenBSD:*:i386

COMMENT=		Debian GNU/Linux shared libraries
EMUL=			linux
CATEGORIES=		emulators
DISTNAME=		debian-libs-3.1
DASH_VER=		5
RESPONSIBLE=		Thorsten Glaser <tg@@mirbsd.de>
RUN_DEPENDS+=		:linux-common-*:emulators/linux-common

# DFSG compliant
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes

DIST_SUBDIR=		deb
MASTER_SITES0=		${MASTER_SITE_DEBIAN:=g/glibc/}
MASTER_SITES1=		${MASTER_SITE_DEBIAN:=e/expat/}
MASTER_SITES2=		${MASTER_SITE_DEBIAN:=f/fontconfig/}
MASTER_SITES3=		${MASTER_SITE_DEBIAN:=f/freetype/}
MASTER_SITES4=		${MASTER_SITE_DEBIAN:=x/xfree86/}
MASTER_SITES5=		${MASTER_SITE_DEBIAN:=z/zlib/}
MASTER_SITES6=		${MASTER_SITE_DEBIAN:=x/xrender/}
MASTER_SITES7=		${MASTER_SITE_DEBIAN:=g/gcc-3.3/}

DISTFILES=		libc6_2.3.2.ds1-22sarge6_i386.deb:0 \
			libexpat1_1.95.8-3_i386.deb:1 \
			libfontconfig1_2.3.1-2_i386.deb:2 \
			libfreetype6_2.1.7-6_i386.deb:3 \
			libice6_4.3.0.dfsg.1-14sarge5_i386.deb:4 \
			libsm6_4.3.0.dfsg.1-14sarge5_i386.deb:4 \
			libx11-6_4.3.0.dfsg.1-14sarge5_i386.deb:4 \
			libxext6_4.3.0.dfsg.1-14sarge5_i386.deb:4 \
			libxft1_4.3.0.dfsg.1-14sarge5_i386.deb:4 \
			libxpm4_4.3.0.dfsg.1-14sarge5_i386.deb:4 \
			libxt6_4.3.0.dfsg.1-14sarge5_i386.deb:4 \
			xlibs_4.3.0.dfsg.1-14sarge5_all.deb:4 \
			zlib1g_1.2.2-4.sarge.2_i386.deb:5 \
			libxrender1_0.8.3-7_i386.deb:6 \
			libstdc++5_3.3.5-13_i386.deb:7

WRKDIST=		${WRKDIR}/debian-libs
NO_BUILD=		Yes
NO_REGRESS=		Yes

BASEDIR=		${PREFIX}/emul/debian/dbl

do-extract:
	mkdir -p ${WRKDIST}
.for _i in ${DISTFILES:T}
	cd ${WRKDIST}; ar x ${FULLDISTDIR}/${_i:C/:.$//} && tar xzf data.tar.gz
.endfor

LIBS=			/lib/ld-linux.so.2 \
			/lib/libc.so.6 \
			/lib/libcrypt.so.1 \
			/lib/libdl.so.2 \
			/lib/libm.so.6 \
			/lib/libnsl.so.1 \
			/lib/libnss_compat.so.2 \
			/lib/libnss_dns.so.2 \
			/lib/libnss_files.so.2 \
			/lib/libpthread.so.0 \
			/lib/libresolv.so.2 \
			/lib/librt.so.1 \
			/lib/libutil.so.1 \
			/usr/X11R6/lib/libICE.so.6 \
			/usr/X11R6/lib/libSM.so.6 \
			/usr/X11R6/lib/libX11.so.6 \
			/usr/X11R6/lib/libXext.so.6 \
			/usr/X11R6/lib/libXft.so.1 \
			/usr/X11R6/lib/libXpm.so.4 \
			/usr/X11R6/lib/libXt.so.6 \
			/usr/lib/libXrender.so.1 \
			/usr/lib/libexpat.so.0 \
			/usr/lib/libfontconfig.so.1 \
			/usr/lib/libfreetype.so.6 \
			/usr/lib/libstdc++.so.5 \
			/usr/lib/libz.so.1

do-install:
	${INSTALL_DATA_DIR} ${BASEDIR}
.for _i in ${LIBS}
	chmod u+w ${WRKDIST}${_i}
	perl -i -pe 's!/lib/ld-linux\.so\.2!/dbl/ld-linux.so.2!' ${WRKDIST}${_i}
	${INSTALL} ${INSTALL_COPY} -o ${BINOWN} -g ${BINGRP} -m 444 \
	    ${WRKDIST}${_i} ${BASEDIR}/
.endfor
	chmod ${BINMODE} ${BASEDIR}/ld-linux.so.2

.include <bsd.port.mk>
@


1.8
log
@debian sucks, they donâ€™t keep old distfiles
â†’ update, since xlibs had 2 security bumpsâ€¦
@
text
@d1 1
a1 1
# $MirOS: ports/emulators/debian/Makefile,v 1.7 2007/05/12 13:34:31 bsiegert Exp $
@


1.7
log
@Debian sarge update, see http://www.debian.org/News/2007/20070407 :
Pull in updated packages, bump patchlevel

Hmm, should we update this to etch?
@
text
@d1 1
a1 1
# $MirOS: ports/emulators/debian/Makefile,v 1.6 2006/10/14 23:39:36 tg Exp $
d9 1
a9 1
DASH_VER=		4
d33 8
a40 8
			libice6_4.3.0.dfsg.1-14sarge3_i386.deb:4 \
			libsm6_4.3.0.dfsg.1-14sarge3_i386.deb:4 \
			libx11-6_4.3.0.dfsg.1-14sarge3_i386.deb:4 \
			libxext6_4.3.0.dfsg.1-14sarge3_i386.deb:4 \
			libxft1_4.3.0.dfsg.1-14sarge3_i386.deb:4 \
			libxpm4_4.3.0.dfsg.1-14sarge3_i386.deb:4 \
			libxt6_4.3.0.dfsg.1-14sarge3_i386.deb:4 \
			xlibs_4.3.0.dfsg.1-14sarge3_all.deb:4 \
@


1.6
log
@* add MASTER_SITE_DEBIAN to network.conf.template, switch some ports to it
* debian is one of these that don't like to keep copies, update distfiles
@
text
@d1 1
a1 1
# $MirOS: ports/emulators/debian/Makefile,v 1.5 2006/09/14 00:09:09 tg Exp $
d9 1
a9 1
FULLPKGNAME=		${DISTNAME}-3
d29 1
a29 1
DISTFILES=		libc6_2.3.2.ds1-22sarge4_i386.deb:0 \
d33 8
a40 8
			libice6_4.3.0.dfsg.1-14sarge1_i386.deb:4 \
			libsm6_4.3.0.dfsg.1-14sarge1_i386.deb:4 \
			libx11-6_4.3.0.dfsg.1-14sarge1_i386.deb:4 \
			libxext6_4.3.0.dfsg.1-14sarge1_i386.deb:4 \
			libxft1_4.3.0.dfsg.1-14sarge1_i386.deb:4 \
			libxpm4_4.3.0.dfsg.1-14sarge1_i386.deb:4 \
			libxt6_4.3.0.dfsg.1-14sarge1_i386.deb:4 \
			xlibs_4.3.0.dfsg.1-14sarge1_all.deb:4 \
@


1.5
log
@clean up COMMENT and HOMEPAGE; regenerate INDEX (2761, 169 marked as broken, probably many many more) ­ edited by script with manual postprocessing
@
text
@d1 1
a1 1
# $MirOS: ports/emulators/debian/Makefile,v 1.4 2006/06/25 06:26:52 tg Exp $
d5 1
a5 1
COMMENT=			Debian GNU/Linux shared libraries
d9 1
a9 1
FULLPKGNAME=		${DISTNAME}-2
a19 2
MASTER_SITE_DEBIAN=	http://ftp.debian.org/pool/main/

d29 1
a29 1
DISTFILES=		libc6_2.3.2.ds1-22_i386.deb:0 \
d32 1
a32 1
			libfreetype6_2.1.7-2.4_i386.deb:3 \
@


1.4
log
@add a few more libs to the debian package, and preload the
resolver in opera (now it works w/o redhat-base installed,
but adding that still freaks the plugins, why? systrace is
not helpful at this point any more...)
@
text
@d1 1
a1 1
# $MirOS: ports/emulators/debian/Makefile,v 1.3 2006/02/01 20:38:42 tg Exp $
d5 1
a5 1
COMMENT=		"Debian GNU/Linux shared libraries"
@


1.3
log
@revamp compat_linux(8) support library port structure to allow for
undisturbed coexistence of more than one set of libraries and dyld
and patch the opera binary to call /dbl/ld-linux.so.2 instead
@
text
@d1 1
a1 1
# $MirOS: ports/emulators/debian/Makefile,v 1.2 2006/01/18 11:24:36 tg Exp $
d9 1
a9 1
FULLPKGNAME=		${DISTNAME}-1
d28 2
d39 1
d43 3
a45 1
			zlib1g_1.2.2-4.sarge.2_i386.deb:5
d61 1
d64 4
d69 3
d76 1
d79 1
d83 1
d89 2
@


1.2
log
@oops, reverse logic was true
@
text
@d1 1
a1 1
# $MirOS: ports/emulators/debian/Makefile,v 1.1 2006/01/18 11:16:47 tg Exp $
d9 1
a9 1
FULLPKGNAME=		${DISTNAME}-0
d11 1
d43 1
d46 1
a46 21
BASEDIR=		${PREFIX}/emul/debian

.include <mirports.sys.mk>
.if ${OStype} == "MirBSD"
HAS_DYNEXEC!=		eval $$(uname -l|sed \
			    's/^\#\([0-9]*\)[a-z]\([0-9A-F][0-9A-F]\).*$$/let \
			     major=\1 minor=16\#\2/'); \
			(( (major > 8) || ((major == 8) && (minor > 161)) )) \
			    && echo dynexec || true
.endif

FLAVORS=		${HAS_DYNEXEC}
FLAVOR?=		${HAS_DYNEXEC}

.if ${FLAVOR:L:Mdynexec}
SED_PLIST+=		| sed -e '/^KLUDGE:/d'
LDSO=			ld-linux.so.2
.else
SED_PLIST+=		| sed -e '/^KLUDGE:/s///'
LDSO=			ld-linux.so.2.bin
.endif
a53 4
do-build:
	sed -e 's!@@@@BASEDIR@@@@!${BASEDIR}!g' -e 's!@@@@LDSO@@@@!${LDSO}!g' \
	    <${FILESDIR}/run >${WRKSRC}/run

d76 1
a76 9
.if !${FLAVOR:L:Mdynexec}
	# hack ET_DYN
	cp ${BASEDIR}/ld-linux.so.2 ${BASEDIR}/ld-linux.so.2.bin
	chmod 600 ${BASEDIR}/ld-linux.so.2.bin
	print -n '\02' | dd of=${BASEDIR}/ld-linux.so.2.bin \
	    bs=1 conv=notrunc seek=16
.endif
	chmod ${BINMODE} ${BASEDIR}/ld-linux.so.2*
	${INSTALL_SCRIPT} ${WRKSRC}/run ${BASEDIR}/
@


1.1
log
@port the Debian Woody shared libraries (needed for opera) so that
they do not conflict or require redhat-base
@
text
@d1 1
a1 1
# $MirOS$
d59 1
a59 1
SED_PLIST+=		| sed -e '/^KLUDGE:/s///'
d62 1
a62 1
SED_PLIST+=		| sed -e '/^KLUDGE:/d'
@

