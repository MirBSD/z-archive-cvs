head	1.3;
access;
symbols;
locks; strict;
comment	@# @;


1.3
date	2007.04.03.19.42.40;	author tg;	state dead;
branches;
next	1.2;
commitid	1004612AC977E789195;

1.2
date	2005.10.11.22.00.18;	author tg;	state Exp;
branches;
next	1.1;
commitid	3d0c434c35fc3eef;

1.1
date	2005.03.18.15.46.01;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.03.18.15.46.01;	author tg;	state Exp;
branches;
next	;


desc
@@


1.3
log
@• remove ports that are simply broken, don't work, for too long, with no
  update or update-willing person in sight, kde stuff, web2.0 stuff that
  we don't want in ports (just stuff it into /var/www yourself, it isn't
  that difficult, right?), stuff for which no new version exists/will be
  and some obsd cruft; adjust dependencies
• no BUILD_DEPENDS+=RUN_DEPENDS or vice versa any more, *ever*
• fix some other stuff partially

ok bsiegert@@
@
text
@$MirOS: ports/emulators/wine/wine/patches/patch-msdos_dpmi_c,v 1.2 2005/10/11 22:00:18 tg Exp $
--- msdos/dpmi.c.orig	Thu Feb 25 17:32:34 1999
+++ msdos/dpmi.c	Tue Oct 11 21:29:34 2005
@@@@ -20,6 +20,7 @@@@
 #include "process.h"
 #include "callback.h"
 #include "debug.h"
+#include "stackframe.h"
 
 #define DOS_GET_DRIVE(reg) ((reg) ? (reg) - 1 : DRIVE_GetCurrentDrive())
 
@@@@ -211,22 +212,26 @@@@ static void DPMI_CallRMCBProc( CONTEXT *
          * real-mode call structure. */
         if (flag & 1) {
             /* 32-bit DPMI client */
-            __asm__ __volatile__("
-                 pushl %%es
-                 pushl %%ds
-                 pushfl
-                 movl %4,%%es
-                 movl %3,%%ds
-                 lcall %2
-                 popl %%ds
-                 movl %%es,%0
-                 popl %%es
-             "
+            __asm__ __volatile__("\n"
+"                 pushl %%ebp\n"
+"                 pushl %%esi\n"
+"                 pushl %%es\n"
+"                 pushl %%ds\n"
+"                 pushfl\n"
+"                 mov %4,%%es\n"
+"                 mov %3,%%ds\n"
+"                 lcall %2\n"
+"                 popl %%ds\n"
+"                 mov %%es,%0\n"
+"                 popl %%es\n"
+"                 popl %%esi\n"
+"                 popl %%ebp\n"
+"             "
              : "=g" (es), "=D" (edi)
              : "m" (rmcb->proc_ofs),
                "g" (ss), "g" (rmcb->regs_sel),
                "S" (ESP_reg(context)), "D" (rmcb->regs_ofs)
-             : "eax", "ecx", "edx", "esi", "ebp" );
+             : "eax", "ecx", "edx" );
         } else {
             /* 16-bit DPMI client */
             CONTEXT ctx = *context;
@


1.2
log
@make wine compile again with gcc-3.4 (not so forgiving)
and changed IPX header files
@
text
@d1 1
a1 1
$MirOS: ports/emulators/wine/wine/patches/patch-msdos_dpmi_c,v 1.1.7.1 2005/03/18 15:46:01 tg Exp $
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
$MirOS$
d3 1
a3 1
+++ msdos/dpmi.c	Sat Nov  6 23:40:44 2004
d12 1
a12 1
@@@@ -211,22 +212,24 @@@@ static void DPMI_CallRMCBProc( CONTEXT *
d28 2
a29 1
+"                 pushl %%si\n"
d33 2
a34 2
+"                 movl %4,%%es\n"
+"                 movl %3,%%ds\n"
d37 1
a37 1
+"                 movl %%es,%0\n"
d39 2
a40 1
+"                 popl %%si\n"
d47 1
a47 1
+             : "eax", "ecx", "edx", "ebp" );
@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
