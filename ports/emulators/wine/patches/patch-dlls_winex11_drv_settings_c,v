head	1.1;
access;
symbols;
locks; strict;
comment	@# @;


1.1
date	2008.07.30.00.15.48;	author tg;	state Exp;
branches;
next	;
commitid	100488FB23E3E0E7494;


desc
@@


1.1
log
@Wine 1.0 port, mostly taken from pkgsrc®

request for help: there is probably something about mmap.c the only
thing preventing us from running this… similar to the issues outlined
in the FreeBSD wiki about Wine, but made harder due to W^X probably

This will almost certainly not work on MidnightBSD, have a hard time
working on OpenBSD (especially due to no VFORK_SHM there), is totally
untested on Darwin (and PFRAG.dylib is missing), and not for Interix;
I wonder if it would work on NetBSD® (it should) if MirPorts ran the-
re, but if so, it had IPX support, which theirs doesn’t ☺
@
text
@$MirOS$
$NetBSD: patch-ca,v 1.1 2008/06/28 05:18:57 jmcneill Exp $
--- dlls/winex11.drv/settings.c.orig	Tue Jun 17 14:07:08 2008
+++ dlls/winex11.drv/settings.c	Tue Jul 29 17:52:28 2008
@@@@ -431,6 +431,16 @@@@ LONG X11DRV_ChangeDisplaySettingsEx( LPC
         return DISP_CHANGE_SUCCESSFUL;
     }
 
+    if (devmode->dmPelsWidth == 800 && devmode->dmPelsHeight == 600)
+    {
+	DEVMODEW newdm = *devmode;
+
+	ERR("800x600 not available, trying 800x480\n");
+	newdm.dmPelsWidth = 800;
+	newdm.dmPelsHeight = 480;
+	return X11DRV_ChangeDisplaySettingsEx(devname, &newdm, hwnd, flags, lpvoid);
+    }
+
     /* no valid modes found */
     ERR("No matching mode found %ux%ux%u @@%u! (%s)\n",
         devmode->dmPelsWidth, devmode->dmPelsHeight,
@
