head	1.1;
access;
symbols;
locks; strict;
comment	@# @;


1.1
date	2008.07.30.00.15.50;	author tg;	state Exp;
branches;
next	;
commitid	100488FB23E3E0E7494;


desc
@@


1.1
log
@Wine 1.0 port, mostly taken from pkgsrc®

request for help: there is probably something about mmap.c the only
thing preventing us from running this… similar to the issues outlined
in the FreeBSD wiki about Wine, but made harder due to W^X probably

This will almost certainly not work on MidnightBSD, have a hard time
working on OpenBSD (especially due to no VFORK_SHM there), is totally
untested on Darwin (and PFRAG.dylib is missing), and not for Interix;
I wonder if it would work on NetBSD® (it should) if MirPorts ran the-
re, but if so, it had IPX support, which theirs doesn’t ☺
@
text
@$MirOS$
--- programs/winefile/winefile.c.orig	Tue Jun 17 14:07:08 2008
+++ programs/winefile/winefile.c	Tue Jul 29 22:37:05 2008
@@@@ -2448,7 +2448,7 @@@@ static LRESULT CALLBACK FrameWndProc(HWN
 				case ID_DRIVE_UNIX_FS: {
 					TCHAR path[MAX_PATH];
 #ifdef UNICODE
-					char cpath[MAX_PATH];
+					char cpath[1024];
 #endif
 					ChildWnd* child;
 
@@@@ -2457,6 +2457,7 @@@@ static LRESULT CALLBACK FrameWndProc(HWN
 
 #ifdef UNICODE
 					getcwd(cpath, MAX_PATH);
+					cpath[MAX_PATH - 1] = '\0';
 					MultiByteToWideChar(CP_UNIXCP, 0, cpath, -1, path, MAX_PATH);
 #else
 					getcwd(path, MAX_PATH);
@
