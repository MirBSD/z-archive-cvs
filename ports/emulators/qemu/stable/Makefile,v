head	1.5;
access;
symbols;
locks; strict;
comment	@# @;


1.5
date	2009.10.27.13.09.50;	author tg;	state Exp;
branches;
next	1.4;
commitid	1004AE6F12912E1C3B2;

1.4
date	2009.08.16.16.26.45;	author tg;	state Exp;
branches;
next	1.3;
commitid	1004A882F1F72B43308;

1.3
date	2008.10.04.19.03.06;	author tg;	state Exp;
branches;
next	1.2;
commitid	10048E7BD9A0842B398;

1.2
date	2008.05.11.20.35.48;	author tg;	state Exp;
branches;
next	1.1;
commitid	100482758AB5CB3B36E;

1.1
date	2008.05.07.15.46.05;	author tg;	state Exp;
branches;
next	;
commitid	1004821CEB27BD5D7BE;


desc
@@


1.5
log
@make “qemu -fda allinone.img -tftp /tmp/tftpboot -bootp /pxelinux.0 -s -S”
work for MirOS bsd4grml debugging
@
text
@# $MirOS: ports/emulators/qemu/stable/Makefile,v 1.4 2009/08/16 16:26:45 tg Exp $
# $OpenBSD: Makefile,v 1.7 2005/11/05 12:11:05 todd Exp $

# no success on other platforms yet
ONLY_FOR_PLATFORMS=	MirBSD:*:* \
			OpenBSD:*:amd64 OpenBSD:*:i386 OpenBSD:*:macppc

COMMENT=		fast multi-system emulator
DISTNAME=		qemu-0.7.2
DASH_VER=		5
CATEGORIES=		emulators
HOMEPAGE=		http://fabrice.bellard.free.fr/qemu/
MASTER_SITES=		${HOMEPAGE}

PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes

BUILD_DEPENDS=		::textproc/texi2html
LIB_DEPENDS=		SDL::devel/sdl
USE_GMAKE=		Yes
USE_X11=		Yes
CONFIGURE_STYLE=	simple
CONFIGURE_ARGS+=	--prefix=${PREFIX:Q} \
			--cc=${_PASS_CC:T:Q} \
			--make=${GMAKE:Q} \
			--interp-prefix=${LOCALBASE:Q}/share/qemu/gnemul-%M \
			--extra-cflags=${CFLAGS:M*:Q} \
			--extra-ldflags=${LDFLAGS:M*:Q} \
			--enable-adlib
CONFIGURE_ARGS+=	--enable-werror

.include <mirports.sys.mk>

FILESDIR=		${.CURDIR}/../files

.if ${MACHINE_ARCH} == "amd64"
PATCH_LIST=		patch-* misc-*
.endif

post-extract:
	cp ${FILESDIR}/{gnu-c99-math,kqemu,vgafont}.h ${WRKSRC}/

.include <bsd.port.mk>
@


1.4
log
@change
• _PASS_CC back from 「mpcc」 to 「${WRKDIR}/bin/mpcc」 (note that the
  former 「${WRKDIR:Q}/bin/mpcc」 was wrong)
• all uses of _PASS_CC to either
  ‣ ${_PASS_CC:T:Q} (when passing, e.g. for libtool – this is for use
    when ${WRKDIR}/bin is in $$PATH)
  ‣ ${_PASS_CC:Q} (when invoking, e.g. in post-build targets – only
    these I saw when mechanically doing this; Benny wants to fix the
    remaining ones; I should’ve introduced no more breakage than was)
• _PASS_CXX/mpcxx just the same

agreed bsiegert@@
@
text
@d1 1
a1 1
# $MirOS: ports/emulators/qemu/stable/Makefile,v 1.3 2008/10/04 19:03:06 tg Exp $
d10 1
a10 1
DASH_VER=		4
@


1.3
log
@mass conversion from
• ${CC}
• "${CC}"
• '${CC}'
• ${CC:Q}
to ${_PASS_CC:Q} (or without :Q if it’s executed, not assigned), and
same for CXX… most of these are VERY UGLY, prone to break with ccache
and maybe even without…
@
text
@d1 1
a1 1
# $MirOS: ports/emulators/qemu/stable/Makefile,v 1.2 2008/05/11 20:35:48 tg Exp $
d26 1
a26 1
			--cc=${_PASS_CC:Q} \
@


1.2
log
@• unify builds
• bring kqemu to qemu-stable
@
text
@d1 1
a1 1
# $MirOS: ports/emulators/qemu/stable/Makefile,v 1.1 2008/05/07 15:46:05 tg Exp $
d26 1
a26 1
			--cc=${CC:Q} \
@


1.1
log
@move existing qemu port (0.7.2) to emulators/qemu/stable/
@
text
@d1 1
a1 1
# $MirOS: ports/emulators/qemu/Makefile,v 1.8 2007/06/30 02:31:28 tg Exp $
d10 1
a10 1
DASH_VER=		3
d24 3
a26 2
CONFIGURE_STYLE=	gnu
CONFIGURE_ARGS+=	--cc=${CC:Q} \
d31 2
a32 2
			--enable-adlib \
			--disable-kqemu
d36 2
d42 3
@

