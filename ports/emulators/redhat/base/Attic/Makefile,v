head	1.7;
access;
symbols;
locks; strict;
comment	@# @;


1.7
date	2008.10.05.01.23.55;	author tg;	state dead;
branches;
next	1.6;
commitid	10048E8170C54F5D796;

1.6
date	2006.09.14.00.09.11;	author tg;	state Exp;
branches;
next	1.5;
commitid	10045089C0E234154C3;

1.5
date	2006.02.20.20.50.01;	author tg;	state Exp;
branches;
next	1.4;
commitid	10043FA2B6921CBC297;

1.4
date	2006.02.01.20.38.45;	author tg;	state Exp;
branches;
next	1.3;
commitid	10043E11C3B4C8B055B;

1.3
date	2005.12.27.18.49.03;	author tg;	state Exp;
branches;
next	1.2;
commitid	10043B18C9826944877;

1.2
date	2005.07.07.21.20.47;	author bsiegert;	state Exp;
branches;
next	1.1;
commitid	66bc42cd9a7ea714;

1.1
date	2005.03.18.15.45.56;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.03.18.15.45.56;	author tg;	state Exp;
branches;
next	;


desc
@@


1.7
log
@remove redhat and debian emulation in favour of fedora emulation
while probably still not feature-complete, a definitive improvement
if something breaks, tell me and Iâ€™ll fix it ASAP of course
@
text
@# $MirOS: ports/emulators/redhat/base/Makefile,v 1.6 2006/09/14 00:09:11 tg Exp $
# $OpenBSD: Makefile,v 1.21 2004/03/02 07:49:24 ish Exp $

COMMENT=			Linux compatibility package based on RedHat GNU/Linux 8.0
PKGNAME=	redhat_base-8.0-${PL}
MASTER_SITES=	${MASTER_SITE_REDHAT:=redhat/linux/8.0/en/os/i386/RedHat/RPMS/}
MASTER_SITES0=	${MASTER_SITE_REDHAT:=redhat/linux/updates/8.0/en/os/i386/}
DISTFILES=	${RPMS}
RPMDIR=		${FULLDISTDIR}
RUN_DEPENDS+=	:linux-common-*:emulators/linux-common

RPMS=		glibc-2.3.2-4.80.8.i386.rpm:0 \
		glibc-common-2.3.2-4.80.8.i386.rpm:0 \
		libattr-2.0.8-3.i386.rpm \
		libacl-2.0.11-2.i386.rpm \
		termcap-11.0.1-13.noarch.rpm \
		libtermcap-2.0.8-31.i386.rpm \
		bash-2.05b-5.1.i386.rpm:0 \
		ncurses-5.2-28.i386.rpm \
		zlib-1.1.4-8.8x.i386.rpm:0 \
		fileutils-4.1.9-11.2.i386.rpm:0 \
		binutils-2.13.90.0.2-2.i386.rpm \
		compat-libstdc++-7.3-2.96.110.i386.rpm \
		libstdc++-3.2-7.i386.rpm \
		sh-utils-2.0.12-3.i386.rpm \
		readline-4.3-3.i386.rpm \
		XFree86-libs-4.2.1-23.i386.rpm:0 \
		glib-1.2.10-8.i386.rpm \
		gtk+-1.2.10-22.i386.rpm \
		libjpeg-6b-21.i386.rpm \
		libpng-1.2.2-8.i386.rpm:0 \
		fontconfig-2.0-3.i386.rpm \
		freetype-2.1.2-7.i386.rpm \
		expat-1.95.4-1.i386.rpm

REMOVE_DIRS=	/usr/doc /usr/info /usr/man /usr/share/doc /usr/share/zoneinfo
REMOVE_FILES=	/etc/fonts/fonts.conf /etc/localtime

PATCH_LIST=

do-install:
.for rpm in ${RPMS:S/:0//}
	@@cd ${EMDIR}; ${LOCALBASE}/bin/rpm2cpio ${RPMDIR}/${rpm} | cpio -id
.endfor

# Get rid of some unnecessary files and directories.
.for D in ${REMOVE_DIRS}
	@@rm -rf ${EMDIR}/${D}
.endfor
.for F in ${REMOVE_FILES}
	@@rm -f ${EMDIR}/${F}
.endfor

	@@cd ${EMDIR} && ${PATCH} -p0 --forward --quiet -E < ${PATCHDIR}/patch-ldd

# copy in ld.so.conf
	${INSTALL_DATA} ${FILESDIR}/ld.so.conf ${EMDIR}/etc/
	${INSTALL_DATA} ${FILESDIR}/fonts.conf ${EMDIR}/etc/fonts/

# run elf2olf on a few binaries known not to run as elf
	@@elf2olf -o linux ${EMDIR}/sbin/ldconfig

# rename ldconfig and install wrapper
	@@cp -p ${EMDIR}/sbin/ldconfig ${EMDIR}/sbin/ldconfig.bin
	${INSTALL_SCRIPT} ${FILESDIR}/ldconfig ${EMDIR}/sbin

# make a copy of ld.so, convert to olf and then patch
	@@cp -p ${EMDIR}/lib/ld-2.3.2.so ${EMDIR}/usr/bin/ld-2.3.2-olf.so
	@@elf2olf -o linux ${EMDIR}/usr/bin/ld-2.3.2-olf.so
	@@perl ${FILESDIR}/fix-ldd.pl ${EMDIR}/usr/bin/ld-2.3.2-olf.so

post-install:
# remove setuid root bits, fix ownerships
	@@find ${EMDIR} -perm -4000 -exec chmod u-s {} \;
	@@find ${EMDIR} -user 5041 -exec chown -h ${BINOWN}:${BINGRP} {} \;

.include <bsd.port.mk>
@


1.6
log
@clean up COMMENT and HOMEPAGE; regenerate INDEX (2761, 169 marked as broken, probably many many more) ­ edited by script with manual postprocessing
@
text
@d1 1
a1 1
# $MirOS: ports/emulators/redhat/base/Makefile,v 1.5 2006/02/20 20:50:01 tg Exp $
@


1.5
log
@install /etc/fonts inside the linuxulator as well
(use MirOS #8 fonts.conf) because OpenBSD-current
uses this "x.org" crap which breaks compatibility
whereever you look (fix by myself)
@
text
@d1 1
a1 1
# $MirOS: ports/emulators/redhat/base/Makefile,v 1.4 2006/02/01 20:38:45 tg Exp $
d4 1
a4 1
COMMENT=	"Linux compatibility package based on RedHat GNU/Linux 8.0"
@


1.4
log
@revamp compat_linux(8) support library port structure to allow for
undisturbed coexistence of more than one set of libraries and dyld
and patch the opera binary to call /dbl/ld-linux.so.2 instead
@
text
@d1 1
a1 1
# $MirOS: ports/emulators/redhat/base/Makefile,v 1.3 2005/12/27 18:49:03 tg Exp $
d36 2
a37 3
REMOVE_DIRS=	/usr/doc /usr/info /usr/man /usr/share/doc \
		/usr/share/zoneinfo /etc/fonts
REMOVE_FILES=	/etc/localtime
d57 2
a58 1
	${INSTALL_DATA} ${FILESDIR}/ld.so.conf ${EMDIR}/etc
@


1.3
log
@* unbreak for user
* unbreak after libtoolise (remove .la files from installed system,
  crude kludge invented by bad bad bsiegert@@)
* bump
@
text
@d1 1
a1 1
# $MirOS: ports/emulators/redhat/base/Makefile,v 1.2 2005/07/07 21:20:47 bsiegert Exp $
d5 1
a5 2
EMUL=		linux
PKGNAME=	redhat_base-8.0-6
d10 1
a41 6
NO_BUILD=	Yes
NO_REGRESS=	Yes

pre-install:
	@@${INSTALL_DATA_DIR} ${PREFIX}

d44 1
a44 1
	@@cd ${PREFIX}; ${LOCALBASE}/bin/rpm2cpio ${RPMDIR}/${rpm} | cpio -id
d49 1
a49 1
	@@rm -rf ${PREFIX}/${D}
d52 1
a52 1
	@@rm -f ${PREFIX}/${F}
d55 1
a55 1
	@@cd ${PREFIX} && ${PATCH} -p0 --forward --quiet -E < ${PATCHDIR}/patch-ldd
d58 1
a58 1
	${INSTALL_DATA} ${FILESDIR}/ld.so.conf ${PREFIX}/etc
d61 1
a61 1
	@@elf2olf -o linux ${PREFIX}/sbin/ldconfig
d64 2
a65 2
	@@cp -p ${PREFIX}/sbin/ldconfig ${PREFIX}/sbin/ldconfig.bin
	${INSTALL_SCRIPT} ${FILESDIR}/ldconfig ${PREFIX}/sbin
d68 3
a70 3
	@@cp -p ${PREFIX}/lib/ld-2.3.2.so ${PREFIX}/usr/bin/ld-2.3.2-olf.so
	@@elf2olf -o linux ${PREFIX}/usr/bin/ld-2.3.2-olf.so
	@@perl ${FILESDIR}/fix-ldd.pl ${PREFIX}/usr/bin/ld-2.3.2-olf.so
d74 2
a75 2
	@@find ${PREFIX} -perm -4000 -exec chmod u-s {} \;
	@@find ${PREFIX} -user 5041 -exec chown -h ${BINOWN}:${BINGRP} {} \;
@


1.2
log
@Semi-automatic update of the remaining ports to the new patchlevel format.

Please correct mistakes if you find them :).
@
text
@d1 1
a1 1
# $MirOS$
d6 1
a6 1
PKGNAME=	redhat_base-8.0-5
d79 1
a79 1
# remove setuid root bits
d81 1
a81 3

# Fix ownerships
	@@find ${PREFIX} -user 5041 -exec chown -h root:wheel {} \;
@


1.1
log
@Initial revision
@
text
@d6 1
a6 1
PKGNAME=	redhat_base-8.0p5
@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
