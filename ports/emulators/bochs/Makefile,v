head	1.5;
access;
symbols;
locks; strict;
comment	@# @;


1.5
date	2015.01.24.16.41.54;	author tg;	state Exp;
branches;
next	1.4;
commitid	10054C3CAE955B56674;

1.4
date	2009.08.16.10.21.08;	author bsiegert;	state Exp;
branches;
next	1.3;
commitid	1004A87DD8D402033E1;

1.3
date	2008.03.09.17.22.39;	author tg;	state Exp;
branches;
next	1.2;
commitid	10047D41CAA7E715397;

1.2
date	2006.09.14.00.09.08;	author tg;	state Exp;
branches;
next	1.1;
commitid	10045089C0E234154C3;

1.1
date	2005.03.18.15.45.52;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.03.18.15.45.52;	author tg;	state Exp;
branches;
next	;


desc
@@


1.5
log
@‚Ä¢ import a virtually unmodified (update legal situation; convert to BDFC)
  version of the vgaoem14 and vgaoem16 fonts from my website‚Äôs CVS export
  (ca. 2003 or so), for archival and possibly development
‚Ä¢ update the bochs port, point to fixedmisc README for legal situation
  and tell people to ignore the ‚Äúunfree__‚Äù pr√¶fix (untrue)
@
text
@# $MirOS: ports/emulators/bochs/Makefile,v 1.4 2009/08/16 10:21:08 bsiegert Exp $
# $OpenBSD: Makefile,v 1.36 2004/05/12 22:40:11 pedro Exp $
# $NetBSD: Makefile,v 1.2 1998/09/22 06:11:36 garbled Exp $

BROKEN=		fails to build

COMMENT=		x86 machine simulator
DISTNAME=		bochs-2.1.1
DASH_VER=		1
CATEGORIES=		emulators
MASTER_SITES=		${MASTER_SITE_SOURCEFORGE:=bochs/}
HOMEPAGE=		http://bochs.sourceforge.net/

# GNU GPLv2
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

USE_CXX=		Yes
CONFIGURE_STYLE=	autoconf no-autoheader
AUTOCONF_NEW=		Yes
CONFIGURE_ARGS+=	--enable-cdrom \
			--enable-fpu \
			--enable-ne2000 \
			--with-nogui \
			--with-term \
			--enable-all-optimizations

FLAVOURS=	debug i386 i486 i686 x86_64 smp smp_4 smp_8 \
		no_x11 no_mmx no_comp no_pci no_debug_readline
FLAVOUR?=

.if ${FLAVOUR:L:Mdebug}
CONFIGURE_ARGS+= --enable-debugger --enable-disasm --enable-x86-debugger
.  if ${FLAVOUR:L:Mno_debug_readline}
CONFIGURE_ARGS+= --enable-readline
.  endif
.endif

USE_CXX=	Yes
.if !${FLAVOUR:L:Mno_x11}
USE_X11=	Yes
CONFIGURE_ARGS+= --with-x11
.endif

.if ${FLAVOUR:L:Mi386}
FLAVOUR+=	no_mmx
CONFIGURE_ARGS+= --enable-cpu-level="3" --disable-mmx
. if ${FLAVOUR:L:Mi486} || ${FLAVOUR:L:Mi686} || ${FLAVOUR:L:Mx86_64}
ERRORS +=	"Fatal: cannot use i486, i686, or x86_64 flavours with i386"
. endif
.endif

.if ${FLAVOUR:L:Mi486}
FLAVOUR+=	no_mmx
CONFIGURE_ARGS+= --enable-cpu-level="4" --disable-mmx
. if ${FLAVOUR:L:Mi386} ||  ${FLAVOUR:L:Mi686} || ${FLAVOUR:L:Mx86_64}
ERRORS +=	"Fatal: cannot use i386, i686, or x86_64 flavours with i486"
. endif
.endif

.if ! ${FLAVOUR:L:Mi386} && ! ${FLAVOUR:L:Mi486} && ! ${FLAVOUR:L:Mi686}
CONFIGURE_ARGS+= --enable-cpu-level="5"
.endif

.if ${FLAVOUR:L:Mi686}
CONFIGURE_ARGS+= --enable-cpu-level="6"
. if ${FLAVOUR:L:Mi386} ||  ${FLAVOUR:L:Mi486}
ERRORS +=	"Fatal: cannot use i386 or i486 flavours with i686"
. endif
.endif

.if ${FLAVOUR:L:Mx86_64}
.  if !${FLAVOUR:L:Mi686}
ERRORS+=	"Fatal: i686 flavour required for x86_64"
.  else
CONFIGURE_ARGS+= --enable-x86-64
.  endif
.else
CONFIGURE_ARGS+= --disable-x86-64
.endif

.if !${FLAVOUR:L:Mno_pci}
CONFIGURE_ARGS+= --enable-pci
.endif

.if ${FLAVOUR:L:Msmp} || ${FLAVOUR:L:Msmp_4} || ${FLAVOUR:L:Msmp_8}
. if ! ${FLAVOUR:L:Mi686}
ERRORS += "Fatal: i686 flavour required for smp"
. endif
. if ${FLAVOUR:L:Msmp_8}
CONFIGURE_ARGS+= --enable-processors=8
. elif ${FLAVOUR:L:Msmp_4}
CONFIGURE_ARGS+= --enable-processors=4
. else
CONFIGURE_ARGS+= --enable-processors=2
. endif
CONFIGURE_ARGS+= --enable-apic
.else
CONFIGURE_ARGS+= --disable-apic
.endif

.if !${FLAVOUR:L:Mno_mmx}
CONFIGURE_ARGS+= --enable-mmx
.endif

.if !${FLAVOUR:L:Mno_comp}
CONFIGURE_ARGS+= --enable-compressed-hd
.endif

post-extract:
	cd ${WRKSRC:Q} && exec ${MKSH} ${.CURDIR}/patches/unfree__fontinstall

post-configure:
	@@sed -e 's@@!!PREFIX!!@@${PREFIX}@@' \
	    <${WRKSRC}/.bochsrc >${WRKSRC}/bochsrc

NO_REGRESS=	Yes

.for _ncpu in 2 4 8
BIOS +=	BIOS-bochs-${_ncpu}-processors
.endfor
BIOS +=	BIOS-bochs-latest
BIOS +=	VGABIOS-elpin-2.40 VGABIOS-elpin-LICENSE
BIOS +=	VGABIOS-lgpl-latest VGABIOS-lgpl-README

do-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/bochs/bios
	${INSTALL_DATA_DIR} ${PREFIX}/share/bochs/doc
	cd ${WRKBUILD}; ${INSTALL_PROGRAM} bochs bximage ${PREFIX}/bin
	cd ${WRKSRC}/bios; ${INSTALL_DATA} ${BIOS} ${PREFIX}/share/bochs/bios
	${INSTALL_MAN} ${WRKSRC}/doc/man/*.1 ${PREFIX}/man/man1
	${INSTALL_MAN} ${WRKSRC}/doc/man/*.5 ${PREFIX}/man/man5
	${INSTALL_DATA} ${WRKSRC}/docs-html/*.html ${PREFIX}/share/bochs/doc
	${INSTALL_DATA} ${WRKSRC}/bochsrc ${PREFIX}/share/bochs

.include <bsd.port.mk>
@


1.4
log
@Break, fails to build.

I am going to (have to) break a lot more ports, I think.
@
text
@d1 1
a1 1
# $MirOS: ports/emulators/bochs/Makefile,v 1.3 2008/03/09 17:22:39 tg Exp $
d7 6
a12 5
COMMENT=			x86 machine simulator
DISTNAME=	bochs-2.1.1
CATEGORIES=	emulators
MASTER_SITES=	${MASTER_SITE_SOURCEFORGE:=bochs/}
HOMEPAGE=	http://bochs.sourceforge.net/
d20 9
a28 8
CONFIGURE_STYLE= autoconf no-autoheader
AUTOCONF_NEW=	 Yes
CONFIGURE_ARGS=	--enable-cdrom \
		--enable-fpu \
		--enable-ne2000 \
		--with-nogui \
		--with-term \
		--enable-all-optimizations
d112 3
@


1.3
log
@bulk convert FLAVOR to FLAVOUR; nuke unused file; convert to $Mdocdate
@
text
@d1 1
a1 1
# $MirOS: ports/emulators/bochs/Makefile,v 1.2 2006/09/14 00:09:08 tg Exp $
d5 2
@


1.2
log
@clean up COMMENT and HOMEPAGE; regenerate INDEX (2761, 169 marked as broken, probably many many more) ≠ edited by script with manual postprocessing
@
text
@d1 1
a1 1
# $MirOS: ports/emulators/bochs/Makefile,v 1.1.7.1 2005/03/18 15:45:52 tg Exp $
d26 1
a26 1
FLAVORS=	debug i386 i486 i686 x86_64 smp smp_4 smp_8 \
d28 1
a28 1
FLAVOR?=
d30 1
a30 1
.if ${FLAVOR:L:Mdebug}
d32 1
a32 1
.  if ${FLAVOR:L:Mno_debug_readline}
d38 1
a38 1
.if !${FLAVOR:L:Mno_x11}
d43 2
a44 2
.if ${FLAVOR:L:Mi386}
FLAVOR+=	no_mmx
d46 2
a47 2
. if ${FLAVOR:L:Mi486} || ${FLAVOR:L:Mi686} || ${FLAVOR:L:Mx86_64}
ERRORS +=	"Fatal: cannot use i486, i686, or x86_64 flavors with i386"
d51 2
a52 2
.if ${FLAVOR:L:Mi486}
FLAVOR+=	no_mmx
d54 2
a55 2
. if ${FLAVOR:L:Mi386} ||  ${FLAVOR:L:Mi686} || ${FLAVOR:L:Mx86_64}
ERRORS +=	"Fatal: cannot use i386, i686, or x86_64 flavors with i486"
d59 1
a59 1
.if ! ${FLAVOR:L:Mi386} && ! ${FLAVOR:L:Mi486} && ! ${FLAVOR:L:Mi686}
d63 1
a63 1
.if ${FLAVOR:L:Mi686}
d65 2
a66 2
. if ${FLAVOR:L:Mi386} ||  ${FLAVOR:L:Mi486}
ERRORS +=	"Fatal: cannot use i386 or i486 flavors with i686"
d70 3
a72 3
.if ${FLAVOR:L:Mx86_64}
.  if !${FLAVOR:L:Mi686}
ERRORS+=	"Fatal: i686 flavor required for x86_64"
d80 1
a80 1
.if !${FLAVOR:L:Mno_pci}
d84 3
a86 3
.if ${FLAVOR:L:Msmp} || ${FLAVOR:L:Msmp_4} || ${FLAVOR:L:Msmp_8}
. if ! ${FLAVOR:L:Mi686}
ERRORS += "Fatal: i686 flavor required for smp"
d88 1
a88 1
. if ${FLAVOR:L:Msmp_8}
d90 1
a90 1
. elif ${FLAVOR:L:Msmp_4}
d100 1
a100 1
.if !${FLAVOR:L:Mno_mmx}
d104 1
a104 1
.if !${FLAVOR:L:Mno_comp}
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $MirOS$
d5 1
a5 1
COMMENT=	"x86 machine simulator"
@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
