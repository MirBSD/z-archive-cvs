head	1.9;
access;
symbols;
locks; strict;
comment	@# @;


1.9
date	2007.04.03.19.42.14;	author tg;	state dead;
branches;
next	1.8;
commitid	1004612AC977E789195;

1.8
date	2006.09.14.00.09.10;	author tg;	state Exp;
branches;
next	1.7;
commitid	10045089C0E234154C3;

1.7
date	2006.02.01.15.42.15;	author tg;	state Exp;
branches;
next	1.6;
commitid	10043E0D60F1A22E1E1;

1.6
date	2006.01.01.02.45.59;	author tg;	state Exp;
branches;
next	1.5;
commitid	10043B742786BBA895F;

1.5
date	2005.11.21.20.46.01;	author tg;	state Exp;
branches;
next	1.4;
commitid	7f124382321b63cf;

1.4
date	2005.11.17.23.05.56;	author tg;	state Exp;
branches;
next	1.3;
commitid	5a7437d0cd520df;

1.3
date	2005.11.17.18.43.58;	author tg;	state Exp;
branches;
next	1.2;
commitid	14ce437ccf72c45a;

1.2
date	2005.11.17.18.37.26;	author tg;	state Exp;
branches;
next	1.1;
commitid	27b8437ccdc0b77e;

1.1
date	2005.11.17.14.48.37;	author tg;	state Exp;
branches;
next	;
commitid	22d8437c97fd966a;


desc
@@


1.9
log
@â€¢ remove ports that are simply broken, don't work, for too long, with no
  update or update-willing person in sight, kde stuff, web2.0 stuff that
  we don't want in ports (just stuff it into /var/www yourself, it isn't
  that difficult, right?), stuff for which no new version exists/will be
  and some obsd cruft; adjust dependencies
â€¢ no BUILD_DEPENDS+=RUN_DEPENDS or vice versa any more, *ever*
â€¢ fix some other stuff partially

ok bsiegert@@
@
text
@# $MirOS: ports/emulators/qvm86/Makefile,v 1.8 2006/09/14 00:09:10 tg Exp $
# $OpenBSD: Makefile,v 1.7 2005/11/05 12:11:05 todd Exp $

BROKEN=			problems with network, sound, etc.

ONLY_FOR_PLATFORMS=	MirBSD:*:i386

COMMENT=			fast i386 emulator with kernel module
PKGNAME=		${_CVS_DISTF0:R}-0
CATEGORIES=		emulators
HOMEPAGE=		http://fabrice.bellard.free.fr/qemu/ \
			http://savannah.nongnu.org/qvm86/
CVS_DISTREPO=		anoncvs@@savannah.nongnu.org:/cvsroot/qemu
CVS_DISTDATE=		2005/11/17 15:00
CVS_DISTMODS=		qemu
CVS_DISTFILE=		qemu
CVS_DISTREPO0=		anoncvs@@savannah.nongnu.org:/cvsroot/qvm86
CVS_DISTDATE0=		2005/11/17 15:00
CVS_DISTMODS0=		qvm86
CVS_DISTFILE0=		qvm86

# GNU GPLv2
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes

BUILD_DEPENDS=		::textproc/texi2html
LIB_DEPENDS=		SDL::devel/sdl
USE_GMAKE=		Yes
USE_X11=		Yes
CONFIGURE_STYLE=	gnu
CONFIGURE_ARGS+=	--cc="${CC}" \
			--make="${GMAKE}" \
			--interp-prefix="${LOCALBASE}/share/qemu/gnemul-%M" \
			--target-list=i386-softmmu \
			--extra-cflags="${CFLAGS}" \
			--extra-ldflags="${LDFLAGS}" \
			--enable-adlib \
			--disable-kqemu

.include <mirports.sys.mk>
COPTS+=			-fno-stack-protector

WRKDIST=		${WRKDIR}/qemu
QVMLKMFILES=		Makefile.bsdlkm lkm
LKMDIR=			${TRUEPREFIX}/share/qemu/lkm

MAKE_ENV+=		BSDMAKE=/usr/bin/make
MAKE_ENV+=		LKMDIR=${LKMDIR}

SMKVER!=		print $$((${OSver:R} * 256 + ${OSver:E}))
.if ${SMKVER} < 2106
IGNORE+=		"requires a newer system make(1), please upgrade"
.endif

post-extract:
	@@mv ${WRKDIR}/qvm86 ${WRKDIST}/
	@@cd ${FILESDIR} && find ${QVMLKMFILES} -type f \
	    | cpio -pdu ${WRKDIST}/qvm86/

pre-patch:
	@@cd ${WRKSRC} && ${PATCH} ${PATCH_DIST_ARGS} -l <qvm86/patch.qvm86

pre-install:
	${INSTALL_DATA_DIR} ${DESTDIR}${LKMDIR}

.include <bsd.port.mk>
@


1.8
log
@clean up COMMENT and HOMEPAGE; regenerate INDEX (2761, 169 marked as broken, probably many many more) ­ edited by script with manual postprocessing
@
text
@d1 1
a1 1
# $MirOS: ports/emulators/qvm86/Makefile,v 1.7 2006/02/01 15:42:15 tg Exp $
@


1.7
log
@change the way OS version detection and variable assignment works,
and fix or break all ports which use some of the variables.

Do not use:
* OPSYS, OSMAJOR, OSMINOR: used in OpenBSD (maybe more)
* OSREV, OSrev: changed meaning relative to OpenBSD
* OSrev, OSrel, OSrelm, OSrelx, OSrpl: used in MirBSD (7 and 8)

Do use (preferred first):
* OStype (MirBSD, OpenBSD, Darwin, Interix, ...)
* OSver (always <number>.<number> in decimal)
  - on OpenBSD: 3.8
  - on MirBSD: major.patchlevel
  - on Darwin: 8.4 (without .0)
  - on Interix: 3.5
* OStriplet (i386-ecce-mirbsd8, zaurus-unknown-openbsd3.9,
  powerpc-apple-darwin8.2.0, ...)
* OSREV (the output of "uname -r")
  - on OpenBSD: 3.8
  - on MirBSD: 8
  - on Darwin: 8.4.0
@
text
@d1 1
a1 1
# $MirOS: ports/emulators/qvm86/Makefile,v 1.6 2006/01/01 02:45:59 tg Exp $
d8 1
a8 1
COMMENT=		"fast i386 emulator with kernel module"
@


1.6
log
@switch ERRORS to IGNORE to fix make index
@
text
@d1 1
a1 1
# $MirOS: ports/emulators/qvm86/Makefile,v 1.5 2005/11/21 20:46:01 tg Exp $
d52 1
a52 6
SMKVER!=		let major=$$(print | /usr/bin/env -i \
			    /usr/bin/make -f - ___DISPLAY_MAKEVARS=OSrev); \
			let minor=$$(print | /usr/bin/env -i \
			    /usr/bin/make -f - ___DISPLAY_MAKEVARS=OSrpl); \
			let 'version=major * 256 + minor'; print $$version

@


1.5
log
@mark as broken
@
text
@d1 1
a1 1
# $MirOS: ports/emulators/qvm86/Makefile,v 1.4 2005/11/17 23:05:56 tg Exp $
d59 1
a59 1
ERRORS+=		"Your system make(1) is too old, please upgrade."
@


1.4
log
@* fix invocation of /usr/bin/make when using wrappers
* convert to CVS distfiles w/ mpczar (first port to use this)
@
text
@d1 1
a1 1
# $MirOS: ports/emulators/qvm86/Makefile,v 1.3 2005/11/17 18:43:58 tg Exp $
d4 2
@


1.3
log
@only allow /usr/bin/make 08:3A or newer
@
text
@d1 1
a1 1
# $MirOS: ports/emulators/qvm86/Makefile,v 1.2 2005/11/17 18:37:26 tg Exp $
d7 1
a7 3
V_EMU=			20051117
V_QVM=			20051117
PKGNAME=		qvm86-${V_QVM}-1
d11 8
a18 3
DISTFILES=		qemu-${V_EMU}.cgz \
			qvm86-${V_QVM}.cgz:0
MASTER_SITES=		#XXX
d50 4
a53 2
SMKVER!=		let major=$$(print | /usr/bin/make -f - ___DISPLAY_MAKEVARS=OSrev); \
			let minor=$$(print | /usr/bin/make -f - ___DISPLAY_MAKEVARS=OSrpl); \
@


1.2
log
@bump to -1
* add LKM stub (equivalent to contrib/code/lkm/programmer)
* dual-licence the LKM stub under LGPL 2.0
* enable qvm86 support in qemu

Tested: still works, with module loaded and not loaded
@
text
@d1 1
a1 1
# $MirOS: ports/emulators/qvm86/Makefile,v 1.1 2005/11/17 14:48:37 tg Exp $
d47 8
@


1.1
log
@initial port of qemu-HEAD + qvm86-HEAD
* not tested, only a make-compile attempt
  -> pcnet and so on removed
* i386 -> i386 only
* kqemu/qvm86 support disabled for now
  (no attempt at porting the LKM has been done yet)
* untested if it still works

conflicts with qemu-* of course (bsiegert@@ please check the syntax :)
@
text
@d1 1
a1 1
# $MirOS: ports/emulators/qemu/Makefile,v 1.3 2005/11/15 12:25:06 tg Exp $
d9 1
a9 1
PKGNAME=		qvm86-${V_QVM}-0
a34 1
			--disable-qvm86 \
d41 5
d49 2
d55 3
@

