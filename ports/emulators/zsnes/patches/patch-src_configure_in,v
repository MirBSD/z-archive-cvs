head	1.4;
access;
symbols;
locks; strict;
comment	@# @;


1.4
date	2008.11.03.19.04.38;	author tg;	state Exp;
branches;
next	1.3;
commitid	100490F4AE20E132F01;

1.3
date	2008.10.30.19.42.07;	author tg;	state Exp;
branches;
next	1.2;
commitid	100490A0E163748529B;

1.2
date	2005.10.02.19.25.35;	author tg;	state Exp;
branches;
next	1.1;
commitid	6107434033f5d23b;

1.1
date	2005.03.18.15.46.03;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.03.18.15.46.03;	author tg;	state Exp;
branches;
next	;


desc
@@


1.4
log
@â€¢ apply some patches from zsnes CVS
â€¢ fix some things, e.g. code placement in .data section
â€¢ allow loading gzipâ€™d ROMs with â€˜.gzâ€™ extension
â€¢ on MirBSD, allow for loading gzipâ€™d files (even split ROMs)
  when they have no â€˜.gzâ€™ extension too, using gzfopen(3)
â€¢ simplify the port
â€¢ honour our CFLAGS better
@
text
@$MirOS: ports/emulators/zsnes/patches/patch-src_configure_in,v 1.3 2008/10/30 19:42:07 tg Exp $
--- src/configure.in.orig	Wed Jan 19 22:52:16 2005
+++ src/configure.in	Mon Nov  3 17:33:27 2008
@@@@ -9,13 +9,12 @@@@ AC_SUBST(VERSION)
 AC_ARG_WITH(nasm-prefix,[  --with-nasm-prefix=PFX Prefix where nasm is installed (optional)], nasm_prefix="$withval", nasm_prefix="")
 
 dnl -- Where is our compiler, and who are we compiling for?
-CFLAGS="$CFLAGS -pipe -I. -Wall -I/usr/local/include -I/usr/include"
+CFLAGS="$CFLAGS $CPPFLAGS -I. -Wall"
 
 dnl -- You might wanna change -I/usr/include if you're trying to do this with
 dnl Mingw, because it doesnt have a standard file tree. Maybe if ming do this
 dnl else do -I/usr/include. Or some shit. You figure it out.
 
-LDFLAGS="$LDFLAGS -L/usr/local/lib -L/usr/lib"
 
 dnl -- Same thing here.
 
@@@@ -37,9 +36,9 @@@@ case "$target" in
 		CFLAGS="$CFLAGS -D__LINUX__ -D__BEOS__"
         	NFLAGS="$NFLAGS -D__LINUX__ -D__BEOS__ -f elf -DELF"
 		;;
-	*-*-*openbsd*)
+	*-*-*openbsd* | *-*-mirbsd*)
 		CFLAGS="$CFLAGS -D__LINUX__ -D__FreeBSD__"
-		NFLAGS="$NFLAGS -D__LINUX__ -D__FreeBSD__ -D__OpenBSD__ -f aoutb"
+		NFLAGS="$NFLAGS -D__LINUX__ -D__FreeBSD__ -D__OpenBSD__ -DELF -f elf"
 		;;
 	*-*-*bsd*)
 		CFLAGS="$CFLAGS -D__LINUX__ -D__FreeBSD__"
@@@@ -113,13 +112,15 @@@@ if test x$debug = xyes; then
 	dnl enabled. 
 
 	CFLAGS="$CFLAGS -DDEBUG -O0 -fno-omit-frame-pointer -ggdb3"
-	NFLAGS="$NFLAGS -DDEBUG -g -s -O1" dnl -O0 doesnt work
+	NFLAGS="$NFLAGS -DDEBUG -s -O1" dnl -O0 doesnt work
+	NDFLAGS="-g"
 	ZSNESEXE="zsnesd"
 else
 	AC_MSG_RESULT(no)
 	
-	CFLAGS="$CFLAGS -O3 -ffast-math -fomit-frame-pointer -fexpensive-optimizations -s"
+	CFLAGS="-O3 -ffast-math -fomit-frame-pointer -fexpensive-optimizations -s $CFLAGS"
 	NFLAGS="$NFLAGS -O1"
+	NDFLAGS=
 	ZSNESEXE="zsnes"
 fi
 
@@@@ -156,6 +157,7 @@@@ dnl Checks for library functions.
 AC_SUBST(ZSNESEXE)
 AC_SUBST(GL_DRAW)
 AC_SUBST(NFLAGS)
+AC_SUBST(NDFLAGS)
 AC_SUBST(NASMPATH)
 AC_OUTPUT(Makefile)
 echo
@


1.3
log
@fix build: honour cppflags
use png module instead of hardcoding
@
text
@d1 1
a1 1
$MirOS: ports/emulators/zsnes/patches/patch-src_configure_in,v 1.2 2005/10/02 19:25:35 tg Exp $
d3 1
a3 1
+++ src/configure.in	Thu Oct 30 19:38:13 2008
d42 2
a43 1
 	CFLAGS="$CFLAGS -O3 -ffast-math -fomit-frame-pointer -fexpensive-optimizations -s"
@


1.2
log
@Dunkelheit breitet sich über dem Land aus, während die Mana Kraft versiegt...

Update to 1.42, works sort of.
* Should, according to #zsnes hints, use -rHEAD instead, much better on BSD
* reverted man page to older version due to licence issues
* backported one zfilew.c hunk from CVS zsnes
* playing gzip'd files does not work
@
text
@d1 1
a1 1
$MirOS$
d3 1
a3 1
+++ src/configure.in	Sun Oct  2 18:36:57 2005
d9 1
a9 1
+CFLAGS="$CFLAGS -I. -Wall"
@


1.1
log
@Initial revision
@
text
@d1 6
a6 5
--- src/configure.in.orig	Thu May 23 10:11:18 2002
+++ src/configure.in	Fri Apr 25 22:46:33 2003
@@@@ -16,7 +16,7 @@@@ dnl See also: remarks supplied in the de
 AC_INIT(init.asm)
 AC_CONFIG_HEADER(config.h)	
d8 1
a8 1
-CFLAGS="-pipe -I. -Wall"
d10 12
a21 4
 AC_PROG_CC
 AC_PATH_PROG(NASMPATH,nasm,[AC_MSG_ERROR(nasm 0.98 is required)])
 NFLAGS="$NFLAGS -w-orphan-labels"
@@@@ -29,7 +29,7 @@@@ case "$target" in
d23 2
a24 1
 	*-*-*openbsd*)
d31 10
a40 3
@@@@ -143,33 +143,8 @@@@ else
 	dnl zsnes more easily deal with small instruction caches, and more
 	dnl effectivly use branch prediction.
d42 3
a44 2
-	CFLAGS="$CFLAGS -Os -ffast-math -fomit-frame-pointer -fschedule-insns2 -s"
+	CFLAGS="$CFLAGS -Os -ffast-math -fomit-frame-pointer -fschedule-insns2"
a45 25
-fi
-
-AC_MSG_CHECKING(which processor class to optimize for)
-if test x$debug != xyes; then
-			case "$target" in
-				i486-*-*)
-					CFLAGS="$CFLAGS -march=i486"
-					AC_MSG_RESULT(486)
-					;;
-				i586-*-*)
-					CFLAGS="$CFLAGS -march=pentium"
-					AC_MSG_RESULT(Pentium)
-					;;
-				i686-*-*)
-					CFLAGS="$CFLAGS -march=pentiumpro"
-					AC_MSG_RESULT(PPro/P2)
-					;;
-				*)
-					AC_MSG_RESULT(386)
-					AC_MSG_WARN(*** This is probably not what you want use --target)
-					;;
-			esac
-
-else
-	AC_MSG_RESULT(no optimization because debug enabled)
d48 8
a55 1
 dnl Checks for header files.
@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
