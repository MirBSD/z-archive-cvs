head	1.23;
access;
symbols
	bsiegert-svn16:1.22.0.2
	bsiegert-svn16_BASE:1.22;
locks; strict;
comment	@# @;


1.23
date	2013.11.02.19.10.59;	author tg;	state Exp;
branches;
next	1.22;
commitid	10052754E514CDEA287;

1.22
date	2009.07.29.20.31.27;	author bsiegert;	state Exp;
branches
	1.22.2.1;
next	1.21;
commitid	1004A70B1852D3DD57A;

1.21
date	2008.12.15.20.27.35;	author tg;	state Exp;
branches;
next	1.20;
commitid	1004946BDA131623437;

1.20
date	2008.09.21.18.05.52;	author bsiegert;	state Exp;
branches;
next	1.19;
commitid	10048D68D001A2E943C;

1.19
date	2008.06.28.11.29.26;	author bsiegert;	state Exp;
branches;
next	1.18;
commitid	10048662085112D21FF;

1.18
date	2008.03.15.23.16.55;	author tg;	state Exp;
branches;
next	1.17;
commitid	10047DC58F316B51020;

1.17
date	2008.03.14.20.56.52;	author tg;	state Exp;
branches;
next	1.16;
commitid	10047DAE6953D896018;

1.16
date	2008.03.09.17.22.33;	author tg;	state Exp;
branches;
next	1.15;
commitid	10047D41CAA7E715397;

1.15
date	2007.09.17.21.02.05;	author bsiegert;	state Exp;
branches;
next	1.14;
commitid	10046EEEACD7BE0DF44;

1.14
date	2007.05.17.16.37.35;	author bsiegert;	state Exp;
branches;
next	1.13;
commitid	100464C84D33BC2F455;

1.13
date	2007.01.09.22.36.59;	author tg;	state Exp;
branches;
next	1.12;
commitid	10045A418DA79565A05;

1.12
date	2006.12.20.15.31.17;	author tg;	state Exp;
branches;
next	1.11;
commitid	100458956E02A39AB3C;

1.11
date	2006.11.08.16.45.42;	author bsiegert;	state Exp;
branches;
next	1.10;
commitid	100455209A90CE83743;

1.10
date	2006.10.11.15.30.10;	author bsiegert;	state Exp;
branches;
next	1.9;
commitid	100452D0E083AC9D816;

1.9
date	2006.10.07.21.27.45;	author bsiegert;	state Exp;
branches;
next	1.8;
commitid	10045281B5153FFBB6C;

1.8
date	2006.09.14.00.08.57;	author tg;	state Exp;
branches;
next	1.7;
commitid	10045089C0E234154C3;

1.7
date	2006.06.04.20.29.35;	author bsiegert;	state Exp;
branches;
next	1.6;
commitid	100448342AE38CC7CE7;

1.6
date	2006.06.04.19.49.13;	author tg;	state Exp;
branches;
next	1.5;
commitid	100448339312A19CEA0;

1.5
date	2006.05.29.21.16.21;	author bsiegert;	state Exp;
branches;
next	1.4;
commitid	100447B649831B621D6;

1.4
date	2005.12.06.20.00.01;	author bsiegert;	state Exp;
branches;
next	1.3;
commitid	2e54395ed8e258e;

1.3
date	2005.07.06.19.21.29;	author bsiegert;	state Exp;
branches;
next	1.2;
commitid	609742cc2f044f70;

1.2
date	2005.05.30.21.10.37;	author bsiegert;	state Exp;
branches;
next	1.1;
commitid	44b4429b8146617e;

1.1
date	2005.03.18.15.45.35;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.22.2.1
date	2009.10.31.12.31.21;	author bsiegert;	state Exp;
branches;
next	;
commitid	1004AEC2DF2132D90A8;

1.1.7.1
date	2005.03.18.15.45.35;	author tg;	state Exp;
branches;
next	;


desc
@@


1.23
log
@fix hardcoded #!/bin/ksh (use #!/usr/bin/env mksh for ports)
@
text
@# $MirOS: ports/devel/subversion/Makefile,v 1.22 2009/07/29 20:31:27 bsiegert Exp $

COMMENT=		Subversion revision control system
VERSION=		1.5.2
DASH_VER=		2
DISTNAME=		subversion-${VERSION}
CATEGORIES=		devel net
HOMEPAGE=		http://subversion.tigris.org/
RESPONSIBLE=		Benny Siegert <bsiegert@@gmx.de>

# BSD
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM= Yes
PERMIT_DISTFILES_FTP=	Yes

MASTER_SITES=		http://subversion.tigris.org/tarballs/
EXTRACT_SUFX=		.tar.bz2

FLAVOURS=		bsddb
FLAVOUR?=

LIB_DEPENDS+=		apr::devel/apr/apr
LIB_DEPENDS+=		neon::net/neon
RUN_DEPENDS+=		:p5-URI-*:www/p5-URI
MODULES+=		p5

.if ${FLAVOUR:L:Mbsddb}
LIB_DEPENDS+=		db.4.2::databases/db
LIB_DEPENDS+=		aprutil::devel/apr/util,bsddb
CONFIGURE_ARGS+=	--with-berkeley-db
.else
LIB_DEPENDS+=		aprutil::devel/apr/util
CONFIGURE_ARGS+=	--without-berkeley-db
.endif

# We don't support building the apache module (yet).
CONFIGURE_STYLE=	autoconf no-autoheader
AUTOCONF_NEW=		Yes
MODULES+=		p5

CONFIGURE_ARGS+=	--with-neon=${LOCALBASE}
CONFIGURE_ARGS+=	--disable-nls
CONFIGURE_ARGS+=	${CONFIGURE_SHARED}

DOCFILES=		svnsync.txt fsfs ssh-tricks

post-build:
	cd ${WRKBUILD} && ${SETENV} ${MAKE_ENV} ${MAKE_PROGRAM} swig-pl
	${NROFF} -mdoc ${FILESDIR}/svnup-cvs.1 >${WRKBUILD}/contrib/client-side/svnup-cvs.cat1

post-install:
	cd ${WRKBUILD} && ${SETENV} ${MAKE_ENV} ${_FAKE_SETUP} \
	${MAKE_PROGRAM} install-swig-pl \
	INSTALLSITELIB=${PREFIX:Q}/${P5SITE} \
        INSTALLSITEARCH="\$${INSTALLSITELIB}/${MODPERL_ARCH}" \
        INSTALLBIN=${TRUEPREFIX:Q}/bin INSTALLSCRIPT='$${INSTALLBIN}' \
        INSTALLMAN3DIR=${PREFIX:Q}/man/man3 \
        INSTALLSITEMAN3DIR=${PREFIX:Q}/man/man3 \
        INSTALLVENDORMAN3DIR=${PREFIX:Q}/man/man3
	${INSTALL_SCRIPT} ${WRKSRC}/contrib/client-side/svn_load_dirs/svn_load_dirs.pl ${PREFIX}/bin/svn_load_dirs
	${INSTALL_SCRIPT} ${FILESDIR}/svnup-cvs ${PREFIX}/bin
	${INSTALL_MAN} ${WRKSRC}/contrib/client-side/svnup-cvs.cat1 ${PREFIX}/man/cat1/svnup-cvs.0
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/subversion
	${INSTALL_DATA} ${WRKSRC}/contrib/client-side/svn_load_dirs/svn_load_dirs.README ${PREFIX}/share/doc/subversion
.for i in ${DOCFILES}
	${INSTALL_DATA} ${WRKSRC}/notes/${i} ${PREFIX}/share/doc/subversion
.endfor

.include <bsd.port.mk>
@


1.22
log
@Crude hack for fixing the build on Darwin: don't take over LDFLAGS from
the main Makefile to the perl stuff, instead use only the flags selected by
EU::MM.
@
text
@d1 1
a1 1
# $MirOS: ports/devel/subversion/Makefile,v 1.21 2008/12/15 20:27:35 tg Exp $
d5 1
a5 1
DASH_VER=		1
@


1.22.2.1
log
@Update to subversion-1.6.6, VERY experimental right now. For example this
gem on Darwin:

[lem:~] bsiegert% perl -MSVN::Core -e 1
Bus error
@
text
@d1 1
a1 1
# $MirOS: ports/devel/subversion/Makefile,v 1.22 2009/07/29 20:31:27 bsiegert Exp $
d4 2
a5 2
VERSION=		1.6.6
DASH_VER=		0
@


1.21
log
@â€¢ use ${NROFF}
â€¢ fix missing MAKE_ENV &c.

still one bug remaining:

Writing /usr/ports/devel/subversion/w-subversion-1.5.2-0/fake-i386/usr/mpkg/libdata/perl5/site_perl/i386-mirbsd/auto/SVN/_Core/.packlist
Appending installation info to /usr/libdata/perl5/i386-mirbsd/5.8.8/perllocal.pod
systrace: deny user: root, prog: /usr/dbin/mksh, pid: 14724(0)[14494], policy: /usr/mpkg/bin/mmake, filters: 204, syscall: native-fswrite(5), filename: /usr/libdata/perl5/i386-mirbsd/5.8.8/perllocal.pod
/usr/dbin/mksh: cannot create /usr/libdata/perl5/i386-mirbsd/5.8.8/perllocal.pod: Operation not permitted
*** Error code 1 (ignored)

While this one is ignored, it *must* be resolved, because
this is dangerous on OEs without systrace!
@
text
@d1 1
a1 1
# $MirOS: ports/devel/subversion/Makefile,v 1.20 2008/09/21 18:05:52 bsiegert Exp $
d5 1
a5 1
DASH_VER=		0
@


1.20
log
@Update to 1.5.2-0, relatively straightforward
@
text
@d1 1
a1 1
# $MirOS: ports/devel/subversion/Makefile,v 1.19 2008/06/28 11:29:26 bsiegert Exp $
d49 2
a50 2
	cd ${WRKBUILD} && ${MAKE_PROGRAM} swig-pl
	nroff -mdoc ${FILESDIR}/svnup-cvs.1 > ${WRKSRC}/contrib/client-side/svnup-cvs.cat1
a51 1
# Use of LOCALBASE is intentional so that DESTDIR is not added twice.
d53 3
a55 2
	cd ${WRKBUILD} && ${MAKE_PROGRAM} install-swig-pl \
	INSTALLSITELIB=${LOCALBASE:Q}/${P5SITE} \
d57 4
a60 4
        INSTALLBIN=${LOCALBASE:Q}/bin INSTALLSCRIPT='$${INSTALLBIN}' \
        INSTALLMAN3DIR=${LOCALBASE:Q}/man/man3 \
        INSTALLSITEMAN3DIR=${LOCALBASE:Q}/man/man3 \
        INSTALLVENDORMAN3DIR=${LOCALBASE:Q}/man/man3
@


1.19
log
@Update to 1.5.0-0. Big update, go read
http://subversion.tigris.org/svn_1.5_releasenotes.html
for details.
@
text
@d1 1
a1 1
# $MirOS: ports/devel/subversion/Makefile,v 1.18 2008/03/15 23:16:55 tg Exp $
d4 1
a4 1
VERSION=		1.5.0
@


1.18
log
@bsiegert@@ agrees that itâ€™s better to have all the variables in the p5 module
@
text
@d1 1
a1 1
# $MirOS: ports/devel/subversion/Makefile,v 1.17 2008/03/14 20:56:52 tg Exp $
d4 2
a5 1
VERSION=		1.4.5
d26 1
d61 1
a61 1
	${INSTALL_SCRIPT} ${WRKSRC}/contrib/client-side/svn_load_dirs.pl ${PREFIX}/bin/svn_load_dirs
d65 1
@


1.17
log
@I found three non-modperl users of P5ARCH, two of which were broken
convert all three to modp5
@
text
@d1 1
a1 1
# $MirOS: ports/devel/subversion/Makefile,v 1.16 2008/03/09 17:22:33 tg Exp $
a4 1
DASH_VER=		0
a34 1

d38 1
a45 6
MODULES+=		p5
# We have to replicate some of the perl.port.mk logic here.
P5MAN3EXT!=		/usr/bin/perl -e 'use Config; print ".".$$Config{man3ext};'
P5DLEXT!=		/usr/bin/perl -e 'use Config; print ".".$$Config{dlext};'
SUBST_VARS+=		P5SITE P5MAN3EXT P5DLEXT

@


1.16
log
@bulk convert FLAVOR to FLAVOUR; nuke unused file; convert to $Mdocdate
@
text
@d1 1
a1 1
# $MirOS: ports/devel/subversion/Makefile,v 1.15 2007/09/17 21:02:05 bsiegert Exp $
d47 1
d49 3
a51 4
MODPERL_ARCH!=		/usr/bin/perl -e 'use Config; print $$Config{archname}, "\n";'
P5MAN3EXT!=	/usr/bin/perl -e 'use Config; print ".".$$Config{man3ext};'
P5DLEXT!=	/usr/bin/perl -e 'use Config; print ".".$$Config{dlext};'
SUBST_VARS+=	P5ARCH P5SITE P5MAN3EXT P5DLEXT
@


1.15
log
@Update subversion to 1.4.5-0. Also build and install the Perl bindings in
all cases, as all of our platforms have perl in base.

I had to replicate some of the logic in perl.port.mk for this. Idea: How
about making most of perl.port.mk .if ${CONFIGURE_STYLE:L:Mperl}? This way,
ports like this one or irssi can do MODULES+=perl.
@
text
@d1 1
a1 1
# $MirOS: ports/devel/subversion/Makefile,v 1.14 2007/05/17 16:37:35 bsiegert Exp $
d20 2
a21 2
FLAVORS=		bsddb
FLAVOR?=
d27 1
a27 1
.if ${FLAVOR:L:Mbsddb}
@


1.14
log
@Update to 1.4.3-0, no surprises here
@
text
@d1 1
a1 1
# $MirOS: ports/devel/subversion/Makefile,v 1.13 2007/01/09 22:36:59 tg Exp $
d4 1
a4 1
VERSION=		1.4.3
a36 1
#
a37 1
#
d47 5
a51 3
# Workaround for autotools madness
post-patch:
	rm -rf ${WRKSRC}/apr-util/autom4te.cache
d54 1
d57 1
d59 7
@


1.13
log
@Yep, me committing here. No, heaven's not gonna fall down (yet).
I just want to make sucky operating systems less sucky, and I've
found a solution, thanks to the folks who wrote this:
| http://gentoo-wiki.com/HOWTO_Create_an_UTF-8_enabled_system

I hope bsiegert@@ won't rip off my head for touching a port of hisâ€¦

Oh, I also regen'd the distinfo with TIGER hash included.
@
text
@d1 1
a1 1
# $MirOS: ports/devel/subversion/Makefile,v 1.12 2006/12/20 15:31:17 tg Exp $
d4 2
a5 2
VERSION=		1.4.2
DASH_VER=		1
@


1.12
log
@sync DASH_VER usage:
* the dash doesn't belong into the DASH_VER variable,
  it's only a decimal integer value
* DASH_VER already defaults to 0 (admittedly new)
* PKGNAME already defaults to ${DISTNAME}-${DASH_VER}
@
text
@d1 1
a1 1
# $MirOS: ports/devel/subversion/Makefile,v 1.11 2006/11/08 16:45:42 bsiegert Exp $
d5 1
a7 1

@


1.11
log
@Update to 1.4.2, contains my patches from last time. Also add a few useful
documents to the share/doc/subversion directory.
@
text
@d1 1
a1 1
# $MirOS: ports/devel/subversion/Makefile,v 1.10 2006/10/11 15:30:10 bsiegert Exp $
a4 1
DASH_VER=		-0
a5 1
PKGNAME=		subversion-${VERSION}${DASH_VER}
@


1.10
log
@Add explicit neon dependency, bump patchlevel.
@
text
@d1 1
a1 1
# $MirOS: ports/devel/subversion/Makefile,v 1.9 2006/10/07 21:27:45 bsiegert Exp $
d4 2
a5 2
VERSION=		1.4.0
DASH_VER=		-1
d49 1
a49 1
#MAKE_ENV+=		LD_LIBRARY_PATH=${WRKINST}${LOCALBASE}/lib
d62 4
@


1.9
log
@Update subversion to 1.4.0-0. apr and apr-util are no longer contained in
the svn tarball, so delete the old subversion package before upgrading.

The release contains a typo that breaks the installation. Way to go.

If you want to have Berkeley DB support, you also need the bsddb flavour
of apr-util.
@
text
@d1 1
a1 1
# $MirOS: ports/devel/subversion/Makefile,v 1.7 2006/06/04 20:29:35 bsiegert Exp $
d5 1
a5 1
DASH_VER=		-0
d26 1
@


1.8
log
@clean up COMMENT and HOMEPAGE; regenerate INDEX (2761, 169 marked as broken, probably many many more) ­ edited by script with manual postprocessing
@
text
@d3 2
a4 2
COMMENT=			Subversion revision control system
VERSION=		1.3.2
d25 1
a25 2
LIB_DEPENDS+=		xml2::textproc/libxml
LIB_DEPENDS+=		neon::net/neon
a26 1
MODULES=		textproc/expat
d30 2
a31 2

CONFIGURE_ARGS+=	--with-dbm=db42 --with-berkeley-db
d33 1
a44 1
CONFIGURE_ARGS+=	--with-gdbm=no
a45 1
CONFIGURE_ARGS+=	--with-expat=${EXPAT_PREFIX}
d48 1
a48 2
MODGNU_CONFIG_GUESS_DIRS= ${WRKSRC} ${WRKSRC}/apr ${WRKSRC}/apr-util
MAKE_ENV+=		LD_LIBRARY_PATH=${WRKINST}${LOCALBASE}/lib
@


1.7
log
@Update to 1.3.2-0, some bugfixes.
@
text
@d1 1
a1 1
# $MirOS: ports/devel/subversion/Makefile,v 1.6 2006/06/04 19:49:13 tg Exp $
d3 1
a3 1
COMMENT=		"Subversion revision control system"
@


1.6
log
@if you @@comment out all entries in a directory,
@@comment out the @@dirrm directory too, please!

bump patchlevel; now let me see how I pkg_delete this thing...
@
text
@d1 1
a1 1
# $MirOS: ports/devel/subversion/Makefile,v 1.5 2006/05/29 21:16:21 bsiegert Exp $
d4 2
a5 2
VERSION=		1.3.1
DASH_VER=		-1
@


1.5
log
@Update subversion to 1.3.1-0, use expat module.

Request by tg@@ (no kidding!)
@
text
@d1 1
a1 1
# $MirOS: ports/devel/subversion/Makefile,v 1.4 2005/12/06 20:00:01 bsiegert Exp $
d5 1
a5 1
DASH_VER=		-0
@


1.4
log
@Update subversion to 1.2.3. Yes, I know, 1.3.0 will be out soon.
Can now be built optionally without bsddb (default for now as bsddb is
broken on MirOS-current).
@
text
@d1 1
a1 1
# $MirOS: ports/devel/subversion/Makefile,v 1.3 2005/07/06 19:21:29 bsiegert Exp $
d4 1
a4 1
VERSION=		1.2.3
a25 1
LIB_DEPENDS+=		expat::textproc/expat
d28 1
d48 1
@


1.3
log
@Move some packages (those that use DASH_VER) to new patchlevels.
@
text
@d1 1
a1 1
# $MirOS$
d4 1
a4 1
VERSION=		1.2.0
d22 3
a24 1
LIB_DEPENDS+=		db.4.2::databases/db
d27 1
a27 1
LIB_DEPENDS+=		neon.24.7::net/neon
d30 9
d46 1
a46 1
CONFIGURE_ARGS+=	--with-dbm=db42 --with-gdbm=no
@


1.2
log
@Update subversion to 1.2.0.
Daswarjaeinfach.
@
text
@d5 1
a5 1
DASH_VER=		
@


1.1
log
@Initial revision
@
text
@d4 1
a4 1
VERSION=		1.1.2
d50 2
a51 2
	${INSTALL_PROGRAM} ${WRKSRC}/contrib/client-side/svn_load_dirs.pl ${PREFIX}/bin/svn_load_dirs
	${INSTALL_PROGRAM} ${FILESDIR}/svnup-cvs ${PREFIX}/bin
@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
