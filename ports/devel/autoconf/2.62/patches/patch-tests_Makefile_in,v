head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2009.11.22.00.16.24;	author tg;	state Exp;
branches;
next	1.1;
commitid	1004B088259208162D8;

1.1
date	2009.11.18.20.48.08;	author bsiegert;	state Exp;
branches;
next	;
commitid	1004B045D7A02892B0A;


desc
@@


1.2
log
@merge bsiegert@@’s OpenBSD 2.62 port, my MirBSD 2.61 port, add portability
to GNU m4 (back which was removed by these OpenBSD people), fix things,
and add a few workarounds for bugs in our m4 (which increments the line
number too early, upon first encounter of a newline even if the newline
is pushed back into the input buffer)

this is still not ready for general consumption, but good for testing,
and a candidate for AUTOCONF_NEW default *after* the next full MirBSD
release (or, at the very least, full snapshot, which has been adopted);
although I’d rather like to get a 2.65 (but not tonight…) with our m4
working first and switch there then
@
text
@$MirOS$
$OpenBSD: patch-tests_Makefile_in,v 1.1.1.1 2008/08/19 23:52:19 espie Exp $
--- tests/Makefile.in.orig	Sat Apr  5 23:06:41 2008
+++ tests/Makefile.in	Sat Nov 21 23:28:31 2009
@@@@ -518,6 +518,9 @@@@ package.m4: Makefile
 	  echo 'm4_define([AT_PACKAGE_STRING],    [$(PACKAGE_STRING)])' && \
 	  echo 'm4_define([AT_PACKAGE_BUGREPORT], [$(PACKAGE_BUGREPORT)])'; \
 	} > $@@-t
+	:;{ echo 'g/-MirPorts-[0-9]*/s///g'; echo wq; } | ed -s $@@-t
+	echo   'm4_define([AT_PACKAGE_BRAND],     [$(PACKAGE_VERSION)])' | \
+	    sed 's/2\.[0-9]*\(-MirP\)/\1/' >>$@@-t
 	mv $@@-t $@@
 
 wrapper.in: $(srcdir)/wrapper.as $(m4sh_m4f_dependencies)
@@@@ -532,9 +535,7 @@@@ $(wrappers): wrapper.in
 	mv -f $@@.tmp $@@
 $(TESTSUITE): package.m4 \
 	      local.at \
-	      $(TESTSUITE_AT) \
-	      $(autotest_m4f_dependencies)
-	cd $(top_builddir)/lib/autotest && $(MAKE) $(AM_MAKEFLAGS) autotest.m4f
+	      $(TESTSUITE_AT)
 	$(AUTOTEST) -I . -I $(srcdir) suite.at -o $@@.tmp
 	mv $@@.tmp $@@
 
@


1.1
log
@Pull in autoconf 2.62 from OpenBSD ports, with minimal modifications,
no "MirPorts" branding. Works with /usr/bin/m4.
@
text
@d1 1
d3 13
a15 3
--- tests/Makefile.in.orig	Sun Apr  6 01:07:04 2008
+++ tests/Makefile.in	Thu Aug 14 17:34:46 2008
@@@@ -532,9 +532,7 @@@@ $(wrappers): wrapper.in
@

