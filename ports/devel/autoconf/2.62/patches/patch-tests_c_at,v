head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2009.11.22.00.16.24;	author tg;	state Exp;
branches;
next	1.1;
commitid	1004B088259208162D8;

1.1
date	2009.11.18.20.48.09;	author bsiegert;	state Exp;
branches;
next	;
commitid	1004B045D7A02892B0A;


desc
@@


1.2
log
@merge bsiegert@@’s OpenBSD 2.62 port, my MirBSD 2.61 port, add portability
to GNU m4 (back which was removed by these OpenBSD people), fix things,
and add a few workarounds for bugs in our m4 (which increments the line
number too early, upon first encounter of a newline even if the newline
is pushed back into the input buffer)

this is still not ready for general consumption, but good for testing,
and a candidate for AUTOCONF_NEW default *after* the next full MirBSD
release (or, at the very least, full snapshot, which has been adopted);
although I’d rather like to get a 2.65 (but not tonight…) with our m4
working first and switch there then
@
text
@$MirOS$
--- tests/c.at.orig	Sat Apr  5 23:04:25 2008
+++ tests/c.at	Sat Nov 21 23:28:30 2009
@@@@ -141,13 +141,13 @@@@ AT_CLEANUP
 AT_SETUP([AC_PROG_CPP without warnings])
 
 # Ignore if /lib/cpp doesn't work
-AT_CHECK([[echo '#include <stdio.h>' | /lib/cpp || exit 77]],
+AT_CHECK([[echo '#include <stdio.h>' | ${CC:-cc} -E - || exit 77]],
   [], [ignore], [ignore])
 
 # A cpp which exit status is meaningless.
 AT_DATA([mycpp],
 [[#! /bin/sh
-/lib/cpp "$@@"
+${CC:-cc} -E "$@@"
 exit 0
 ]])
 
@@@@ -179,7 +179,7 @@@@ AT_CLEANUP
 AT_SETUP([AC_PROG_CPP via CC])
 
 # Ignore if /lib/cpp doesn't work
-AT_CHECK([[echo '#include <stdio.h>' | /lib/cpp || exit 77]],
+AT_CHECK([[echo '#include <stdio.h>' | ${CC:-cc} -E - || exit 77]],
   [], [ignore], [ignore])
 
 AT_DATA([mycc],
@


1.1
log
@Pull in autoconf 2.62 from OpenBSD ports, with minimal modifications,
no "MirPorts" branding. Works with /usr/bin/m4.
@
text
@d1 4
a4 4
$OpenBSD: patch-tests_c_at,v 1.1.1.1 2008/08/19 23:52:19 espie Exp $
--- tests/c.at.orig	Sun Apr  6 01:04:48 2008
+++ tests/c.at	Sat Jul 19 11:53:22 2008
@@@@ -141,7 +141,7 @@@@ AT_CLEANUP
d9 1
a9 1
+AT_CHECK([[echo '#include <stdio.h>' | /usr/bin/cpp || exit 77]],
d13 7
d25 1
a25 1
+AT_CHECK([[echo '#include <stdio.h>' | /usr/bin/cpp || exit 77]],
@

