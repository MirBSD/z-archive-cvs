head	1.6;
access;
symbols;
locks; strict;
comment	@# @;


1.6
date	2018.11.08.02.24.58;	author tg;	state Exp;
branches;
next	1.5;
commitid	1005BE39E4361E8E050;

1.5
date	2017.01.29.00.51.35;	author tg;	state Exp;
branches;
next	1.4;
commitid	100588D3CA7154DADA9;

1.4
date	2017.01.28.14.16.29;	author tg;	state Exp;
branches;
next	1.3;
commitid	100588CA7D54013BEFF;

1.3
date	2009.11.22.00.16.22;	author tg;	state Exp;
branches;
next	1.2;
commitid	1004B088259208162D8;

1.2
date	2009.11.21.16.52.12;	author tg;	state Exp;
branches;
next	1.1;
commitid	1004B081AC70BF29A67;

1.1
date	2009.11.18.20.48.06;	author bsiegert;	state Exp;
branches;
next	;
commitid	1004B045D7A02892B0A;


desc
@@


1.6
log
@fix scoping mistake causing occasional CPPFLAGS loss

• 2.13 was not affected (code was correct before porting to 2.5x)
• 2.60, 2.61 share the same (buggy) code
• 2.62 has more fancy (but just as broken) code
• all others don’t carry the fix
@
text
@# $MirOS: ports/devel/autoconf/2.62/Makefile,v 1.4 2017/01/28 14:16:29 tg Exp $

COMMENT=		automatically configure source code on many Un*x platforms
VSN=			2.62
DISTNAME=		autoconf-${VSN}
DASH_VER=		4
CATEGORIES=		devel
HOMEPAGE=		http://www.gnu.org/software/autoconf/

# GNU GPLv2+ (v3 files not installed)
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes

.include <mirports.sys.mk>

MASTER_SITES=		${MASTER_SITE_GNU:=autoconf/}
BUILD_DEPENDS+=		:help2man-*:devel/help2man
USE_M4=			new	# XXX maybe "old" is enough?
MODULES+=		m4
B_R_DEPENDS+=		${MODM4_DEPENDS}

CONFIGURE_STYLE=	gnu
AUTOCONF_NEW=		Yes
CONFIGURE_ARGS+=	--program-suffix=-${VSN:Q}
CONFIGURE_ENV+=		AWK=${AWK:Q}
CONFIGURE_ENV+=		M4=${M4:Q}
CONFIGURE_ENV+=		EMACS=no
EXTRA_XAKE_FLAGS+=	pkgdatadir=${PREFIX:Q}/share/${DISTNAME:Q}

# many tests appear to fail, for whitespace and lineno. diffs only
REGRESS_DEPENDS+=	::devel/automake/1.9
REGRESS_FLAGS+=		AUTOMAKE_VERSION=1.9

pre-configure:
	print ',g/'${VSN:S/./\./g:Q}'/s//&-MirPorts-${DASH_VER}/g\nwq' | \
	    ed -s ${WRKSRC}/configure

post-install:
	cd ${PREFIX:Q}/info && for a in *.info*; do \
		[[ $$a = *-${VSN:Q}* ]] && continue; \
		pre=$${a%%.info*}; post=$${a#$$pre}; \
		mv "$$a" "$${pre}-${VSN:Q}$$post"; \
	done

.include <bsd.port.mk>
@


1.5
log
@fix PLIST, we don’t install more than one copy of the GNU standards… if at all
@
text
@d6 1
a6 1
DASH_VER=		3
@


1.4
log
@fix yacc expansion mistake
@
text
@d1 1
a1 1
# $MirOS: ports/devel/autoconf/2.62/Makefile,v 1.3 2009/11/22 00:16:22 tg Exp $
d6 1
a6 1
DASH_VER=		2
@


1.3
log
@merge bsiegert@@’s OpenBSD 2.62 port, my MirBSD 2.61 port, add portability
to GNU m4 (back which was removed by these OpenBSD people), fix things,
and add a few workarounds for bugs in our m4 (which increments the line
number too early, upon first encounter of a newline even if the newline
is pushed back into the input buffer)

this is still not ready for general consumption, but good for testing,
and a candidate for AUTOCONF_NEW default *after* the next full MirBSD
release (or, at the very least, full snapshot, which has been adopted);
although I’d rather like to get a 2.65 (but not tonight…) with our m4
working first and switch there then
@
text
@d1 1
a1 1
# $MirOS: ports/devel/autoconf/2.61/Makefile,v 1.4 2009/11/21 17:24:39 tg Exp $
d6 1
a6 1
DASH_VER=		1
@


1.2
log
@use m4 MODULE
@
text
@d1 1
a1 2
# $MirOS: ports/devel/autoconf/2.62/Makefile,v 1.1 2009/11/18 20:48:06 bsiegert Exp $
# $OpenBSD: Makefile,v 1.2 2009/06/12 19:22:57 matthieu Exp $
d3 18
a20 17
COMMENT =	automatically configure source code on many Un*x platforms

DISTNAME =	autoconf-2.62
CATEGORIES =	devel
MASTER_SITES =	${MASTER_SITE_GNU:=autoconf/}

HOMEPAGE =	http://www.gnu.org/software/autoconf/

# GPL
PERMIT_DISTFILES_CDROM =Yes
PERMIT_DISTFILES_FTP =	Yes
PERMIT_PACKAGE_CDROM =	Yes
PERMIT_PACKAGE_FTP =	Yes

BUILD_DEPENDS =		:help2man-*:devel/help2man
RUN_DEPENDS =		::devel/metaauto
USE_M4=			new
d24 4
a27 8
SUFFIX =		-2.62
CONFIGURE_STYLE =	gnu
CONFIGURE_ARGS +=	--program-suffix=${SUFFIX} \
			--without-lispdir \
			--mandir=${PREFIX}/man \
			--infodir=${PREFIX}/info
EXTRA_XAKE_FLAGS +=	pkgdatadir=${PREFIX}/share/autoconf${SUFFIX} EMACS=no lispdir=
CONFIGURE_ENV +=	${EXTRA_XAKE_FLAGS}
d29 17
a45 5
CONFIGURE_ENV +=	AWK="${AWK}" ac_cv_sh_n_works=yes
MODGNU_CONFIG_GUESS_DIRS =${WRKSRC}/build-aux
SUBST_VARS =		SUFFIX
REGRESS_DEPENDS =	::devel/automake/1.9
REGRESS_FLAGS +=	AUTOMAKE_VERSION=1.9
@


1.1
log
@Pull in autoconf 2.62 from OpenBSD ports, with minimal modifications,
no "MirPorts" branding. Works with /usr/bin/m4.
@
text
@d1 1
a1 1
# $MirOS$
d20 3
d32 1
a32 1
CONFIGURE_ENV +=	M4="/usr/bin/m4"
@

