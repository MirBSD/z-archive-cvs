head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2012.02.11.19.30.03;	author tg;	state dead;
branches;
next	1.1;
commitid	1004F36C11F02848ED5;

1.1
date	2010.09.18.23.14.08;	author tg;	state Exp;
branches;
next	;
commitid	1004C9547CD4D455210;


desc
@@


1.2
log
@update the CVS package in MirPorts (to match base and Debian)

• since the Debian cvs source package was taken over by this one,
  reverse things and use the Debian *.diff.gz to get our patches
  from ;-) saves tracking things in CVS thrice
• since the Debian cvs binary package contains PDF documentation
  generated from something with our patches, ship it instead of
  the one from the vanilla CVS distfile
• ship cvs-switchroot(1) from Debian, which is just a fancy name
  for mircvs://src/scripts/mnt-cvsroot and has a manpage
• move stuff from PREFIX/share/cvs to PREFIX/share/doc/cvs as is proper
• fix regression testsuite on MirBSD as much as possible (same as base)
@
text
@$MirOS: ports/devel/cvs/patches/patch-src_zlib_c,v 1.1 2010/09/18 23:14:08 tg Exp $
--- src/zlib.c.orig	Fri Jun  3 18:25:47 2005
+++ src/zlib.c	Sat Sep 18 22:39:44 2010
@@@@ -20,6 +20,8 @@@@
 #include "buffer.h"
 #include "pagealign_alloc.h"
 
+__RCSID("$MirOS: ports/devel/cvs/patches/patch-src_zlib_c,v 1.1 2010/09/18 23:14:08 tg Exp $");
+
 #if defined (SERVER_SUPPORT) || defined (CLIENT_SUPPORT)
 
 #if HAVE_ZLIB_H
@@@@ -229,7 +231,7 @@@@ compress_buffer_input (void *closure, ch
 	   would fetch all the available bytes, and at least one byte.  */
 
 	status = (*cb->buf->input) (cb->buf->closure, bd->text,
-				    need, BUFFER_DATA_SIZE, &nread);
+				    need ? 1 : 0, BUFFER_DATA_SIZE, &nread);
 
 	if (status == -2)
 	    /* Don't try to recover from memory allcoation errors.  */
@


1.1
log
@• apply 90zlib-read-compressed.diff from Debian, with the following
  explanation from DragonFly BSD via MidnightBSD (thanks laffer1):
  zlib.c: byte by byte to fix infinity waiting on some zlib operations while using compression.
• add MidnightBSD’s global “-g” option: force group-writable permissions
• merge patch for backwards annotation from DragonFly BSD via MidnightBSD
@
text
@d1 1
a1 1
$MirOS$
d8 1
a8 1
+__RCSID("$MirOS$");
@

