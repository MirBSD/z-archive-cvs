head	1.3;
access;
symbols;
locks; strict;
comment	@# @;


1.3
date	2012.02.11.19.29.57;	author tg;	state dead;
branches;
next	1.2;
commitid	1004F36C11F02848ED5;

1.2
date	2010.09.15.23.41.21;	author tg;	state Exp;
branches;
next	1.1;
commitid	1004C9159AB6B64B332;

1.1
date	2010.09.15.20.57.00;	author tg;	state Exp;
branches;
next	;
commitid	1004C9132F41004B31C;


desc
@@


1.3
log
@update the CVS package in MirPorts (to match base and Debian)

• since the Debian cvs source package was taken over by this one,
  reverse things and use the Debian *.diff.gz to get our patches
  from ;-) saves tracking things in CVS thrice
• since the Debian cvs binary package contains PDF documentation
  generated from something with our patches, ship it instead of
  the one from the vanilla CVS distfile
• ship cvs-switchroot(1) from Debian, which is just a fancy name
  for mircvs://src/scripts/mnt-cvsroot and has a manpage
• move stuff from PREFIX/share/cvs to PREFIX/share/doc/cvs as is proper
• fix regression testsuite on MirBSD as much as possible (same as base)
@
text
@$MirOS: ports/devel/cvs/patches/patch-src_cvsrc_c,v 1.2 2010/09/15 23:41:21 tg Exp $
--- src/cvsrc.c.orig	Wed Mar 16 15:51:52 2005
+++ src/cvsrc.c	Wed Sep 15 23:39:58 2010
@@@@ -17,6 +17,8 @@@@
 #include "cvs.h"
 #include "getline.h"
 
+__RCSID("$MirOS: ports/devel/cvs/patches/patch-src_cvsrc_c,v 1.2 2010/09/15 23:41:21 tg Exp $");
+
 /* this file is to be found in the user's home directory */
 
 #ifndef	CVSRC_FILENAME
@@@@ -41,6 +43,7 @@@@ read_cvsrc (int *argc, char ***argv, con
     size_t line_chars_allocated;
 
     char *optstart;
+    int white_len = 0;
 
     int command_len;
     int found = 0;
@@@@ -96,9 +99,12 @@@@ read_cvsrc (int *argc, char ***argv, con
 	if (line[0] == '#')
 	    continue;
 
+	while (isspace(line[white_len]))
+		++white_len;
+
 	/* stop if we match the current command */
-	if (!strncmp (line, cmdname, command_len)
-	    && isspace ((unsigned char) *(line + command_len)))
+	if (!strncmp (line + white_len, cmdname, command_len)
+	    && isspace ((unsigned char) *(line + white_len + command_len)))
 	{
 	    found = 1;
 	    break;
@@@@ -120,7 +126,7 @@@@ read_cvsrc (int *argc, char ***argv, con
     if (found)
     {
 	/* skip over command in the options line */
-	for (optstart = strtok (line + command_len, "\t \n");
+	for (optstart = strtok (line + white_len + command_len, "\t \n");
 	     optstart;
 	     optstart = strtok (NULL, "\t \n"))
 	{
@


1.2
log
@oh well… warning freeness (-Wall -Werror on MirBSD, some on MirDebian)
@
text
@d1 1
a1 1
$MirOS: ports/devel/cvs/patches/patch-src_cvsrc_c,v 1.1 2010/09/15 20:57:00 tg Exp $
d8 1
a8 1
+__RCSID("$MirOS: ports/devel/cvs/patches/patch-src_cvsrc_c,v 1.1 2010/09/15 20:57:00 tg Exp $");
@


1.1
log
@WIP port (will be worked on more, commit for safety)

Some changes, in this order:
• re-sync with MirOS base cvs
• reduce diff against upstream
• apply cvs-datetime.patch from Arkadiusz Miskiewicz <arekm>
  via Concurrent Versions System - Bugs: bug #21523, can't parse date/time: =UTC when commiting file (workaround/fix attached)
• apply (only those considered somewhat sane) patches from Debian cvs_1:1.12.13-12
  – 11_check_method_crash
  – 12_rcs2log_POSIX_sort
  – 14_ext_expansion
  – 15_PATH_MAX_check
  – 20_readdir_errno
  – 21_getcwd_chroot
  – 25_import-n-X
  – 51_newlines_in_commit_template (partially)
  – 55_keyword_alphanumerics (modified)
  – 62_cvsrc_whitespace
  – 65_login_cvspass_message
  – 69_ext_allowroot (modified)
  – 71_cvsbug_tmpfix
  – 81_fix_-l (modified)
  – 85_normalize_correct_roots
  – 86_server_wrapper (modified)
  – 93_homedir (modified)
  – 95_flag_conflicted_copies
  – 96_manpage_fixes (partially)
  – 97_cvs.info.typo (partially)
  – 98_fix_sparc_sigbus.diff
• document Debian’s changes in the Texinfo manual
• modify mkman.pl to produce more correct looking output
• point to texinfo HTML document from HTML manpage
• fix fseeko configure.in test
• correct bugs in Debian’s changes
@
text
@d1 1
a1 1
$MirOS$
d3 1
a3 1
+++ src/cvsrc.c	Wed Sep 15 19:36:15 2010
d8 1
a8 1
+__RCSID("$MirOS$");
d17 1
a17 1
+    int white_len;
d25 2
a26 2
+    for (white_len=0; isspace(line[white_len]); white_len++)
+        ;
@

