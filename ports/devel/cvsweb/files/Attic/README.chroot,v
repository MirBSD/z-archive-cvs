head	1.3;
access;
symbols;
locks; strict;
comment	@# @;


1.3
date	2007.04.29.23.38.02;	author tg;	state dead;
branches;
next	1.2;
commitid	10046352C0744D07509;

1.2
date	2005.09.11.02.33.52;	author tg;	state Exp;
branches;
next	1.1;
commitid	773e432397611c14;

1.1
date	2005.03.18.15.44.31;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.03.18.15.44.31;	author tg;	state Exp;
branches;
next	;


desc
@@


1.3
log
@why do we have a friggin' w̲e̲b̲ ̲f̲r̲a̲m̲e̲w̲o̲r̲k̲ in the ports tree?!
all the user has to do is to install the dependencies¹, get
the distfile, extract, copy to /var/www (or a document root
de gusto) and he's all set.

more of this to follow removal…

¹) p5-URI and p5-IPC-Run
@
text
@# $OpenBSD: README.chroot,v 1.1 2003/12/30 03:38:09 jolan Exp $
# Author: Jolan Luff <jolan@@openbsd.org>

In order to make CVSweb operate in a chroot environment, it is
necessary to copy all of the relevant tools, libraries, and perl modules
that CVSweb employs into ${WWW_PREFIX}.

First, create the basic directory structure:

$ cd ${WWW_PREFIX}
# mkdir {tmp,usr}
# chown www:www tmp	(needs to be writeable for the www user)

$ cd ${WWW_PREFIX}/usr
# mkdir -p {bin,lib,libdata/perl5,libexec}

$ cd ${WWW_PREFIX}/usr/libdata/perl5
# mkdir -p {File,IPC,Time,warnings,`machine`-openbsd/5.8.2}

Now, the required binaries:

$ cd ${WWW_PREFIX}/usr/bin
# cp -p /usr/bin/{co,cvs,diff,perl,rcsdiff,rlog,uname} .

Next, the libraries that the binaries are linked to:

NOTE: Wildcards will, of course, copy any old, unused libraries that are
lurking around (for example, from an upgrade):

$ cd ${WWW_PREFIX}/usr/lib
# cp -p /usr/lib/lib{c,crypto,des,gssapi,krb5,m,perl,util,z}.so* .

Now, the run-time link-editor:

$ cd ${WWW_PREFIX}/usr/libexec
# cp -p /usr/libexec/ld.so .

And finally, the perl modules:

$ cd ${WWW_PREFIX}/usr/libdata/perl5
# cp -p /usr/libdata/perl5/{Carp,Exporter,Symbol,base,integer}.pm .
# cp -p /usr/libdata/perl5/{strict,warnings,vars}.pm .
# cp -p /usr/libdata/perl5/File/Basename.pm ./File/
# cp -p /usr/libdata/perl5/IPC/Open{2,3}.pm ./IPC/
# cp -p /usr/libdata/perl5/Time/Local.pm ./Time/
# cp -p /usr/libdata/perl5/warnings/register.pm ./warnings/

$ cd ${WWW_PREFIX}/usr/libdata/perl5/`machine`-openbsd/5.8.2
# cp -p /usr/libdata/perl5/`machine`-openbsd/5.8.2/{Config,Cwd}.pm .

Editing cvsweb and cvsweb.conf
------------------------------

The cvsweb program itself and cvsweb.conf both assume Apache is not
running in a chroot environment, so we need to change some default paths
so they are relative to ${WWW_PREFIX}.

In ${WWW_PREFIX}/cgi-bin/cvsweb:

for ("$mydir/cvsweb.conf", '${WWW_PREFIX}/conf/cvsweb/cvsweb.conf') {
for ("$mydir/cvsweb.conf", '/conf/cvsweb/cvsweb.conf') {

In ${WWW_PREFIX}/conf/cvsweb/cvsweb.conf:

Change CVSrepositories to reflect the location of the directories which
contain CVSROOT.  This example shows a local repository NFS mounted over
loopback into ${WWW_PREFIX}/cvs, since the directory must be relative to
${WWW_PREFIX}, we use /cvs.

@@CVSrepositories = (
	'local'   => ['Local Repository', '/home/cvs'],	      (default)
	'local'   => ['Local Repository', '/cvs'],	      (chroot)

And the same idea for $mimetypes:

$mime_types = '${WWW_PREFIX}/conf/mime.types';		       (default)
$mime_types = '/conf/mime.types';			       (chroot)
@


1.2
log
@convert /var/www to ${WWW_PREFIX} more or less mechanically
this breaks some ports, but most of the breakage can be solved
by converting to @@sample and the rest should be some basic
adding of substitution (SUBST_VARS and/or ed/sed)...
@
text
@@


1.1
log
@Initial revision
@
text
@d6 1
a6 1
that CVSweb employs into /var/www.
d10 1
a10 1
$ cd /var/www
d14 1
a14 1
$ cd /var/www/usr
d17 1
a17 1
$ cd /var/www/usr/libdata/perl5
d22 1
a22 1
$ cd /var/www/usr/bin
d30 1
a30 1
$ cd /var/www/usr/lib
d35 1
a35 1
$ cd /var/www/usr/libexec
d40 1
a40 1
$ cd /var/www/usr/libdata/perl5
d48 1
a48 1
$ cd /var/www/usr/libdata/perl5/`machine`-openbsd/5.8.2
d56 1
a56 1
so they are relative to /var/www.
d58 1
a58 1
In /var/www/cgi-bin/cvsweb:
d60 1
a60 1
for ("$mydir/cvsweb.conf", '/var/www/conf/cvsweb/cvsweb.conf') {
d63 1
a63 1
In /var/www/conf/cvsweb/cvsweb.conf:
d67 2
a68 2
loopback into /var/www/cvs, since the directory must be relative to
/var/www, we use /cvs.
d76 1
a76 1
$mime_types = '/var/www/conf/mime.types';		       (default)
@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
