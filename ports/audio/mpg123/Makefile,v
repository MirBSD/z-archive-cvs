head	1.13;
access;
symbols;
locks; strict;
comment	@# @;


1.13
date	2018.10.07.00.58.47;	author tg;	state Exp;
branches;
next	1.12;
commitid	1005BB95A4A58169AD1;

1.12
date	2017.02.25.18.23.21;	author tg;	state Exp;
branches;
next	1.11;
commitid	10058B1CBAC126BD574;

1.11
date	2016.05.04.23.14.25;	author tg;	state Exp;
branches;
next	1.10;
commitid	100572A826B610BF057;

1.10
date	2010.09.21.21.23.51;	author tg;	state Exp;
branches;
next	1.9;
commitid	1004C992261692DCA0F;

1.9
date	2008.06.02.22.16.21;	author tg;	state Exp;
branches;
next	1.8;
commitid	1004844710934F5C91A;

1.8
date	2008.05.17.23.29.30;	author tg;	state Exp;
branches;
next	1.7;
commitid	100482F6A6C6AACC09D;

1.7
date	2008.05.16.22.14.18;	author tg;	state Exp;
branches;
next	1.6;
commitid	100482E074539FBFB0B;

1.6
date	2008.03.09.17.22.25;	author tg;	state Exp;
branches;
next	1.5;
commitid	10047D41CAA7E715397;

1.5
date	2006.09.14.00.07.11;	author tg;	state Exp;
branches;
next	1.4;
commitid	10045089C0E234154C3;

1.4
date	2006.09.04.18.57.25;	author tg;	state Exp;
branches;
next	1.3;
commitid	10044FC770129E2B9DC;

1.3
date	2006.02.09.11.11.06;	author tg;	state Exp;
branches;
next	1.2;
commitid	10043EB23217A35557B;

1.2
date	2005.07.07.21.17.22;	author bsiegert;	state Exp;
branches;
next	1.1;
commitid	66bc42cd9a7ea714;

1.1
date	2005.03.18.15.43.03;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.03.18.15.43.03;	author tg;	state Exp;
branches;
next	;


desc
@@


1.13
log
@some streams transmit UTF-8 in their ICY information,
so convert only from OPTU iswoctet as cp1252
@
text
@# $MirOS: ports/audio/mpg123/Makefile,v 1.12 2017/02/25 18:23:21 tg Exp $
# $OpenBSD: Makefile,v 1.30 2003/11/13 20:51:50 margarida Exp $

# might not be too hard to add more
ONLY_FOR_PLATFORM=	MirBSD:*:* OpenBSD:*:*

COMMENT=		MPEG audio 1/2 Layer 1, 2 and 3 player
DISTNAME=		mpg123-0.59r
DASH_VER=		10
CATEGORIES=		audio
HOMEPAGE=		http://www.mpg123.de/

# GNU LGPLv2.1 (except libao and oldalsa audio modules, which are GPL)
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes

MASTER_SITES=	http://www.mpg123.de/mpg123/ \
		http://www-ti.informatik.uni-tuebingen.de/~hippm/mpg123/ \
		ftp://ftp.tu-clausthal.de/pub/unix/audio/mpg123/ \
		http://ftp.tu-clausthal.de/pub/unix/audio/mpg123
MASTER_SITES0=	ftp://ftp.kame.net/pub/kame/misc/
MASTER_SITES1=	http://www.unix-ag.org/Linux-Alpha/Packages/

PATCHFILES=		mpg123-059r-v6-20000713b.diff.gz:0 \
			l3.diff.gz:1
PATCH_DIST_STRIP=	-p1

FLAVOURS=		esd
FLAVOUR?=

.if ${FLAVOUR:L:Mesd}
LIB_DEPENDS=		esd.2::audio/esound
EXTRA_XAKE_FLAGS+=	AUDIO=esd
.endif

MPG123_VSN=		${PKGNAME:S/-${DASH_VER}$/-MirPorts-${DASH_VER}/}
CPPFLAGS+=		-DMPG123_VSN=\"${MPG123_VSN:Q}\"
MAKE_FILE=		${FILESDIR}/BSDmakefile
NO_REGRESS=		Yes

post-extract:
	cp ${FILESDIR}/{audio_openbsd,icy,uniprint}.c ${WRKSRC}/

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/mpg123
	${INSTALL_DATA} ${WRKSRC}/{COPYING,README{,.remote}} \
	    ${PREFIX}/share/mpg123/

.include <bsd.port.mk>
@


1.12
log
@Marc Espie broke TERM_CONTROL, so drop it
@
text
@d1 1
a1 1
# $MirOS: ports/audio/mpg123/Makefile,v 1.11 2016/05/04 23:14:25 tg Exp $
d9 1
a9 1
DASH_VER=		9
@


1.11
log
@add some debugging around the ‚ÄúYuck! Error in buffer handling...: Invalid argument‚Äù message I get
@
text
@d1 1
a1 1
# $MirOS: ports/audio/mpg123/Makefile,v 1.10 2010/09/21 21:23:51 tg Exp $
d9 1
a9 1
DASH_VER=		8
d44 1
a44 1
	cp ${FILESDIR}/{audio_openbsd,icy,term,uniprint}.c ${WRKSRC}/
@


1.10
log
@use arc4random() a bit more efficiently
@
text
@d1 1
a1 1
# $MirOS: ports/audio/mpg123/Makefile,v 1.9 2008/06/02 22:16:21 tg Exp $
d9 1
a9 1
DASH_VER=		7
@


1.9
log
@we are now allowed to redistribute: mpg123 is LGPL, as confirmed by the
current maintainer in person at LinuxTag (where I didn‚Äôt even get the time
to unpack my laptop, lest alone hack‚Ä¶), who corresponded with the original
author (incidentally, we‚Äôre all from the same country‚Ä¶)

Thanks, Thomas!
@
text
@d1 1
a1 1
# $MirOS: ports/audio/mpg123/Makefile,v 1.8 2008/05/17 23:29:30 tg Exp $
d9 1
a9 1
DASH_VER=		6
@


1.8
log
@‚Ä¢ convert to MirMake (now it should be *much* easier to add other OSes)
‚Ä¢ use wide character string output for ICY meta information from cp1252
@
text
@d1 1
a1 1
# $MirOS: ports/audio/mpg123/Makefile,v 1.7 2008/05/16 22:14:18 tg Exp $
d13 1
a13 1
# See the COPYING file installed with the package.
@


1.7
log
@add support for shoutcast metadata \o/
@
text
@d1 1
a1 1
# $MirOS: ports/audio/mpg123/Makefile,v 1.6 2008/03/09 17:22:25 tg Exp $
d9 1
a9 1
DASH_VER=		5
a32 14
OBJECTS=		icy.o term.o
CPPFLAGS+=		-DOPENBSD -DREAL_IS_FLOAT -DTERM_CONTROL -DINET6 \
			-DUSE_MMAP
ALL_TARGET=		mpg123-make
EXTRA_XAKE_FLAGS+=	OBJECTS=${OBJECTS:Q}
NO_REGRESS=		Yes

.if ${MACHINE_ARCH} == "i386"
CPPFLAGS+=		-DROT_I386 -DI386_ASSEM -DPENTIUM_OPT
OBJECTS+=		decode_i386.o decode_i586.o dct64_i386.o
.else
OBJECTS+=		decode.o dct64.o
.endif

d35 1
a35 3
OBJECTS+=		audio_esd.o
.else
OBJECTS+=		audio_openbsd.o
d38 7
a44 2
post-patch:
	cp ${FILESDIR}/{audio_openbsd,icy,term}.c ${WRKSRC}/
d46 1
a46 3
do-install:
	${INSTALL_PROGRAM} ${WRKBUILD}/mpg123 ${PREFIX}/bin/
	${INSTALL_MAN} ${WRKBUILD}/mpg123.1 ${PREFIX}/man/man1/
d48 2
a49 1
	${INSTALL_DATA} ${WRKSRC}/COPYING ${PREFIX}/share/mpg123/
@


1.6
log
@bulk convert FLAVOR to FLAVOUR; nuke unused file; convert to $Mdocdate
@
text
@d1 1
a1 1
# $MirOS: ports/audio/mpg123/Makefile,v 1.5 2006/09/14 00:07:11 tg Exp $
d4 1
d7 1
a7 1
COMMENT=			MPEG audio 1/2 Layer 1, 2 and 3 player
d9 1
a9 1
PKGNAME=		${DISTNAME}-4
d33 1
a33 1
OBJECTS=		term.o
d38 1
d55 1
a55 1
	@@cp ${FILESDIR}/audio_openbsd.c ${FILESDIR}/term.c ${WRKSRC}/
a62 2
NO_REGRESS=	Yes

@


1.5
log
@clean up COMMENT and HOMEPAGE; regenerate INDEX (2761, 169 marked as broken, probably many many more) ≠ edited by script with manual postprocessing
@
text
@d1 1
a1 1
# $MirOS: ports/audio/mpg123/Makefile,v 1.4 2006/09/04 18:57:25 tg Exp $
d29 2
a30 2
FLAVORS=		esd
FLAVOR?=
d45 1
a45 1
.if ${FLAVOR:L:Mesd}
@


1.4
log
@* style
* mark as open/mirbsd only
* much simplify build while adding the benefit of honouring copts better
* use arc4random(3)
* bump patchlevel
@
text
@d1 1
a1 1
# $MirOS: ports/audio/mpg123/Makefile,v 1.3 2006/02/09 11:11:06 tg Exp $
d6 1
a6 1
COMMENT=		MPEG audio 1/2 Layer 1, 2 and 3 player
@


1.3
log
@Fix a few abuses:
| CONFIGURE_ENV=	CPPFLAGS="-I${LOCALBASE}/include/libpng \
|			    -I${LOCALBASE}/include -I${X11BASE}/include" \
| 			LDFLAGS="-L${LOCALBASE}/lib -L${X11BASE}/lib" \
|			PKGCONFIG_PATH=...

* use Benny's pkgconfig module
  - fixes PKGCONFIG_PATH in all places
  - adds explicit dependencies on pkgconfig where needed
* use a new png module
  - also cought a few implicit dependencies
* use a new freetype1 module in two places (more to come?)
* CPPFLAGS, LDFLAGS are in CONFIGURE_ENV anyway, so correctly
  add to them as CPPFLAGS+=<tab>foo instead
* use EXTRA_{M,X,F}AKE_FLAGS
* CC is given anyway, too
* add MAKEINFO= to gnu style

Still doesn't catch all OpenBSD abuses, but most of them.

Brokenness analysis:
* Automatically done
  - CFLAGS+=CPPFLAGS
  - CXXFLAGS+=CPPFLAGS
  - CPPFLAGS+=-I${LOCALBASE}/include
  - LDFLAGS+=-L${LOCALBASE}/lib
  - CONFIGURE_ENV, MAKE_FLAGS+=
    + LDFLAGS=LDFLAGS
    + CPPFLAGS you get the idea
    + CFLAGS
    + CXXFLAGS
    + CC
    + CXX (if USE_CXX)
* Done if USE_X11=Yes
  - CPPFLAGS+=X11BASE/include
  - LDFLAGS+=X11BASE/lib

Tell me if there are problems, but first try adding
an EXTRA_ before MAKE_FLAGS and FAKE_FLAGS.
Remember EXTRA_XAKE_FLAGS get added to both.
@
text
@d1 1
a1 1
# $MirOS: ports/audio/mpg123/Makefile,v 1.2 2005/07/07 21:17:22 bsiegert Exp $
d4 1
a4 5
COMMENT=	"MPEG audio 1/2 Layer 1, 2 and 3 player"
DISTNAME=	mpg123-0.59r
PKGNAME=	${DISTNAME}-3
CATEGORIES=	audio
HOMEPAGE=	http://www.mpg123.de/
d6 10
a15 2
# Long, unclear license in ${WRKSRC}/COPYING.
PERMIT_PACKAGE_CDROM=	No
a16 2
PERMIT_DISTFILES_CDROM=	No
PERMIT_DISTFILES_FTP=	Yes
d25 3
a27 3
PATCHFILES=	mpg123-059r-v6-20000713b.diff.gz:0 \
		l3.diff.gz:1
PATCH_DIST_STRIP= -p1
d29 1
a29 1
FLAVORS=	esd
d32 13
d46 2
a47 2
LIB_DEPENDS=	esd.2::audio/esound
ALL_TARGET=	mirbsd-esd
d49 1
a49 1
ALL_TARGET=	mirbsd
d53 1
a53 1
	@@cp ${FILESDIR}/audio_openbsd.c ${FILESDIR}/term.c ${WRKSRC}
d56 2
a57 2
	${INSTALL_PROGRAM} ${WRKBUILD}/mpg123 ${PREFIX}/bin
	${INSTALL_MAN} ${WRKBUILD}/mpg123.1 ${PREFIX}/man/man1
d59 1
a59 1
	${INSTALL_DATA} ${WRKSRC}/COPYING ${PREFIX}/share/mpg123
@


1.2
log
@Semi-automatic update of the remaining ports to the new patchlevel format.

Please correct mistakes if you find them :).
@
text
@d1 1
a1 1
# $MirOS$
a36 2
MAKE_FLAGS+=	CC="${CC}" COPTS="${COPTS}" CPPFLAGS="${CPPFLAGS}"

@


1.1
log
@Initial revision
@
text
@d6 1
a6 1
PKGNAME=	${DISTNAME}p3
@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
