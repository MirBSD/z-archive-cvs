head	1.5;
access;
symbols;
locks; strict;
comment	@# @;


1.5
date	2007.04.29.19.56.03;	author tg;	state Exp;
branches;
next	1.4;
commitid	1004634F85E5794B1FE;

1.4
date	2007.02.23.13.43.20;	author tg;	state Exp;
branches;
next	1.3;
commitid	10045DEEF7E1F725FA5;

1.3
date	2007.02.23.11.04.31;	author bsiegert;	state Exp;
branches;
next	1.2;
commitid	10045DEC9F90E81073A;

1.2
date	2006.06.23.15.13.51;	author bsiegert;	state Exp;
branches;
next	1.1;
commitid	100449C04891AE35D5E;

1.1
date	2005.03.18.15.42.45;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.03.18.15.42.45;	author tg;	state Exp;
branches;
next	;


desc
@@


1.5
log
@also let this use libz, install relevant docs, etc.
@
text
@$MirOS: ports/archivers/zip/patches/patch-unix_Makefile,v 1.4 2007/02/23 13:43:20 tg Exp $
--- unix/Makefile.orig	Sat Apr 22 23:51:55 2006
+++ unix/Makefile	Sun Apr 29 19:50:59 2007
@@@@ -17,10 +17,9 @@@@ SHELL = /bin/sh
 LN = ln -s
 
 # (to use the Gnu compiler, change cc to gcc in CC)
-CC = cc
 BIND = $(CC)
 AS = $(CC) -c
-CPP = /lib/cpp
+CPP = $(CC) -E
 EXE =
 
 # probably can change this to 'install' if you have it
@@@@ -47,7 +46,7 @@@@ VERSION = Version 2.32
 #   LFLAGS1   flags after output file spec, before obj file list
 #   LFLAGS2   flags after obj file list (libraries, etc)
 CFLAGS_NOOPT = -I. -DUNIX $(LOCAL_ZIP)
-CFLAGS = -O2 $(CFLAGS_NOOPT)
+CFLAGS += $(CFLAGS_NOOPT)
 LFLAGS1 =
 LFLAGS2 = -s
 
@@@@ -128,18 +127,16 @@@@ $(ZIPMANUAL): man/zip.1
 # install
 install:        $(ZIPS)
 	-$(INSTALL_D) $(BINDIR)
-	$(INSTALL_PROGRAM) $(ZIPS) $(BINDIR)
-	-cd $(BINDIR); $(CHMOD) $(BINFLAGS) $(ZIPS)
+	$(BSD_INSTALL_PROGRAM) $(ZIPS) $(BINDIR)
 	-$(INSTALL_D) $(MANDIR)
-	$(INSTALL) man/zip.1 $(MANDIR)/zip.$(manext)
-	$(CHMOD) $(MANFLAGS) $(MANDIR)/zip.$(manext)
+	$(BSD_INSTALL_MAN) man/zip.1 $(MANDIR)/zip.$(manext)
 
 uninstall:
 	-cd $(BINDIR); rm -f $(ZIPS)
 	-cd $(MANDIR); rm -f zip.$(manext)
 
 flags:  unix/configure
-	sh unix/configure "${CC}" "${CFLAGS_NOOPT}"
+	sh unix/configure ${CC:Q} ${CFLAGS:M*:Q}
 
 # These symbols, when #defined using -D have these effects on compilation:
 # ZMEM                  - includes C language versions of memset(), memcpy(),
@@@@ -161,6 +158,9 @@@@ generic: flags
 
 generic_gcc:
 	$(MAKE) generic CC=gcc CPP="gcc -E"
+
+generic_zlib:
+	${MAKE} generic CFLAGS='${CFLAGS} -DUSE_ZLIB' LFLAGS2='${LFLAGS2} -lz'
 
 # AT&T 6300 PLUS (don't know yet how to allocate 64K bytes):
 att6300nodir:
@


1.4
log
@polish, re-indent, “fix” the configure script to honour CFLAGS
@
text
@d1 1
a1 1
$MirOS: ports/archivers/zip/patches/patch-unix_Makefile,v 1.3 2007/02/23 11:04:31 bsiegert Exp $
d3 1
a3 1
+++ unix/Makefile	Fri Feb 23 13:31:19 2007
d47 10
@


1.3
log
@ftp.info-zip.org and mirror sites have vanished, distfiles only on sourceforge
now. Also update zip to 2.32, zcrypt code is now included. tg@@: could you
take a look over the zip port if there are problems? It does do some fancy
CFLAGS munging but I don't get any errors so I think it should be OK.
@
text
@d1 3
a3 3
$MirOS: ports/archivers/zip/patches/patch-unix_Makefile,v 1.2 2006/06/23 15:13:51 bsiegert Exp $
--- unix/Makefile.orig	Sun Apr 23 01:51:55 2006
+++ unix/Makefile	Fri Feb 23 12:00:56 2007
d43 1
a43 1
+	sh unix/configure "${CC}" "${CFLAGS}"
@


1.2
log
@SECURITY: Update zip to 2.31-0. Thsi should have happened WAY sooner, my bad.

Fixes: CVE-2004-1010
@
text
@d1 3
a3 3
$MirOS$
--- unix/Makefile.orig	2005-02-28 08:33:50.000000000 +0100
+++ unix/Makefile	2006-06-23 17:01:26.000000000 +0200
d16 1
a16 2
@@@@ -45,7 +44,7 @@@@ VERSION = Version 2.31
 #   CFLAGS    flags for C compile
d19 3
a21 2
-CFLAGS = -O2 -I. -DUNIX $(LOCAL_ZIP)
+CFLAGS +=  -I. -DUNIX $(LOCAL_ZIP)
d25 1
a25 1
@@@@ -126,11 +125,9 @@@@ $(ZIPMANUAL): man/zip.1
d39 8
@


1.1
log
@Initial revision
@
text
@d1 25
a25 3
--- unix/Makefile.orig	Mon Nov 29 00:22:42 1999
+++ unix/Makefile	Sun Jul 23 22:24:56 2000
@@@@ -125,11 +125,9 @@@@
d29 1
a29 1
-	$(INSTALL) $(ZIPS) $(BINDIR)
@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
