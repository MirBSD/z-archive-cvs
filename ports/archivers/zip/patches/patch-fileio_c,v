head	1.3;
access;
symbols;
locks; strict;
comment	@# @;


1.3
date	2007.02.23.11.04.31;	author bsiegert;	state Exp;
branches;
next	1.2;
commitid	10045DEC9F90E81073A;

1.2
date	2006.06.23.15.13.51;	author bsiegert;	state Exp;
branches;
next	1.1;
commitid	100449C04891AE35D5E;

1.1
date	2005.03.18.15.42.45;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.03.18.15.42.45;	author tg;	state Exp;
branches;
next	;


desc
@@


1.3
log
@ftp.info-zip.org and mirror sites have vanished, distfiles only on sourceforge
now. Also update zip to 2.32, zcrypt code is now included. tg@@: could you
take a look over the zip port if there are problems? It does do some fancy
CFLAGS munging but I don't get any errors so I think it should be OK.
@
text
@$MirOS: ports/archivers/zip/patches/patch-fileio_c,v 1.2 2006/06/23 15:13:51 bsiegert Exp $
$OpenBSD: patch-fileio_c,v 1.1 2004/02/06 08:29:24 kevlo Exp $
--- fileio.c.orig	Thu Jun 16 05:31:30 2005
+++ fileio.c	Fri Feb 23 11:51:23 2007
@@@@ -919,7 +919,15 @@@@ char *zip;              /* path name of 
   }
 #else
   strcat(t, "ziXXXXXX"); /* must use lowercase for Linux dos file system */
-  return mktemp(t);
+  {
+    int fd = mkstemp(t);
+    if ( fd == -1 ) {
+      perror( "can't create temp file" );
+      exit(1);
+    }
+    close(fd);
+    return t;
+  }
 #endif /* NO_MKTEMP */
 #endif /* TANDEM */
 #endif /* CMS_MVS */
@


1.2
log
@SECURITY: Update zip to 2.31-0. Thsi should have happened WAY sooner, my bad.

Fixes: CVE-2004-1010
@
text
@d1 1
a1 1
$MirOS$
d3 3
a5 3
--- fileio.c.orig	2005-01-29 05:28:34.000000000 +0100
+++ fileio.c	2006-06-23 16:40:07.000000000 +0200
@@@@ -860,7 +860,15 @@@@ char *zip;              /* path name of 
@


1.1
log
@Initial revision
@
text
@d1 1
d3 3
a5 3
--- fileio.c.orig	2004-02-06 16:11:15.000000000 +0000
+++ fileio.c	2004-02-06 16:21:58.000000000 +0000
@@@@ -859,7 +859,15 @@@@ char *zip;              /* path name of 
@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
