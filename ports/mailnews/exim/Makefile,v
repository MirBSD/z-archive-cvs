head	1.12;
access;
symbols;
locks; strict;
comment	@# @;


1.12
date	2009.08.16.16.27.21;	author tg;	state Exp;
branches;
next	1.11;
commitid	1004A882F1F72B43308;

1.11
date	2008.10.04.19.03.16;	author tg;	state Exp;
branches;
next	1.10;
commitid	10048E7BD9A0842B398;

1.10
date	2008.06.08.17.05.38;	author bsiegert;	state Exp;
branches;
next	1.9;
commitid	100484C116505557E8E;

1.9
date	2008.03.09.17.23.04;	author tg;	state Exp;
branches;
next	1.8;
commitid	10047D41CAA7E715397;

1.8
date	2007.04.12.20.22.18;	author bsiegert;	state Exp;
branches;
next	1.7;
commitid	100461E950F57F35708;

1.7
date	2006.09.14.00.10.33;	author tg;	state Exp;
branches;
next	1.6;
commitid	10045089C0E234154C3;

1.6
date	2006.06.08.12.10.37;	author bsiegert;	state Exp;
branches;
next	1.5;
commitid	100448813C155765E47;

1.5
date	2006.04.26.15.55.09;	author bsiegert;	state Exp;
branches;
next	1.4;
commitid	100444F97121F5A06E9;

1.4
date	2006.02.01.16.28.02;	author tg;	state Exp;
branches;
next	1.3;
commitid	10043E0E1771404AF56;

1.3
date	2005.07.07.21.22.44;	author bsiegert;	state Exp;
branches;
next	1.2;
commitid	66bc42cd9a7ea714;

1.2
date	2005.03.28.14.50.24;	author bsiegert;	state Exp;
branches;
next	1.1;

1.1
date	2005.03.18.15.49.34;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.03.18.15.49.34;	author tg;	state Exp;
branches;
next	;


desc
@@


1.12
log
@change
‚Ä¢ _PASS_CC back from „Äåmpcc„Äç to „Äå${WRKDIR}/bin/mpcc„Äç (note that the
  former „Äå${WRKDIR:Q}/bin/mpcc„Äç was wrong)
‚Ä¢ all uses of _PASS_CC to either
  ‚Ä£ ${_PASS_CC:T:Q} (when passing, e.g. for libtool ‚Äì this is for use
    when ${WRKDIR}/bin is in $$PATH)
  ‚Ä£ ${_PASS_CC:Q} (when invoking, e.g. in post-build targets ‚Äì only
    these I saw when mechanically doing this; Benny wants to fix the
    remaining ones; I should‚Äôve introduced no more breakage than was)
‚Ä¢ _PASS_CXX/mpcxx just the same

agreed bsiegert@@
@
text
@# $MirOS: ports/mailnews/exim/Makefile,v 1.11 2008/10/04 19:03:16 tg Exp $

COMMENT=		flexible mail transfer agent
VERSION=		4.69
DISTNAME=		exim-${VERSION}
DASH_VER=		0
CATEGORIES=		mail
MASTER_SITES=		ftp://ftp.csx.cam.ac.uk/pub/software/email/exim/exim4/ \
			http://ftp.planetmirror.com/pub/exim/exim4/ \
			ftp://ftp.planetmirror.com/pub/exim/exim4/
				
EXTRACT_SUFX=		.tar.bz2
SUBST_VARS+=		VERSION
HOMEPAGE=		http://www.exim.org/
RESPONSIBLE=		Benny Siegert <bsiegert@@gmx.de>

# GPL
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

NO_REGRESS=		Yes

FLAVOURS=		no_x11 no_perl mysql pgsql ldap iconv
FLAVOUR?=

EXIM_ROUTERS=		ACCEPT DNSLOOKUP IPLITERAL MANUALROUTE QUERYPROGRAM REDIRECT # IPLOOKUP
EXIM_TRANSPORTS=	APPENDFILE AUTOREPLY PIPE SMTP # LMTP
EXIM_MAILBOX_FORMATS=	MAILDIR # MAILSTORE MBX
EXIM_LOOKUP_METHODS=	DBM LSEARCH CDB DNSDB DSEARCH PASSWD
EXIM_AUTH_MECHANISMS=	CRAM_MD5 PLAINTEXT SPA

.if !${FLAVOUR:L:Mno_x11}
USE_X11=		Yes
.endif

.if ${FLAVOUR:L:Mmysql}
LIB_DEPENDS+=		lib/mysql/mysqlclient.10:mysql-client-*:databases/mysql
EXIM_LOOKUP_METHODS+=	MYSQL
EXIM_LOOKUP_INCLUDE+=	-I${LOCALBASE}/include/mysql
EXIM_LOOKUP_LIBS+=	-L${LOCALBASE}/lib/mysql -lmysqlclient
.endif

.if ${FLAVOUR:L:Mpgsql}
LIB_DEPENDS+=		pq.2::databases/postgresql
EXIM_LOOKUP_METHODS+=	PGSQL
EXIM_LOOKUP_INCLUDE+=	-I${LOCALBASE}/include/postgresql
EXIM_LOOKUP_LIBS+=	-L${LOCALBASE}/lib/ -lpq
PERMIT_PACKAGE_CDROM=	dependency databases/postgresql is not allowed for CDROM
.endif

.if ${FLAVOUR:L:Mldap}
LIB_DEPENDS+=		ldap.2,lber:openldap-client-2.*:databases/openldap
EXIM_LOOKUP_METHODS+=	LDAP
EXIM_LOOKUP_INCLUDE+=	-I${LOCALBASE}/include
EXIM_LOOKUP_LIBS+=	-L${LOCALBASE}/lib -lldap -llber
.endif

.if ${FLAVOUR:L:Miconv}
MODULES+=		converters/libiconv
EXIM_EXTRA_LIBS+=	-L${ICONV_PREFIX}/lib -liconv
EXIM_CFLAGS+=		-I${ICONV_PREFIX}/include
.endif

post-patch:
	cp ${WRKSRC}/OS/Makefile-OpenBSD ${WRKSRC}/OS/Makefile-MirBSD
	cp ${WRKSRC}/OS/Makefile-OpenBSD ${WRKSRC}/OS/Makefile-ekkoBSD
	cp ${WRKSRC}/OS/os.h-OpenBSD ${WRKSRC}/OS/os.h-MirBSD
	cp ${WRKSRC}/OS/os.h-OpenBSD ${WRKSRC}/OS/os.h-ekkoBSD

do-configure:
	@@echo "BIN_DIRECTORY=${PREFIX}/sbin" >> ${WRKSRC}/Local/Makefile
	@@echo "CONFIGURE_FILE=${SYSCONFDIR}/exim/exim.conf" >> ${WRKSRC}/Local/Makefile
	@@echo "SPOOL_DIRECTORY=/var/spool/exim" >> ${WRKSRC}/Local/Makefile
	@@echo "LOG_FILE_PATH=syslog" >> ${WRKSRC}/Local/Makefile
	@@echo "SYSTEM_ALIASES_FILE=/etc/mail/aliases" >> ${WRKSRC}/Local/Makefile
	@@echo "PID_FILE_PATH=/var/run/exim.pid" >> ${WRKSRC}/Local/Makefile
	@@echo "EXIM_USER=root" >> ${WRKSRC}/Local/Makefile
	@@echo "ALT_CONFIG_ROOT_ONLY=yes" >> ${WRKSRC}/Local/Makefile
	@@echo "HEADERS_CHARSET=\"ISO-8859-1\"" >> ${WRKSRC}/Local/Makefile
	@@echo "SYSLOG_LOG_PID=yes" >> ${WRKSRC}/Local/Makefile
	@@echo "EXICYCLOG_MAX=7" >> ${WRKSRC}/Local/Makefile
	@@echo "COMPRESS_COMMAND=/usr/bin/gzip" >> ${WRKSRC}/Local/Makefile
	@@echo "COMPRESS_SUFFIX=gz" >> ${WRKSRC}/Local/Makefile
	@@echo "ZCAT_COMMAND=/usr/bin/zcat" >> ${WRKSRC}/Local/Makefile
	@@echo "CYRUS_PWCHECK_SOCKET=/var/pwcheck/pwcheck" >> ${WRKSRC}/Local/Makefile
	@@echo "CYRUS_SASLAUTHD_SOCKET=/var/sasl2/mux" >> ${WRKSRC}/Local/Makefile
	@@echo "WITH_CONTENT_SCAN=yes" >> ${WRKSRC}/Local/Makefile
	@@echo "HAVE_IPV6=yes" >> ${WRKSRC}/Local/Makefile
.for ROUTER in ${EXIM_ROUTERS}
	@@echo "ROUTER_${ROUTER}=yes" >> ${WRKSRC}/Local/Makefile
.endfor
.for TRANSPORT in ${EXIM_TRANSPORTS}
	@@echo "TRANSPORT_${TRANSPORT}=yes" >> ${WRKSRC}/Local/Makefile
.endfor
.for FORMAT in ${EXIM_MAILBOX_FORMATS}
	@@echo "SUPPORT_${FORMAT}=yes" >> ${WRKSRC}/Local/Makefile
.endfor
.for METHOD in ${EXIM_LOOKUP_METHODS}
	@@echo "LOOKUP_${METHOD}=yes" >> ${WRKSRC}/Local/Makefile
.endfor
.for MECHANISM in ${EXIM_AUTH_MECHANISMS}
	@@echo "AUTH_${MECHANISM}=yes" >> ${WRKSRC}/Local/Makefile
.endfor
	@@echo "LOOKUP_INCLUDE=${EXIM_LOOKUP_INCLUDE}" >> ${WRKSRC}/Local/Makefile
	@@echo "LOOKUP_LIBS=${EXIM_LOOKUP_LIBS}" >> ${WRKSRC}/Local/Makefile
	@@echo "EXTRALIBS_EXIM=${EXIM_EXTRA_LIBS}" >> ${WRKSRC}/Local/Makefile
	@@echo "CFLAGS=${EXIM_CFLAGS}" >> ${WRKSRC}/Local/Makefile
.if !${FLAVOUR:L:Mno_x11}
	@@echo "EXIM_MONITOR=eximon.bin" >> ${WRKSRC}/Local/Makefile
	@@cp ${WRKSRC}/exim_monitor/EDITME ${WRKSRC}/Local/eximon.conf
.endif
	@@echo "SUPPORT_TLS=yes" >> ${WRKSRC}/Local/Makefile
	@@echo "TLS_LIBS=-lssl -lcrypto" >> ${WRKSRC}/Local/Makefile
.if !${FLAVOUR:L:Mno_perl}
	@@echo "EXIM_PERL=perl.o" >> ${WRKSRC}/Local/Makefile
.endif
.if ${FLAVOUR:L:Mldap}
	@@echo "LDAP_LIB_TYPE=OPENLDAP2" >> ${WRKSRC}/Local/Makefile
.endif
.if ${FLAVOUR:L:Miconv}
	@@echo "HAVE_ICONV=yes" >> ${WRKSRC}/Local/Makefile
.endif
	@@echo CC=${_PASS_CC:T:Q} >> ${WRKSRC}/Local/Makefile
	@@echo CFLAGS=${CFLAGS:Q} >> ${WRKSRC}/Local/Makefile

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/exim
	${INSTALL_DATA} ${WRKINST}/etc/exim/exim.conf ${PREFIX}/share/examples/exim
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/exim
	${INSTALL_DATA} ${WRKSRC}/doc/spec.txt ${PREFIX}/share/doc/exim
	${INSTALL_DATA} ${WRKSRC}/doc/README.SIEVE ${PREFIX}/share/doc/exim
	${INSTALL_DATA} ${WRKSRC}/doc/filter.txt ${PREFIX}/share/doc/exim
	${INSTALL_MAN} ${WRKSRC}/doc/exim.8 ${PREFIX}/man/man8

.include <bsd.port.mk>
@


1.11
log
@mass conversion from
‚Ä¢ ${CC}
‚Ä¢ "${CC}"
‚Ä¢ '${CC}'
‚Ä¢ ${CC:Q}
to ${_PASS_CC:Q} (or without :Q if it‚Äôs executed, not assigned), and
same for CXX‚Ä¶ most of these are VERY UGLY, prone to break with ccache
and maybe even without‚Ä¶
@
text
@d1 1
a1 1
# $MirOS: ports/mailnews/exim/Makefile,v 1.10 2008/06/08 17:05:38 bsiegert Exp $
d125 1
a125 1
	@@echo CC=${_PASS_CC:Q} >> ${WRKSRC}/Local/Makefile
@


1.10
log
@Update to 4.69-0, sure to include some security fixes
@
text
@d1 1
a1 1
# $MirOS: ports/mailnews/exim/Makefile,v 1.9 2008/03/09 17:23:04 tg Exp $
d125 2
a126 2
	@@echo "CC=${CC}" >> ${WRKSRC}/Local/Makefile
	@@echo "CFLAGS=${CFLAGS}" >> ${WRKSRC}/Local/Makefile
@


1.9
log
@bulk convert FLAVOR to FLAVOUR; nuke unused file; convert to $Mdocdate
@
text
@d1 1
a1 1
# $MirOS: ports/mailnews/exim/Makefile,v 1.8 2007/04/12 20:22:18 bsiegert Exp $
d4 1
a4 1
VERSION=		4.62
d23 2
@


1.8
log
@package (not necessary all flavours) is not for CDROM because of dependency
@
text
@d1 1
a1 1
# $MirOS: ports/mailnews/exim/Makefile,v 1.7 2006/09/14 00:10:33 tg Exp $
d23 2
a24 2
FLAVORS=		no_x11 no_perl mysql pgsql ldap iconv
FLAVOR?=
d32 1
a32 1
.if !${FLAVOR:L:Mno_x11}
d36 1
a36 1
.if ${FLAVOR:L:Mmysql}
d43 1
a43 1
.if ${FLAVOR:L:Mpgsql}
d51 1
a51 1
.if ${FLAVOR:L:Mldap}
d58 1
a58 1
.if ${FLAVOR:L:Miconv}
d108 1
a108 1
.if !${FLAVOR:L:Mno_x11}
d114 1
a114 1
.if !${FLAVOR:L:Mno_perl}
d117 1
a117 1
.if ${FLAVOR:L:Mldap}
d120 1
a120 1
.if ${FLAVOR:L:Miconv}
@


1.7
log
@clean up COMMENT and HOMEPAGE; regenerate INDEX (2761, 169 marked as broken, probably many many more) ≠ edited by script with manual postprocessing
@
text
@d1 1
a1 1
# $MirOS: ports/mailnews/exim/Makefile,v 1.6 2006/06/08 12:10:37 bsiegert Exp $
d3 1
a3 1
COMMENT=			flexible mail transfer agent
d6 1
a6 1
PKGNAME=		exim-${VERSION}-0
d18 4
a21 4
PERMIT_PACKAGE_CDROM=   Yes
PERMIT_PACKAGE_FTP=     Yes
PERMIT_DISTFILES_CDROM= Yes
PERMIT_DISTFILES_FTP=   Yes
d48 1
@


1.6
log
@Upgrade exim to 4.62-0, includes some bugfixes
@
text
@d1 1
a1 1
# $MirOS: ports/mailnews/exim/Makefile,v 1.5 2006/04/26 15:55:09 bsiegert Exp $
d3 1
a3 1
COMMENT=		"flexible mail transfer agent"
@


1.5
log
@Update to 4.61-0, solve various build problems.

Also remove the no_wrap flavour (tcp wrappers are now always off)
and the no_ssl flavour (now always on).
@
text
@d1 1
a1 1
# $MirOS: ports/mailnews/exim/Makefile,v 1.4 2006/02/01 16:28:02 tg Exp $
d4 1
a4 1
VERSION=		4.61
d58 1
a58 1
MODULES=		converters/libiconv
@


1.4
log
@add USE_ICONV variable to MODULES=converters/libiconv which
defaults to any -> doesn't pull in the port under Darwin and
MirOS-current, uses libiconv (GNU or BSD) in base
@
text
@d1 1
a1 1
# $MirOS: ports/mailnews/exim/Makefile,v 1.3 2005/07/07 21:22:44 bsiegert Exp $
d4 1
a4 1
VERSION=		4.50
d23 1
a23 1
FLAVORS=		no_x11 no_perl no_ssl no_wrap mysql pgsql ldap iconv
a35 4
.if !${FLAVOR:L:Mno_wrap}
EXIM_EXTRA_LIBS+=	-lwrap
.endif

a110 1
.if !${FLAVOR:L:Mno_ssl}
a112 1
.endif
a115 3
.if !${FLAVOR:L:Mno_wrap}
	@@echo "USE_TCP_WRAPPERS=yes" >> ${WRKSRC}/Local/Makefile
.endif
a131 4
.if ${FLAVOR:L:Mexiscan}
	${INSTALL_DATA} ${WRKSRC}/doc/exiscan-acl-examples.txt ${PREFIX}/share/doc/exim
	${INSTALL_DATA} ${WRKSRC}/doc/exiscan-acl-spec.txt ${PREFIX}/share/doc/exim
.endif
@


1.3
log
@Semi-automatic update of the remaining ports to the new patchlevel format.

Please correct mistakes if you find them :).
@
text
@d1 1
a1 1
# $MirOS: ports/mailnews/exim/Makefile,v 1.2 2005/03/28 14:50:24 bsiegert Exp $
d63 2
a64 2
EXIM_EXTRA_LIBS+=	-L${LOCALBASE}/lib -liconv
EXIM_CFLAGS+=		-I${LOCALBASE}/include
@


1.2
log
@Update exim to 4.50.

The exiscan patch is now integrated. While here, update DESCR a bit and
build some more flavors in bulk builds (not the mysql ones though).
@
text
@d1 1
a1 1
# $MirOS$
d6 1
a6 1
PKGNAME=		exim-${VERSION}
@


1.1
log
@Initial revision
@
text
@d4 1
a4 1
VERSION=		4.44
a10 1
MASTER_SITES0=		http://duncanthrax.net/exiscan-acl/
a11 2
EXISCAN_DIST=		exiscan-acl-4.44-28.patch:0
SUPDISTFILES+=		${EXISCAN_DIST}
d23 1
a23 1
FLAVORS=		no_x11 no_perl no_ssl no_wrap mysql pgsql ldap iconv exiscan
a66 5
.if ${FLAVOR:L:Mexiscan}
PATCHFILES=		${EXISCAN_DIST}
PATCH_DIST_STRIP=	-p1
.endif

d90 1
@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
