head	1.5;
access;
symbols;
locks; strict;
comment	@# @;


1.5
date	2010.10.01.17.11.45;	author tg;	state dead;
branches;
next	1.4;
commitid	1004CA616634288B333;

1.4
date	2010.09.21.21.23.55;	author tg;	state Exp;
branches;
next	1.3;
commitid	1004C992261692DCA0F;

1.3
date	2008.04.06.17.06.44;	author tg;	state Exp;
branches;
next	1.2;
commitid	10047F9033A70331D39;

1.2
date	2008.04.06.16.40.35;	author tg;	state Exp;
branches;
next	1.1;
commitid	10047F8FD157B5DA86B;

1.1
date	2007.07.07.20.42.50;	author tg;	state Exp;
branches;
next	;
commitid	100468FFAD3781DB0D1;


desc
@@


1.5
log
@methinks this was too slow
@
text
@$MirOS: ports/math/ent/patches/patch-ent_c,v 1.4 2010/09/21 21:23:55 tg Exp $
--- ent.c.orig	Tue Oct 20 17:13:53 1998
+++ ent.c	Tue Sep 21 18:44:49 2010
@@@@ -18,6 +18,7 @@@@
 */
 
 #include <stdio.h>
+#include <stdlib.h>
 #include <string.h>
 #include <ctype.h>
 #include <math.h>
@@@@ -25,6 +26,16 @@@@
 #include <unistd.h>
 #endif
 
+#include <sys/param.h>
+#if defined(MirBSD) && (MirBSD > 0x0A15)
+#include <adler32.h>
+#ifndef arc4random_pushb_fast
+#define arc4random_pushb_fast arc4random_pushb
+#endif
+
+__RCSID("$MirOS: ports/math/ent/patches/patch-ent_c,v 1.4 2010/09/21 21:23:55 tg Exp $");
+#endif
+
 #include "iso8859.h"
 #include "randtest.h"
 
@@@@ -127,7 +138,12 @@@@ int main(int argc, char *argv[])
 	    fold = FALSE,	      /* Fold upper to lower */
 	    binary = FALSE,	      /* Treat input as a bitstream */
 	    terse = FALSE;	      /* Terse (CSV format) output */
+#if defined(MirBSD) && (MirBSD > 0x0A15)
+	ADLER32_CTX ctx;
 
+	ADLER32Init(&ctx);
+#endif
+
         while ((opt = getopt(argc, argv, "bcftu?BCFTU")) != -1) {
 	    switch (toISOlower(opt)) {
                  case 'b':
@@@@ -176,6 +192,11 @@@@ int main(int argc, char *argv[])
 	while ((oc = fgetc(fp)) != EOF) {
 	   unsigned char ocb;
 
+#if defined(MirBSD) && (MirBSD > 0x0A15)
+	   ocb = oc;
+	   ADLER32Update(&ctx, &ocb, 1);
+#endif
+
 	   if (fold && isISOalpha(oc) && isISOupper(oc)) {
 	      oc = toISOlower(oc);
 	   }
@@@@ -195,6 +216,10 @@@@ int main(int argc, char *argv[])
 	   rt_add(&ocb, 1);
 	}
 	V fclose(fp);
+
+#if defined(MirBSD) && (MirBSD > 0x0A15)
+	arc4random_pushb_fast(&ctx, sizeof (ctx));
+#endif
 
 	/* Complete calculation and return sequence metrics */
 
@


1.4
log
@use arc4random() a bit more efficiently
@
text
@d1 1
a1 1
$MirOS: ports/math/ent/patches/patch-ent_c,v 1.3 2008/04/06 17:06:44 tg Exp $
d23 1
a23 1
+__RCSID("$MirOS: ports/math/ent/patches/patch-ent_c,v 1.3 2008/04/06 17:06:44 tg Exp $");
@


1.3
log
@better
@
text
@d1 1
a1 1
$MirOS: ports/math/ent/patches/patch-ent_c,v 1.2 2008/04/06 16:40:35 tg Exp $
d3 1
a3 1
+++ ent.c	Sun Apr  6 17:06:27 2008
d19 2
a20 2
+#ifndef arc4random_pushk
+#define arc4random_pushk arc4random_pushb
d23 1
a23 1
+__RCSID("$MirOS$");
d60 1
a60 1
+	arc4random_pushk(&ctx, sizeof (ctx));
@


1.2
log
@use arc4random_pushk
@
text
@d1 1
a1 1
$MirOS: ports/math/ent/patches/patch-ent_c,v 1.1 2007/07/07 20:42:50 tg Exp $
d3 10
a12 2
+++ ent.c	Sun Apr  6 16:40:18 2008
@@@@ -25,6 +25,12 @@@@
a17 1
+#include <stdlib.h>
d19 5
d29 1
a29 1
@@@@ -127,7 +133,12 @@@@ int main(int argc, char *argv[])
d42 1
a42 1
@@@@ -176,6 +187,11 @@@@ int main(int argc, char *argv[])
d54 1
a54 1
@@@@ -195,6 +211,14 @@@@ int main(int argc, char *argv[])
a59 1
+#ifdef arc4random_pushk
a60 3
+#else
+	arc4random_pushb(&ctx, sizeof (ctx));
+#endif
@


1.1
log
@modernise, fix paths in docs, contribute to pool
@
text
@d1 1
a1 1
$MirOS$
d3 1
a3 1
+++ ent.c	Sat Jul  7 20:41:09 2007
d23 1
a23 1
+
d26 1
a26 1
 
d42 1
a42 1
@@@@ -195,6 +211,10 @@@@ int main(int argc, char *argv[])
d48 3
d53 1
@

