head	1.15;
access;
symbols;
locks; strict;
comment	@# @;


1.15
date	2009.08.16.16.28.26;	author tg;	state Exp;
branches;
next	1.14;
commitid	1004A882F1F72B43308;

1.14
date	2008.11.08.23.04.06;	author tg;	state Exp;
branches;
next	1.13;
commitid	10049161AC72620EAF0;

1.13
date	2008.11.08.19.54.26;	author tg;	state Exp;
branches;
next	1.12;
commitid	1004915EE7B01C2001C;

1.12
date	2008.10.04.19.03.41;	author tg;	state Exp;
branches;
next	1.11;
commitid	10048E7BD9A0842B398;

1.11
date	2008.03.17.02.19.37;	author tg;	state Exp;
branches;
next	1.10;
commitid	10047DDD5491E169183;

1.10
date	2008.03.17.02.10.50;	author tg;	state Exp;
branches;
next	1.9;
commitid	10047DDD31A23EBBE26;

1.9
date	2006.11.16.20.45.41;	author tg;	state Exp;
branches;
next	1.8;
commitid	100455CCE0670404B2A;

1.8
date	2006.11.16.20.22.43;	author tg;	state Exp;
branches;
next	1.7;
commitid	100455CC89A324056CE;

1.7
date	2006.09.14.00.13.30;	author tg;	state Exp;
branches;
next	1.6;
commitid	10045089C0E234154C3;

1.6
date	2006.02.21.13.06.23;	author tg;	state Exp;
branches;
next	1.5;
commitid	10043FB105674712833;

1.5
date	2006.01.15.12.57.45;	author tg;	state Exp;
branches;
next	1.4;
commitid	10043CA46CF54F0E0A5;

1.4
date	2006.01.13.02.55.55;	author tg;	state Exp;
branches;
next	1.3;
commitid	10043C716C96E42CCCE;

1.3
date	2005.12.14.23.13.18;	author tg;	state Exp;
branches;
next	1.2;
commitid	10043A0A71B3A57908E;

1.2
date	2005.11.18.00.22.05;	author tg;	state Exp;
branches;
next	1.1;
commitid	39c3437d1e9c0ee7;

1.1
date	2005.03.18.15.52.04;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.03.18.15.52.04;	author tg;	state Exp;
branches;
next	;


desc
@@


1.15
log
@change
‚Ä¢ _PASS_CC back from „Äåmpcc„Äç to „Äå${WRKDIR}/bin/mpcc„Äç (note that the
  former „Äå${WRKDIR:Q}/bin/mpcc„Äç was wrong)
‚Ä¢ all uses of _PASS_CC to either
  ‚Ä£ ${_PASS_CC:T:Q} (when passing, e.g. for libtool ‚Äì this is for use
    when ${WRKDIR}/bin is in $$PATH)
  ‚Ä£ ${_PASS_CC:Q} (when invoking, e.g. in post-build targets ‚Äì only
    these I saw when mechanically doing this; Benny wants to fix the
    remaining ones; I should‚Äôve introduced no more breakage than was)
‚Ä¢ _PASS_CXX/mpcxx just the same

agreed bsiegert@@
@
text
@# $MirOS: ports/sysutils/daemontools/Makefile,v 1.14 2008/11/08 23:04:06 tg Exp $

COMMENT=		collection of tools for managing unix services
CATEGORIES=		sysutils
DISTNAME=		daemontools-0.76
DASH_VER=		4
MANVER=			20020131
HOMEPAGE=		http://cr.yp.to/daemontools.html
RESPONSIBLE=		Thorsten Glaser <tg@@mirbsd.org>

# Public Domain: http://cr.yp.to/distributors.html
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

DISTFILES=		${DISTNAME}${EXTRACT_SUFX} \
			${DISTNAME}-man-${MANVER}${EXTRACT_SUFX}:0
MASTER_SITES=		http://cr.yp.to/daemontools/
MASTER_SITES0=		http://smarden.org/pape/djb/manpages/
WRKDIST=		${WRKDIR}
NO_REGRESS=		Yes

MAN8LIST=		envdir envuidgid fghack multilog setlock setuidgid \
			softlimit supervise svc svok svscan svstat tai64n \
			tai64nlocal svscanboot pgrphack readproctitle

BINLIST=		envdir envuidgid fghack multilog pgrphack \
			readproctitle setlock setuidgid softlimit \
			supervise svc svok svscan svstat tai64n tai64nlocal

do-build:
	if [[ ! -e ${WRKSRC}/admin/${DISTNAME}/src/home ]]; then \
		print -r -- ${_PASS_CC:T:Q} ${CFLAGS:M*:Q} \
		    >${WRKSRC}/admin/${DISTNAME}/src/conf-cc; \
		print -r -- ${_PASS_CC:T:Q} ${CFLAGS:M*:Q} ${LDFLAGS:M*:Q} \
		    >${WRKSRC}/admin/${DISTNAME}/src/conf-ld; \
		print -r -- ${PREFIX:Q} >${WRKSRC}/admin/${DISTNAME}/src/home; \
	fi
	cd ${WRKSRC}/admin/${DISTNAME}/src && \
	    ${SETENV} ${MAKE_ENV} ${MAKE_PROGRAM} it

do-install:
.for i in ${BINLIST}
	${INSTALL_PROGRAM} ${WRKSRC}/admin/${DISTNAME}/src/$i ${PREFIX}/bin/
.endfor
	for a in ${WRKSRC}/admin/${DISTNAME}/src/svscanboot \
	    ${WRKDIR}/daemontools-man/svscanboot.8; do \
		chmod u+w $$a; \
		print ',g!/usr/local!s!!${TRUEPREFIX}!g\nwq' | ed -s $$a; \
	done
	print ',g!^/command!s!!${TRUEPREFIX}/bin!\nwq' | \
	    ed -s ${WRKSRC}/admin/${DISTNAME}/src/svscanboot
	${INSTALL_SCRIPT} ${WRKSRC}/admin/${DISTNAME}/src/svscanboot \
	    ${PREFIX}/bin/
.for i in ${MAN8LIST}
	${INSTALL_MAN} ${WRKDIR}/daemontools-man/$i.8 ${PREFIX}/man/man8/
.endfor

.include <bsd.port.mk>
@


1.14
log
@more mass conversions, including ancient eMail addresses
@
text
@d1 1
a1 1
# $MirOS: ports/sysutils/daemontools/Makefile,v 1.13 2008/11/08 19:54:26 tg Exp $
d34 1
a34 1
		print -r -- ${_PASS_CC:Q} ${CFLAGS:M*:Q} \
d36 1
a36 1
		print -r -- ${_PASS_CC:Q} ${CFLAGS:M*:Q} ${LDFLAGS:M*:Q} \
@


1.13
log
@fix compilation: honour MAKE_ENV
@
text
@d1 1
a1 1
# $MirOS: ports/sysutils/daemontools/Makefile,v 1.12 2008/10/04 19:03:41 tg Exp $
d9 1
a9 1
RESPONSIBLE=		Thorsten Glaser <tg@@66h.42h.de>
@


1.12
log
@mass conversion from
‚Ä¢ ${CC}
‚Ä¢ "${CC}"
‚Ä¢ '${CC}'
‚Ä¢ ${CC:Q}
to ${_PASS_CC:Q} (or without :Q if it‚Äôs executed, not assigned), and
same for CXX‚Ä¶ most of these are VERY UGLY, prone to break with ccache
and maybe even without‚Ä¶
@
text
@d1 1
a1 1
# $MirOS: ports/sysutils/daemontools/Makefile,v 1.11 2008/03/17 02:19:37 tg Exp $
d40 2
a41 1
	cd ${WRKSRC}/admin/${DISTNAME}/src && ${MAKE_PROGRAM} it
@


1.11
log
@print ipv echo here too
@
text
@d1 1
a1 1
# $MirOS: ports/sysutils/daemontools/Makefile,v 1.10 2008/03/17 02:10:50 tg Exp $
d34 1
a34 1
		print -r -- ${CC:Q} ${CFLAGS:M*:Q} \
d36 1
a36 1
		print -r -- ${CC:Q} ${CFLAGS:M*:Q} ${LDFLAGS:M*:Q} \
@


1.10
log
@these are now public domain, as of 2007-12-28
thanks Prof. Bernstein!

this means that MirOS #11 will come with d√¶montools in base, finally!
@
text
@d1 1
a1 1
# $MirOS: ports/sysutils/daemontools/Makefile,v 1.9 2006/11/16 20:45:41 tg Exp $
d34 1
a34 1
		echo ${CC:Q} ${CFLAGS:M*:Q} \
d36 1
a36 1
		echo ${CC:Q} ${CFLAGS:M*:Q} ${LDFLAGS:M*:Q} \
d38 1
a38 1
		echo ${PREFIX:Q} >${WRKSRC}/admin/${DISTNAME}/src/home; \
d49 1
a49 1
		print '%g!/usr/local!s!!${TRUEPREFIX}!g\nwq' | ed -s $$a; \
d51 2
a52 2
	print '%g!^/command!s!!${TRUEPREFIX}/bin!\nwq' \
	    | ed -s ${WRKSRC}/admin/${DISTNAME}/src/svscanboot
@


1.9
log
@allow rebuild
@
text
@d1 1
a1 1
# $MirOS: ports/sysutils/daemontools/Makefile,v 1.8 2006/11/16 20:22:43 tg Exp $
d6 1
a7 1
PKGNAME=		${DISTNAME}-4
d11 5
a15 7
# May distribute patches.
# Must not distribute binaries.
# Must not distribute distfiles.
PERMIT_PACKAGE_CDROM=	No
PERMIT_PACKAGE_FTP=	No
PERMIT_DISTFILES_CDROM=	No
PERMIT_DISTFILES_FTP=	"http://cr.yp.to/distributors.html"
@


1.8
log
@* we can fetch these with /usr/bin/ftp again, must've been the HTTP/1.1 glitch
* regen; reindent
@
text
@d1 1
a1 1
# $MirOS: ports/sysutils/daemontools/Makefile,v 1.7 2006/09/14 00:13:30 tg Exp $
d35 7
a41 4
	@@echo ${CC:Q} ${CFLAGS:M*:Q} >${WRKSRC}/admin/${DISTNAME}/src/conf-cc
	@@echo ${CC:Q} ${CFLAGS:M*:Q} ${LDFLAGS:M*:Q} \
	    >${WRKSRC}/admin/${DISTNAME}/src/conf-ld
	@@echo ${PREFIX:Q} >${WRKSRC}/admin/${DISTNAME}/src/home
@


1.7
log
@clean up COMMENT and HOMEPAGE; regenerate INDEX (2761, 169 marked as broken, probably many many more) ≠ edited by script with manual postprocessing
@
text
@d1 1
a1 1
# $MirOS: ports/sysutils/daemontools/Makefile,v 1.6 2006/02/21 13:06:23 tg Exp $
d3 1
a3 1
COMMENT=			collection of tools for managing unix services
d19 14
a32 16
FETCH_CMD=		lynx -source >$$f

DISTFILES=	${DISTNAME}${EXTRACT_SUFX} \
		${DISTNAME}-man-${MANVER}${EXTRACT_SUFX}:0
MASTER_SITES=	http://cr.yp.to/daemontools/
MASTER_SITES0=	http://smarden.org/pape/djb/manpages/

MAN8LIST=	envdir envuidgid fghack multilog setlock setuidgid softlimit \
		supervise svc svok svscan svstat tai64n tai64nlocal \
		svscanboot pgrphack readproctitle

BINLIST=	envdir envuidgid fghack multilog pgrphack readproctitle \
		setlock setuidgid softlimit supervise svc svok svscan \
		svstat tai64n tai64nlocal

WRKDIST=	${WRKDIR}
d35 5
a39 4
	@@echo ${CC} ${CFLAGS} >${WRKSRC}/admin/${DISTNAME}/src/conf-cc
	@@echo ${CC} ${CFLAGS} ${LDFLAGS} >${WRKSRC}/admin/${DISTNAME}/src/conf-ld
	@@echo ${PREFIX} >${WRKSRC}/admin/${DISTNAME}/src/home
	cd ${WRKSRC}/admin/${DISTNAME}/src && make it
d52 2
a53 1
	${INSTALL_SCRIPT} ${WRKSRC}/admin/${DISTNAME}/src/svscanboot ${PREFIX}/bin/
d55 1
a55 1
	${INSTALL_MAN} ${WRKDIR}/daemontools-man/$i.8 ${PREFIX}/man/man8
a57 2
NO_REGRESS=	Yes

@


1.6
log
@use lynx(1) to fetch, ftp(1) is somehow broken (or rather, publicfile)
@
text
@d1 1
a1 1
# $MirOS: ports/sysutils/daemontools/Makefile,v 1.5 2006/01/15 12:57:45 tg Exp $
d3 1
a3 1
COMMENT=		"collection of tools for managing unix services"
@


1.5
log
@found a new upstream for manual page tarballs;
they are even versioned now; update, sync, bump
@
text
@d1 1
a1 1
# $MirOS: ports/sysutils/daemontools/Makefile,v 1.4 2006/01/13 02:55:55 tg Exp $
d19 2
@


1.4
log
@TINSTA /command/svc(1)
@
text
@d1 1
a1 1
# $MirOS: ports/sysutils/daemontools/Makefile,v 1.3 2005/12/14 23:13:18 tg Exp $
d6 2
a7 1
PKGNAME=		${DISTNAME}-3
d19 2
a20 1
DISTFILES=	${DISTNAME}${EXTRACT_SUFX} ${DISTNAME}-man${EXTRACT_SUFX}:0
d22 1
a22 1
MASTER_SITES0=	${_MASTER_SITE_MIRBSD}
@


1.3
log
@fix for localbases other than /usr/local
@
text
@d1 1
a1 1
# $MirOS: ports/sysutils/daemontools/Makefile,v 1.2 2005/11/18 00:22:05 tg Exp $
d6 1
a6 1
PKGNAME=		${DISTNAME}-2
d47 2
@


1.2
log
@* sng, daemontools: update my email address
* daemontools: remove patch to use in-libc TAI64 functions,
  because they can't (yet) be reliably detected (unbreaks make index
  with MirMake instead of /usr/bin/make, and much more)
@
text
@d1 1
a1 1
# $MirOS: ports/sysutils/daemontools/Makefile,v 1.1.7.1 2005/03/18 15:52:04 tg Exp $
d6 1
a6 1
PKGNAME=		${DISTNAME}-1
d35 1
a35 1
	@@echo ${PREFIX} > ${WRKSRC}/admin/${DISTNAME}/src/home
d40 1
a40 1
	${INSTALL_PROGRAM} ${WRKSRC}/admin/${DISTNAME}/src/$i ${PREFIX}/bin
d42 6
a47 3
	cd ${WRKSRC}/admin/${DISTNAME}/src && \
		sed s,/command/svc,/usr/local/bin/svc, <svscanboot >svscanboot.new
	${INSTALL_SCRIPT} ${WRKSRC}/admin/${DISTNAME}/src/svscanboot.new ${PREFIX}/bin/svscanboot
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $MirOS$
d3 6
a8 5
COMMENT=	"collection of tools for managing unix services"
CATEGORIES=	sysutils
DISTNAME=	daemontools-0.76
HOMEPAGE=	http://cr.yp.to/daemontools.html
RESPONSIBLE=	Thorsten Glaser <x86@@ePost.de>
a30 5
PATCH_LIST=
.if ${OSname} == "mirbsd" && ${OSrev} >= 8
PATCH_LIST+=	patch-admin_daemontools-0_76_src_tai_now_c \
		patch-admin_daemontools-0_76_src_taia_now_c
.endif
@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
