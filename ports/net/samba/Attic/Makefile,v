head	1.6;
access;
symbols;
locks; strict;
comment	@# @;


1.6
date	2007.04.03.19.45.16;	author tg;	state dead;
branches;
next	1.5;
commitid	1004612AC977E789195;

1.5
date	2006.09.14.00.12.16;	author tg;	state Exp;
branches;
next	1.4;
commitid	10045089C0E234154C3;

1.4
date	2006.02.09.09.36.11;	author tg;	state Exp;
branches;
next	1.3;
commitid	10043EB0C94610EDE76;

1.3
date	2006.01.01.03.49.12;	author tg;	state Exp;
branches;
next	1.2;
commitid	10043B7514A64E72E33;

1.2
date	2005.07.07.21.24.58;	author bsiegert;	state Exp;
branches;
next	1.1;
commitid	66bc42cd9a7ea714;

1.1
date	2005.03.18.15.49.02;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.03.18.15.49.02;	author tg;	state Exp;
branches;
next	;


desc
@@


1.6
log
@â€¢ remove ports that are simply broken, don't work, for too long, with no
  update or update-willing person in sight, kde stuff, web2.0 stuff that
  we don't want in ports (just stuff it into /var/www yourself, it isn't
  that difficult, right?), stuff for which no new version exists/will be
  and some obsd cruft; adjust dependencies
â€¢ no BUILD_DEPENDS+=RUN_DEPENDS or vice versa any more, *ever*
â€¢ fix some other stuff partially

ok bsiegert@@
@
text
@# $MirOS: ports/net/samba/Makefile,v 1.5 2006/09/14 00:12:16 tg Exp $
# $OpenBSD: Makefile,v 1.21 2003/10/26 09:33:23 sturm Exp $

BROKEN=		does not function correctly sometimes

COMMENT=			SMB and CIFS client and server for UNIX
COMMENT-docs=			documentation and examples for samba

PKGNAME=	${DISTNAME}-0
PKGNAME-docs=	samba-docs-${VERSION}-0

VERSION=	3.0.11
DISTNAME=	samba-${VERSION}
CATEGORIES=	net
HOMEPAGE=	http://www.samba.org/
MASTER_SITES=	\
		http://ca.samba.org/samba/ftp/old-versions/ \
		http://us2.samba.org/samba/ftp/old-versions/

# GPL
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

MODULES=	converters/libiconv
S_LIB_DEPENDS=	popt::devel/popt \
		readline::devel/libreadline
MAKE_FLAGS=	PASSWD_PROGRAM="/usr/bin/passwd"
FAKE_FLAGS=	DESTDIR='${WRKINST}' \
		prefix="${PREFIX}" \
		BASEDIR="${PREFIX}" \
		LIBDIR="${PREFIX}/lib/samba" \
		PIDDIR="/var/run" \
		SWATDIR="${PREFIX}/share/swat" \
		SBINDIR="${PREFIX}/libexec" \
		VARDIR="/var"

CONFDIR=	${SYSCONFDIR}/samba
SAMBA_LOGDIR=	/var/log
SUBST_VARS=	CONFDIR

CONFIGURE_STYLE=autoconf
AUTOCONF_NEW=	Yes
CONFIGURE_ARGS=	--libdir="${PREFIX}/lib/samba" \
		--localstatedir="/var" \
		--sbindir="${PREFIX}/libexec" \
		--with-configdir="${CONFDIR}" \
		--with-lockdir="/var/spool/samba" \
		--with-piddir="/var/run" \
		--with-logfilebase="${SAMBA_LOGDIR}" \
		--with-privatedir="${CONFDIR}" \
		--with-readline \
		--with-libsmbclient \
		--with-quotas \
		--with-swatdir="${PREFIX}/share/swat" \
		--with-ssl \
		--with-sslinc="/usr/include/ssl" \
		--with-ssllib="/usr/lib"

FLAVORS=	ads cups ldap
FLAVOR?=

MULTI_PACKAGES=	-docs
SUBPACKAGE?=

.if ${FLAVOR:L:Mads}
.  if ${OSname} == "openbsd"
CPPFLAGS+=	-I/usr/include/kerberosV
FLAVORS+=	ldap
CONFIGURE_ARGS+=--with-ads
.  else
ERRORS+=	Kerberos is not supported on MirOS BSD.
.  endif
.else
CONFIGURE_ARGS+=--without-ads
.endif

.if ${FLAVOR:L:Mcups}
CONFIGURE_ARGS+=--enable-cups
S_LIB_DEPENDS+=	cups::print/cups
.else
CONFIGURE_ARGS+=--disable-cups
.endif

.if ${FLAVOR:L:Mldap}
CONFIGURE_ARGS+=--with-ldap
S_LIB_DEPENDS+=	ldap,lber::databases/openldap
.else
CONFIGURE_ARGS+=--without-ldap
.endif

.if defined(PACKAGING) && ${SUBPACKAGE} == "-docs"
RUN_DEPENDS=	:samba-=${VERSION}:net/samba
.else
LIB_DEPENDS=	${S_LIB_DEPENDS}
.endif

NO_REGRESS=	Yes

WRKDIST=	${WRKDIR}/${DISTNAME}/source

SAMBA_DOCS=	${WRKSRC}/../README \
		${WRKSRC}/../docs/THANKS \
		${WRKSRC}/../docs/history \
		${WRKSRC}/../docs/registry/*.reg

SAMPLE_CONFIG=	${PREFIX}/share/examples/samba/smb.conf.default

.if ${FLAVOR} != ""
pre-extract:
	@@echo ">>> Warning: flavoured build not tested!"
	@@sleep 3
.endif

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/samba/pdf
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/samba/htmldocs
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/samba
	@@cp -R ${WRKSRC}/../examples/* ${PREFIX}/share/examples/samba
	@@chown -R ${SHAREOWN}:${SHAREGRP} ${PREFIX}/share/examples/samba
	${INSTALL_DATA} ${FILESDIR}/README.MirPorts ${PREFIX}/share/doc/samba
	@@for i in ${SAMBA_DOCS}; do \
	 ${INSTALL_DATA} $$i ${PREFIX}/share/doc/samba ;	\
	done
	@@for i in ${WRKSRC}/../docs/*.pdf ; do \
	 ${INSTALL_DATA} $$i ${PREFIX}/share/doc/samba/pdf ; \
	done
	@@for i in ${WRKSRC}/../docs/htmldocs/* ; do \
	 if [ -f $$i ]; then \
	  ${INSTALL_DATA} $$i ${PREFIX}/share/doc/samba/htmldocs ;\
	 fi \
	done
	@@sed -e 's:/usr/spool/samba:/var/spool/samba:g' \
	 -e 's:/usr/local/samba/var/log:${SAMBA_LOGDIR}/smbd:g' \
	 ${WRKSRC}/../examples/smb.conf.default > ${SAMPLE_CONFIG}
	${INSTALL_SCRIPT} ${WRKSRC}/script/mksmbpasswd.sh \
	 ${PREFIX}/bin/mksmbpasswd
	@@chown ${BINOWN}:${BINGRP} ${PREFIX}/bin/smbpasswd
	@@chmod 111 ${PREFIX}/bin/smbpasswd

.include <bsd.port.mk>
@


1.5
log
@clean up COMMENT and HOMEPAGE; regenerate INDEX (2761, 169 marked as broken, probably many many more) ­ edited by script with manual postprocessing
@
text
@d1 1
a1 1
# $MirOS: ports/net/samba/Makefile,v 1.4 2006/02/09 09:36:11 tg Exp $
@


1.4
log
@remove SEPARATE_BUILD for once and for good, I'm fed up with
all the trouble it can cause - ports which need it (e.g. the
GCC SC doesnt "support" building gcc with srcdir=objdir) can
set stuff like WRKBUILD themselves.
@
text
@d1 1
a1 1
# $MirOS: ports/net/samba/Makefile,v 1.3 2006/01/01 03:49:12 tg Exp $
d6 2
a7 2
COMMENT=	"SMB and CIFS client and server for UNIX"
COMMENT-docs=	"documentation and examples for samba"
@


1.3
log
@mark as broken. better is.
@
text
@d1 1
a1 1
# $MirOS: ports/net/samba/Makefile,v 1.2 2005/07/07 21:24:58 bsiegert Exp $
a42 1
SEPARATE_BUILD=	concurrent
@


1.2
log
@Semi-automatic update of the remaining ports to the new patchlevel format.

Please correct mistakes if you find them :).
@
text
@d1 1
a1 1
# $MirOS$
d4 2
@


1.1
log
@Initial revision
@
text
@d7 2
a8 2
PKGNAME=	${DISTNAME}
PKGNAME-docs=	samba-docs-${VERSION}
@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
