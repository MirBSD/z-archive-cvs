head	1.5;
access;
symbols;
locks; strict;
comment	@# @;


1.5
date	2017.04.04.19.49.33;	author tg;	state Exp;
branches;
next	1.4;
commitid	10058E3F8A62F08813C;

1.4
date	2012.01.04.23.16.40;	author tg;	state Exp;
branches;
next	1.3;
commitid	1004F04DDE925150E8F;

1.3
date	2008.12.30.03.01.32;	author tg;	state Exp;
branches;
next	1.2;
commitid	10049598F0E37360586;

1.2
date	2008.04.02.00.06.04;	author tg;	state Exp;
branches;
next	1.1;
commitid	10047F2CD0D74098805;

1.1
date	2007.02.17.20.49.07;	author tg;	state Exp;
branches;
next	;
commitid	10045D76A5967EACE0B;


desc
@@


1.5
log
@pretty straight-forward update of rsync:

• add most OpenBSD patches (but ignore rrsync)
• add a patch from Debian (adding -4/-6 to ssh on rsync -4/-6)

marked as “broken: do not use yet” because I’m targetting a
leap second patch for this release (rsync transfers time_t
over the network, which cannot go well…)
@
text
@$MirOS$
$OpenBSD: patch-rsyncd_conf_5,v 1.6 2016/01/10 21:36:22 naddy Exp $
--- rsyncd.conf.5.orig	Mon Dec 21 20:20:30 2015
+++ rsyncd.conf.5	Tue Apr  4 19:41:41 2017
@@@@ -68,12 +68,11 @@@@ When run via inetd you should add a line
 and a single line something like this to /etc/inetd.conf:
 .PP 
 .nf 
-  rsync   stream  tcp     nowait  root   /usr/bin/rsync rsyncd \-\-daemon
+  rsync   stream  tcp     nowait  root   ${TRUEPREFIX}/bin/rsync rsyncd \-\-daemon
 .fi 
 
 .PP 
-Replace \(dq\&/usr/bin/rsync\(dq\& with the path to where you have rsync installed on
-your system.  You will then need to send inetd a HUP signal to tell it to
+You will then need to send inetd a HUP signal to tell it to
 reread its config file.
 .PP 
 Note that you should \fBnot\fP send the rsync daemon a HUP signal to force
@@@@ -405,7 +404,7 @@@@ This parameter specifies the user name o
 file transfers to and from that module should take place as when the daemon
 was run as root. In combination with the \(dq\&gid\(dq\& parameter this determines what
 file permissions are available. The default when run by a super\-user is to
-switch to the system\(cq\&s \(dq\&nobody\(dq\& user.  The default for a non\-super\-user is to
+switch to the system\(cq\&s \(dq\&_rsync\(dq\& user.  The default for a non\-super\-user is to
 not try to change the user.  See also the \(dq\&gid\(dq\& parameter.
 .IP 
 The RSYNC_USER_NAME environment variable may be used to request that rsync run
@@@@ -424,7 +423,7 @@@@ used when accessing the module.  The fir
 any extra ones be set as supplemental groups.  You may also specify a \(dq\&*\(dq\& as
 the first gid in the list, which will be replaced by all the normal groups for
 the transfer\(cq\&s user (see \(dq\&uid\(dq\&).  The default when run by a super\-user is to
-switch to your OS\(cq\&s \(dq\&nobody\(dq\& (or perhaps \(dq\&nogroup\(dq\&) group with no other
+switch to the \(dq\&_rsync\(dq\& group with no other
 supplementary groups.  The default for a non\-super\-user is to not change any
 group attributes (and indeed, your OS may not allow a non\-super\-user to try to
 change their group settings).
@@@@ -584,7 +583,7 @@@@ require that you specify a group passwor
 passwords.
 .IP 
 There is no default for the \(dq\&secrets file\(dq\& parameter, you must choose a name
-(such as \f(CW/etc/rsyncd.secrets\fP).  The file must normally not be readable
+(such as \f(CW${SYSCONFDIR}/rsyncd.secrets\fP).  The file must normally not be readable
 by \(dq\&other\(dq\&; see \(dq\&strict modes\(dq\&.  If the file is not found or is rejected, no
 logins for a \(dq\&user auth\(dq\& module will be possible.
 .IP 
@@@@ -985,8 +984,8 @@@@ A more sophisticated example would be:
 .PP 
 .nf 
 
-uid = nobody
-gid = nobody
+uid = _rsync
+gid = _rsync
 use chroot = yes
 max connections = 4
 syslog facility = local5
@@@@ -1012,12 +1011,12 @@@@ pid file = /var/run/rsyncd.pid
         path = /data/cvs
         comment = CVS repository (requires authentication)
         auth users = tridge, susan
-        secrets file = /etc/rsyncd.secrets
+        secrets file = ${SYSCONFDIR}/rsyncd.secrets
 
 .fi 
 
 .PP 
-The /etc/rsyncd.secrets file would look something like this:
+The ${SYSCONFDIR}/rsyncd.secrets file would look something like this:
 .PP 
 .RS 
 \f(CWtridge:mypass\fP
@@@@ -1030,7 +1029,7 @@@@ The /etc/rsyncd.secrets file would look 
 .SH "FILES"
 
 .PP 
-/etc/rsyncd.conf or rsyncd.conf
+${SYSCONFDIR}/rsyncd.conf or rsyncd.conf
 .PP 
 .SH "SEE ALSO"
 
@


1.4
log
@update
@
text
@d1 47
a47 4
$MirOS: ports/net/rsync/patches/patch-rsyncd_conf_5,v 1.3 2008/12/30 03:01:32 tg Exp $
--- rsyncd.conf.5.orig	Fri Sep 23 16:35:31 2011
+++ rsyncd.conf.5	Wed Jan  4 23:02:19 2012
@@@@ -764,8 +764,8 @@@@ A more sophisticated example would be:
d58 24
@


1.3
log
@update rsync, not even 36hrs old…
@
text
@d1 4
a4 4
$MirOS: ports/net/rsync/patches/patch-rsyncd_conf_5,v 1.2 2008/04/02 00:06:04 tg Exp $
--- rsyncd.conf.5.orig	Mon Dec 29 02:03:14 2008
+++ rsyncd.conf.5	Tue Dec 30 02:50:27 2008
@@@@ -758,8 +758,8 @@@@ A more sophisticated example would be:
@


1.2
log
@upgrade to rsync 3, GPLv3
• took me more than 2 hours
• book example of crazy buildsystem:
  ‣ does not use libtool or automake/aclocal
  ‣ does not use iconv.m4
  ‣ uses configure.sh custom filename for configure script
• bump version, remove old CVE fix
• switch to CONFIGURE_STYLE=autoconf
• add a touching file (rsyncam.dep) for “configure.sh” processing ☹
• use --disable-iconv explicitly for -static flavour
• use libiconv module (dependency) for normal flavour
• patch configure.in to use our iconv.m4 file
• install a few more doc files
• make rsync *NOT* link against -liconv if --disable-iconv is given!
  ‣ prevents a DT_NEEDED which otherwise appeared even if
    no function from the iconv library was imported!
• when calling $CC with -c, always add $CFLAGS $CPPFLAGS (sigh…)
• support MidnightBSD: we assume they have FreeBSD xattr support
@
text
@d1 4
a4 4
$MirOS$
--- rsyncd.conf.5.orig	Mon Mar 31 06:31:29 2008
+++ rsyncd.conf.5	Tue Apr  1 22:37:08 2008
@@@@ -757,8 +757,8 @@@@ A more sophisticated example would be:
@


1.1
log
@update to 2.6.9
@
text
@d2 3
a4 3
--- rsyncd.conf.5.orig	Tue Nov  7 04:39:29 2006
+++ rsyncd.conf.5	Sat Feb 17 20:24:51 2007
@@@@ -657,8 +657,8 @@@@ A more sophisticated example would be:
d12 1
a12 1
 use chroot = no
@

