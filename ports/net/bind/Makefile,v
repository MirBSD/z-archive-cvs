head	1.11;
access;
symbols;
locks; strict;
comment	@# @;


1.11
date	2008.12.07.18.58.01;	author tg;	state Exp;
branches;
next	1.10;
commitid	100493C1C934A10FB73;

1.10
date	2008.06.15.14.29.28;	author tg;	state Exp;
branches;
next	1.9;
commitid	1004855275C5CF12510;

1.9
date	2008.05.25.20.56.38;	author tg;	state Exp;
branches;
next	1.8;
commitid	1004839D28B6A814A50;

1.8
date	2008.05.07.22.48.32;	author tg;	state Exp;
branches;
next	1.7;
commitid	100482231C374D9CA0B;

1.7
date	2008.03.09.17.23.15;	author tg;	state Exp;
branches;
next	1.6;
commitid	10047D41CAA7E715397;

1.6
date	2007.07.25.20.15.35;	author bsiegert;	state Exp;
branches;
next	1.5;
commitid	10046A7AEEA23D36E47;

1.5
date	2007.03.11.21.05.06;	author bsiegert;	state Exp;
branches;
next	1.4;
commitid	10045F46EB64C61C19B;

1.4
date	2006.09.14.00.11.34;	author tg;	state Exp;
branches;
next	1.3;
commitid	10045089C0E234154C3;

1.3
date	2006.02.09.09.36.07;	author tg;	state Exp;
branches;
next	1.2;
commitid	10043EB0C94610EDE76;

1.2
date	2005.07.07.21.24.01;	author bsiegert;	state Exp;
branches;
next	1.1;
commitid	66bc42cd9a7ea714;

1.1
date	2005.03.18.15.49.24;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.03.18.15.49.24;	author tg;	state Exp;
branches;
next	;


desc
@@


1.11
log
@switch all CVS_DISTF (and svn) to MCZ_FETCH=Yes except these
which already were or these which are broken anyway (net/bind)
to make them IS_INTERACTIVE=No and thus suitable for bulk builds

agreed bsiegert@@
@
text
@# $MirOS: ports/net/bind/Makefile,v 1.10 2008/06/15 14:29:28 tg Exp $
# $OpenBSD: Makefile,v 1.42 2003/04/10 18:08:56 jsyn Exp $

BROKEN+=		distfile fetch problem
BROKEN+=		netaddr.c:136: error: conflicting types for 'isc_netaddr_format'

COMMENT=		ISC BIND 9 libraries, audited OpenBSD version
COMMENT-server=		ISC BIND 9 server, audited OpenBSD version
COMMENT-client=		ISC BIND 9 client tools, audited OpenBSD version

VERSION=		9.3.4.1
MCZ_FETCH=		Yes
CVS_DISTREPO=		:ext:anoncvs@@anoncvs.ca.openbsd.org:/cvs
CVS_DISTDATE=		2007/07/25
CVS_DISTMODS=		src/usr.sbin/bind src/etc/bind
CVS_DISTFILE=		bind

PKGNAME=		bind-${VERSION}-${DASH_VER}
FULLPKGNAME=		bind-lib-${VERSION}-${DASH_VER}
PKGNAME-server=		bind-server-${VERSION}-${DASH_VER}
PKGNAME-client=		bind-client-${VERSION}-${DASH_VER}

CATEGORIES=		net

HOMEPAGE=		http://www.isc.org/products/BIND/
RESPONSIBLE=		Benny Siegert <bsiegert@@gmx.de>

# BSD licence
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

WRKDIST=		${WRKDIR}/src/usr.sbin/bind/
ETCDIR=			${WRKDIR}/src/etc/bind/

DATADIR=		/var/named
SUBST_VARS+=		DATADIR

MULTI_PACKAGES=		-server -client
SUBPACKAGE?=
FLAVOURS=		static threads
FLAVOUR?=

.if defined(PACKAGING) && ${FLAVOUR} != "static"
. if ${SUBPACKAGE} == "-client"
RUN_DEPENDS=		:bind-lib-${VERSION}:net/bind
. elif ${SUBPACKAGE} == "-server"
RUN_DEPENDS=		:bind-lib-${VERSION}:net/bind \
			:bind-client-${VERSION}:net/bind
. endif
.endif

.if ${FLAVOUR:L:Mstatic}
CFLAGS+=		"-static"
NO_SHARED_LIBS=		Yes
.endif

.include <mirports.sys.mk>
.if ${OStype:M*BSD}
RND_DEVICE=		/dev/arandom
.else
RND_DEVICE=		/dev/urandom
.endif

NO_REGRESS=		Yes
CONFIGURE_STYLE=	autoconf no-autoheader
AUTOCONF_NEW=		Yes

CONFIGURE_ARGS+=	--with-libtool ${CONFIGURE_SHARED}
CONFIGURE_ARGS+=	--localstatedir=/var
CONFIGURE_ARGS+=	--disable-libbind
CONFIGURE_ARGS+=	--with-openssl=/usr
CONFIGURE_ARGS+=	--with-randomdev=/dev/arandom

.if ${FLAVOUR:L:Mthreads}
CONFIGURE_ARGS+=	--enable-threads
.else
CONFIGURE_ARGS+=	--disable-threads
.endif

MISCDOCFILES=	dnssec ipv6 migration migration-4to9 \
		options rfc-compliance roadmap sdb

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/bind9/arm
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/bind9/misc
	${INSTALL_DATA} ${WRKSRC}/doc/arm/*.html ${PREFIX}/share/doc/bind9/arm
.for file in ${MISCDOCFILES}
	${INSTALL_DATA} ${WRKSRC}/doc/misc/${file} ${PREFIX}/share/doc/bind9/misc
.endfor
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/bind9
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/bind9/etc
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/bind9/standard
	${INSTALL_DATA} ${ETCDIR}/named-*.conf ${PREFIX}/share/examples/bind9/etc
	${INSTALL_DATA} ${ETCDIR}/root.hint ${PREFIX}/share/examples/bind9/standard
.for file in localhost loopback loopback6.arpa
	${INSTALL_DATA} ${ETCDIR}/db.${file} ${PREFIX}/share/examples/bind9/standard/${file}
.endfor
	sed -e s,@@LOCALBASE@@,${LOCALBASE}, < ${FILESDIR}/rc.local.frag > ${PREFIX}/share/examples/bind9/rc.local.frag

.include <bsd.port.mk>
@


1.10
log
@break
@
text
@d1 1
a1 1
# $MirOS: ports/net/bind/Makefile,v 1.9 2008/05/25 20:56:38 tg Exp $
d12 1
@


1.9
log
@use :ext: in front of OpenBSDâ€™s anoncvs mirror, and document
@
text
@d1 1
a1 1
# $MirOS: ports/net/bind/Makefile,v 1.8 2008/05/07 22:48:32 tg Exp $
d4 3
@


1.8
log
@â€¢ replace MODGNU_CONFIG_GUESS_DIRS with MODGNU_RECURSE_DIRS
â€¢ always place ${WRKSRC} itself at the end of MODGNU_RECURSE_DIRS due to
  recursion issues inside of autoconf itself
â€¢ if MODGNU_RECURSE_DIRS=${WRKSRC} stood in the Makefile, nuke it (default)
â€¢ remove dead reference to MODGNU_TWIDDLE_DIRS
@
text
@d1 1
a1 1
# $MirOS: ports/net/bind/Makefile,v 1.7 2008/03/09 17:23:15 tg Exp $
d9 1
a9 1
CVS_DISTREPO=		anoncvs@@anoncvs.ca.openbsd.org:/cvs
@


1.7
log
@bulk convert FLAVOR to FLAVOUR; nuke unused file; convert to $Mdocdate
@
text
@d1 1
a1 1
# $MirOS: ports/net/bind/Makefile,v 1.6 2007/07/25 20:15:35 bsiegert Exp $
a64 1
MODGNU_CONFIG_GUESS_DIRS= ${WRKSRC}
@


1.6
log
@Update bind to 9.3.4-P1 (9.3.4.1-0 for us). That Other BSD says that this
version is not vulnerable to those cache poisoning attacks, but still
switch to ISC's new id generator and MANUALLY apply the patch.

I actually had to download both upstream tarballs and do a recursive diff
as ISC does not provide a patch, only a new version. Oh, and they chose to
integrate some win32 changes as well for good measure. Sigh.
@
text
@d1 1
a1 1
# $MirOS: ports/net/bind/Makefile,v 1.5 2007/03/11 21:05:06 bsiegert Exp $
d38 2
a39 2
FLAVORS=		static threads
FLAVOR?=
d41 1
a41 1
.if defined(PACKAGING) && ${FLAVOR} != "static"
d50 1
a50 1
.if ${FLAVOR:L:Mstatic}
d73 1
a73 1
.if ${FLAVOR:L:Mthreads}
@


1.5
log
@Update Bind to 9.3.4 from OpenBSD. The first update since 20C3, no kidding!

- Use cvs distfile
- libtoolise plist
- use @@sample instead of an install script

commit prodded by tg@@
@
text
@d1 1
a1 1
# $MirOS: ports/net/bind/Makefile,v 1.4 2006/09/14 00:11:34 tg Exp $
d8 1
a8 1
VERSION=		9.3.4
d10 1
a10 1
CVS_DISTDATE=		2007/03/10
@


1.4
log
@clean up COMMENT and HOMEPAGE; regenerate INDEX (2761, 169 marked as broken, probably many many more) ­ edited by script with manual postprocessing
@
text
@d1 1
a1 1
# $MirOS: ports/net/bind/Makefile,v 1.3 2006/02/09 09:36:07 tg Exp $
d4 14
a17 11
COMMENT=			ISC BIND 9 libraries, audited OpenBSD version
COMMENT-server=			ISC BIND 9 server, audited OpenBSD version
COMMENT-client=			ISC BIND 9 client tools, audited OpenBSD version

VERSION=		9.2.3p1
DASHVER=		20031222
DISTNAME=		bind9-${DASHVER}

FULLPKGNAME=		bind-lib-${VERSION}-0
PKGNAME-server=		bind-server-${VERSION}-0
PKGNAME-client=		bind-client-${VERSION}-0
a20 4
MASTER_SITES=		${_MASTER_SITE_MIRBSD}

EXTRACT_SUFX=		.tar.bz2

d24 1
a24 1
# BSD license
d33 2
a34 10
CONFIGURE_STYLE=	gnu
CONFIGURE_ARGS+=	--with-libtool ${CONFIGURE_SHARED} \
			--localstatedir=/var \
			--disable-libbind \
			--with-openssl=/usr \
			--with-randomdev=/dev/arandom
AUTOCONF_NEW=		Yes
MODGNU_CONFIG_GUESS_DIRS= ${WRKSRC}

REGRESS_TARGET=		test
a37 1

d43 1
a43 1
RUN_DEPENDS=		:bind-lib-${VERSION}:net/bind9
d45 2
a46 2
RUN_DEPENDS=		:bind-lib-${VERSION}:net/bind9 \
			:bind-client-${VERSION}:net/bind9
d55 18
d94 1
a94 1
.for file in localhost loopback loopback6.arpa loopback6.int
@


1.3
log
@remove SEPARATE_BUILD for once and for good, I'm fed up with
all the trouble it can cause - ports which need it (e.g. the
GCC SC doesnt "support" building gcc with srcdir=objdir) can
set stuff like WRKBUILD themselves.
@
text
@d1 1
a1 1
# $MirOS: ports/net/bind/Makefile,v 1.2 2005/07/07 21:24:01 bsiegert Exp $
d4 3
a6 3
COMMENT=		"ISC BIND 9 libraries, audited OpenBSD version"
COMMENT-server=		"ISC BIND 9 server, audited OpenBSD version"
COMMENT-client=		"ISC BIND 9 client tools, audited OpenBSD version"
@


1.2
log
@Semi-automatic update of the remaining ports to the new patchlevel format.

Please correct mistakes if you find them :).
@
text
@d1 1
a1 1
# $MirOS$
a33 1
SEPARATE_BUILD=		concurrent
@


1.1
log
@Initial revision
@
text
@d12 3
a14 3
FULLPKGNAME=		bind-lib-${VERSION}
PKGNAME-server=		bind-server-${VERSION}
PKGNAME-client=		bind-client-${VERSION}
@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
