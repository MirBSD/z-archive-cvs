head	1.9;
access;
symbols;
locks; strict;
comment	@# @;


1.9
date	2009.08.16.16.27.41;	author tg;	state Exp;
branches;
next	1.8;
commitid	1004A882F1F72B43308;

1.8
date	2008.10.16.19.43.57;	author tg;	state Exp;
branches;
next	1.7;
commitid	10048F798F722A050E5;

1.7
date	2008.10.04.19.03.20;	author tg;	state Exp;
branches;
next	1.6;
commitid	10048E7BD9A0842B398;

1.6
date	2007.04.13.19.38.45;	author bsiegert;	state Exp;
branches;
next	1.5;
commitid	100461FDC5B065B2EDE;

1.5
date	2006.09.14.00.11.39;	author tg;	state Exp;
branches;
next	1.4;
commitid	10045089C0E234154C3;

1.4
date	2005.07.07.21.24.08;	author bsiegert;	state Exp;
branches;
next	1.3;
commitid	66bc42cd9a7ea714;

1.3
date	2005.04.11.15.56.20;	author tg;	state Exp;
branches;
next	1.2;

1.2
date	2005.04.10.21.50.37;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.03.18.15.48.12;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.03.18.15.48.12;	author tg;	state Exp;
branches;
next	;


desc
@@


1.9
log
@change
‚Ä¢ _PASS_CC back from „Äåmpcc„Äç to „Äå${WRKDIR}/bin/mpcc„Äç (note that the
  former „Äå${WRKDIR:Q}/bin/mpcc„Äç was wrong)
‚Ä¢ all uses of _PASS_CC to either
  ‚Ä£ ${_PASS_CC:T:Q} (when passing, e.g. for libtool ‚Äì this is for use
    when ${WRKDIR}/bin is in $$PATH)
  ‚Ä£ ${_PASS_CC:Q} (when invoking, e.g. in post-build targets ‚Äì only
    these I saw when mechanically doing this; Benny wants to fix the
    remaining ones; I should‚Äôve introduced no more breakage than was)
‚Ä¢ _PASS_CXX/mpcxx just the same

agreed bsiegert@@
@
text
@# $MirOS: ports/net/dss/Makefile,v 1.8 2008/10/16 19:43:57 tg Exp $
# $OpenBSD: Makefile,v 1.4 2003/10/26 23:49:37 naddy Exp $

BROKEN=			unfetchable distfile
#BROKEN=			security issues

ONLY_FOR_PLATFORM=	OpenBSD:*:i386 MirBSD:*:i386

COMMENT=			Darwin Streaming Server
COMMENT-admin=			Darwin Streaming Server, Admin Interface
COMMENT-examples=		Darwin Streaming Server, Example Movies
COMMENT-proxy=			Darwin Streaming Proxy

VERSION=	4.1.3
DISTNAME=	DSS-4_1_3.src

PKGNAME=		dss-${VERSION}-0
FULLPKGNAME=		dss-server-${VERSION}-0
PKGNAME-admin=		dss-admin-${VERSION}-0
PKGNAME-examples=	dss-examples-${VERSION}-0
PKGNAME-proxy=		dss-proxy-${VERSION}-0

CATEGORIES=    	net


# Apple Public Source License (APSL)
PERMIT_PACKAGE_CDROM=	No
PERMIT_PACKAGE_FTP=	No 
PERMIT_DISTFILES_CDROM=	No
PERMIT_DISTFILES_FTP=	No

HOMEPAGE=		http://developer.apple.com/darwin/projects/streaming/

MULTI_PACKAGES=		-admin -examples -proxy
SUBPACKAGE?=

.if ${SUBPACKAGE} == "-admin"
RUN_DEPENDS=		:p5-Net-SSLeay->=1.03:security/p5-Net_SSLeay
.endif

WRKTMP=		${WRKDIR}/tmp

EXAMPLESDIR=	${PREFIX}/share/examples/dss
ADMINHTMLDIR=	${PREFIX}/share/dss/AdminHtml
DOCDIR=		${PREFIX}/share/doc/dss

FETCH_MANUALLY=	"The source to this port may not be automatically fetched" \
		"due to licensing restrictions. You MUST fetch the source" \
		"from http://developer.apple.com/darwin/projects/streaming/ " \
		"manually." \
		"" \
		"Once ${DISTFILES} has been downloaded, move it to" \
		"${FULLDISTDIR} and then restart this build." \
		""

post-patch:
	@@find ${WRKSRC} -type f | xargs perl -pi -e \
		"s|/usr/local|${PREFIX}|g"
	@@find ${WRKSRC} -type f | xargs perl -pi -e \
		"s|/etc|${SYSCONFDIR}|g"
	@@find ${WRKSRC} -type f | xargs perl -pi -e \
		's,^CCFLAGS \+= -O3,#CCFLAGS \+= -O3,g'
	@@find ${WRKSRC} -type f | xargs perl -pi -e \
		's,-g -Wall,-Wall,g'

do-build:
	cd ${WRKSRC}; env CC=${_PASS_CC:T:Q} CFLAGS=${CFLAGS:Q} ./Buildit

post-build:
	rm -fr ${WRKTMP}/{server,proxy}
	mkdir -p ${WRKTMP}/{server,proxy}
	cd ${WRKSRC}; ./DSS_MakeRoot -f ${WRKTMP}/server
	cd ${WRKSRC}; ./DSS_MakeProxyRoot ${WRKTMP}/proxy
	cp ${WRKSRC}/qtaccess ${WRKTMP}/server

do-install:
	${INSTALL_PROGRAM} \
		${WRKTMP}/proxy/StreamingProxy \
		${PREFIX}/sbin/streamingproxy
	${INSTALL_PROGRAM} ${WRKTMP}/server/qtpasswd ${PREFIX}/bin
	${INSTALL_PROGRAM} \
		${WRKTMP}/server/DarwinStreamingServer \
		${PREFIX}/sbin/streamingserver
	${INSTALL_PROGRAM} \
		${WRKTMP}/server/MP3Broadcaster \
		${PREFIX}/bin/mp3broadcaster
	${INSTALL_PROGRAM} \
		${WRKTMP}/server/PlaylistBroadcaster \
		${PREFIX}/bin/playlistbroadcaster
	${INSTALL_PROGRAM} \
		${WRKTMP}/server/streamingadminserver.pl \
		${PREFIX}/sbin/streamingadminserver
	${INSTALL_DATA_DIR} ${DOCDIR}
	${INSTALL_DATA} ${WRKTMP}/proxy/StreamingProxy.html ${DOCDIR}
	${INSTALL_DATA} ${WRKTMP}/server/readme.pdf ${DOCDIR}
	${INSTALL_DATA} ${WRKTMP}/server/3rdPartyAcknowledgements.rtf ${DOCDIR}
	${INSTALL_DATA_DIR} ${ADMINHTMLDIR}
	${INSTALL_DATA_DIR} ${ADMINHTMLDIR}/images 
	${INSTALL_DATA_DIR} ${ADMINHTMLDIR}/includes 
	${INSTALL_DATA} \
		${WRKTMP}/server/AdminHtml/*.{pl,cgi,html} \
		${ADMINHTMLDIR}
	${INSTALL_DATA} \
		${WRKTMP}/server/AdminHtml/images/*.gif \
		${ADMINHTMLDIR}/images
	${INSTALL_DATA} \
		${WRKTMP}/server/AdminHtml/includes/*.js \
		${ADMINHTMLDIR}/includes
.for lang in en de fr ja
	${INSTALL_DATA_DIR} ${ADMINHTMLDIR}/html_${lang}
	${INSTALL_DATA} \
		${WRKTMP}/server/AdminHtml/html_${lang}/* \
		${ADMINHTMLDIR}/html_${lang}
.endfor
	${INSTALL_DATA_DIR} ${EXAMPLESDIR}
	${INSTALL_DATA} \
		${WRKTMP}/proxy/streamingproxy.conf \
		${EXAMPLESDIR}
	${INSTALL_DATA} \
		${WRKTMP}/server/streamingserver.xml \
		${EXAMPLESDIR}
	${INSTALL_DATA} \
		${WRKTMP}/server/relayconfig.xml-Sample \
		${EXAMPLESDIR}/relayconfig.xml
.for file in qtaccess qtusers qtgroups
	${INSTALL_DATA} ${WRKTMP}/server/${file} ${EXAMPLESDIR}
.endfor
	${INSTALL_DATA_DIR} ${EXAMPLESDIR}/movies
	${INSTALL_DATA} ${WRKTMP}/server/*.mov ${EXAMPLESDIR}/movies
	${INSTALL_DATA} ${WRKTMP}/server/*.mp3 ${EXAMPLESDIR}/movies
	${INSTALL_DATA} ${WRKTMP}/server/*.mp4 ${EXAMPLESDIR}/movies

.include <bsd.port.mk>
@


1.8
log
@many more distfile fixes:
either change stuff to let ‚Äúmmake checksum‚Äù succeed, for example by fixing
MASTER_SITES or DIST_SUBDIR, or by adding the ‚ÄúSize‚Äù That Does Matter‚Ñ¢ to
the distinfo (so that b0rken downloads are skipped), or by whatever other
means, or mark b0rken stuff as BROKEN for sure. For squid, I removed one
of the upstream patches from the list.

After this, all non-BROKEN (and some BROKEN and NOT_FOR_PLATFORM) distfiles
verify successfully (and thusly link to FTP/ and CDROM/ on the mirror).
@
text
@d1 1
a1 1
# $MirOS: ports/net/dss/Makefile,v 1.7 2008/10/04 19:03:20 tg Exp $
d67 1
a67 1
	cd ${WRKSRC}; env CC=${_PASS_CC:Q} CFLAGS=${CFLAGS:Q} ./Buildit
@


1.7
log
@mass conversion from
‚Ä¢ ${CC}
‚Ä¢ "${CC}"
‚Ä¢ '${CC}'
‚Ä¢ ${CC:Q}
to ${_PASS_CC:Q} (or without :Q if it‚Äôs executed, not assigned), and
same for CXX‚Ä¶ most of these are VERY UGLY, prone to break with ccache
and maybe even without‚Ä¶
@
text
@d1 1
a1 1
# $MirOS: ports/net/dss/Makefile,v 1.6 2007/04/13 19:38:45 bsiegert Exp $
d4 2
a5 1
BROKEN=			security issues
@


1.6
log
@Fix quoting of BROKEN line
@
text
@d1 1
a1 1
# $MirOS$
d66 1
a66 1
	cd ${WRKSRC}; env CC="${CC}" CFLAGS="${CFLAGS}" ./Buildit
@


1.5
log
@clean up COMMENT and HOMEPAGE; regenerate INDEX (2761, 169 marked as broken, probably many many more) ≠ edited by script with manual postprocessing
@
text
@d1 1
d4 1
a4 1
BROKEN=			"security issues"
d10 1
a10 1
COMMENT-examples=			Darwin Streaming Server, Example Movies
@


1.4
log
@Semi-automatic update of the remaining ports to the new patchlevel format.

Please correct mistakes if you find them :).
@
text
@d7 4
a10 4
COMMENT=		"Darwin Streaming Server"
COMMENT-admin=		"Darwin Streaming Server, Admin Interface"
COMMENT-examples=	"Darwin Streaming Server, Example Movies"
COMMENT-proxy=		"Darwin Streaming Proxy"
@


1.3
log
@the port part of platform refinal
@
text
@d15 5
a19 5
PKGNAME=		dss-${VERSION}
FULLPKGNAME=		dss-server-${VERSION}
PKGNAME-admin=		dss-admin-${VERSION}
PKGNAME-examples=	dss-examples-${VERSION}
PKGNAME-proxy=		dss-proxy-${VERSION}
@


1.2
log
@NOPIC_PLATFORMS, LP64_PLATFORMS and general change of
{NOT,ONLY}_FOR_{ARCH{,E,ES},OS} to {NOT,ONLY}_FOR_PLATFORM

some fallout maybe, I hope not
@
text
@d5 1
a5 1
ONLY_FOR_PLATFORM=	OpenBSD:i386 MirBSD:i386
@


1.1
log
@Initial revision
@
text
@d5 2
a14 2
ONLY_FOR_ARCHS=		i386

@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
