head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2008.05.02.13.31.17;	author tg;	state Exp;
branches;
next	1.1;
commitid	100481B17B36B22A571;

1.1
date	2005.03.18.15.49.18;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.03.18.15.49.18;	author tg;	state Exp;
branches;
next	;


desc
@@


1.2
log
@unbreak, fix, modernise, nuke warnings, libtoolise PLIST
@
text
@$MirOS$
$OpenBSD: patch-snmplib_scapi_c,v 1.1 2002/06/16 20:02:19 pvalchev Exp $
--- snmplib/scapi.c.orig	Mon Oct  1 09:52:27 2001
+++ snmplib/scapi.c	Fri May  2 13:00:52 2008
@@@@ -56,6 +56,7 @@@@
 #include <openssl/hmac.h>
 #include <openssl/evp.h>
 #include <openssl/rand.h>
+#include <des.h>
 #endif
 
 #ifdef QUITFUN
@@@@ -324,6 +325,7 @@@@ sc_hash(oid *hashtype, size_t hashtypele
 #ifdef USE_OPENSSL 
   EVP_MD *hash(void);
   HMAC_CTX *c = NULL; 
+  unsigned int rMAC_len;
 #endif
 
   DEBUGTRACE;
@@@@ -351,7 +353,8 @@@@ sc_hash(oid *hashtype, size_t hashtypele
     return(SNMPERR_GENERR);
   }
   EVP_DigestUpdate(&c->md_ctx, buf, buf_len);
-  EVP_DigestFinal(&(c->md_ctx), MAC, MAC_len);
+  EVP_DigestFinal(&(c->md_ctx), MAC, &rMAC_len);
+  *MAC_len = rMAC_len;
   free(c);
   return (rval);
 #else /* USE_INTERNAL_MD5 */
@@@@ -593,11 +596,11 @@@@ sc_encrypt(	oid    *privtype,	size_t pri
 
 		memcpy(my_iv, iv, ivlen);
 		/* encrypt the data */
-		des_ncbc_encrypt(plaintext, ciphertext, plast, key_sch, 
+		des_ncbc_encrypt((des_cblock *)plaintext, (des_cblock *)ciphertext, plast, key_sch, 
 				 (des_cblock *) my_iv, DES_ENCRYPT);
                 if (pad > 0) {
                     /* then encrypt the pad block */
-                    des_ncbc_encrypt(pad_block, ciphertext+plast, pad_size, 
+                    des_ncbc_encrypt((des_cblock *)pad_block, (des_cblock *)(ciphertext+plast), pad_size, 
                                      key_sch, (des_cblock *)my_iv, DES_ENCRYPT);
                     *ctlen = plast + pad_size;
                 } else {
@@@@ -715,7 +718,7 @@@@ sc_decrypt(	oid    *privtype,	size_t pri
 		(void) des_key_sched(&key_struct, key_sch);
 	
 		memcpy(my_iv, iv, ivlen);
-		des_cbc_encrypt(ciphertext, plaintext, ctlen, key_sch, 
+		des_cbc_encrypt((des_cblock *)ciphertext, (des_cblock *)plaintext, ctlen, key_sch, 
 				(des_cblock *) my_iv, DES_DECRYPT);
                 *ptlen = ctlen;
 	}
@


1.1
log
@Initial revision
@
text
@d1 1
d3 2
a4 2
--- snmplib/scapi.c.orig	Sun Jun 16 13:48:32 2002
+++ snmplib/scapi.c	Sun Jun 16 13:48:55 2002
d13 41
@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
