head	1.52;
access;
symbols;
locks; strict;
comment	@# @;


1.52
date	2017.03.15.22.45.22;	author tg;	state Exp;
branches;
next	1.51;
commitid	10058C9C41A0C975C95;

1.51
date	2016.08.11.20.19.07;	author tg;	state Exp;
branches;
next	1.50;
commitid	10057ACDDC90C549100;

1.50
date	2016.07.29.19.38.57;	author tg;	state Exp;
branches;
next	1.49;
commitid	100579BB0D62C0C7F51;

1.49
date	2016.06.12.22.28.38;	author tg;	state Exp;
branches;
next	1.48;
commitid	100575DE22040948CDE;

1.48
date	2016.03.26.17.28.56;	author tg;	state Exp;
branches;
next	1.47;
commitid	10056F6C535787D61F0;

1.47
date	2014.06.09.14.21.59;	author tg;	state Exp;
branches;
next	1.46;
commitid	1005395C31B36A73DD1;

1.46
date	2013.09.10.18.40.40;	author tg;	state Exp;
branches;
next	1.45;
commitid	100522F67C114F9BF81;

1.45
date	2013.08.14.21.01.20;	author tg;	state Exp;
branches;
next	1.44;
commitid	100520BF03833095B50;

1.44
date	2013.01.05.01.50.13;	author tg;	state Exp;
branches;
next	1.43;
commitid	10050E786EB7BEC335E;

1.43
date	2011.11.20.01.38.37;	author tg;	state Exp;
branches;
next	1.42;
commitid	1004EC85A340D5FE8FB;

1.42
date	2011.08.27.22.14.59;	author tg;	state Exp;
branches;
next	1.41;
commitid	1004E596C7A1A82B910;

1.41
date	2009.07.18.12.26.00;	author tg;	state Exp;
branches;
next	1.40;
commitid	1004A61BF6E1492B1EB;

1.40
date	2009.05.30.22.12.40;	author tg;	state Exp;
branches;
next	1.39;
commitid	1004A21AF201444134C;

1.39
date	2009.05.30.21.53.52;	author tg;	state Exp;
branches;
next	1.38;
commitid	1004A21AAF23C8ECC05;

1.38
date	2009.05.30.21.52.28;	author tg;	state Exp;
branches;
next	1.37;
commitid	1004A21AA7B58FF2D17;

1.37
date	2009.05.30.21.40.28;	author tg;	state Exp;
branches;
next	1.36;
commitid	1004A21A7D6044C01D7;

1.36
date	2008.11.08.23.03.56;	author tg;	state Exp;
branches;
next	1.35;
commitid	10049161AC72620EAF0;

1.35
date	2008.10.27.21.40.36;	author tg;	state Exp;
branches;
next	1.34;
commitid	100490634E663D82993;

1.34
date	2008.05.01.00.52.34;	author tg;	state Exp;
branches;
next	1.33;
commitid	1004819145953F55377;

1.33
date	2008.03.17.02.10.49;	author tg;	state Exp;
branches;
next	1.32;
commitid	10047DDD31A23EBBE26;

1.32
date	2008.03.09.17.23.16;	author tg;	state Exp;
branches;
next	1.31;
commitid	10047D41CAA7E715397;

1.31
date	2007.02.09.15.25.09;	author tg;	state Exp;
branches;
next	1.30;
commitid	10045CC926B2C6699C4;

1.30
date	2006.11.16.21.51.55;	author tg;	state Exp;
branches;
next	1.29;
commitid	100455CDD8B0A2BB995;

1.29
date	2006.11.16.21.27.41;	author tg;	state Exp;
branches;
next	1.28;
commitid	100455CD7E35DD2962C;

1.28
date	2006.11.16.20.24.39;	author tg;	state Exp;
branches;
next	1.27;
commitid	100455CC91E7AB63CBA;

1.27
date	2006.09.14.00.11.38;	author tg;	state Exp;
branches;
next	1.26;
commitid	10045089C0E234154C3;

1.26
date	2006.08.26.16.46.55;	author tg;	state Exp;
branches;
next	1.25;
commitid	10044F07B0818D7B74C;

1.25
date	2006.08.13.02.17.28;	author tg;	state Exp;
branches;
next	1.24;
commitid	10044DE8BC71B09B82C;

1.24
date	2006.08.10.15.31.55;	author tg;	state Exp;
branches;
next	1.23;
commitid	10044DB51566C83CF2A;

1.23
date	2006.07.27.01.15.34;	author tg;	state Exp;
branches;
next	1.22;
commitid	10044C813CC55B921AF;

1.22
date	2006.07.27.00.58.10;	author tg;	state Exp;
branches;
next	1.21;
commitid	10044C80EE124197593;

1.21
date	2006.06.15.01.43.14;	author tg;	state Exp;
branches;
next	1.20;
commitid	1004490BB236D1F4B88;

1.20
date	2006.03.27.21.28.22;	author tg;	state Exp;
branches;
next	1.19;
commitid	100442858EF0A0704E9;

1.19
date	2006.03.24.22.25.16;	author tg;	state Exp;
branches;
next	1.18;
commitid	100442471D02BCAAFAA;

1.18
date	2006.02.21.13.07.35;	author tg;	state Exp;
branches;
next	1.17;
commitid	10043FB10AC7B349D0B;

1.17
date	2006.02.18.16.53.47;	author tg;	state Exp;
branches;
next	1.16;
commitid	10043F751292FA8A01E;

1.16
date	2006.01.24.21.54.21;	author tg;	state Exp;
branches;
next	1.15;
commitid	10043D6A21654DAA21E;

1.15
date	2006.01.17.22.40.37;	author tg;	state Exp;
branches;
next	1.14;
commitid	10043CD71AE7CE50D89;

1.14
date	2006.01.17.21.13.39;	author tg;	state Exp;
branches;
next	1.13;
commitid	10043CD5DF843EBF979;

1.13
date	2006.01.17.21.08.43;	author tg;	state Exp;
branches;
next	1.12;
commitid	10043CD5CEA3957D3C1;

1.12
date	2006.01.17.20.55.32;	author tg;	state Exp;
branches;
next	1.11;
commitid	10043CD59A91A442803;

1.11
date	2006.01.17.20.45.41;	author tg;	state Exp;
branches;
next	1.10;
commitid	10043CD575B2AADC8AB;

1.10
date	2006.01.15.12.57.45;	author tg;	state Exp;
branches;
next	1.9;
commitid	10043CA46CF54F0E0A5;

1.9
date	2005.12.14.23.27.51;	author tg;	state Exp;
branches;
next	1.8;
commitid	10043A0AA0E5A220A51;

1.8
date	2005.12.06.20.37.25;	author tg;	state Exp;
branches;
next	1.7;
commitid	d8a4395f6846666;

1.7
date	2005.12.05.15.55.29;	author tg;	state Exp;
branches;
next	1.6;
commitid	777e439462d8d925;

1.6
date	2005.08.21.11.49.39;	author tg;	state Exp;
branches;
next	1.5;
commitid	3af74308676450c3;

1.5
date	2005.07.07.21.24.07;	author bsiegert;	state Exp;
branches;
next	1.4;
commitid	66bc42cd9a7ea714;

1.4
date	2005.07.02.10.44.13;	author tg;	state Exp;
branches;
next	1.3;
commitid	4fc742c66feea733;

1.3
date	2005.05.14.23.24.02;	author tg;	state Exp;
branches;
next	1.2;
commitid	65ae428688a783cb;

1.2
date	2005.05.14.23.19.35;	author tg;	state dead;
branches;
next	1.1;
commitid	111042868783e878;

1.1
date	2005.03.18.15.48.07;	author tg;	state Exp;
branches
	1.1.7.1
	1.1.201.1;
next	;

1.1.7.1
date	2005.03.18.15.48.07;	author tg;	state Exp;
branches;
next	;

1.1.201.1
date	2005.05.14.23.21.01;	author tg;	state Exp;
branches;
next	;
commitid	1e94428687d39445;


desc
@@


1.52
log
@finally fixâ€¦
@
text
@# $MirOS: ports/net/djbdns/Makefile,v 1.51 2016/08/11 20:19:07 tg Exp $

COMMENT=		collection of Domain Name System server and tools
VERSION=		1.05
CATEGORIES=		net
DISTNAME=		djbdns-${VERSION}
DASH_VER=		48
MANVER=			20031023
HOMEPAGE=		http://cr.yp.to/djbdns.html
RESPONSIBLE=		Thorsten Glaser <tg@@mirbsd.org>

# Public Domain: http://cr.yp.to/distributors.html
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

FLAVOURS=		eorsn icann opennic
FLAVOUR?=		icann

DISTFILES=		${DISTNAME}${EXTRACT_SUFX} \
			${DISTNAME}-man-${MANVER}${EXTRACT_SUFX}:0
MASTER_SITES=		http://cr.yp.to/djbdns/ \
			ftp://ftp.id.wustl.edu/pub/qmail/
MASTER_SITES0=		http://smarden.org/pape/djb/manpages/

RUN_DEPENDS=		::sysutils/daemontools
NO_REGRESS=		Yes

.undef DNSROOT

# root hints:		ftp://ftp.internic.net/domain/named.root.sig
# root hints:		ftp://ftp.internic.net/domain/named.root
.if ${FLAVOUR:L:Micann}
.  ifdef DNSROOT
BROKEN=			Multiple DNS Roots chosen; invalid combination
.  else
DNSROOT=		icann
.  endif
.endif

# public resolvers:	2a01:7e0::212:224:71:71 212.224.71.71 79.133.62.62
# root hints:		http://www.orsn.org/roothint/root-hint.txt
.if ${FLAVOUR:L:Meorsn}
.  ifdef DNSROOT
BROKEN=			Multiple DNS Roots chosen; invalid combination
.  else
DNSROOT=		eorsn
.  endif
.endif

# public resolvers:	185.27.253.92 62.141.38.230 78.138.98.82 78.138.97.33
# root hints:		$(dig . NS @@75.127.96.89)
.if ${FLAVOUR:L:Mopennic}
.  ifdef DNSROOT
BROKEN=			Multiple DNS Roots chosen; invalid combination
.  else
DNSROOT=		opennic
.  endif
.endif

.if !defined(DNSROOT) || ${DNSROOT} == ""
BROKEN=			choose a DNS Root flavour (suggest: eorsn)
.endif

WRKDIST=		${WRKDIR}
WRKSRC=			${WRKDIR}/build
CONFIGURE_STYLE=	simple
CONFIGURE_ENV+=		TOP=${WRKDIR} SYSCONFDIR=${SYSCONFDIR:Q}
MAKE_ENV+=		TOP=${WRKDIR}
CPPFLAGS+=		-D_SYSCONFDIR=\"${SYSCONFDIR:Q}\"
CPPFLAGS+=		-D_DJBDNS_PORT_V=\"${PKGNAME:Q}\"
CPPFLAGS+=		-D_PATH_MKSH=\"${MKSH:Q}\"

post-extract:
	cd ${FILESDIR}; pax -rw build ${WRKDIR}
	cd ${WRKDIR}; mv djbdns-${VERSION} src; mv djbdns-man man

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/djbdns
	${INSTALL_DATA} ${FILESDIR}/data/dnsroots.${DNSROOT} \
	    ${PREFIX}/share/djbdns/dnsroots.global

.include <bsd.port.mk>
@


1.51
log
@completely re-do Fefeâ€™s find_client_loc refactoring, but do it right instead
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.50 2016/07/29 19:38:57 tg Exp $
d7 1
a7 1
DASH_VER=		47
@


1.50
log
@fix arpa. length (vs. int.)
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.49 2016/06/12 22:28:38 tg Exp $
d7 1
a7 1
DASH_VER=		46
@


1.49
log
@prevent use-after-free in the face of CNAMEs and stupid remote servers
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.48 2016/03/26 17:28:56 tg Exp $
d7 1
a7 1
DASH_VER=		45
@


1.48
log
@complete overhaul of djbdns port:

â€¢ merge t4/t6 flavours back into one binary
  â€£ greatly simplify IPv6 handling, too; drop code for v6-less OSes
â€¢ merge v4/v6 dnsroots back into one, update all of them
â€¢ improve documentation a bit
â€¢ apply two patches from http://www.your.org/dnscache/ (SECURITY):
  â€£ merge identical outgoing requests
  â€£ allow caching SOA responses
â€¢ update to Fefeâ€™s djbdns-1.05-test27.diff.bz2
  â€£ fixes recursively resolving hosts behind IPv6-only nameservers;
    spotted by Natureshadow (for Teckidsâ€™ Lunatics network) and via
    http://serverfault.com/q/627912/189656 (which Iâ€™ll answer RSN)
  âš  fix with â€œone secondâ€ CDB validity patch
  âš  adapt for OpenBSD-style IPv6
â€¢ drop ip6.int. reverse v6 DNS for good
â€¢ improve dealing with mixing v4/v6 transport
  â‡’ TODO add IP4SEND/IP6SEND support; currently; if IPSEND is v6
    but we send to a v4 server, we use INADDR_ANY for outgoing,
    as automatic fallback address
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.47 2014/06/09 14:21:59 tg Exp $
d7 1
a7 1
DASH_VER=		44
@


1.47
log
@update all root hints again
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.46 2013/09/10 18:40:40 tg Exp $
d7 1
a7 1
DASH_VER=		43
a38 1
DNSROOT6=		icann
a48 1
DNSROOT6=		eorsn6
a58 1
DNSROOT6=		opennic6
a78 5
post-build:
	cat ${FILESDIR}/data/dnsroots.${DNSROOT6} \
	    ${FILESDIR}/data/dnsroots.${DNSROOT} \
	    >${WRKBUILD}/dnsroots.6+4

a82 2
	${INSTALL_DATA} ${WRKBUILD}/dnsroots.6+4 \
	    ${PREFIX}/share/djbdns/dnsroots.global.v6
@


1.46
log
@hook up OpenNIC again
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.45 2013/08/14 21:01:20 tg Exp $
d7 1
a7 1
DASH_VER=		42
d32 2
d44 1
d54 2
a55 1
# public resolvers:	2a01:4f8:161:1ffa::e 84.200.79.111 217.6.34.47
@


1.45
log
@European ORSN is backâ£ (but keep ICANâ€™T default for now)
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.44 2013/01/05 01:50:13 tg Exp $
d18 1
a18 1
FLAVOURS=		eorsn icann
d51 10
@


1.44
log
@gecko2@@ pointed out to re-check the ICANâ€™t root nameservers: 2 new IPs and 1 changed(!!!) Legacy IP
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.43 2011/11/20 01:38:37 tg Exp $
d18 3
d30 25
d69 3
a71 2
	cat ${FILESDIR}/data/dnsroots.icann6 ${FILESDIR}/data/dnsroots.icann \
	    >${WRKBUILD}/dnsroots.icann6+4
d75 1
a75 1
	${INSTALL_DATA} ${FILESDIR}/data/dnsroots.icann \
d77 1
a77 1
	${INSTALL_DATA} ${WRKBUILD}/dnsroots.icann6+4 \
@


1.43
log
@stop using <sys/taitime.h> API
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.42 2011/08/27 22:14:59 tg Exp $
d7 1
a7 1
DASH_VER=		41
@


1.42
log
@fix nroff

(thatâ€™s what you get for writing man(7) not mdoc(7) which is far better)
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.41 2009/07/18 12:26:00 tg Exp $
d7 1
a7 1
DASH_VER=		40
@


1.41
log
@plug CVE-2009-0858, from Debian
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.40 2009/05/30 22:12:40 tg Exp $
d7 1
a7 1
DASH_VER=		39
@


1.40
log
@The line
â”‚    if (byte_equal(ip+12,4,V6any)) c=V6any;
is wrong in just so many ways. Firstly, it must be
â”‚    if (byte_equal(ip+12,4,V4any)) c=V6any;
of course (hello Felix). Secondly, it just is broken.

0.0.0.0 is *not* the same as [::] but [::FFFF:0.0.0.0]
in this software. You shanâ€™t bind to [::] if I set the
env/IP variable to 0.0.0.0, ever. Dual vs Doble Stack.
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.39 2009/05/30 21:53:52 tg Exp $
d7 1
a7 1
DASH_VER=		38
@


1.39
log
@use IPv6 *and* IPv4 servers in dnscachet6-conf, for both work with the
current code, but not both may be reachable in all situations
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.38 2009/05/30 21:52:28 tg Exp $
d7 1
a7 1
DASH_VER=		37
@


1.38
log
@For IPv6 transport binaries, the ability (bugfix) to use more than four
root/forward servers per zone, since sixteen were allocated no matter
the protocol. For IPv6 transport, doubling the number of allowed root
or forward servers per zone to 32.
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.37 2009/05/30 21:40:28 tg Exp $
d7 1
a7 1
DASH_VER=		36
d40 4
d48 1
a48 1
	${INSTALL_DATA} ${FILESDIR}/data/dnsroots.icann6 \
@


1.37
log
@The ability for dnscachet6 to listen on IPv4 addresses.
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.36 2008/11/08 23:03:56 tg Exp $
d7 1
a7 1
DASH_VER=		35
@


1.36
log
@more mass conversions, including ancient eMail addresses
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.35 2008/10/27 21:40:36 tg Exp $
d7 1
a7 1
DASH_VER=		34
@


1.35
log
@â€¢ remove FLAVOURs
  â€£ OpenNIC has been EUNREACH for a while
  â€£ ORSN is shutting down :'(
    according to http://www.heise.de/newsticker/meldung/117863
â€¢ ICANN is now default for IPv4 and IPv6 root
  .oO(wow, since when do they have IPv6? not for too longâ€¦)
â€¢ fix compile warnings (missing includes) while here
â€¢ remove pkg/ subdirectory while here
â€¢ merge pkg/MESSAGE text into DESCR
â€¢ UTF-8ify DESCR

XXX still missing: IPv6 transport integration into normal binaries
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.34 2008/05/01 00:52:34 tg Exp $
d10 1
a10 1
RESPONSIBLE=		Thorsten Glaser <tg@@66h.42h.de>
@


1.34
log
@remove the advertising clause from all of my contributions
to the MirPorts Framework
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.33 2008/03/17 02:10:49 tg Exp $
d7 1
a7 1
DASH_VER=		33
a17 3
FLAVOURS=		eorsn icann opennic
FLAVOUR?=		eorsn

a26 31
.undef DNSROOT
DNSROOT6=		eorsn6

.if ${FLAVOUR:L:Mopennic}
.  ifdef DNSROOT
BROKEN=			Multiple DNS Roots chosen; invalid combination
.  else
DNSROOT=		opennic
.  endif
.endif

.if ${FLAVOUR:L:Micann}
.  ifdef DNSROOT
BROKEN=			Multiple DNS Roots chosen; invalid combination
.  else
DNSROOT=		icann
.  endif
.endif

.if ${FLAVOUR:L:Meorsn}
.  ifdef DNSROOT
BROKEN=			Multiple DNS Roots chosen; invalid combination
.  else
DNSROOT=		eorsn
.  endif
.endif

.if !defined(DNSROOT) || ${DNSROOT} == ""
BROKEN=			choose a DNS Root flavour (default: eorsn)
.endif

d42 1
a42 1
	${INSTALL_DATA} ${FILESDIR}/data/dnsroots.${DNSROOT} \
d44 1
a44 1
	${INSTALL_DATA} ${FILESDIR}/data/dnsroots.${DNSROOT6} \
@


1.33
log
@these are now public domain, as of 2007-12-28
thanks Prof. Bernstein!

this means that MirOS #11 will come with dÃ¦montools in base, finally!
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.32 2008/03/09 17:23:16 tg Exp $
d7 1
a7 1
DASH_VER=		32
@


1.32
log
@bulk convert FLAVOR to FLAVOUR; nuke unused file; convert to $Mdocdate
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.31 2007/02/09 15:25:09 tg Exp $
d7 1
a8 1
PKGNAME=		djbdns-${VERSION}-32
d12 3
a14 2
# May distribute unchanged distfiles. May distribute patches.
# Must not distribute binaries (changed or not).
a16 2
PERMIT_PACKAGE_CDROM=	"http://cr.yp.to/distributors.html"
PERMIT_PACKAGE_FTP=	"http://cr.yp.to/distributors.html"
@


1.31
log
@update dnsroots.eorsn and dnsroots.eorsn6 from http://european.nl.orsn.net/rootcache.php
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.30 2006/11/16 21:51:55 tg Exp $
d19 2
a20 2
FLAVORS=		eorsn icann opennic
FLAVOR?=		eorsn
d34 1
a34 1
.if ${FLAVOR:L:Mopennic}
d42 1
a42 1
.if ${FLAVOR:L:Micann}
d50 1
a50 1
.if ${FLAVOR:L:Meorsn}
@


1.30
log
@bump version due to root zone changes
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.29 2006/11/16 21:27:41 tg Exp $
d8 1
a8 1
PKGNAME=		djbdns-${VERSION}-31
@


1.29
log
@unbreak, oops
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.28 2006/11/16 20:24:39 tg Exp $
d8 1
a8 1
PKGNAME=		djbdns-${VERSION}-30
@


1.28
log
@dito
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.27 2006/09/14 00:11:38 tg Exp $
d66 1
a66 1
EXTRA_MAKE_ENV+=	TOP=${WRKDIR}
@


1.27
log
@clean up COMMENT and HOMEPAGE; regenerate INDEX (2761, 169 marked as broken, probably many many more) ­ edited by script with manual postprocessing
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.26 2006/08/26 16:46:55 tg Exp $
d3 1
a3 1
COMMENT=			collection of Domain Name System server and tools
a18 2
FETCH_CMD=		lynx -source >$$f

d66 1
a66 1
MAKE_ENV+=		TOP=${WRKDIR}
@


1.26
log
@* use arc4random(3) more
* remove OS limitation, we'll be providing it in libmirmake soon
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.25 2006/08/13 02:17:28 tg Exp $
d3 1
a3 1
COMMENT=		"collection of Domain Name System server and tools"
@


1.25
log
@use pax(1) instead of find(1) | cpio(1)
@
text
@d1 1
a1 4
# $MirOS: ports/net/djbdns/Makefile,v 1.24 2006/08/10 15:31:55 tg Exp $

# uses arc4random(3)
ONLY_FOR_PLATFORM=	MirBSD:*:* OpenBSD:*:*
d8 1
a8 1
PKGNAME=		djbdns-${VERSION}-29
@


1.24
log
@zonenotify cleanup:
* move includes to .c file
* fixup .h (multiple inclusion protection, __BEGIN/END_DECLS)
* cause was used uninitialisedly, causing core dumps

now __CRAZY clean
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.23 2006/07/27 01:15:34 tg Exp $
d77 1
a77 2
	cd ${FILESDIR}; find build -type f \! -path \*CVS\* \
	    | cpio -pdu ${WRKDIR}/
@


1.23
log
@oeps, possible bug
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.22 2006/07/27 00:58:10 tg Exp $
d11 1
a11 1
PKGNAME=		djbdns-${VERSION}-28
@


1.22
log
@* make zonenotify connect to IPv6 (DNS or numeric) too
* make zonenotify connect to all IPs of the hostname given
* make axfrdns log IPv6 addresses (have to move it though)
  XXX pending making DJB_V6ONLY the default and only case
* put fromhex into common file while here
* centralise licence info for my diffs while here
* bump patchlevel

new zonenotify loosely tested, new axfrdns log format seems okay
thanks gecko2 for providing bind9 backup NS on ipv6
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.21 2006/06/15 01:43:14 tg Exp $
d11 1
a11 1
PKGNAME=		djbdns-${VERSION}-27
@


1.21
log
@* enable tinydnst6 to listen on IPv4 addresses too
  (do I have all now? if so, can I nuke the v4 transport versions?)
* fix a buglet in my :: address fix
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.20 2006/03/27 21:28:22 tg Exp $
d11 1
a11 1
PKGNAME=		djbdns-${VERSION}-26
@


1.20
log
@my previous patch fixed :: but not 1::
this one should do it

thanks to Fefe <leitner@@codeblau.de> for, ahem, reminding me;
patch sent to him again
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.19 2006/03/24 22:25:16 tg Exp $
d11 1
a11 1
PKGNAME=		djbdns-${VERSION}-25
@


1.19
log
@ip6_scan: fix return value for case of parsing "::"
unbreaks running tinydnst6 on IN6ADDR_ANY
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.18 2006/02/21 13:07:35 tg Exp $
d11 1
a11 1
PKGNAME=		djbdns-${VERSION}-24
@


1.18
log
@use lynx here, too
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.17 2006/02/18 16:53:47 tg Exp $
d11 1
a11 1
PKGNAME=		djbdns-${VERSION}-23
@


1.17
log
@sync opennic and e-orsn root zones by querying them directly
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.16 2006/01/24 21:54:21 tg Exp $
d22 2
@


1.16
log
@it's settled, let's use /usr/bin/logger for axfrdns under inetd(8)
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.15 2006/01/17 22:40:37 tg Exp $
d11 1
a11 1
PKGNAME=		djbdns-${VERSION}-22
@


1.15
log
@* there is no axfrdns with IPv6 transport¹²
* add inetd wrapper for axfrdns²
* write out the wrapper correctly automatically in axfrdns-conf(8)
* document that
* mark as for MirOS BSD and OpenBSD only due to arc4random(3) usage
* add port version (for zonenotify) and mksh path (for the
  inetd wrapper in axfrdns-conf) to CPPFLAGS
* build zonenotify
* tinydns-data: fix warnings (conversion)
* sync PLIST
* bump package version

¹) unless you tweak UCSPI-TCP
²) or inetd.conf (tcp4, tcp6)

tested against a 'dig @@1.2.3.4 axfr my.domain' on an openbsd box,
so I suppose it works ok
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.14 2006/01/17 21:13:39 tg Exp $
d11 1
a11 1
PKGNAME=		djbdns-${VERSION}-21
@


1.14
log
@Apply http://tinydns.org/one-second.patch

| From nelson@@crynwr.com Sat Jul 23 15:19:58 2005
| X-VM-v5-Data: ([nil nil nil nil nil nil nil nil nil]
| 	["1512" "Tuesday" "20" "April" "2004" "13:06:49" "+0200" "Lennert Buytenhek" "buytenh@@wantstofly.org" nil "61" "patch to make djbdns 1.05 cache its mmap() of the data.cdb file" "^From:" nil nil "4" nil nil nil nil nil nil nil nil nil]
| 	nil)
| Return-Path: <nelson@@crynwr.com>
| Delivered-To: nelson@@desk.crynwr.com
| Received: (qmail 9047 invoked by alias); 23 Jul 2005 15:19:58 -0000
| Delivered-To: alias-nelson-nelson@@crynwr.com
| Received: (qmail 9044 invoked by uid 500); 23 Jul 2005 15:19:58 -0000
| Comment: DomainKeys? See http://antispam.yahoo.com/domainkeys
| DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
|   s=dog; d=wantstofly.org;
|   b=IWNClqptgImEp3WfkGIht8VKuoHgvQcYS2QB6tjfjVSIFs+iulN4Fg1yMtJiDL3D  ;
| Message-ID: <20050723151958.9042.qmail@@desk.crynwr.com>
| X-Original-To: buytenh
| Delivered-To: buytenh@@wantstofly.org
| User-Agent: Mutt/1.4.1i
| X-Keywords:
| X-UID: 800
| From: Lennert Buytenhek <buytenh@@wantstofly.org>
| To: nelson@@crynwr.com
| Subject: patch to make djbdns 1.05 cache its mmap() of the data.cdb file
| Date: Tue, 20 Apr 2004 13:06:49 +0200
|
| Hi,
|
| This patch makes djbdns 1.05 cache its mmap() of the data.cdb file up to a
| maximum of one second.  Under high query load, this substantially reduces
| the number of times that the database file needs to be mapped and unmapped,
| and gives a two-digit percentage performance improvement under 100% system
| load (as discussed on the djbdns mailing list.)
|
| Could you stick a copy of the patch on www.tinydns.org please?  I don't
| have anywhere to host it myself at this point, and I would like to see it
| on that page -- is that acceptable to you?
|
|
| thanks,
| Lennert
@
text
@d1 4
a4 1
# $MirOS: ports/net/djbdns/Makefile,v 1.13 2006/01/17 21:08:43 tg Exp $
d11 1
a11 1
PKGNAME=		djbdns-${VERSION}-20
d71 2
@


1.13
log
@Hand-apply http://www.ohse.de/uwe/patches/dnscache-0.61.okclient.patch
and document; bump patchlevel
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.12 2006/01/17 20:55:32 tg Exp $
d8 1
a8 1
PKGNAME=		djbdns-${VERSION}-19
@


1.12
log
@Apply http://www.iecc.com/rbldns-patch.txt and bump:

| This tiny patch to rbldns adds records for the root of the zone.  That
| is, if the rbldns zone is bad.example.com, with entries like
| 3.0.0.127.bad.example.com, you can now also have A and TXT records for
| plain bad.example.com.  I did this for my korea.services.net zone,
| since potential users keep typing korea.services.net into their web
| browsers and expecting something useful to happen.
|
| There's one new record type in the data file, a line starting with an
| exclamation point, in the same format as the colon record, e.g.
|
|   !10.11.12.13:See http://bad.example.com
|
| (Unlike in a colon record, a $ at the end of the text isn't special.)
|
| No warranty expressed or implied.  If you find bugs, feel free to fix
| them.
| 			- John Levine, May 2002
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.11 2006/01/17 20:45:41 tg Exp $
d8 1
a8 1
PKGNAME=		djbdns-${VERSION}-18
@


1.11
log
@Apply http://tinydns.org/srv-patch, bump patchlevel:

| From: Michael Handler <handler@@sub-rosa.com>
| To: dns@@list.cr.yp.to
| Subject: tinydns-data SRV & axfr-get SRV/PTR patches
| Date: Thu, 14 Sep 2000 20:37:50 -0400
|
| Here's a combined patch that:
|
| a) adds a native SRV type to tinydns-data
|
| Sfqdn:ip:x:port:weight:priority:ttl:timestamp
|
| Standard rules for ip, x, ttl, and timestamp apply. Port, weight, and
| priority all range from 0-65535. Weight and priority are optional; they
| default to zero if not provided.
|
| Sconsole.zoinks.example.com:1.2.3.4:rack102-con1:2001:69:7:300:
|
| b) makes axfr-get decompose SRV and PTR records and write them out in
| native format, rather than opaque. Again, this is necessary because if the
| DNAME fields in the records reference the same zone as fqdn, they can have
| compression pointers that are bogus outside the context of that specific
| packet, and which can't be correctly loaded into data.cdb by tinydns-data.
|
| --michael
|
| Laurent G. Bercot <ska-djbdns@@skarnet.org> updated it for djbdns-1.05:
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.10 2006/01/15 12:57:45 tg Exp $
d8 1
a8 1
PKGNAME=		djbdns-${VERSION}-17
@


1.10
log
@found a new upstream for manual page tarballs;
they are even versioned now; update, sync, bump
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.9 2005/12/14 23:27:51 tg Exp $
d8 1
a8 1
PKGNAME=		djbdns-${VERSION}-16
@


1.9
log
@* update to fefe's djbdns-1.05-test23.diff
  with djbdns-1.05-ixfr.diff
* slightly change naming of v6-transport binaries
* consolidate all added source files in a central directory
  so it can be reused by the v6-transport stuff
* integrate the v6 transport binaries
* fix spacing
* sync descriptive texts with reality
* sync European ORSN (v4 and v6) to their root.hint
* sync OpenNIC too
* Open-RSC seeminly ceased to exist recently
* Apply compiler-temporary-filename.patch
  from http://homepages.tesco.net/~J.deBoynePollard/FGA/djbdns-problems.html
* apply dnscache-cname-handling.patch
* apply dnscache-strict-forwardonly.patch w/ IPv6 tweak
* apply dnscacheip-space-separator.patch
* apply tinydns-alias-chain-truncation.patch
* apply tinydns-data-semantic-error.patch
  appropriately for 6 and 3, too
* fix shell code and path to includes
* fix relative paths
* fix names of library and programmes; NOMAN=yes here (t6)
* Add support for the IPv6 transport module to communicate,
  as a client, with IPv4 transport name servers as well.

  WFM
* build it with -Wall -Werror
* honour ${SYSCONFDIR} throughout the port
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.8 2005/12/06 20:37:25 tg Exp $
d7 2
a8 1
PKGNAME=		djbdns-${VERSION}-15
d23 1
a23 1
			${DISTNAME}-man${EXTRACT_SUFX}:0
d26 1
a26 1
MASTER_SITES0=		${_MASTER_SITE_MIRBSD}
@


1.8
log
@assume no mix (we did have a flag day, didn't we?)
XXX still didn't test the port... and no ipv6 and fixes either
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.7 2005/12/05 15:55:29 tg Exp $
d7 1
a7 1
PKGNAME=		djbdns-${VERSION}-11
d18 1
a18 1
FLAVORS=		eorsn icann opennic orsc
d31 1
a31 1
DNSROOT6=	eorsn6
d35 1
a35 1
BROKEN=		Multiple DNS Roots chosen; invalid combination
d37 1
a37 9
DNSROOT=	opennic
.  endif
.endif

.if ${FLAVOR:L:Morsc}
.  ifdef DNSROOT
BROKEN=		Multiple DNS Roots chosen; invalid combination
.  else
DNSROOT=	orsc
d43 1
a43 1
BROKEN=		Multiple DNS Roots chosen; invalid combination
d45 1
a45 1
DNSROOT=	icann
d51 1
a51 1
BROKEN=		Multiple DNS Roots chosen; invalid combination
d53 1
a53 1
DNSROOT=	eorsn
d58 1
a58 1
BROKEN=		choose a DNS Root flavour (default: eorsn)
d64 1
a64 1
CONFIGURE_ENV+=		TOP=${WRKDIR}
d66 1
@


1.7
log
@correct a version number conversion mistake
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.6 2005/08/21 11:49:39 tg Exp $
d7 1
a7 1
PKGNAME=		djbdns-${VERSION}q-11
@


1.6
log
@_DOMAIN_DU_JOUR dies
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.5 2005/07/07 21:24:07 bsiegert Exp $
d7 1
a7 1
PKGNAME=		djbdns-${VERSION}q-11-0
@


1.5
log
@Semi-automatic update of the remaining ports to the new patchlevel format.

Please correct mistakes if you find them :).
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.3 2005/05/14 23:24:02 tg Exp $
d9 1
a9 1
RESPONSIBLE=		Thorsten Glaser <tg@@${_DOMAIN_DU_JOUR}>
@


1.4
log
@* fix manpage problem mit makewhatis
* change from djbdns-1.05p10 to djbdns-1.05q-11 which SHOULD
  be deemed a newer version (remove the q if 1.06 comes out)
@
text
@d7 1
a7 1
PKGNAME=		djbdns-${VERSION}q-11
@


1.3
log
@merge
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.1.201.1 2005/05/14 23:21:01 tg Exp $
d7 1
a7 1
PKGNAME=		djbdns-${VERSION}p10
@


1.2
log
@nuke old djbdns port

It sucks, because it does not work right here for e.g. 42h.de
but I'm not going to debug this with the old port
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.1 2005/03/18 15:48:07 tg Exp $
d3 12
a14 12
COMMENT=	"collection of Domain Name System tools"
NO_REGRESS=	Yes
VERSION=	1.05
CATEGORIES=	net
DISTNAME=	djbdns-${VERSION}
PKGNAME=	${PKGBASE}-${VERSION}p9
HOMEPAGE=	http://cr.yp.to/djbdns.html
RESPONSIBLE=	Thorsten Glaser <tg@@${_DOMAIN_DU_JOUR}>

# May distribute unchanged distfiles.
# May distribute patches.
# Must not distribute binaries.
a16 2
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
d18 2
a19 2
FLAVORS=	opennic orsc icann eorsn no_ipv4 no_ipv6 original
FLAVOR?=	eorsn
d21 5
a25 4
DISTFILES=	${DISTNAME}${EXTRACT_SUFX} ${DISTNAME}-man${EXTRACT_SUFX}:0
MASTER_SITES=	http://cr.yp.to/djbdns/ \
		ftp://ftp.id.wustl.edu/pub/qmail/
MASTER_SITES0=	${_MASTER_SITE_MIRBSD}
d27 2
a28 1
RUN_DEPENDS=	::sysutils/daemontools
d30 2
a31 25
.if ${FLAVOR:L:Moriginal}
FLAVOR=		original no_ipv6 icann
.endif

.if ${FLAVOR:L:Mno_ipv6}
.  if ${FLAVOR:L:Mno_ipv4}
BROKEN=		Choose either one: no_ipv4, no_ipv6 or none of those
.  else
# no_ipv6: the "original" djbdns
PKGTYPE=	djbdns
PKGBASE=	djbdns
.  endif
.elif ${FLAVOR:L:Mno_ipv4}
# no_ipv4: the AF_INET6 listening flavour
PKGTYPE=	fefedns
PKGBASE=	djbdns6
FLAVOR=		no_ipv4
PLIST=		${PKGDIR}/PLIST6
FULLPKGNAME=	${PKGNAME}
DNSROOT=	eorsn6
.else
# neither: the AF_INET listening flavour
PKGTYPE=	tinydns
PKGBASE=	djbdns
.endif
d37 1
a37 1
DNSROOT=opennic
d45 1
a45 1
DNSROOT=orsc
d53 1
a53 1
DNSROOT=icann
d61 1
a61 1
DNSROOT=eorsn
d66 1
a66 1
BROKEN=		"choose a DNS Root flavour (default: eorsn)"
d69 10
a78 23
# datasize limit in 'run' files is too low for ld.so
# to be able to pull in libc
LDFLAGS+=	-static

ALL_TARGET=	default
INSTALL_TARGET=	setup check

MAN5LIST=	qualification
MAN1LIST=	dnsfilter dnsipq dnsname dnsqr dnstxt dnsip \
		dnsmx dnsq dnstrace dnstracesort
MAN8LIST=	axfr-get dnscache pickdns rbldns tinydns axfrdns \
		pickdns-conf rbldns-conf tinydns-conf walldns-conf \
		dnscache-conf pickdns-data rbldns-data tinydns-data \
		tinydns-edit walldns

BINLIST=	axfr-get axfrdns axfrdns-conf dnscache dnscache-conf \
		dnsfilter dnsip dnsipq dnsmx dnsname dnsq dnsqr dnstrace \
		dnstxt pickdns pickdns-conf pickdns-data random-ip rbldns \
		rbldns-conf rbldns-data tinydns tinydns-conf tinydns-data \
		tinydns-edit tinydns-get walldns walldns-conf
.if ${PKGTYPE} != "djbdns"
BINLIST+=	dnsip6 dnsip6q
.endif
d80 1
a80 66
SCRIPTLIST=	dnstracesort

.if ${PKGTYPE} == "djbdns"
PATCH_LIST=	0patch-Makefile 0patch-hier_c 0patch-dns_h
.  if ${FLAVOR:L:Moriginal}
FILES_LIST=	../pkg/SECURITY
.  else
PATCH_LIST+=	0patch-dnscache_c 0patch-query_c
FILES_LIST=	ignoreip-update
.  endif
.elif ${PKGTYPE} == "fefedns"
PATCH_LIST=	0patch-Makefile 0patch-hier_c 0patch-dnscache_c \
		0patch-query_c 4patch-Makefile 6patch-Makefile \
		patch-FILES patch-TARGETS patch-axfr-get_c 0patch-dns_h \
		46patch-dns_h patch-dns_name_c patch-dns_rcip_c \
		patch-dns_resolve_c patch-dns_transmit_c \
		patch-dnscache-conf_c 6patch-dnscache_c patch-dnsfilter_c \
		patch-dnsname_c patch-dnsq_c patch-dnstrace_c \
		patch-dnstracesort_sh 46patch-hier_c patch-log_c \
		patch-okclient_c patch-pickdns-conf_c patch-printrecord_c \
		patch-qlog_c 6patch-query_c patch-query_h patch-rbldns-conf_c \
		patch-roots_c patch-server_c patch-socket_bind_c \
		patch-socket_h patch-tinydns-conf_c patch-tinydns-data_c \
		patch-tinydns-edit_c patch-walldns-conf_c 6_patch-tdlookup_c
FILES_LIST=	dns_ip6.c dns_ipq6.c dns_nd6.c dns_sortip6.c \
		dnsip6.c dnsip6q.c fmt_xlong.c \
		haveip6.h1 haveip6.h2 haven2i.h1 haven2i.h2 \
		ip6.h ip6_fmt.c ip6_scan.c scan_xlong.c \
		sockaddr_in6.h1 sockaddr_in6.h2 \
		socket_accept6.c socket_bind6.c socket_connect6.c \
		socket_getifidx.c socket_noipv6.c \
		socket_recv6.c socket_send6.c socket_tcp6.c socket_udp6.c \
		tryip6.c tryn2i.c trysa6.c
.else
PATCH_LIST=	0patch-Makefile 0patch-hier_c 0patch-dnscache_c \
		0patch-query_c 4patch-Makefile patch-FILES \
		patch-TARGETS patch-axfr-get_c 46patch-dns_h \
		patch-dnstrace_c patch-dnstracesort_sh \
		46patch-hier_c patch-printrecord_c 4_patch-tdlookup_c \
		patch-tinydns-data_c patch-tinydns-data_8
FILES_LIST=	dns_ip6.c dns_ipq6.c dns_nd6.c dns_sortip6.c \
		dnsip6.c dnsip6q.c fmt_xlong.c \
		ip6.h ip6_fmt.c ip6_scan.c scan_xlong.c ignoreip-update
.endif

.if ${OSname} == "mirbsd" && ${OSrev} >= 8
PATCH_LIST+=	patch-tai_now_c patch-taia_now_c
.endif

pre-patch:
	@@cp ${FILESDIR}/dnsroots.${DNSROOT} \
	  ${WRKSRC}/dnsroots.global || { \
		echo "invalid combination of flavors!"; \
		exit 1; \
	  }

pre-build:
.for file in ${FILES_LIST}
	cp ${FILESDIR}/${file} ${WRKSRC}
.endfor
	echo ${CC} ${CFLAGS} > ${WRKSRC}/conf-cc
	echo ${CC} -s ${LDFLAGS} > ${WRKSRC}/conf-ld
	echo ${PREFIX} > ${WRKSRC}/conf-home

pre-install:
	@@echo ${PREFIX} > ${WRKSRC}/conf-home
d82 4
a85 26

post-install:
.for file in ${BINLIST}
	@@strip ${PREFIX}/bin/${file}
.endfor
.for file in ${BINLIST} ${SCRIPTLIST}
	@@chmod 0555 ${PREFIX}/bin/${file}
.  if ${PKGTYPE} == "fefedns"
	@@mv ${PREFIX}/bin/${file} ${PREFIX}/bin/6${file}
.  endif
.endfor
.if ${PKGTYPE} != "fefedns"
.  for mtype in 1 5 8
.    for file in ${MAN${mtype}LIST}
	${INSTALL_MAN} ${WRKDIR}/djbdns-man/${file}.${mtype} \
		${PREFIX}/man/man${mtype}
.    endfor
.  endfor
.endif
.if ${FLAVOR:L:Mno_ipv4}
	cd ${PREFIX}/share/djbdns && mv dnsroots.global dnsroots.global.v6
.endif
	if [ -e ${WRKSRC}/SECURITY ]; then ${INSTALL_DATA} \
	    ${WRKSRC}/SECURITY ${PREFIX}/share/djbdns; fi
	if [ -e ${WRKSRC}/ignoreip-update ]; then ${INSTALL_SCRIPT} \
	    ${WRKSRC}/ignoreip-update ${PREFIX}/bin; fi
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $MirOS$
@


1.1.201.1
log
@New djbdns port, #ifdef'd, "original" and "no_ipv6" flavours removed
"no_ipv4" non-functional at the moment, will follow later after
redesign using crunchgen(1) and crunchide(1)
@
text
@d1 1
a1 1
# $MirOS: ports/net/djbdns/Makefile,v 1.1.7.1 2005/03/18 15:48:07 tg Exp $
d3 14
a16 10
COMMENT=		"collection of Domain Name System server and tools"
VERSION=		1.05
CATEGORIES=		net
DISTNAME=		djbdns-${VERSION}
PKGNAME=		djbdns-${VERSION}p10
HOMEPAGE=		http://cr.yp.to/djbdns.html
RESPONSIBLE=		Thorsten Glaser <tg@@${_DOMAIN_DU_JOUR}>

# May distribute unchanged distfiles. May distribute patches.
# Must not distribute binaries (changed or not).
a18 2
PERMIT_PACKAGE_CDROM=	"http://cr.yp.to/distributors.html"
PERMIT_PACKAGE_FTP=	"http://cr.yp.to/distributors.html"
d20 2
a21 2
FLAVORS=		eorsn icann opennic orsc
FLAVOR?=		eorsn
d23 4
a26 5
DISTFILES=		${DISTNAME}${EXTRACT_SUFX} \
			${DISTNAME}-man${EXTRACT_SUFX}:0
MASTER_SITES=		http://cr.yp.to/djbdns/ \
			ftp://ftp.id.wustl.edu/pub/qmail/
MASTER_SITES0=		${_MASTER_SITE_MIRBSD}
d28 1
a28 2
RUN_DEPENDS=		::sysutils/daemontools
NO_REGRESS=		Yes
d30 25
a54 2
.undef DNSROOT
DNSROOT6=	eorsn6
d60 1
a60 1
DNSROOT=	opennic
d68 1
a68 1
DNSROOT=	orsc
d76 1
a76 1
DNSROOT=	icann
d84 1
a84 1
DNSROOT=	eorsn
d89 1
a89 1
BROKEN=		choose a DNS Root flavour (default: eorsn)
d92 91
a182 10
WRKDIST=		${WRKDIR}
WRKSRC=			${WRKDIR}/build
CONFIGURE_STYLE=	simple
CONFIGURE_ENV+=		TOP=${WRKDIR}
MAKE_ENV+=		TOP=${WRKDIR}

post-extract:
	cd ${FILESDIR}; find build -type f \! -path \*CVS\* \
	    | cpio -pdu ${WRKDIR}/
	cd ${WRKDIR}; mv djbdns-${VERSION} src; mv djbdns-man man
d185 24
a208 5
	${INSTALL_DATA_DIR} ${PREFIX}/share/djbdns
	${INSTALL_DATA} ${FILESDIR}/data/dnsroots.${DNSROOT} \
	    ${PREFIX}/share/djbdns/dnsroots.global
	${INSTALL_DATA} ${FILESDIR}/data/dnsroots.${DNSROOT6} \
	    ${PREFIX}/share/djbdns/dnsroots.global.v6
@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
