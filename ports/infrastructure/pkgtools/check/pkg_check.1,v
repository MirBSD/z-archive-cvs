head	1.4;
access;
symbols;
locks; strict;
comment	@.\" @;


1.4
date	2018.12.25.19.37.59;	author tg;	state Exp;
branches;
next	1.3;
commitid	1005C22871909EC7FE2;

1.3
date	2016.02.11.20.12.00;	author tg;	state Exp;
branches;
next	1.2;
commitid	10056BCEAFF41919B5B;

1.2
date	2010.03.09.20.05.55;	author tg;	state Exp;
branches;
next	1.1;
commitid	1004B96AA317A99D979;

1.1
date	2010.03.09.19.38.49;	author bsiegert;	state Exp;
branches;
next	;
commitid	1004B96A3AF0F9FA7FB;


desc
@@


1.4
log
@update from contrib/samples/portmdoc,v 1.11
@
text
@.\" $MirOS: ports/infrastructure/pkgtools/check/pkg_check.1,v 1.3 2016/02/11 20:12:00 tg Exp $
.\"-
.\" Copyright (c) 2010
.\"	Benny Siegert <bsiegert@@gmx.de>
.\"
.\" Provided that these terms and disclaimer and all copyright notices
.\" are retained or reproduced in an accompanying document, permission
.\" is granted to deal in this work without restriction, including un-
.\" limited rights to use, publicly perform, distribute, sell, modify,
.\" merge, give away, or sublicence.
.\"
.\" This work is provided "AS IS" and WITHOUT WARRANTY of any kind, to
.\" the utmost extent permitted by applicable law, neither express nor
.\" implied; without malicious intent or gross negligence. In no event
.\" may a licensor, author or contributor be held liable for indirect,
.\" direct, other damage, loss, or other issues arising in any way out
.\" of dealing in the work, even if advised of the possibility of such
.\" damage or existence of a defect, except proven that it results out
.\" of said person's immediate fault when using the work as intended.
.\"-
.\" Copyright (c) 2008, 2009, 2010, 2016, 2018
.\"	mirabilos <m@@mirbsd.org>
.\"-
.\" Try to make GNU groff and AT&T nroff more compatible
.\" * ` generates ‘ in gnroff, so use \`
.\" * ' generates ’ in gnroff, \' generates ´, so use \*(aq
.\" * - generates ‐ in gnroff, \- generates −, so .tr it to -
.\"   thus use - for hyphens and \- for minus signs and option dashes
.\" * ~ is size-reduced and placed atop in groff, so use \*(TI
.\" * ^ is size-reduced and placed atop in groff, so use \*(ha
.\" * \(en does not work in nroff, so use \*(en
.\" * <>| are problematic, so redefine and use \*(Lt\*(Gt\*(Ba
.\" Also make sure to use \& *before* a punctuation char that is to not
.\" be interpreted as punctuation, and especially with two-letter words
.\" but also (after) a period that does not end a sentence (“e.g.\&”).
.\" The section after the "doc" macropackage has been loaded contains
.\" additional code to convene between the UCB mdoc macropackage (and
.\" its variant as BSD mdoc in groff) and the GNU mdoc macropackage.
.\"
.ie \n(.g \{\
.	if \*[.T]ascii .tr \-\N'45'
.	if \*[.T]latin1 .tr \-\N'45'
.	if \*[.T]utf8 .tr \-\N'45'
.	ds <= \[<=]
.	ds >= \[>=]
.	ds Rq \[rq]
.	ds Lq \[lq]
.	ds sL \(aq
.	ds sR \(aq
.	if \*[.T]utf8 .ds sL `
.	if \*[.T]ps .ds sL `
.	if \*[.T]utf8 .ds sR '
.	if \*[.T]ps .ds sR '
.	ds aq \(aq
.	ds TI \(ti
.	ds ha \(ha
.	ds en \(en
.\}
.el \{\
.	ds aq '
.	ds TI ~
.	ds ha ^
.	ds en \(em
.\}
.\"
.\" Implement .Dd with the Mdocdate RCS keyword
.\"
.rn Dd xD
.de Dd
.ie \\$1$Mdocdate: \{\
.	xD \\$2 \\$3, \\$4
.\}
.el .xD \\$1 \\$2 \\$3 \\$4 \\$5 \\$6 \\$7 \\$8
..
.\"
.\" .Dd must come before definition of .Mx, because when called
.\" with -mandoc, it might implement .Mx itself, but we want to
.\" use our own definition. And .Dd must come *first*, always.
.\"
.Dd $Mdocdate: December 25 2018 $
.\"
.\" Check which macro package we use, and do other -mdoc setup.
.\"
.ie \n(.g \{\
.	if \*[.T]utf8 .tr \[la]\*(Lt
.	if \*[.T]utf8 .tr \[ra]\*(Gt
.	ie d volume-ds-1 .ds tT gnu
.	el .ie d doc-volume-ds-1 .ds tT gnp
.	el .ds tT bsd
.\}
.el .ds tT ucb
.\"
.\" Implement .Mx (MirBSD)
.\"
.ie "\*(tT"gnu" \{\
.	eo
.	de Mx
.	nr curr-font \n[.f]
.	nr curr-size \n[.ps]
.	ds str-Mx \f[\n[curr-font]]\s[\n[curr-size]u]
.	ds str-Mx1 \*[Tn-font-size]\%MirBSD\*[str-Mx]
.	if !\n[arg-limit] \
.	if \n[.$] \{\
.	ds macro-name Mx
.	parse-args \$@@
.	\}
.	if (\n[arg-limit] > \n[arg-ptr]) \{\
.	nr arg-ptr +1
.	ie (\n[type\n[arg-ptr]] == 2) \
.	as str-Mx1 \~\*[arg\n[arg-ptr]]
.	el \
.	nr arg-ptr -1
.	\}
.	ds arg\n[arg-ptr] "\*[str-Mx1]
.	nr type\n[arg-ptr] 2
.	ds space\n[arg-ptr] "\*[space]
.	nr num-args (\n[arg-limit] - \n[arg-ptr])
.	nr arg-limit \n[arg-ptr]
.	if \n[num-args] \
.	parse-space-vector
.	print-recursive
..
.	ec
.	ds sP \s0
.	ds tN \*[Tn-font-size]
.\}
.el .ie "\*(tT"gnp" \{\
.	eo
.	de Mx
.	nr doc-curr-font \n[.f]
.	nr doc-curr-size \n[.ps]
.	ds doc-str-Mx \f[\n[doc-curr-font]]\s[\n[doc-curr-size]u]
.	ds doc-str-Mx1 \*[doc-Tn-font-size]\%MirBSD\*[doc-str-Mx]
.	if !\n[doc-arg-limit] \
.	if \n[.$] \{\
.	ds doc-macro-name Mx
.	doc-parse-args \$@@
.	\}
.	if (\n[doc-arg-limit] > \n[doc-arg-ptr]) \{\
.	nr doc-arg-ptr +1
.	ie (\n[doc-type\n[doc-arg-ptr]] == 2) \
.	as doc-str-Mx1 \~\*[doc-arg\n[doc-arg-ptr]]
.	el \
.	nr doc-arg-ptr -1
.	\}
.	ds doc-arg\n[doc-arg-ptr] "\*[doc-str-Mx1]
.	nr doc-type\n[doc-arg-ptr] 2
.	ds doc-space\n[doc-arg-ptr] "\*[doc-space]
.	nr doc-num-args (\n[doc-arg-limit] - \n[doc-arg-ptr])
.	nr doc-arg-limit \n[doc-arg-ptr]
.	if \n[doc-num-args] \
.	doc-parse-space-vector
.	doc-print-recursive
..
.	ec
.	ds sP \s0
.	ds tN \*[doc-Tn-font-size]
.\}
.el \{\
.	de Mx
.	nr cF \\n(.f
.	nr cZ \\n(.s
.	ds aa \&\f\\n(cF\s\\n(cZ
.	if \\n(aC==0 \{\
.		ie \\n(.$==0 \&MirBSD\\*(aa
.		el .aV \\$1 \\$2 \\$3 \\$4 \\$5 \\$6 \\$7 \\$8 \\$9
.	\}
.	if \\n(aC>\\n(aP \{\
.		nr aP \\n(aP+1
.		ie \\n(C\\n(aP==2 \{\
.			as b1 \&MirBSD\ #\&\\*(A\\n(aP\\*(aa
.			ie \\n(aC>\\n(aP \{\
.				nr aP \\n(aP+1
.				nR
.			\}
.			el .aZ
.		\}
.		el \{\
.			as b1 \&MirBSD\\*(aa
.			nR
.		\}
.	\}
..
.\}
.\"-
.Dt PKG_CHECK 1
.Os
.Sh NAME
.Nm pkg_check
.Nd shell interface to pkgtools matching routines
.Sh SYNOPSIS
.Nm pkg_check
.Ar version1 \&op version2
.Nm pkg_check
.Op Fl q
.Fl m Ar pattern
.Ar pkgname ...
.Sh DESCRIPTION
The
.Nm
command provides functions to check package versions in MirPorts.
It is meant to be called from scripts, not directly from the command
line.
.Pp
There are two distinct modes of operation.
The first one, which takes three arguments, compares the two version
strings
.Ar version1
and
.Ar version2 .
The second argument, the operator, is one of
.Cm \*(Lt , Cm \*(Gt ,
.Cm \*(Lt= , Cm \*(Gt=
or the text equivalents
.Cm \&lt , Cm \&gt , Cm \&le
and
.Cm \&ge .
The exit code is 0 if the comparison is true or 1 if it is false.
.Pp
The second mode allows to check whether one or more package names
.Ar pkgname
match the
.Ar pattern
given as the argument to the
.Fl m
flag.
Unless
.Fl q
.Pq quiet
is given, the matching package names are written to standard output,
one per line.
The exit status is 0 if there was at least one match, 1 otherwise.
.Sh EXAMPLES
.D1 pkg_check 1.4.5 ge 2.0
returns 1.
.D1 pkg_check 23.42-0 '\*(Lt' 23.42-5
returns 0.
.Pp
.D1 pkg_check -m 'autoconf-\*(Gt=2.50' autoconf-2.13 autoconf-2.62
prints
.Qq autoconf-2.62 .
.Sh SEE ALSO
.Xr pkg_add 1 ,
.Xr pkg_info 1 ,
.Xr ports 7 .
.Sh HISTORY
The
.Nm
utility was introduced into The MirPorts Framework by
.An Benny Siegert Aq bsiegert@@mirbsd.org .
@


1.3
log
@merge most recent portmdoc into a̲l̲l̲ of its users; fixup .\& into \&. like
in mksh(1), for Schillix ditroff
@
text
@d1 1
a1 1
.\" $MirOS: ports/infrastructure/pkgtools/check/pkg_check.1,v 1.2 2010/03/09 20:05:55 tg Exp $
d21 1
a21 1
.\" Copyright (c) 2008, 2009, 2010, 2016
d80 1
a80 1
.Dd $Mdocdate: March 9 2010 $
d88 1
d101 1
a101 1
.	ds str-Mx1 \*[Tn-font-size]\%MirOS\*[str-Mx]
d127 32
d165 1
a165 1
.		ie \\n(.$==0 \&MirOS\\*(aa
d171 1
a171 1
.			as b1 \&MirOS\ #\&\\*(A\\n(aP\\*(aa
d179 1
a179 1
.			as b1 \&MirOS\\*(aa
@


1.2
log
@pimp the manpage, asked for by bsiegert@@
@
text
@d1 1
a1 1
.\" $MirOS: ports/infrastructure/pkgtools/check/pkg_check.1,v 1.1 2010/03/09 19:38:49 bsiegert Exp $
d21 2
a22 2
.\" Copyright (c) 2008, 2009
.\"	Thorsten “mirabilos” Glaser <tg@@mirbsd.org>
d32 4
d82 1
a82 1
.\" Check which macro package we use
d85 2
@


1.1
log
@Add the new pkg_check(1) utility. Read the manpage to find out more.
@
text
@d1 1
a1 2
.\"	$MirOS$
.\"
a19 1
.\"
d76 1
a76 1
.Dd $Mdocdate: November 22 2009 $
d154 1
a154 1
.Ar version1 op version2
d173 2
a174 1
.Cm < , Cm > , Cm <= , Cm >=
d176 1
a176 1
.Cm lt , Cm gt , Cm le
d178 1
a178 1
.Cm ge .
d182 3
a184 3
.Pq Ar pkgname
matches
.Ar pattern 
d189 3
a191 3
.Fl q Pq quiet
is given, the matching package names are written to
.Pa stdout ,
d193 1
a193 1
The exit status is 0 if there was at least one match, else 1.
d197 1
a197 1
.D1 pkg_check 23.42-0 '<' 23.42-5
d200 1
a200 1
.D1 pkg_check -m 'autoconf->=2.50' autoconf-2.13 autoconf-2.62
a203 1
.Xr ports 7 ,
d205 2
a206 1
.Xr pkg_info 1 .
d210 2
a211 1
utility was introduced into MirPorts by Benny Siegert.
@

