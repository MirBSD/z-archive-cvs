head	1.16;
access;
symbols
	bsiegert-cfgfile_BASE:1.13
	bsiegert-cfgfile:1.13.0.2
	MIRBSD_8_BASE:1.5;
locks; strict;
comment	@.\" @;


1.16
date	2018.12.25.19.38.03;	author tg;	state Exp;
branches;
next	1.15;
commitid	1005C22871909EC7FE2;

1.15
date	2016.02.11.20.12.04;	author tg;	state Exp;
branches;
next	1.14;
commitid	10056BCEAFF41919B5B;

1.14
date	2014.05.29.18.40.48;	author tg;	state Exp;
branches;
next	1.13;
commitid	10053877F337DFCFA47;

1.13
date	2009.11.22.18.23.36;	author tg;	state Exp;
branches;
next	1.12;
commitid	1004B0981B210A68B89;

1.12
date	2009.11.22.15.48.47;	author tg;	state Exp;
branches;
next	1.11;
commitid	1004B095D622ECA4D23;

1.11
date	2009.10.17.21.51.43;	author tg;	state Exp;
branches;
next	1.10;
commitid	1004ADA3C7648D93868;

1.10
date	2008.03.14.16.46.01;	author tg;	state Exp;
branches;
next	1.9;
commitid	10047DAABDD118A6FDD;

1.9
date	2008.03.12.23.17.21;	author tg;	state Exp;
branches;
next	1.8;
commitid	10047D86495134E62E4;

1.8
date	2008.03.09.17.22.57;	author tg;	state Exp;
branches;
next	1.7;
commitid	10047D41CAA7E715397;

1.7
date	2006.03.19.21.23.16;	author tg;	state Exp;
branches;
next	1.6;
commitid	100441DCBBE25CC5039;

1.6
date	2006.01.13.03.49.26;	author tg;	state Exp;
branches;
next	1.5;
commitid	10043C722F46A94D38C;

1.5
date	2005.12.20.19.57.58;	author tg;	state Exp;
branches;
next	1.4;
commitid	10043A8624B52844F91;

1.4
date	2005.09.12.22.53.26;	author tg;	state Exp;
branches;
next	1.3;
commitid	6e6c432606e897b6;

1.3
date	2005.08.05.20.34.04;	author bsiegert;	state Exp;
branches
	1.3.2.1;
next	1.2;
commitid	4f3042f3ccfa3636;

1.2
date	2005.07.05.20.08.31;	author tg;	state Exp;
branches;
next	1.1;
commitid	6fe042cae8bb6f4d;

1.1
date	2005.03.18.15.47.18;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.3.2.1
date	2005.08.21.11.52.03;	author tg;	state Exp;
branches;
next	;
commitid	2a7d43086aca81b0;

1.1.7.1
date	2005.03.18.15.47.18;	author tg;	state Exp;
branches;
next	;


desc
@@


1.16
log
@update from contrib/samples/portmdoc,v 1.11
@
text
@.\" $MirOS: ports/infrastructure/pkgtools/rtfm/ports.7,v 1.15 2016/02/11 20:12:04 tg Exp $
.\" $OpenBSD: ports.7,v 1.42 2004/04/16 21:23:08 jmc Exp $
.\" $FreeBSD: ports.7,v 1.7 1998/06/23 04:38:50 hoek Exp $
.\"-
.\" Copyright (c) 1997 David E. O'Brien
.\"
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE DEVELOPERS ``AS IS'' AND ANY EXPRESS OR
.\" IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
.\" OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
.\" IN NO EVENT SHALL THE DEVELOPERS BE LIABLE FOR ANY DIRECT, INDIRECT,
.\" INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
.\" NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
.\" DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
.\" THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
.\" (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
.\" THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
.\"-
.\" Copyright (c) 2008, 2009, 2010, 2016, 2018
.\"	mirabilos <m@@mirbsd.org>
.\"-
.\" Try to make GNU groff and AT&T nroff more compatible
.\" * ` generates ‘ in gnroff, so use \`
.\" * ' generates ’ in gnroff, \' generates ´, so use \*(aq
.\" * - generates ‐ in gnroff, \- generates −, so .tr it to -
.\"   thus use - for hyphens and \- for minus signs and option dashes
.\" * ~ is size-reduced and placed atop in groff, so use \*(TI
.\" * ^ is size-reduced and placed atop in groff, so use \*(ha
.\" * \(en does not work in nroff, so use \*(en
.\" * <>| are problematic, so redefine and use \*(Lt\*(Gt\*(Ba
.\" Also make sure to use \& *before* a punctuation char that is to not
.\" be interpreted as punctuation, and especially with two-letter words
.\" but also (after) a period that does not end a sentence (“e.g.\&”).
.\" The section after the "doc" macropackage has been loaded contains
.\" additional code to convene between the UCB mdoc macropackage (and
.\" its variant as BSD mdoc in groff) and the GNU mdoc macropackage.
.\"
.ie \n(.g \{\
.	if \*[.T]ascii .tr \-\N'45'
.	if \*[.T]latin1 .tr \-\N'45'
.	if \*[.T]utf8 .tr \-\N'45'
.	ds <= \[<=]
.	ds >= \[>=]
.	ds Rq \[rq]
.	ds Lq \[lq]
.	ds sL \(aq
.	ds sR \(aq
.	if \*[.T]utf8 .ds sL `
.	if \*[.T]ps .ds sL `
.	if \*[.T]utf8 .ds sR '
.	if \*[.T]ps .ds sR '
.	ds aq \(aq
.	ds TI \(ti
.	ds ha \(ha
.	ds en \(en
.\}
.el \{\
.	ds aq '
.	ds TI ~
.	ds ha ^
.	ds en \(em
.\}
.\"
.\" Implement .Dd with the Mdocdate RCS keyword
.\"
.rn Dd xD
.de Dd
.ie \\$1$Mdocdate: \{\
.	xD \\$2 \\$3, \\$4
.\}
.el .xD \\$1 \\$2 \\$3 \\$4 \\$5 \\$6 \\$7 \\$8
..
.\"
.\" .Dd must come before definition of .Mx, because when called
.\" with -mandoc, it might implement .Mx itself, but we want to
.\" use our own definition. And .Dd must come *first*, always.
.\"
.Dd $Mdocdate: December 25 2018 $
.\"
.\" Check which macro package we use, and do other -mdoc setup.
.\"
.ie \n(.g \{\
.	if \*[.T]utf8 .tr \[la]\*(Lt
.	if \*[.T]utf8 .tr \[ra]\*(Gt
.	ie d volume-ds-1 .ds tT gnu
.	el .ie d doc-volume-ds-1 .ds tT gnp
.	el .ds tT bsd
.\}
.el .ds tT ucb
.\"
.\" Implement .Mx (MirBSD)
.\"
.ie "\*(tT"gnu" \{\
.	eo
.	de Mx
.	nr curr-font \n[.f]
.	nr curr-size \n[.ps]
.	ds str-Mx \f[\n[curr-font]]\s[\n[curr-size]u]
.	ds str-Mx1 \*[Tn-font-size]\%MirBSD\*[str-Mx]
.	if !\n[arg-limit] \
.	if \n[.$] \{\
.	ds macro-name Mx
.	parse-args \$@@
.	\}
.	if (\n[arg-limit] > \n[arg-ptr]) \{\
.	nr arg-ptr +1
.	ie (\n[type\n[arg-ptr]] == 2) \
.	as str-Mx1 \~\*[arg\n[arg-ptr]]
.	el \
.	nr arg-ptr -1
.	\}
.	ds arg\n[arg-ptr] "\*[str-Mx1]
.	nr type\n[arg-ptr] 2
.	ds space\n[arg-ptr] "\*[space]
.	nr num-args (\n[arg-limit] - \n[arg-ptr])
.	nr arg-limit \n[arg-ptr]
.	if \n[num-args] \
.	parse-space-vector
.	print-recursive
..
.	ec
.	ds sP \s0
.	ds tN \*[Tn-font-size]
.\}
.el .ie "\*(tT"gnp" \{\
.	eo
.	de Mx
.	nr doc-curr-font \n[.f]
.	nr doc-curr-size \n[.ps]
.	ds doc-str-Mx \f[\n[doc-curr-font]]\s[\n[doc-curr-size]u]
.	ds doc-str-Mx1 \*[doc-Tn-font-size]\%MirBSD\*[doc-str-Mx]
.	if !\n[doc-arg-limit] \
.	if \n[.$] \{\
.	ds doc-macro-name Mx
.	doc-parse-args \$@@
.	\}
.	if (\n[doc-arg-limit] > \n[doc-arg-ptr]) \{\
.	nr doc-arg-ptr +1
.	ie (\n[doc-type\n[doc-arg-ptr]] == 2) \
.	as doc-str-Mx1 \~\*[doc-arg\n[doc-arg-ptr]]
.	el \
.	nr doc-arg-ptr -1
.	\}
.	ds doc-arg\n[doc-arg-ptr] "\*[doc-str-Mx1]
.	nr doc-type\n[doc-arg-ptr] 2
.	ds doc-space\n[doc-arg-ptr] "\*[doc-space]
.	nr doc-num-args (\n[doc-arg-limit] - \n[doc-arg-ptr])
.	nr doc-arg-limit \n[doc-arg-ptr]
.	if \n[doc-num-args] \
.	doc-parse-space-vector
.	doc-print-recursive
..
.	ec
.	ds sP \s0
.	ds tN \*[doc-Tn-font-size]
.\}
.el \{\
.	de Mx
.	nr cF \\n(.f
.	nr cZ \\n(.s
.	ds aa \&\f\\n(cF\s\\n(cZ
.	if \\n(aC==0 \{\
.		ie \\n(.$==0 \&MirBSD\\*(aa
.		el .aV \\$1 \\$2 \\$3 \\$4 \\$5 \\$6 \\$7 \\$8 \\$9
.	\}
.	if \\n(aC>\\n(aP \{\
.		nr aP \\n(aP+1
.		ie \\n(C\\n(aP==2 \{\
.			as b1 \&MirBSD\ #\&\\*(A\\n(aP\\*(aa
.			ie \\n(aC>\\n(aP \{\
.				nr aP \\n(aP+1
.				nR
.			\}
.			el .aZ
.		\}
.		el \{\
.			as b1 \&MirBSD\\*(aa
.			nR
.		\}
.	\}
..
.\}
.\"-
.Dt PORTS 7
.Os
.Sh NAME
.Nm ports
.Nd contributed applications
.Sh DESCRIPTION
MirPorts, the
.Mx
Ports Collection
(shamelessly stolen from the
.Ox
Ports Collection, which in turn was inspired by
.Fx )
offers a simple way
for users and administrators to install applications.
Each port contains any patches necessary to make the original
application source code compile and run on
.Mx , Ox ,
Darwin (Mac OS X) and Interix.
Compiling an application is as simple as typing
.Ic mmake
in the port directory!
The
.Pa Makefile
automatically fetches the
application source code, either from a local disk or via ftp, unpacks it
on the local system, applies the patches, and compiles it.
If all goes well, simply type
.Ic mmake install
to install the application.
.Pp
For more information about using ports, see
.Pa http://mirbsd.de/ports ,
The
.Ox
Ports Mechanism
.Pq Pa http://www.openbsd.org/ports.html
and the
.Ox
FAQ
.Pq Pa http://www.openbsd.org/faq/ .
For information about creating new ports, see also
the
.Ox
Porting Checklist
.Pq Pa http://www.openbsd.org/checklist.html .
.Pp
For a detailed description of the build process and all the variables
in a port Makefile, see
.Xr bsd.port.mk 5 .
For a detailed description of the packing list
.Pq Pa PLIST
format, see
.Xr pkg_create 1 .
.Sh PORTS MASTER MAKEFILE
The ports master Makefile, normally located in
.Pa /usr/ports/Makefile
(but see
.Ev PORTSDIR
below)
offers a few useful targets.
.Bl -tag -width configure
.It Ar index
rebuild the ports complete index,
.Pa /usr/ports/INDEX
.It Ar mirror\-maker
see
.Xr mirroring\-ports 7 ,
.It Ar print\-index
display the contents of the index in a user-friendly way,
.It Ar search
invoked with a key, e.g.,
.Ic mmake search key=foo ,
retrieve information relevant to a given port (obsolescent).
.El
.Sh SELECTING A SET OF PORTS
If
.Pa /usr/ports/INDEX
is up to date, it is possible to select subsets by setting the following
variables on the command line:
.Bl -tag -width category
.It Va key
package name matching the given key,
.It Va category
port belonging to category,
.It Va maintainer
port maintained by a given person.
.El
.Pp
For instance, to invoke clean on all ports in the x11 category, one can say:
.Bd -literal -offset indent
	$ mmake category=x11 clean
.Ed
.Pp
The index search is done by a perl script, so all regular expressions from
.Xr perlre 1
apply.
.Sh TARGETS
Individual ports are controlled through a few documented targets.
Some of these targets work recursively through subdirectories, so that
someone can, for examples, install all of the net
ports.
.Pp
The variable
.Ev SKIPDIR
can hold a set of package directories to avoid during recursion.
These are always specified relative to the root of the ports tree,
and can contain a flavour or subpackage part
.Po
see
.Xr packages\-specs 7
.Pc .
.Pp
In case of failure in a subdirectory, the shell fragment held in
.Ev REPORT_PROBLEM
is executed.
Default behavior is to call exit, but this can be overridden on the command
line, e.g., to avoid stopping after each problem.
.Bd -literal -offset indent
$ mmake REPORT_PROBLEM=true
.Ed
.Pp
The targets that do this are
.Ar all , build , checksum , clean ,
.Ar configure , extract , fake ,
.Ar fetch , install , distclean ,
.Ar deinstall , reinstall , package ,
.Ar link\-categories , unlink\-categories ,
.Ar describe , show , regress ,
.Ar lib\-depends\-check , homepage\-links , manpages\-check ,
.Ar license\-check , all\-dir\-depends , build\-dir\-depends ,
.Ar run\-dir\-depends
and
.Ar readmes .
.Pp
Target names starting with _ are private to the ports infrastructure,
should not be invoked directly, and are liable to change without notice.
.Pp
In the following list, each target will run the preceding targets
in order automatically.
That is,
.Ar build
will be run
.Pq if necessary
by
.Ar install ,
and so on all the way to
.Ar fetch .
Typical use only runs
.Ar install
explicitly (if root or
.Ev SUDO
is defined in
.Pa /etc/mmake.cfg ) ,
or
.Ar build
(as user), then
.Ar install
(as root).
.Bl -tag -width configure
.It Ar fetch
Fetch all of the files needed to build this port from the site(s)
listed in
.Ev MASTER_SITES
and
.Ev PATCH_SITES .
See
.Ev FETCH_CMD
and
.Ev MASTER_SITE_OVERRIDE .
.It Ar checksum
Verify that the fetched distfile matches the one the port was tested against.
Defining
.Ev NO_CHECKSUM
to
.Dv Yes
will skip this step.
Sometimes, distfiles change without warning.
The main
.Ox
mirror should still hold a copy of old distfiles, indexed by checksum.
Using
.Bd -literal -offset indent
$ mmake checksum REFETCH=true
.Ed
.Pp
will try to get a set of distfiles that match the recorded checksum.
.It Ar depends
Install
.Pq or package if only compilation is necessary
any dependencies of the current port.
When called by the
.Ar extract , install
or
.Ar fetch
targets, this is run in scattered pieces as
.Ar lib\-depends , build\-depends
and
.Ar run\-depends .
Defining
.Ev NO_DEPENDS
to
.Dv Yes
will skip this step.
.It Ar extract
Expand the distfile into a work directory.
.It Ar patch
Apply any patches that are necessary for the port.
.It Ar configure
Configure the port.
Some ports will ask questions during this stage.
See
.Ev INTERACTIVE
and
.Ev BATCH .
.It Ar build
Build the port.
This is the same as calling the
.Ar all
target.
.It Ar fake
Pretend to install the port under a subdirectory of the work directory.
.It Ar package
Create a binary package from the fake installation.
The package is a .tgz file that can be used to
install the port on several machines with
.Xr pkg_add 1 .
.It Ar install
Install the resulting package.
.El
.Pp
The following targets are not run during the normal install process.
.Bl -tag -width fetch-list
.It Ar print\-build\-depends print\-run\-depends
Print an ordered list of all the compile and run dependencies.
.It Ar clean
Remove the expanded source code.
This does not recurse to dependencies unless
.Ev CLEANDEPENDS
is defined to
.Dv Yes .
.It Ar distclean
Remove the port's distfile(s) and perform the
.Ar clean
operation.
This does not recurse to dependencies.
.It Ar reinstall
Use this to restore a port after using
.Xr pkg_delete 1 .
.It Ar link\-categories
Populate the ports tree with symbolic links for each category the port
belongs to.
.It Ar unlink\-categories
Remove the symbolic links created by
.Ar link\-categories .
.El
.Sh BULK PACKAGE BUILDING
The ports tree contains some mechanisms to save space when building
large collections of packages.
If
.Ev BIN_PACKAGES ,
.Ev TRUST_PACKAGES ,
and
.Ev BULK
are set to
.Sq Yes
for a package build, some shortcuts are taken to allow cleaning up working
directories on the fly.
.Pp
Some important caveats apply:
the packages already built in the package repository are assumed to be
up-to-date (BIN_PACKAGES), the database of installed packages is assumed
to be accurate (TRUST_PACKAGES), and the bulk cookies are assumed to be
up-to-date (BULK).
.Pp
This means that newer iterations of package buildings should make sure
those conditions are met, which entails erasing old package repository,
removing packages that need to be rebuilt from the base of installed
packages, and cleaning up old bulk cookies.
.Pp
If any of these conditions is not met, the package build may run into weird
problems.
.Sh NETWORK CONFIGURATION
The variables pertaining to network access have been marshalled into
.Pa ${PORTSDIR}/infrastructure/template/network.conf.template .
.Pp
To customize that setup, copy that file into
.Pa ${PORTSDIR}/infrastructure/db/network.conf
and edit it.
.Bl -tag -width MASTER_SITES
.It Ev MASTER_SITE_OPENBSD
If set to
.Dv Yes ,
include the master
.Ox
site when fetching files.
.It Ev MASTER_SITE_FREEBSD
If set to
.Dv Yes ,
include the master
.Fx
site when fetching files.
.It Ev MASTER_SITE_OVERRIDE
Go to this site first for all files.
.El
.Sh FLAVOURS
MirPorts comes with a mechanism called
.Ic FLAVOURS .
Thanks to this mechanism, users can select specific options provided by
a given port.
.Pp
If a port is "flavoured", there should be a terse description of
available flavours in the
.Pa pkg/DESCR
file.
.Pp
For example, the shells/tcsh port comes with a flavour called
.Ic static .
This changes the building process so a statically compiled version of
the program will be built.
To avoid confusion with other packages or flavours,
the package name will be extended with a dash-separated list of
the selected flavours.
.Pp
In this instance, the corresponding package will be called
.Ic tcsh\-6.13.00\-0\-static .
.Pp
To build a port with a specific flavour, just pass
.Ev FLAVOUR
in the environment of the
.Xr make 1
command:
.Bd -literal -offset indent
$ env FLAVOUR="static" mmake package
.Ed
.Pp
and of course, use the same settings for the subsequent invocations of make:
.Bd -literal -offset indent
$ env FLAVOUR="static" mmake package
$ env FLAVOUR="static" mmake clean
.Ed
.Pp
More than one flavour may be specified:
.Bd -literal -offset indent
$ cd /usr/ports/mail/exim
$ env FLAVOUR="mysql ldap" mmake package
.Ed
.Pp
Specifying a flavour that does not exist is an error.
Additionally, some ports impose some further restrictions on flavour
combinations, when such combinations do not make sense.
.Pp
Lots of ports can be built without X11 requirement and accordingly
have a
.Ic no_x11
flavour.
.Pp
Flavour settings are not propagated to dependencies.
If a specific combination is needed, careful hand-building of the
required set of packages is still necessary.
.Sh MULTI_PACKAGES
MirPorts comes with a mechanism called
.Ic MULTI_PACKAGES.
This mechanism is used when a larger package is broken down into
several smaller components referred to as subpackages.
.Pp
If a port is "subpackaged", in addition to the main package, each
subpackage will have a corresponding description in the
.Pa pkg/DESCR\-subpackage
file.
.Pp
For example, the database/mysql port comes with subpackages called
.Ic tests
and
.Ic server .
.Pp
In this instance, the build will yield multiple packages, one
corresponding to each subpackage. In the case of our mysql example,
the subpackages will be called
.Ic mysql\-tests\-<version> and mysql\-server\-<version> .
.Pp
When
.Ic mmake install
is invoked, all subpackages are installed by default.
See
.Ev PREFER_SUBPKG_INSTALL
below for how to change this.
To install/deinstall a specific subpackage of a port, you may
.Xr pkg_add 1
them manually, or alternatively, you may set
.Ev SUBPACKAGE
in the environment of the
.Xr make 1
command during the install/deinstall phase:
.Bd -literal -offset indent
$ env SUBPACKAGE="\-server" mmake install
$ env SUBPACKAGE="\-server" mmake deinstall
.Ed
.Pp
.Sh PORT VARIABLES
These can be changed in the environment, or in
.Pa /etc/mmake.cfg
for persistence.
They can also be set on make's command line, e.g.,
.Ic mmake VAR_FOO=foo
.Pp
Boolean variables should be set to
.Dv Yes
instead of simply being defined, for uniformity and future compatibility.
.Pp
Variable names starting with _ are private to the ports infrastructure,
should not be changed by the user, and are liable to change without notice.
.Bl -tag -width MASTER_SITES
.It Ev BATCH
If defined, only operate on a port if it can be installed 100% automatically.
.It Ev BULK_COOKIES_DIR
During bulk package building, used to store cookies for already built
packages to avoid rebuilding them, since the actual
working directory will already have been cleaned out.
Defaults to bulk/${MACHINE_ARCH} under
.Ev PORTSDIR .
.It Ev CLEANDEPENDS
If set to
.Dv Yes ,
let
.Sq clean
recurse to dependencies.
.It Ev DISTDIR
Where to find/put distfiles, normally
.Pa Distfiles/
in
.Ev PORTSDIR .
.It Ev FETCH_CMD
Command to use to fetch files.
Normally
.Xr ftp 1 .
Actually,
.Dq ftp Fl o .
.It Ev INTERACTIVE
If defined, only operate on a port if it requires interaction.
.It Ev LOCALBASE
Where to install things in general
.Pq usually Pa /usr/local .
.It Ev MASTER_SITES
Primary sites for distribution files if not found locally.
.It Ev PATCH_DEBUG
If defined, display verbose output when applying each patch.
.It Ev PATCH_SITES
Primary location(s) for distribution patch files if not found
locally.
.It Ev PKGREPOSITORYBASE
Used only for the
.Ar package
target; the base directory for the packages tree, normally
.Pa Packages/
in
.Ev PORTSDIR .
If this directory exists, the package tree will be (partially) constructed.
This directory does not have to exist; if it doesn't, packages will be
placed into the current directory, or define one of
.Bl -tag -width PKGREPOSITORY
.It Ev PKGREPOSITORY
Directory to put the package in.
.It Ev PKGFILE
The full path to the package.
.El
.It Ev PORTSDIR
Location of the ports tree
.Pq usually Pa /usr/ports .
.It Ev PREFER_SUBPKG_INSTALL
If set to No, don't install all subpackages when executing
.Ic mmake install .
Default is Yes.
.It Ev USE_SYSTRACE
Set to
.Sq Yes
to protect the
.Ar configure , build ,
and
.Ar fake
targets with
.Xr systrace 1 .
This way it is ensured that ports do not make any network connections
during build or write outside some well defined directories.
The filter list is stored in
.Pa ${PORTSDIR}/infrastructure/db/systrace.filter .
.It Ev VMEM_AUTOUNLOCK
Set to
.Sq Yes
to raise the
.Ic ulimit
values for datasize and memory automatically for building ports with
.Ev VMEM_WARNING
set.
.El
.Sh USING A READ-ONLY PORTS TREE
Select read-write partition(s) that can accommodate working directories, the
distfiles repository, and the built packages.
Set
.Ev WRKOBJDIR ,
.Ev PACKAGES ,
.Ev BULK_COOKIES_DIR
and
.Ev DISTDIR
in
.Pa /etc/mmake.cfg
accordingly.
.Sh FILES
.Bl -tag -width /usr/ports/xxxxxxxx -compact
.It Pa /etc/mmake.cfg
Default MirMake configuration file.
.It Pa /usr/ports
The default ports directory.
.It Pa /usr/ports/Makefile
Ports master Makefile.
.It Pa /usr/ports/INDEX
Ports index.
.It Pa /usr/ports/infrastructure/mk/bsd.port.mk
The ports main engine.
.It Pa /usr/ports/infrastructure/templates/network.conf.template
Network configuration defaults.
.It Pa /usr/ports/infrastructure/db/network.conf
Local network configuration.
.It Pa /usr/ports/infrastructure/db/systrace.filter
Filter list for systrace.
.It Pa /usr/ports/infrastructure/db/user.list
List of users and groups created by ports.
.El
.Sh SEE ALSO
.Xr make 1 ,
.Xr pkg_add 1 ,
.Xr pkg_create 1 ,
.Xr pkg_delete 1 ,
.Xr pkg_info 1 ,
.Xr bsd.port.mk 5 ,
.Xr packages 7
.Pp
The MirPorts Homepage:
.Pa http://mirbsd.de/ports
.Pp
The
.Ox
Ports Mechanism:
.Pa http://www.openbsd.org/ports.html
.Pp
The
.Ox
Porting Checklist:
.Pa http://www.openbsd.org/checklist.html
.Sh HISTORY
.Nm The Ports Collection
appeared in
.Fx 1.0 .
MirPorts is currently maintained by Benny Siegert and Thorsten Glaser.
.Sh AUTHORS
This man page was originated by
David O'Brien, from the
.Fx
project.
.Sh BUGS
Ports documentation is split over several places \*(en
.Xr bsd.port.mk 5 ,
the
.Dq Ports Collection
section of the
.Fx
handbook, the
.Dq Porting Existing Software
section of the
.Fx
handbook,
and some man pages.
.Ox
adds a few web pages to further confuse the issue.
@


1.15
log
@merge most recent portmdoc into a̲l̲l̲ of its users; fixup .\& into \&. like
in mksh(1), for Schillix ditroff
@
text
@d1 1
a1 1
.\" $MirOS: ports/infrastructure/pkgtools/rtfm/ports.7,v 1.13 2009/11/22 18:23:36 tg Exp $
d29 1
a29 1
.\" Copyright (c) 2008, 2009, 2010, 2016
d88 1
a88 1
.Dd $Mdocdate: November 22 2009 $
d96 1
d109 1
a109 1
.	ds str-Mx1 \*[Tn-font-size]\%MirOS\*[str-Mx]
d135 32
d173 1
a173 1
.		ie \\n(.$==0 \&MirOS\\*(aa
d179 1
a179 1
.			as b1 \&MirOS\ #\&\\*(A\\n(aP\\*(aa
d187 1
a187 1
.			as b1 \&MirOS\\*(aa
@


1.14
log
@change FETCH_CMD to end with -o (ftp, fetch) or -O (GNU wget)
and use this
@
text
@d29 2
a30 2
.\" Copyright (c) 2008, 2009
.\"	Thorsten “mirabilos” Glaser <tg@@mirbsd.org>
d40 4
d90 1
a90 1
.\" Check which macro package we use
d93 2
@


1.13
log
@fix more manpages
@
text
@d1 1
a1 1
.\" $MirOS: ports/infrastructure/pkgtools/rtfm/ports.7,v 1.12 2009/11/22 15:48:47 tg Exp $
d591 2
@


1.12
log
@update to contrib/samples/portmdoc,v 1.6
@
text
@d1 1
a1 1
.\" $MirOS: ports/infrastructure/pkgtools/rtfm/ports.7,v 1.11 2009/10/17 21:51:43 tg Exp $
d84 1
a84 1
.Dd $Mdocdate: November 17 2009 $
d220 1
a220 1
.It Ar mirror-maker
d222 2
a223 2
.Xr mirroring-ports 7 ,
.It Ar print-index
d265 1
a265 1
.Xr packages-specs 7
d282 1
a282 1
.Ar link-categories , unlink-categories ,
d284 3
a286 3
.Ar lib-depends-check , homepage-links , manpages-check ,
.Ar license-check , all-dir-depends , build-dir-depends ,
.Ar run-dir-depends
d351 1
a351 1
.Ar lib-depends , build-depends
d353 1
a353 1
.Ar run-depends .
d388 1
a388 1
.It Ar print-build-depends print-run-depends
d404 1
a404 1
.It Ar link-categories
d407 1
a407 1
.It Ar unlink-categories
d409 1
a409 1
.Ar link-categories .
d480 1
a480 1
.Ic tcsh-6.13.00-0-static .
d523 1
a523 1
.Pa pkg/DESCR-subpackage
d534 1
a534 1
.Ic mysql-tests-<version> and mysql-server-<version> .
d550 2
a551 2
$ env SUBPACKAGE="-server" mmake install
$ env SUBPACKAGE="-server" mmake deinstall
d713 1
a713 1
Ports documentation is split over several places ---
@


1.11
log
@new cool variable VMEM_AUTOUNLOCK including documentation
inspired by pkgsrc® which does this automagically and always, IIRC
@
text
@d1 1
a1 1
.\" $MirOS: ports/infrastructure/pkgtools/rtfm/ports.7,v 1.10 2008/03/14 16:46:01 tg Exp $
d29 3
d33 3
a35 3
.\" * ` generates ‘ in groff, so use \`
.\" * ' generates ’ in groff, \' generates ´, so use \*(aq
.\" * - generates ‐ in groff, \- generates −, fixed in tmac/mdoc/doc-groff
d40 4
d45 13
d71 1
d83 10
a92 1
.Dd $Mdocdate: March 14 2008 $
d95 32
a126 7
.de Mx
.nr cF \\n(.f
.nr cZ \\n(.s
.ds aa \&\f\\n(cF\s\\n(cZ
.if \\n(aC==0 \{\
.	ie \\n(.$==0 \&MirOS\\*(aa
.	el .aV \\$1 \\$2 \\$3 \\$4 \\$5 \\$6 \\$7 \\$8 \\$9
d128 21
a148 6
.if \\n(aC>\\n(aP \{\
.	nr aP \\n(aP+1
.	ie \\n(C\\n(aP==2 \{\
.		as b1 \&MirOS\ #\&\\*(A\\n(aP\\*(aa
.		ie \\n(aC>\\n(aP \{\
.			nr aP \\n(aP+1
a150 5
.		el .aZ
.	\}
.	el \{\
.		as b1 \&MirOS\\*(aa
.		nR
d152 1
d154 1
a154 1
..
@


1.10
log
@use .Dd before (re)defining .Mx, otherwise tmac.andoc fucks up on mnbsd
@
text
@d1 1
a1 1
.\" $MirOS: ports/infrastructure/pkgtools/rtfm/ports.7,v 1.9 2008/03/12 23:17:21 tg Exp $
d62 1
a62 1
.Dd $Mdocdate$
d573 8
@


1.9
log
@declare .Dd and .Mx
@
text
@d1 1
a1 1
.\" $MirOS: ports/infrastructure/pkgtools/rtfm/ports.7,v 1.8 2008/03/09 17:22:57 tg Exp $
d59 5
a88 1
.Dd $Mdocdate: March 9 2008 $
@


1.8
log
@bulk convert FLAVOR to FLAVOUR; nuke unused file; convert to $Mdocdate
@
text
@d1 1
a1 1
.\" $MirOS: ports/infrastructure/pkgtools/rtfm/ports.7,v 1.7 2006/03/19 21:23:16 tg Exp $
d29 56
a84 1
.Dd $Mdocdate$
@


1.7
log
@change website (yes, again...)

this time: www.mirbsd.org (not yet working)
ports are using mirbsd.mirsolutions.de (working again) for now
@
text
@d1 1
a1 1
.\" $MirOS: ports/infrastructure/pkgtools/rtfm/ports.7,v 1.6 2006/01/13 03:49:26 tg Exp $
d29 1
a29 1
.Dd January 25, 1998
d137 1
a137 1
and can contain a flavor or subpackage part
d350 1
a350 1
To avoid confusion with other packages or flavors,
d352 1
a352 1
the selected flavors.
d358 1
a358 1
.Ev FLAVOR
d363 1
a363 1
$ env FLAVOR="static" mmake package
d368 2
a369 2
$ env FLAVOR="static" mmake package
$ env FLAVOR="static" mmake clean
d375 1
a375 1
$ env FLAVOR="mysql ldap" mmake package
@


1.6
log
@* mirbsd.bsdadvocacy.org -> www.66h.42h.de
* mirbsd.mirsolutions.de -> www.66h.42h.de (loses SSL)
* http*/cvs.cgi/ -> cvs.mirbsd.de
* mirsolutions.de -> mirbsd.org

No complete transition yet, but this helps a lot with
the recent and upcoming(!) domain issues.

Please use only http://mirbsd.de/ as mirror redirector
and only http://cvs.mirbsd.de/ as CVSweb redirector.
Please do not use mirbsd.de for anything else save eMail.
@
text
@d1 1
a1 1
.\" $MirOS: ports/infrastructure/pkgtools/rtfm/ports.7,v 1.5 2005/12/20 19:57:58 tg Exp $
d62 1
a62 1
.Pa http://www.66h.42h.de/?ports ,
d558 1
a558 1
.Pa http://www.66h.42h.de/?ports 
@


1.5
log
@make -> mmake, as discussed
@
text
@d1 1
a1 1
.\" $MirOS: ports/infrastructure/pkgtools/rtfm/ports.7,v 1.4 2005/09/12 22:53:26 tg Exp $
d62 1
a62 1
.Pa http://mirbsd.bsdadvocacy.org/?ports ,
d558 1
a558 1
.Pa http://mirbsd.bsdadvocacy.org/?ports 
@


1.4
log
@join tg-ports-devel branch into HEAD
@
text
@d1 1
a1 1
.\" $MirOS: ports/infrastructure/pkgtools/rtfm/ports.7,v 1.3.2.1 2005/08/21 11:52:03 tg Exp $
d50 1
a50 1
.Ic make
d58 1
a58 1
.Ic sudo make install
d102 1
a102 1
.Ic make search key=foo ,
d121 1
a121 1
	$ make category=x11 clean
d149 1
a149 1
$ make REPORT_PROBLEM=true
d183 1
a183 1
.Pa /etc/make.cfg ) ,
d213 1
a213 1
$ make checksum REFETCH=true
d363 1
a363 1
$ env FLAVOR="static" make package
d368 2
a369 2
$ env FLAVOR="static" make package
$ env FLAVOR="static" make clean
d375 1
a375 1
$ env FLAVOR="mysql ldap" make package
d412 1
a412 1
.Ic make install
d425 2
a426 2
$ env SUBPACKAGE="-server" make install
$ env SUBPACKAGE="-server" make deinstall
d431 1
a431 1
.Pa /etc/make.cfg
d434 1
a434 1
.Ic make VAR_FOO=foo
d499 1
a499 1
.Ic make install .
d525 1
a525 1
.Pa /etc/make.cfg
d529 1
a529 1
.It Pa /etc/make.cfg
a530 2
.It Pa /etc/mmake.cfg
MirMake on Darwin, OpenBSD etc. configuration file.
@


1.3
log
@Update MirPorts manpages.

flavor -> flavour
OpenBSD ports -> MirPorts
mandatory patchlevels
etc.pp.
@
text
@d1 1
a1 1
.\" $MirOS$
d183 1
a183 1
.Pa /etc/mk.conf ) ,
d431 1
a431 1
.Pa /etc/mk.conf
d525 1
a525 1
.Pa /etc/mk.conf
d529 4
@


1.3.2.1
log
@mk.conf changes
@
text
@d1 1
a1 1
.\" $MirOS: ports/infrastructure/pkgtools/rtfm/ports.7,v 1.3 2005/08/05 20:34:04 bsiegert Exp $
d183 1
a183 1
.Pa /etc/make.cfg ) ,
d431 1
a431 1
.Pa /etc/make.cfg
d525 1
a525 1
.Pa /etc/make.cfg
a528 4
.It Pa /etc/make.cfg
Default MirMake configuration file.
.It Pa /etc/mmake.cfg
MirMake on Darwin, OpenBSD etc. configuration file.
@


1.2
log
@* capitalise the initial letter on Distfiles, Packages, etc.
* slightly change the Packages layout

agreed bsiegert@@
@
text
@d36 2
a37 2
The
.Ox
d40 4
a43 2
.Fx
Ports Collection) offers a simple way
d47 2
a48 1
.Ox .
d62 1
d66 2
a67 1
(http://www.openbsd.org/ports.html) and the
d69 3
a71 2
FAQ (http://www.openbsd.org/faq/).
For information about creating new ports, see
d74 2
a75 1
Porting Checklist (http://www.openbsd.org/checklist.html).
d77 2
a78 1
For a detailed description of the build process, see
d80 4
d335 3
a337 5
.Sh FLAVORS
The
.Ox
ports tree comes with a mechanism called
.Ic FLAVORS .
d341 2
a342 2
If a port is "flavored", there should be a terse description of
available flavors in the
d346 1
a346 1
For example, the shells/bash port comes with a flavor called
d355 1
a355 1
.Ic bash-1.14.7p1-static .
d357 1
a357 1
To build a port with a specific flavor, just pass
d372 1
a372 1
More than one flavor may be specified:
d378 2
a379 2
Specifying a flavor that does not exist is an error.
Additionally, some ports impose some further restrictions on flavor
d385 1
a385 1
flavor.
d387 1
a387 1
Flavor settings are not propagated to dependencies.
d391 1
a391 3
The
.Ox
ports tree comes with a mechanism called
d411 6
d443 14
a456 6
.It Ev PORTSDIR
Location of the ports tree
.Po
usually
.Pa /usr/ports
.Pc
d462 16
d482 1
a482 1
.Pa packages/${MACHINE_ARCH}
d494 7
a500 33
.It Ev BULK_COOKIES_DIR
During bulk package building, used to store cookies for already built
packages to avoid rebuilding them, since the actual
working directory will already have been cleaned out.
Defaults to bulk/${MACHINE_ARCH} under
.Ev PORTSDIR .
.It Ev LOCALBASE
Where to install things in general
.Po
usually
.Pa /usr/local
.Pc
.It Ev MASTER_SITES
Primary sites for distribution files if not found locally.
.It Ev PATCH_SITES
Primary location(s) for distribution patch files if not found
locally.
.It Ev CLEANDEPENDS
If set to
.Dv Yes ,
let
.Sq clean
recurse to dependencies.
.It Ev FETCH_CMD
Command to use to fetch files.
Normally
.Xr ftp 1 .
.It Ev PATCH_DEBUG
If defined, display verbose output when applying each patch.
.It Ev INTERACTIVE
If defined, only operate on a port if it requires interaction.
.It Ev BATCH
If defined, only operate on a port if it can be installed 100% automatically.
d555 3
d560 2
a561 1
Ports Mechanism: http://www.openbsd.org/ports.html
d565 2
a566 1
Porting Checklist: http://www.openbsd.org/checklist.html
d571 1
a571 6
It was introduced in
.Ox
by Ejovi Nuwere, with much initial effort by Angelos D. Keromytis.
Maintenance passed then to Marco S. Hyman, and then to Christopher Turan.
It is currently managed by Marc Espie, Brad Smith, and Christian Weisgerber,
along with a host of others found at ports@@openbsd.org.
@


1.1
log
@Initial revision
@
text
@d1 4
a4 1
.\"
d28 1
a28 4
.\"
.\" $OpenBSD: ports.7,v 1.42 2004/04/16 21:23:08 jmc Exp $
.\" $FreeBSD: ports.7,v 1.7 1998/06/23 04:38:50 hoek Exp $
.\"
d437 1
a437 1
.Pa distfiles/
@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
