head	1.1;
access;
symbols
	bsiegert-cfgfile:1.1.0.2;
locks; strict;
comment	@ * @;


1.1
date	2010.01.01.15.43.14;	author bsiegert;	state dead;
branches
	1.1.2.1;
next	;
commitid	1004B3E180123764EFE;

1.1.2.1
date	2010.01.01.15.43.14;	author bsiegert;	state Exp;
branches;
next	1.1.2.2;
commitid	1004B3E180123764EFE;

1.1.2.2
date	2010.02.27.11.06.07;	author bsiegert;	state Exp;
branches;
next	;
commitid	1004B88FC932807280C;


desc
@@


1.1
log
@file test-cfgfile.c was initially added on branch bsiegert-cfgfile.
@
text
@@


1.1.2.1
log
@Initial prototype of regression tests for pkgtools, using C and perl's
Test::More and Test::Harness (aka prove(1))
@
text
@a0 23
#include <err.h>
#include <stdbool.h>
#include <stdio.h>
#include "lib.h"

bool Verbose = true;

void
cleanup(int signo)
{
	/* do nothing */
}

int
main(int argc, char **argv)
{
	if (!cfg_read_config((argc > 1 ? argv[1] : NULL)))
		warnx("Reading config file failed");
	cfg_dump_vars();
	/*printf("\n");*/
	cfg_dump_sources();
	return 0;
}
@


1.1.2.2
log
@11 tests now, yay!
@
text
@a13 6
/* This program is called by the regression test test-cfgfile.t.
 * The first argument is the path to the configuration file, the second one
 * is either a variable name, the value of which is printed, or one of the
 * special values "Sources" or "Variables".
 */

d19 3
a21 11
	if (argc > 2) {
		if (!strcmp(argv[2], "Sources"))
			cfg_dump_sources();
		else if (!strcmp(argv[2], "Variables"))
			cfg_dump_vars();
		else
			cfg_dump_var(argv[2]);
	} else {
		cfg_dump_vars();
		cfg_dump_sources();
	}
@


