head	1.3;
access;
symbols
	MIRBSD_8_BASE:1.1.7.1;
locks; strict;
comment	@# @;


1.3
date	2009.03.29.13.04.04;	author tg;	state Exp;
branches;
next	1.2;
commitid	10049CF71B654F9EF54;

1.2
date	2008.05.03.22.19.36;	author tg;	state Exp;
branches;
next	1.1;
commitid	100481CE507120DC340;

1.1
date	2005.03.18.15.47.16;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.03.18.15.47.16;	author tg;	state Exp;
branches;
next	;


desc
@@


1.3
log
@• take care of dbins
• #!/bin/mksh shebang, in most places
• rcsid while here
@
text
@#!/bin/mksh
# $MirOS: ports/infrastructure/db/uname.sed,v 1.2 2008/05/03 22:19:36 tg Exp $
#-
# Copyright (c) 2004, 2008
#	Thorsten "mirabilos" Glaser <tg@@mirbsd.de>
#
# Provided that these terms and disclaimer and all copyright notices
# are retained or reproduced in an accompanying document, permission
# is granted to deal in this work without restriction, including un-
# limited rights to use, publicly perform, distribute, sell, modify,
# merge, give away, or sublicence.
#
# This work is provided "AS IS" and WITHOUT WARRANTY of any kind, to
# the utmost extent permitted by applicable law, neither express nor
# implied; without malicious intent or gross negligence. In no event
# may a licensor, author or contributor be held liable for indirect,
# direct, other damage, loss, or other issues arising in any way out
# of dealing in the work, even if advised of the possibility of such
# damage or existence of a defect, except proven that it results out
# of said person's immediate fault when using the work as intended.
#-
# Fake FreeBSD for MidnightBSD and OpenBSD for MirBSD, to aid broken
# build systems (Schily, Mozilla, ...)

function usage {
	print -u2 'usage: uname [-ailmnprsv]'
	exit 1
}

flag_a=
flag_i=
flag_l=
flag_m=
flag_n=
flag_p=
flag_r=
flag_s=
flag_v=
integer has_one=0

sysname=@@@@OStype@@@@
version=@@@@OScompat@@@@

while getopts "ailmnprsv" c; do
	case $c {
	(a)
		flag_l=-l
		flag_m=-m
		flag_n=-n
		flag_r=-r
		flag_s=-s
		flag_v=-v
		has_one=1 ;;
	(i|l|m|n|p|r|s|v)
		eval flag_$c=-$c
		has_one=1 ;;
	(*)
		usage ;;
	}
done
shift $((OPTIND - 1))

(( $# )) && usage

(( has_one )) || flag_s=-s
[[ $sysname = MirBSD ]] || flag_l=
[[ $sysname = MidnightBSD ]] || flag_i=

integer rv=0
if [[ -n $flag_n ]]; then
	nodename="$(/usr/bin/uname -n)"
	rv=$?
fi
reststr=
if [[ -n $flag_l$flag_v$flag_m$flag_p$flag_i ]]; then
	reststr="$(/usr/bin/uname $flag_l $flag_v $flag_m $flag_p $flag_i)"
	has_one=$?
	(( rv = rv ? rv : has_one ))
fi

outstr=
sp=
if [[ -n $flag_s ]]; then
	if [[ $sysname = MidnightBSD ]]; then
		outstr=FreeBSD
	elif [[ $sysname = MirBSD ]]; then
		outstr=OpenBSD
	else
		print -u2 "uname: unknown host os '$sysname'"
		exit 1
	fi
	sp=' '
fi
if [[ -n $flag_n ]]; then
	outstr=$outstr$sp$nodename
	sp=' '
fi
if [[ -n $flag_r ]]; then
	outstr=$outstr$sp$version
	sp=' '
fi
[[ -n $reststr ]] && outstr=$outstr$sp$reststr

print -r -- "$outstr"
exit $rv
@


1.2
log
@rewrite, support mnbsd, process muuuuch better
@
text
@d1 2
a2 2
#!/usr/bin/env mksh
# $MirOS: src/share/misc/licence.template,v 1.24 2008/04/22 11:43:31 tg Rel $
@


1.1
log
@Initial revision
@
text
@d1 2
a2 2
#!/bin/sh
# $MirOS$
d4 2
a5 2
# Copyright (c) 2004
#	Thorsten "mirabile" Glaser <x86@@ePost.de>
d7 5
a11 6
# Subject to these terms, everybody who obtained a copy of this work
# is hereby permitted to deal in the work without restriction inclu-
# ding without limitation the rights to use, distribute, sell, modi-
# fy, publically perform, give away, merge or sublicence it provided
# this notice is kept and the authors and contributors are given due
# credit in derivates or accompanying documents.
d13 8
a20 5
# This work is provided "as is" with no explicit or implicit warran-
# ties whatsoever to the maximum extent permitted by applicable law;
# in no event may an author or contributor be held liable for damage
# that is, directly or indirectly, caused by the work, even if advi-
# sed of the possibility of such damage.
d22 2
a23 1
# uname faking OpenBSD 3.4 for MirBSD #7 (eg. for schily, mozilla)
d25 48
a72 6
if [ -z "$1" -o x"$1" = x"-s" ]; then
	echo OpenBSD
  elif [ x"$1" = x"-r" ]; then
	echo @@@@OScompat@@@@
  else
	exec /usr/bin/uname "$@@"
d74 32
a105 1
exit 0
@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
