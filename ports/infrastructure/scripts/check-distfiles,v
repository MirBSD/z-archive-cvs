head	1.3;
access;
symbols
	MIRBSD_8_BASE:1.3;
locks; strict;
comment	@# @;


1.3
date	2005.11.15.19.34.01;	author tg;	state Exp;
branches;
next	1.2;
commitid	7927437a38332782;

1.2
date	2005.07.05.20.08.32;	author tg;	state Exp;
branches;
next	1.1;
commitid	6fe042cae8bb6f4d;

1.1
date	2005.03.18.15.47.19;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.03.18.15.47.19;	author tg;	state Exp;
branches;
next	;


desc
@@


1.3
log
@crude U+0060 removal
@
text
@#!/bin/sh
# $MirOS: ports/infrastructure/scripts/check-distfiles,v 1.2 2005/07/05 20:08:32 tg Exp $
# $OpenBSD: check-distfiles,v 1.4 2003/02/25 11:36:55 espie Exp $
#
# Copyright (c) 1999 Marc Espie.
# 
# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions
# are met:
# 1. Redistributions of source code must retain the above copyright
#    notice, this list of conditions and the following disclaimer.
# 2. Redistributions in binary form must reproduce the above copyright
#    notice, this list of conditions and the following disclaimer in the
#    documentation and/or other materials provided with the distribution.
# 
# THIS SOFTWARE IS PROVIDED BY THE OPENBSD PROJECT AND CONTRIBUTORS
# ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
# LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
# A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OPENBSD
# PROJECT OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
# SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
# LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
# DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
# THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
# (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
# OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

PATH=/bin:/usr/bin
export PATH

# This script does a full-scale check of everything that lives under
# /usr/ports/Distfiles
PORTS=/usr/ports
ALLSUMS=$(mktemp /tmp/checksums.XXXXXX) || exit 1
GREP_RESULT=$(mktemp /tmp/grep.XXXXXX) || exit 1
# assume that INDEX is up-to-date
touch $ALLSUMS
cut -d\| -f2 <$PORTS/INDEX|while read i
do
	if [ -f $i/distinfo ] 
	then
		cat $i/distinfo >>$ALLSUMS
	else
		echo "Port $i does not seem to have a checksum file"
	fi
done

cd $PORTS/Distfiles 
find . -type f|sed -e 's|^\./||'|while read name
do
	if grep "^SHA1 ($name) = " $ALLSUMS >$GREP_RESULT
	then
		sha1 $name >>$GREP_RESULT
		uniq -u <$GREP_RESULT
	else
		echo "no checksum recorded for $name"
	fi
done

rm $ALLSUMS $GREP_RESULT
@


1.2
log
@* capitalise the initial letter on Distfiles, Packages, etc.
* slightly change the Packages layout

agreed bsiegert@@
@
text
@d2 1
a2 1
# $MirOS$
d34 2
a35 2
ALLSUMS=`mktemp /tmp/checksums.XXXXXX` || exit 1
GREP_RESULT=`mktemp /tmp/grep.XXXXXX` || exit 1
@


1.1
log
@Initial revision
@
text
@d2 1
a2 1
#
d32 1
a32 1
# /usr/ports/distfiles
d48 1
a48 1
cd $PORTS/distfiles 
@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
