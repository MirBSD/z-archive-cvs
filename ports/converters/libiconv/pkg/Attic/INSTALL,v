head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2008.04.07.18.42.24;	author tg;	state dead;
branches;
next	1.1;
commitid	10047FA6A081EF172DD;

1.1
date	2008.03.14.19.41.43;	author tg;	state Exp;
branches;
next	;
commitid	10047DAD50844E03050;


desc
@@


1.2
log
@• nuke VMEM_WARNING
• nuke INSTALL/DEINSTALL: LIB_DEPENDS can do relative paths
  like this: LIB_DEPENDS+= ../giconv/lib/iconv
• nuke MESSAGE, it is only confusing these days (pre-MirBSD-#9 times)

• introduce fake pkgviews, formal specification:
  – ${LOCALBASE}/pkgview/${STEM} (i.e. PKGNAME without version and dashver)
  – PLIST must also contain hierarchy up to “@@dirrm pkgview”
  – ${LOCALBASE}/pkgview/${STEM}/ may have subdirs include and lib *ONLY*
    (everything else goes directly to ${LOCALBASE}/ as usual)
  – packages with this system must use (provide) MODULES
  – the MODULES file must provide something like ${FOO_PREFIX}
  – and should probably add it to the appropriate *FLAGS vars
• these are until we have real pkgview+buildlink3 style stuff like TNF
  (ok, probably never or in 5 years ☻)

‣ NOTE: @@lib will add /usr/mpkg/pkgview/libiconv/lib (in my case) to
  the default library search path *and not remove it on pkg_delete*!
  ① this is buggy, if you add it you must remove it too (XXX how?)
  ② this should be unneeded because we use DT_RPATH – Benny?
@
text
@#!/usr/bin/env mksh
# $MirOS: ports/converters/libiconv/pkg/INSTALL,v 1.1 2008/03/14 19:41:43 tg Exp $

# exit on errors, use a sane path and install prefix
#
set -e
PATH=/bin:/usr/bin:/sbin:/usr/sbin
PREFIX=${PKG_PREFIX:-/usr/local}

# verify proper execution
#
if [ $# -ne 2 ]; then
	print -u2 "usage: $0 distname { PRE-INSTALL | POST-INSTALL }"
	exit 1
fi

# Verify/process the command
#
case $2 in
PRE-INSTALL)
	: nothing to pre-install for this port
	;;
POST-INSTALL)
	cd ${PREFIX}/lib
	. ../giconv/lib/libiconv.la
	[[ -z $dlname ]] || ln -sf ../giconv/lib/$dlname \
	    $(echo $dlname | sed s/libiconv/libgiconv/)
	;;
*)
	print -u2 "usage: $0 distname { PRE-INSTALL | POST-INSTALL }"
	exit 1
	;;
esac

exit 0
@


1.1
log
@ok I'm fed up with it
@
text
@d2 1
a2 1
# $MirOS$
@

