head	1.7;
access;
symbols;
locks; strict;
comment	@# @;


1.7
date	2008.02.25.11.15.49;	author bsiegert;	state Exp;
branches;
next	1.6;
commitid	10047C2A32B0448D3FB;

1.6
date	2006.12.11.22.59.14;	author tg;	state Exp;
branches;
next	1.5;
commitid	100457DE2881CF8197C;

1.5
date	2006.11.20.22.50.49;	author tg;	state Exp;
branches;
next	1.4;
commitid	100456230FC38CFA9CB;

1.4
date	2006.09.14.00.15.39;	author tg;	state Exp;
branches;
next	1.3;
commitid	10045089C0E234154C3;

1.3
date	2006.02.09.09.36.25;	author tg;	state Exp;
branches;
next	1.2;
commitid	10043EB0C94610EDE76;

1.2
date	2005.07.07.21.29.21;	author bsiegert;	state Exp;
branches;
next	1.1;
commitid	66bc42cd9a7ea714;

1.1
date	2005.03.18.16.00.55;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.03.18.16.00.55;	author tg;	state Exp;
branches;
next	;


desc
@@


1.7
log
@SECURITY: Update to 8.4.18, fixes CVE-2008-0553.
@
text
@# $MirOS: ports/x11/tk/8.4/Makefile,v 1.6 2006/12/11 22:59:14 tg Exp $
# $OpenBSD: Makefile,v 1.6 2004/05/07 15:28:32 naddy Exp $

ONLY_FOR_PLATFORM=	MirBSD:*:* OpenBSD:*:*

COMMENT=		graphical toolkit for Tcl
VERSION=		8.4.18
DISTNAME=		tk${VERSION}-src
PKGNAME=		tk-${VERSION}-0
CATEGORIES=		x11 x11/tk
MASTER_SITES=		${MASTER_SITE_SOURCEFORGE:=tcl/}
HOMEPAGE=		http://www.tcl.tk/

# BSD
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

LIB_DEPENDS+=		tcl84:tcl-8.4.*:lang/tcl/8.4

FAKE_FLAGS=	INSTALL="install -c" INSTALL_ROOT="${WRKINST}" \
		BASE_INCLUDE_DIR='$$(prefix)/include/tk$$(VERSION)' \
		INCLUDE_INSTALL_DIR='$$(INSTALL_ROOT)$$(BASE_INCLUDE_DIR)' \
		GENERIC_INCLUDE_INSTALL_DIR='$$(BASE_INCLUDE_DIR)/generic' \
		UNIX_INCLUDE_INSTALL_DIR='$$(BASE_INCLUDE_DIR)/unix' \
		MAN_INSTALL_DIR='$${INSTALL_ROOT}$$(TK_LIBRARY)/man'

USE_X11=		Yes
CONFIGURE_STYLE=	autoconf no-autoheader
CONFIGURE_ARGS+=	${CONFIGURE_SHARED} \
			--enable-static \
			--with-tcl=${LOCALBASE:Q}/lib/tcl8.4
CONFIGURE_ENV+=		PORTSDIR="${PORTSDIR}"

WRKDIST=		${WRKDIR}/tk${VERSION}
WRKSRC=			${WRKDIST}/unix

REGRESS_TARGET=		test
REGRESS_DEPENDS+=	::lang/tcl/8.4:regress
REGRESS_FLAGS=		TCL_BIN_DIR=$$(cd ${PORTSDIR}/lang/tcl/8.4 && \
			    ${MAKE} show=WRKBUILD)
# This regression test wants an X11 display
REGRESS_FLAGS+=		DISPLAY=${DISPLAY} XAUTHORITY=${XAUTHORITY}
REGRESS_IS_INTERACTIVE=	Yes

post-install:
.ifndef DEBUG
	@@strip ${PREFIX}/bin/wish8.4
.endif

.include <bsd.port.mk>
@


1.6
log
@better workaround for the issue that lib dependencies' middle
part is not correctly checked pre-build: add them to BUILD_DEPENDS
if they have a middle part

XXX what about them being RUN_DEPENDS? especially on not shared
XXX arches, where this isn't done automatically... probably, if
XXX the library package (.cgz) contains additional stuff, the
XXX porter who devises the dependency should add an explicit
XXX run-time dependency
@
text
@d1 1
a1 1
# $MirOS: ports/x11/tk/8.4/Makefile,v 1.5 2006/11/20 22:50:49 tg Exp $
d7 1
a7 1
VERSION=		8.4.14
@


1.5
log
@update+fix

can't verify the testsuite though:
* evilwm crashes during "event" test
* icewm makes "clipboard" test fail
* focus-5.1 test fails
* grid test segfaults:
  Nov 20 22:34:17 odem /bsd: signal 11 received by (tktest:24807) UID(2999) EUID(2999), parent (mksh:6937) UID(2999) EUID(2999)

I just hope it's enoughâ€¦
@
text
@d1 1
a1 1
# $MirOS$
d20 1
a20 2
B_R_DEPENDS+=		:tcl->=8.4:lang/tcl/8.4
LIB_DEPENDS+=		tcl84::lang/tcl/8.4
@


1.4
log
@clean up COMMENT and HOMEPAGE; regenerate INDEX (2761, 169 marked as broken, probably many many more) ­ edited by script with manual postprocessing
@
text
@d1 1
d4 1
a4 1
COMMENT=			graphical toolkit for Tcl
d6 7
a12 1
VERSION=	8.4.6
d14 1
a14 8
DISTNAME=	tk${VERSION}-src
PKGNAME=	tk-${VERSION}-0
CATEGORIES=	x11 x11/tk
MASTER_SITES=	${MASTER_SITE_SOURCEFORGE:=tcl/}

HOMEPAGE=	http://www.tcl.tk/

# BSD 
d20 2
a21 1
LIB_DEPENDS=    tcl84:tcl->=8.4:lang/tcl/8.4
a22 1
MAKE_FLAGS=	CFLAGS="${CFLAGS}"
d30 14
a43 11
USE_X11=	Yes
CONFIGURE_STYLE= autoconf no-autoheader
CONFIGURE_ARGS+= ${CONFIGURE_SHARED}
CONFIGURE_ARGS+= --enable-static --with-tcl="${LOCALBASE}/lib/tcl8.4"
CONFIGURE_ENV=  PORTSDIR="${PORTSDIR}"

WRKDIST=	${WRKDIR}/tk${VERSION}/unix

REGRESS_TARGET=test
REGRESS_DEPENDS=::lang/tcl/8.4:regress
REGRESS_FLAGS=TCL_BIN_DIR=`cd ${PORTSDIR}/lang/tcl/8.4 && ${MAKE} show=WRKBUILD`
d45 2
a46 2
REGRESS_FLAGS+=DISPLAY=${DISPLAY} XAUTHORITY=${XAUTHORITY}
REGRESS_IS_INTERACTIVE=Yes
d49 1
d51 1
@


1.3
log
@remove SEPARATE_BUILD for once and for good, I'm fed up with
all the trouble it can cause - ports which need it (e.g. the
GCC SC doesnt "support" building gcc with srcdir=objdir) can
set stuff like WRKBUILD themselves.
@
text
@d3 1
a3 1
COMMENT=	"graphical toolkit for Tcl"
@


1.2
log
@Semi-automatic update of the remaining ports to the new patchlevel format.

Please correct mistakes if you find them :).
@
text
@a29 1
SEPARATE_BUILD=	concurrent
@


1.1
log
@Initial revision
@
text
@d8 1
a8 1
PKGNAME=	tk-${VERSION}
@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
