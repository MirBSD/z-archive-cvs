head	1.25;
access;
symbols;
locks; strict;
comment	@# @;


1.25
date	2014.05.28.21.26.58;	author tg;	state Exp;
branches;
next	1.24;
commitid	100538654B9251B19C1;

1.24
date	2010.01.06.17.32.36;	author bsiegert;	state Exp;
branches;
next	1.23;
commitid	1004B44C8F44C0A8C2F;

1.23
date	2009.12.28.14.55.15;	author tg;	state Exp;
branches;
next	1.22;
commitid	1004B38C6D25E238175;

1.22
date	2009.10.13.19.10.17;	author bsiegert;	state Exp;
branches;
next	1.21;
commitid	1004AD4D00E50F6A852;

1.21
date	2009.05.30.20.38.24;	author tg;	state Exp;
branches;
next	1.20;
commitid	1004A2198964D89D064;

1.20
date	2009.03.02.17.45.54;	author bsiegert;	state Exp;
branches;
next	1.19;
commitid	10049AC1B4D06B15B97;

1.19
date	2008.11.08.23.03.46;	author tg;	state Exp;
branches;
next	1.18;
commitid	10049161AC72620EAF0;

1.18
date	2008.08.19.18.07.29;	author tg;	state Exp;
branches;
next	1.17;
commitid	10048AB0BC837149826;

1.17
date	2008.08.08.20.47.36;	author tg;	state Exp;
branches;
next	1.16;
commitid	100489CB0C24CA9BB25;

1.16
date	2008.07.15.19.47.13;	author bsiegert;	state Exp;
branches;
next	1.15;
commitid	100487CFEA04998EF8E;

1.15
date	2008.04.07.19.20.05;	author tg;	state Exp;
branches;
next	1.14;
commitid	10047FA73D650DD59D5;

1.14
date	2008.03.09.17.23.03;	author tg;	state Exp;
branches;
next	1.13;
commitid	10047D41CAA7E715397;

1.13
date	2007.12.29.16.57.34;	author bsiegert;	state Exp;
branches;
next	1.12;
commitid	10047767C9600007725;

1.12
date	2007.08.24.14.23.40;	author tg;	state Exp;
branches;
next	1.11;
commitid	10046CEE9FC1401796C;

1.11
date	2007.07.19.22.13.07;	author tg;	state Exp;
branches;
next	1.10;
commitid	100469FE1FD2A71EBDA;

1.10
date	2007.07.19.22.10.20;	author tg;	state Exp;
branches;
next	1.9;
commitid	100469FE15C64315C1A;

1.9
date	2007.04.03.19.44.08;	author tg;	state Exp;
branches;
next	1.8;
commitid	1004612AC977E789195;

1.8
date	2006.09.14.00.10.26;	author tg;	state Exp;
branches;
next	1.7;
commitid	10045089C0E234154C3;

1.7
date	2005.11.16.19.08.22;	author tg;	state Exp;
branches;
next	1.6;
commitid	6735437b83b3a100;

1.6
date	2005.11.15.19.23.38;	author tg;	state Exp;
branches;
next	1.5;
commitid	4bc7437a35cfd3f4;

1.5
date	2005.11.15.19.16.56;	author tg;	state Exp;
branches;
next	1.4;
commitid	3e70437a3435830c;

1.4
date	2005.11.04.14.02.32;	author tg;	state Exp;
branches;
next	1.3;
commitid	35cd436b691eab9c;

1.3
date	2005.07.07.21.22.32;	author bsiegert;	state Exp;
branches;
next	1.2;
commitid	66bc42cd9a7ea714;

1.2
date	2005.04.10.22.43.51;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.03.18.15.47.49;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.03.18.15.47.49;	author tg;	state Exp;
branches;
next	;


desc
@@


1.25
log
@drop (non-free) sqlite support; fix some regression tests
@
text
@# $MirOS: ports/lang/python/Makefile.inc,v 1.24 2010/01/06 17:32:36 bsiegert Exp $
# $OpenBSD: Makefile.inc,v 1.32 2005/06/06 20:47:04 alek Exp $

.include <mirports.sys.mk>

# IMPORTANT!  If you make any changes to the Python ports, be sure
# to also update files/CHANGES.MirPorts for your change.  This is a
# requirement of the PSF license, if it constitutes a change to
# Python itself.

COMMENT=		interpreted object-oriented programming language

PKGNAME=		python-${VERSION}${PATCHLEVEL}-${DASH_VER}
DISTNAME=		Python-${VERSION}${PATCHLEVEL}
CATEGORIES=		lang
MASTER_SITES=		http://www.python.org/ftp/${PSUBDIR}/
PSUBDIR=		python/${VERSION}${PATCHLEVEL}
EXTRACT_SUFX=		.tgz

HOMEPAGE=		http://www.python.org/

# PSF license <http://www.python.org/${VERSION}/license.html>
# A summary of changes to Python is required to be distributed
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

LIB_DEPENDS+=		bz2::archivers/bzip2

# Python wants GNU libreadline so badly.
MODULES+=		devel/libreadline
CPPFLAGS+=		-I${WRKDIR:Q}/include	# XXX hack, see below

CONFIGURE_STYLE=	autoconf
AUTOCONF_NEW=		Yes
CONFIGURE_ARGS+=	${CONFIGURE_SHARED}
# --srcdir is needed for systrace to work correctly
CONFIGURE_ARGS+=	--with-fpectl --with-threads --srcdir=${WRKSRC:Q}
.if ${OStype:NInterix:NDarwin}
CONFIGURE_ARGS+=	--enable-ipv6
.endif
.if ${OStype:MDarwin}
CONFIGURE_ARGS+=	MACOSX_DEPLOYMENT_TARGET=
.endif

# THREAD_STACK_SIZE value might be changed by particular python release
THREAD_STACK_SIZE?=	0x20000		# increase this for zope

REGRESS_TARGET=		test
# see mircvs://contrib/code/Snippets/posixtz.c
.if exists(/usr/lib/libposixtz.so)
REGRESS_ENV+=		LD_PRELOAD=/usr/lib/libposixtz.so
.endif

.for _i in ${MACHINE_ARCH} ${ARCH}
.  if !empty(LP64_PLATFORMS:M${OStype}\:${_i})
NO64BIT=	\#
.  endif
.endfor

.ifdef NO64BIT
SED_PLIST+=	-e '/%%mm%%/d'
.else
SED_PLIST+=	-e '/%%mm%%/r${PKGDIR}/PFRAG.mm' -e '//d'
.endif

.if ${OStype} == "MirBSD"
NONIS=		\#
SED_PLIST+=	| sed -e '/^IFNIS:/d'
.else
SED_PLIST+=	| sed -e '/^IFNIS:/s///'
.endif

.if ${OStype} == "Darwin"
INSTALL_STRIP=
.endif

# Same algorithm as in configure
.ifndef _MD_SYSTEM
_MD_SYSTEM!=	uname -s | tr -d '[/ ]' | tr '[[A-Z]]' '[[a-z]]'
.MAKEFLAGS:=	${.MAKEFLAGS} _MD_SYSTEM=${_MD_SYSTEM:Q}
.endif
.ifndef _MD_RELEASE
_MD_RELEASE!=	uname -r | tr -d '[/ ]' | sed 's/^[[A-Z]]\.//' | sed 's/\..*//'
.MAKEFLAGS:=	${.MAKEFLAGS} _MD_RELEASE=${_MD_RELEASE:Q}
.endif
.if ${OStype:MDarwin}
MACHDEP=	${_MD_SYSTEM}
.else
MACHDEP=	${_MD_SYSTEM}${_MD_RELEASE}
.endif
SUBST_VARS+=	MACHDEP PATCHLEVEL

post-extract:
	mkdir -p ${WRKDIR}/include
	ln -s ${LOCALBASE}/include/readline ${WRKDIR}/include/

post-install:
	${INSTALL_SCRIPT} ${WRKSRC}/Tools/scripts/pydoc \
		${PREFIX}/bin/pydoc${VERSION}
	if [ -f ${FILESDIR}/idle ] ; then \
	sed -e "s,@@VERSION@@,${VERSION},g" -e "s,@@LOCALBASE@@,${LOCALBASE},g" \
		${FILESDIR}/idle >${WRKSRC}/idle ; \
	${INSTALL_SCRIPT} ${WRKSRC}/idle ${PREFIX}/bin/idle${VERSION} ; \
	fi
	cd ${WRKSRC}; tar -cf - Tools | (cd ${PREFIX}/lib/python${VERSION}; \
		tar -xf -)
	${INSTALL_DATA} ${WRKSRC}/libpython${VERSION}.a \
		${PREFIX}/lib/python${VERSION}/config
	if [ -f ${PREFIX}/lib/python${VERSION}/config/libpython${VERSION}.so.0.0 ]; then \
		cd ${PREFIX}/lib && ln -s python${VERSION}/config/libpython${VERSION}.so.0.0; \
	fi
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/python${VERSION}
	${INSTALL_DATA} ${FILESDIR}/CHANGES.* \
	    ${PREFIX}/share/doc/python${VERSION}/
@


1.24
log
@Make this actually usable on Darwin by installing unstripped binaries.
Also quote the tests for MACOSX_DEPLOYMENT_TARGET, which may be empty,
and drop support for old (<10.3) Mac OS versions. Bump 2.5 patchlevel.
@
text
@d1 1
a1 1
# $MirOS: ports/lang/python/Makefile.inc,v 1.23 2009/12/28 14:55:15 tg Exp $
d51 4
@


1.23
log
@speed up recursive ops by use of .MAKEFLAGS (not MAKEFLAGS like TNF,
since our make is different, apparently)
@
text
@d1 1
a1 1
# $MirOS: ports/lang/python/Makefile.inc,v 1.22 2009/10/13 19:10:17 bsiegert Exp $
d71 4
@


1.22
log
@Python builds and works using libffi from ports on Darwin. PFRAG.shared now
contains all the files not installed by default on Darwin.
@
text
@d1 1
a1 1
# $MirOS: ports/lang/python/Makefile.inc,v 1.21 2009/05/30 20:38:24 tg Exp $
d72 1
d74 3
d78 2
@


1.21
log
@â€¢ update to the latest 2.5 series Python
â€¢ cope for possible hidden dependency on ncursesw
â€¢ mark as NOT_FOR_PLATFORM Darwin, because both anakin and jajabings
  are not powered on right now, so I cannot sync PFRAG.dylib, and this
  way we can avoid needing to bump DASH_VER upon doing so (just remove
  the NOT_FOR_PLATFORM clause, commit Makefile and PFRAG.dylib at once)
â€¢ make dbhash usable with bsddb185 module ipv bsddb module (gebi@@grml.org)
â€¢ make gdbm usable, itâ€™s pulled in anyway if installed, and in py3k there
  will be no bsddb[185] any more anyway (gebi@@grml.org)
â€¢ ensure IPv6 is not forcibly enabled on Interix
â€¢ add PATCHLEVEL to SUBST_VARS (for egg info)
@
text
@d1 1
a1 1
# $MirOS: ports/lang/python/Makefile.inc,v 1.20 2009/03/02 17:45:54 bsiegert Exp $
d40 1
a40 1
.if ${OStype} != "Interix"
d43 3
d74 3
d78 1
@


1.20
log
@Hopefully unbreak python2.3 by removing some superfluous @@ signs
@
text
@d1 1
a1 1
# $MirOS: ports/lang/python/Makefile.inc,v 1.19 2008/11/08 23:03:46 tg Exp $
d33 1
a33 1
CPPFLAGS+=		-I${WRKDIR}/include	# XXX hack, see below
d39 2
a40 1
CONFIGURE_ARGS+=	--with-fpectl --with-threads --srcdir=${WRKSRC}
d42 1
d72 1
a72 1
SUBST_VARS+=	MACHDEP
@


1.19
log
@more mass conversions, including ancient eMail addresses
@
text
@d1 1
a1 1
# $MirOS: ports/lang/python/Makefile.inc,v 1.18 2008/08/19 18:07:29 tg Exp $
d80 1
a80 1
	@@sed -e "s,@@VERSION@@,${VERSION},g" -e "s,@@LOCALBASE@@,${LOCALBASE},g" \
d84 1
a84 1
	@@cd ${WRKSRC}; tar -cf - Tools | (cd ${PREFIX}/lib/python${VERSION}; \
d88 1
a88 1
	@@if [ -f ${PREFIX}/lib/python${VERSION}/config/libpython${VERSION}.so.0.0 ]; then \
@


1.18
log
@â€¢ introduce the GNU libreadline module and pkgviews!
â€¢ required to unbreak and fix gnuplot, and do so
â€¢ â€¦ including time_t crap
@
text
@d1 1
a1 1
# $MirOS: ports/lang/python/Makefile.inc,v 1.17 2008/08/08 20:47:36 tg Exp $
a31 2
# XXX both PSF and FSF say Python licence is GPL compatible,
# XXX but I doubt it a little. -mirabile
@


1.17
log
@CHANGES.OpenBSD was missingâ€¦ now how could that come? :D
We just install CHANGES.* files now.
@
text
@d1 1
a1 1
# $MirOS: ports/lang/python/Makefile.inc,v 1.16 2008/07/15 19:47:13 bsiegert Exp $
d34 1
a34 1
LIB_DEPENDS+=		readline::devel/libreadline
@


1.16
log
@Oops, Makefile.inc has to be changed for this to work. While here, adapt
2.3 to the new Makefile.in (actually, move almost everything over to
2.3/Makefile) and upgrade to 2.3.7.
@
text
@d1 1
a1 1
# $MirOS: ports/lang/python/Makefile.inc,v 1.15 2008/04/07 19:20:05 tg Exp $
d94 1
a94 4
	${INSTALL_DATA} ${FILESDIR}/CHANGES.OpenBSD \
		${PREFIX}/share/doc/python${VERSION}/CHANGES.OpenBSD
	[[ ! -f ${FILESDIR}/CHANGES.MirPorts ]] || \
	    ${INSTALL_DATA} ${FILESDIR}/CHANGES.MirPorts \
@


1.15
log
@â€¢ KNF, simplify, etc.
â€¢ use MODULES+=textproc/expat

not a single one of them is tested, sry Benny, but you got the faster box â˜»
@
text
@d1 1
a1 1
# $MirOS: ports/lang/python/Makefile.inc,v 1.14 2008/03/09 17:23:03 tg Exp $
a11 8
COMMENT-bsddb=		Berkeley db module for Python
COMMENT-expat=		expat module for Python
COMMENT-gdbm=		GNU dbm module for Python
COMMENT-idle=		IDE for Python
COMMENT-mpz=		GNU arbitrary magnitude integer module for Python
COMMENT-tests=		Python test suite
COMMENT-tkinter=	tk GUI module for Python
COMMENT-tools=		extra tools for Python
a20 1
RESPONSIBLE=		Benny Siegert <bsiegert@@gmx.de>
a28 14
FLAVOURS+=		no_bsddb no_cxx no_expat no_gdbm no_idle no_mpz no_tkinter
FLAVOUR?=		no_bsddb

.if ${FLAVOUR:L:Mno_cxx}
FLAVOUR+=		no_bsddb no_expat no_gdbm no_idle no_mpz no_tkinter
CONFIGURE_ARGS+=	--without-cxx
MULTI_PACKAGES=
.else
USE_CXX=		Yes
MULTI_PACKAGES=		-tests -tools
.endif

SUBPACKAGE?=

d34 1
a34 1
LIB_DEPENDS+=		readline.5::devel/libreadline
a36 125
.if defined(PACKAGING)
#  All subpackages depend on the main python package.
.  if !empty(SUBPACKAGE)
.    if ${FLAVOUR:L:Mno_cxx}
RUN_DEPENDS+=		::lang/python/${VERSION},no_cxx
.    else
RUN_DEPENDS+=		::lang/python/${VERSION}
.    endif
LIB_DEPENDS=
.  endif
.endif

# On architectures with shared libs, no_xxx flavours are a convenient
# way to avoid pulling in dependencies, and don't actually show up
# in the final package names.  On architectures without shared libs,
# no_xxx flavours dictate what gets linked into the Python binary.

.if empty(FLAVOUR:L:Mno_bsddb)
.  if ${FLAVOUR:L:Mno_cxx}
BUILD_DEPENDS+=		::databases/db,no_cxx
.  else
BUILD_DEPENDS+=		::databases/db
.  endif
SETUP_LOCAL+=		Setup.bsddb
.  if !defined(NO_SHARED_LIBS) || ${NO_SHARED_LIBS:U} != YES
MULTI_PACKAGES+=	-bsddb
.  else
LIB_DEPENDS+=		db.4.2::databases/db
.  endif
.endif

.if defined(PACKAGING) && ${SUBPACKAGE} == "-bsddb"
LIB_DEPENDS+=		db.4.2::databases/db
.endif

.if empty(FLAVOUR:L:Mno_gdbm)
BUILD_DEPENDS+=		::databases/gdbm
SETUP_LOCAL+=		Setup.gdbm
.  if !defined(NO_SHARED_LIBS) || ${NO_SHARED_LIBS:U} != YES
MULTI_PACKAGES+=	-gdbm
.  else
LIB_DEPENDS+=		gdbm.3::databases/gdbm
.  endif
.endif

.if defined(PACKAGING) && ${SUBPACKAGE} == "-gdbm"
LIB_DEPENDS+=		gdbm.3::databases/gdbm
.endif

.if empty(FLAVOUR:L:Mno_idle) && empty(FLAVOUR:L:Mno_tkinter)
.  if !defined(NO_SHARED_LIBS) || ${NO_SHARED_LIBS:U} != YES
MULTI_PACKAGES+=	-idle
.  endif
.endif

.if defined(PACKAGING) && ${SUBPACKAGE} == "-idle"
RUN_DEPENDS+=		::lang/python/${VERSION},-tkinter
.endif

.if empty(FLAVOUR:L:Mno_tkinter)
USE_X11=		Yes
BUILD_DEPENDS+=		::x11/tk/8.4
SETUP_LOCAL+=		Setup.tkinter
.  if !defined(NO_SHARED_LIBS) || ${NO_SHARED_LIBS:U} != YES
MULTI_PACKAGES+=	-tkinter
SED_PLIST+=		| sed -e '/^%%tkinter%%/d' \
			| sed -e '/^%%tkinter_no_shared%%/r${PKGDIR}/PFRAG-tkinter.no_shared' -e '//d'
.  else
SED_PLIST+=		| sed -e '/^%%tkinter%%/r${PKGDIR}/PFRAG-tkinter.no_shared' -e '//d'
LIB_DEPENDS+=		tk84::x11/tk/8.4
.  endif
.else
SED_PLIST+=		| sed -e '/^%%tkinter%%/d'
.endif

.if defined(PACKAGING) && ${SUBPACKAGE} == "-tkinter"
LIB_DEPENDS+=		tk84::x11/tk/8.4
.endif

.if empty(FLAVOUR:L:Mno_mpz) && ${VERSION} == "2.3"
BUILD_DEPENDS+=		::devel/gmp
SETUP_LOCAL+=		Setup.mpz
.  if !defined(NO_SHARED_LIBS) || ${NO_SHARED_LIBS:U} != YES
MULTI_PACKAGES+= 	-mpz
.  else
LIB_DEPENDS+=		gmp::devel/gmp
.  endif
.endif

.if defined(PACKAGING) && ${SUBPACKAGE} == "-mpz"
LIB_DEPENDS+=		gmp::devel/gmp
.endif

.if empty(FLAVOUR:L:Mno_expat) && ${VERSION} == "2.3"
SETUP_LOCAL+=		Setup.expat
.  if !defined(NO_SHARED_LIBS) || ${NO_SHARED_LIBS:U} != YES
.    if !defined(PACKAGING)
MODULES+=		textproc/expat
.    endif
MULTI_PACKAGES+= 	-expat
.  else
MODULES+=		textproc/expat
.  endif
.endif

.if defined(PACKAGING) && ${SUBPACKAGE} == "-expat"
MODULES+=		textproc/expat
.endif

# Strip off no_xxx flavours from the package name if we are not
# building the "monster" Python for platforms without shared libraries.

.if !defined(NO_SHARED_LIBS) || ${NO_SHARED_LIBS:U} != YES
FULLPKGNAME=		${PKGNAME}${FLAVOUR_EXT:S/-no_bsddb//:S/-no_expat//:S/-no_gdbm//:S/-no_idle//:S/-no_mpz//:S/-no_tkinter//}
.endif

FULLPKGNAME-bsddb=	python-bsddb-${VERSION}${PATCHLEVEL}-${DASH_VER}
FULLPKGNAME-expat=	python-expat-${VERSION}${PATCHLEVEL}-${DASH_VER}
FULLPKGNAME-gdbm=	python-gdbm-${VERSION}${PATCHLEVEL}-${DASH_VER}
FULLPKGNAME-idle=	python-idle-${VERSION}${PATCHLEVEL}-${DASH_VER}
FULLPKGNAME-mpz=	python-mpz-${VERSION}${PATCHLEVEL}-${DASH_VER}
FULLPKGNAME-tests=	python-tests-${VERSION}${PATCHLEVEL}-${DASH_VER}
FULLPKGNAME-tkinter=	python-tkinter-${VERSION}${PATCHLEVEL}-${DASH_VER}
FULLPKGNAME-tools=	python-tools-${VERSION}${PATCHLEVEL}-${DASH_VER}

a67 12
.if defined(NO_SHARED_LIBS) && ${NO_SHARED_LIBS:U} == YES
NOSHARED=	\#
CONFIGURE_ENV+=	OPT='${CFLAGS}' LDFLAGS='-L${WRKSRC}'
.else
CONFIGURE_ENV+= OPT='${CFLAGS} -DTHREAD_STACK_SIZE=${THREAD_STACK_SIZE} ${PICFLAG}'
LDFLAGS+=	-L${WRKSRC}
MAKE_FLAGS+=	MAJOR=0 MINOR=0 LDLIBRARY=libpython${VERSION}.so.0.0 \
		LD_LIBRARY_PATH=${WRKSRC} PATH="${WRKDIST}:${PORTPATH}"
FAKE_FLAGS+=	MAJOR=0 MINOR=0 LDLIBRARY=libpython${VERSION}.so.0.0 \
		LD_LIBRARY_PATH=${WRKSRC} RANLIB=:
.endif

a74 1
	# XXX hack
a76 12
	# XXX endhack

post-configure:
	@@sed -e 's,@@NOSHARED@@,${NOSHARED},g'	\
	     -e 's,@@NO64BIT@@,${NO64BIT},g'	\
	     -e 's,@@NONIS@@,${NONIS},g'		\
		${FILESDIR}/Setup >${WRKSRC}/Modules/Setup
.for file in ${SETUP_LOCAL}
	@@sed -e 's,@@NOSHARED@@,${NOSHARED},g'	\
		${FILESDIR}/${file} >>${WRKSRC}/Modules/Setup.local
.endfor
	@@cd ${WRKSRC} && ${MAKE_PROGRAM} Makefile
d81 1
d83 3
a85 2
		${FILESDIR}/idle >${WRKSRC}/idle
	${INSTALL_SCRIPT} ${WRKSRC}/idle ${PREFIX}/bin/idle${VERSION}
@


1.14
log
@bulk convert FLAVOR to FLAVOUR; nuke unused file; convert to $Mdocdate
@
text
@d1 1
a1 1
# $MirOS: ports/lang/python/Makefile.inc,v 1.13 2007/12/29 16:57:34 bsiegert Exp $
a152 6
.if ${OStype} == "MirBSD"
MODPY_LOCAL_EXPAT=	# nothing, itâ€™s in base since MirOS #8
.else
MODPY_LOCAL_EXPAT=	expat.4.0:expat->=1.95.6:textproc/expat
.endif

d157 1
a157 1
LIB_DEPENDS+=		${MODPY_LOCAL_EXPAT}
d161 1
a161 1
LIB_DEPENDS+=		${MODPY_LOCAL_EXPAT}
d166 1
a166 1
LIB_DEPENDS+=		${MODPY_LOCAL_EXPAT}
@


1.13
log
@All python ports: new MASTER_SITE, mirroring has been discontinued (!).
2.3: update to 2.3.6-0.
@
text
@d1 1
a1 1
# $MirOS: ports/lang/python/Makefile.inc,v 1.12 2007/08/24 14:23:40 tg Exp $
d38 2
a39 2
FLAVORS+=		no_bsddb no_cxx no_expat no_gdbm no_idle no_mpz no_tkinter
FLAVOR?=		no_bsddb
d41 2
a42 2
.if ${FLAVOR:L:Mno_cxx}
FLAVOR+=		no_bsddb no_expat no_gdbm no_idle no_mpz no_tkinter
d63 1
a63 1
.    if ${FLAVOR:L:Mno_cxx}
d72 1
a72 1
# On architectures with shared libs, no_xxx flavors are a convenient
d75 1
a75 1
# no_xxx flavors dictate what gets linked into the Python binary.
d77 2
a78 2
.if empty(FLAVOR:L:Mno_bsddb)
.  if ${FLAVOR:L:Mno_cxx}
d95 1
a95 1
.if empty(FLAVOR:L:Mno_gdbm)
d109 1
a109 1
.if empty(FLAVOR:L:Mno_idle) && empty(FLAVOR:L:Mno_tkinter)
d119 1
a119 1
.if empty(FLAVOR:L:Mno_tkinter)
d139 1
a139 1
.if empty(FLAVOR:L:Mno_mpz) && ${VERSION} == "2.3"
d159 1
a159 1
.if empty(FLAVOR:L:Mno_expat) && ${VERSION} == "2.3"
d175 1
a175 1
# Strip off no_xxx flavors from the package name if we are not
d179 1
a179 1
FULLPKGNAME=		${PKGNAME}${FLAVOR_EXT:S/-no_bsddb//:S/-no_expat//:S/-no_gdbm//:S/-no_idle//:S/-no_mpz//:S/-no_tkinter//}
@


1.12
log
@we frigginâ€™ have expat in base since AGES
@
text
@d1 1
a1 1
# $MirOS: ports/lang/python/Makefile.inc,v 1.11 2007/07/19 22:13:07 tg Exp $
d24 1
a24 3
MASTER_SITES=		ftp://ftp.python.org/pub/${PSUBDIR}/ \
			http://python.mirrors.pair.com/ftp/${PSUBDIR}/ \
			http://python.mirrors.ilisys.com.au/ftp/${PSUBDIR}/
@


1.11
log
@â€¢ it's DASH_VER not PKG_PATCHLEVEL *yuck*
â€¢ regen distinfo
@
text
@d1 1
a1 1
# $MirOS: ports/lang/python/Makefile.inc,v 1.10 2007/07/19 22:10:20 tg Exp $
d155 6
d165 1
a165 1
LIB_DEPENDS+=		expat.4.0:expat->=1.95.6:textproc/expat
d169 1
a169 1
LIB_DEPENDS+=		expat.4.0:expat->=1.95.6:textproc/expat
d174 1
a174 1
LIB_DEPENDS+=		expat.4.0:expat->=1.95.6:textproc/expat
@


1.10
log
@bsddb is currently ${BROKEN}
@
text
@d1 1
a1 1
# $MirOS: ports/lang/python/Makefile.inc,v 1.9 2007/04/03 19:44:08 tg Exp $
d21 1
a21 1
PKGNAME=		python-${VERSION}${PATCHLEVEL}${PKG_PATCHLEVEL}
d178 8
a185 8
FULLPKGNAME-bsddb=	python-bsddb-${VERSION}${PATCHLEVEL}${PKG_PATCHLEVEL}
FULLPKGNAME-expat=	python-expat-${VERSION}${PATCHLEVEL}${PKG_PATCHLEVEL}
FULLPKGNAME-gdbm=	python-gdbm-${VERSION}${PATCHLEVEL}${PKG_PATCHLEVEL}
FULLPKGNAME-idle=	python-idle-${VERSION}${PATCHLEVEL}${PKG_PATCHLEVEL}
FULLPKGNAME-mpz=	python-mpz-${VERSION}${PATCHLEVEL}${PKG_PATCHLEVEL}
FULLPKGNAME-tests=	python-tests-${VERSION}${PATCHLEVEL}${PKG_PATCHLEVEL}
FULLPKGNAME-tkinter=	python-tkinter-${VERSION}${PATCHLEVEL}${PKG_PATCHLEVEL}
FULLPKGNAME-tools=	python-tools-${VERSION}${PATCHLEVEL}${PKG_PATCHLEVEL}
@


1.9
log
@â€¢ remove ports that are simply broken, don't work, for too long, with no
  update or update-willing person in sight, kde stuff, web2.0 stuff that
  we don't want in ports (just stuff it into /var/www yourself, it isn't
  that difficult, right?), stuff for which no new version exists/will be
  and some obsd cruft; adjust dependencies
â€¢ no BUILD_DEPENDS+=RUN_DEPENDS or vice versa any more, *ever*
â€¢ fix some other stuff partially

ok bsiegert@@
@
text
@d1 1
a1 1
# $MirOS: ports/lang/python/Makefile.inc,v 1.8 2006/09/14 00:10:26 tg Exp $
d41 1
a41 1
FLAVOR?=
@


1.8
log
@clean up COMMENT and HOMEPAGE; regenerate INDEX (2761, 169 marked as broken, probably many many more) ­ edited by script with manual postprocessing
@
text
@d1 1
a1 1
# $MirOS: ports/lang/python/Makefile.inc,v 1.7 2005/11/16 19:08:22 tg Exp $
d11 18
a28 18
COMMENT=			interpreted object-oriented programming language
COMMENT-bsddb=			Berkeley db module for Python
COMMENT-expat=			expat module for Python
COMMENT-gdbm=			GNU dbm module for Python
COMMENT-idle=			IDE for Python
COMMENT-mpz=			GNU arbitrary magnitude integer module for Python
COMMENT-tests=			Python test suite
COMMENT-tkinter=			tk GUI module for Python
COMMENT-tools=			extra tools for Python

PKGNAME=	python-${VERSION}${PATCHLEVEL}${PKG_PATCHLEVEL}
DISTNAME=	Python-${VERSION}${PATCHLEVEL}
CATEGORIES=	lang
MASTER_SITES=	ftp://ftp.python.org/pub/${PSUBDIR}/ \
		http://python.mirrors.pair.com/ftp/${PSUBDIR}/ \
		http://python.mirrors.ilisys.com.au/ftp/${PSUBDIR}/
PSUBDIR=	python/${VERSION}${PATCHLEVEL}
EXTRACT_SUFX=	.tgz
d30 2
a31 2
HOMEPAGE=	http://www.python.org/
RESPONSIBLE=	Benny Siegert <bsiegert@@gmx.de>
d195 1
a195 1
THREAD_STACK_SIZE?=	0x20000
@


1.7
log
@whoops... -0 confusion
thanks bsiegert@@ for noticing
@
text
@d1 1
a1 1
# $MirOS: ports/lang/python/Makefile.inc,v 1.6 2005/11/15 19:23:38 tg Exp $
d11 9
a19 9
COMMENT=	"interpreted object-oriented programming language"
COMMENT-bsddb=	"Berkeley db module for Python"
COMMENT-expat=	"expat module for Python"
COMMENT-gdbm=	"GNU dbm module for Python"
COMMENT-idle=	"IDE for Python"
COMMENT-mpz=	"GNU arbitrary magnitude integer module for Python"
COMMENT-tests=	"Python test suite"
COMMENT-tkinter="tk GUI module for Python"
COMMENT-tools=	"extra tools for Python"
@


1.6
log
@spacing
@
text
@d1 1
a1 1
# $MirOS: ports/lang/python/Makefile.inc,v 1.5 2005/11/15 19:16:56 tg Exp $
d175 1
a175 1
FULLPKGNAME=		${PKGNAME}${FLAVOR_EXT:S/-no_bsddb//:S/-no_expat//:S/-no_gdbm//:S/-no_idle//:S/-no_mpz//:S/-no_tkinter//}-0
@


1.5
log
@update to 2.3.5 (final)
@
text
@d1 1
a1 1
# $MirOS: ports/lang/python/Makefile.inc,v 1.4 2005/11/04 14:02:32 tg Exp $
d213 1
a213 1
SED_PLIST+=	|sed -e '/^IFNIS:/d'
d215 1
a215 1
SED_PLIST+=	|sed -e '/^IFNIS:/s///'
@


1.4
log
@Preliminary commit, to be ok'd by bsiegert@@ later
* remove Python 2.1
* remove Python 2.2
* make the Python 2.3 Makefile easier by shoving stuff into Makefile.inc
* sync patch-configure_in with OpenBSD
  + cc -shared for a.out platforms on 3.8+
  + support for 3.7, 3.8
* add RCS IDs to all patches/files
* sync port and Makefile.inc better against OpenBSD
* sort flavours
* sort Makefile.inc order
* no_cxx flavour now implies _all_ other no_* (missed expat)
* use ${PICFLAG} not -fPIC (invalid on e.g. Darwin, Interix)
* by default, still pull in only the no_cxx flavour as a dependency
  XXX should make no-no_cxx match no_cxx dependency
* XXX update to 2.3.5 missing, will commit that (and 2.4) later
  after this is ok'd by bsiegert@@

untested, WIP
@
text
@d1 1
a1 1
# $MirOS: ports/lang/python/Makefile.inc,v 1.3 2005/07/07 21:22:32 bsiegert Exp $
d4 2
d21 1
a21 1
PKGNAME=	python-${VERSION}${PATCHLEVEL}${PKG_PATCHLEVEL}-0
d60 1
d178 8
a185 7
FULLPKGNAME-expat=	python-expat-${VERSION}${PATCHLEVEL}${PKG_PATCHLEVEL}-0
FULLPKGNAME-gdbm=	python-gdbm-${VERSION}${PATCHLEVEL}${PKG_PATCHLEVEL}-0
FULLPKGNAME-idle=	python-idle-${VERSION}${PATCHLEVEL}${PKG_PATCHLEVEL}-0
FULLPKGNAME-mpz=	python-mpz-${VERSION}${PATCHLEVEL}${PKG_PATCHLEVEL}-0
FULLPKGNAME-tests=	python-tests-${VERSION}${PATCHLEVEL}${PKG_PATCHLEVEL}-0
FULLPKGNAME-tkinter=	python-tkinter-${VERSION}${PATCHLEVEL}${PKG_PATCHLEVEL}-0
FULLPKGNAME-tools=	python-tools-${VERSION}${PATCHLEVEL}${PKG_PATCHLEVEL}-0
a198 2
.include <mirports.sys.mk>

d206 1
a206 1
SED_PLIST+=-e '/%%mm%%/d'
d208 8
a215 1
SED_PLIST+=-e '/%%mm%%/r${PKGDIR}/PFRAG.mm' -e '//d'
d236 6
d245 1
@


1.3
log
@Semi-automatic update of the remaining ports to the new patchlevel format.

Please correct mistakes if you find them :).
@
text
@d1 2
a2 2
# $MirOS: ports/lang/python/Makefile.inc,v 1.1.7.1 2005/03/18 15:47:49 tg Exp $
# $OpenBSD: Makefile.inc,v 1.21 2004/05/15 06:43:23 sturm Exp $
d10 1
d38 1
a38 1
FLAVORS+=		no_expat no_gdbm no_idle no_mpz no_tkinter no_cxx
d42 1
a42 1
FLAVOR+=		no_gdbm no_idle no_mpz no_tkinter
d52 1
a52 8
# All subpackages depend on the main python package.
.if defined(PACKAGING) && !empty(SUBPACKAGE)
.  if ${FLAVOR:L:Mno_cxx}
RUN_DEPENDS+=		::lang/python/${VERSION},no_cxx
.  else
RUN_DEPENDS+=		::lang/python/${VERSION}
.  endif
.endif
d59 12
d76 1
a76 2
# this cannot be put into 2.3/Makefile due to NO_SHARED_LIBS vs MULTI_PACKAGES
.if ${VERSION} == "2.3" && empty(FLAVOR:L:Mno_bsddb)
d138 1
a138 1
.if empty(FLAVOR:L:Mno_mpz)
d152 1
a152 1
.if empty(FLAVOR:L:Mno_expat)
d172 1
a172 1
FULLPKGNAME=${PKGNAME}${FLAVOR_EXT:S/-no_bsddb//:S/-no_expat//:S/-no_gdbm//:S/-no_idle//:S/-no_mpz//:S/-no_tkinter//}-0
d183 2
a184 1
CONFIGURE_STYLE?=	autoconf dest no-autoheader
d188 4
d213 1
a213 1
CONFIGURE_ENV+= OPT='${CFLAGS} -DTHREAD_STACK_SIZE=0x100000 -fPIC'
d228 2
a229 2
	@@sed -e 's,@@NOSHARED@@,${NOSHARED},g' \
	     -e 's,@@NO64BIT@@,${NO64BIT},g'   \
d232 1
a232 1
	@@sed -e 's,@@NOSHARED@@,${NOSHARED},g' \
d253 3
a255 3
	- [ -f ${FILESDIR}/CHANGES.MirPorts ] && ${INSTALL_DATA} \
		${FILESDIR}/CHANGES.MirPorts \
		${PREFIX}/share/doc/python${VERSION}/
@


1.2
log
@unbreak make index, oops
@
text
@d18 1
a18 1
PKGNAME=	python-${VERSION}${PATCHLEVEL}${PKG_PATCHLEVEL}
d167 1
a167 1
FULLPKGNAME=${PKGNAME}${FLAVOR_EXT:S/-no_bsddb//:S/-no_expat//:S/-no_gdbm//:S/-no_idle//:S/-no_mpz//:S/-no_tkinter//}
d170 7
a176 7
FULLPKGNAME-expat=	python-expat-${VERSION}${PATCHLEVEL}${PKG_PATCHLEVEL}
FULLPKGNAME-gdbm=	python-gdbm-${VERSION}${PATCHLEVEL}${PKG_PATCHLEVEL}
FULLPKGNAME-idle=	python-idle-${VERSION}${PATCHLEVEL}${PKG_PATCHLEVEL}
FULLPKGNAME-mpz=	python-mpz-${VERSION}${PATCHLEVEL}${PKG_PATCHLEVEL}
FULLPKGNAME-tests=	python-tests-${VERSION}${PATCHLEVEL}${PKG_PATCHLEVEL}
FULLPKGNAME-tkinter=	python-tkinter-${VERSION}${PATCHLEVEL}${PKG_PATCHLEVEL}
FULLPKGNAME-tools=	python-tools-${VERSION}${PATCHLEVEL}${PKG_PATCHLEVEL}
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $MirOS$
d188 1
a188 1
.  if !empty(LP64_ARCHS:M${_i})
@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
