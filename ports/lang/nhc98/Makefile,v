head	1.7;
access;
symbols;
locks; strict;
comment	@# @;


1.7
date	2009.08.16.17.17.53;	author tg;	state Exp;
branches;
next	1.6;
commitid	1004A883C9B4C196B76;

1.6
date	2009.04.18.20.55.19;	author tg;	state Exp;
branches;
next	1.5;
commitid	10049EA3DCB3FF55AAC;

1.5
date	2009.04.18.19.55.57;	author bsiegert;	state Exp;
branches;
next	1.4;
commitid	10049EA300535F1C516;

1.4
date	2008.10.04.19.03.14;	author tg;	state Exp;
branches;
next	1.3;
commitid	10048E7BD9A0842B398;

1.3
date	2006.09.14.00.10.24;	author tg;	state Exp;
branches;
next	1.2;
commitid	10045089C0E234154C3;

1.2
date	2005.04.10.21.50.17;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.03.18.15.47.45;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.03.18.15.47.45;	author tg;	state Exp;
branches;
next	;


desc
@@


1.7
log
@change all V to VSN (ok bsiegert@@) and some DASH_VER while here
@
text
@# $MirOS: ports/lang/nhc98/Makefile,v 1.6 2009/04/18 20:55:19 tg Exp $
# $OpenBSD: Makefile,v 1.2 2004/05/16 23:37:58 pvalchev Exp $
# $NetBSD: Makefile,v 1.29 2004/03/26 21:19:53 wiz Exp $

BROKEN=		Segmentation fault (core dumped)

NOT_FOR_PLATFORM=	${LP64_PLATFORMS}

COMMENT=	portable Haskell compiler
VSN=		1.16
DISTNAME=	nhc98-${VSN}
CATEGORIES=	lang
HOMEPAGE=	http://www.haskell.org/nhc98/

MASTER_SITES=	http://www.cs.york.ac.uk/fp/nhc98/
MASTER_SITES0=	ftp://ftp.cse.unsw.edu.au/pub/users/dons/nhc98/${VSN}/

DIST_SUBDIR=	${DISTNAME}
DISTFILES=	nhc98src-${VSN}.tar.gz nhc98-${VSN}-regress.tar.bz2:0

# these are vendor patches
PATCHFILES=	patch-${VSN}-typesyn:0 patch-${VSN}-ghc6:0

USE_GMAKE=	Yes
CONFIGURE_STYLE=simple
CONFIGURE_ARGS+=--installdir=${PREFIX:Q}

# if you use ghc to build nhc98, it will run 2.5x faster than with gcc
# so we relegate the gcc path to archs with no ghc
.if (${OStype} == "OpenBSD") && (${MACHINE_ARCH} == "i386" || ${MACHINE_ARCH} == "sparc")
MODULES+=	lang/ghc
CONFIGURE_ARGS+=--buildwith=ghc
.else
CONFIGURE_ARGS+=--buildwith=${CC:Q}
.endif

EXTRA_XAKE_FLAGS+=	OPT=${CFLAGS:Q}

NO_REGRESS=	we don't have python 2.2 any more, bsiegert@@ please update to use 2.5
#REGRESS_DEPENDS+=::lang/python/2.2
#REGRESS_RESULT=	${WRKSRC}/../${DISTNAME}-regress/actual.result
#REGRESS_FLAGS=	TEST_HC=${WRKSRC:Q}/script/nhc98 WAY=normal
#REGRESS_FLAGS+=	EXTRA_RUNTEST_OPTS=--output-summary=${REGRESS_RESULT:Q} \
#		PYTHON=${LOCALBASE:Q}/bin/python2.2

# BSDish
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

.include <bsd.port.mk>
@


1.6
log
@* disable regression tests, as they hardcode python 2.2 and cause
  a missing-dependency Makefile semantics failure
  - bsiegert@@ please investigate
* quote, whitespace (except add one tab everywhere), etc.
* unbreak, fix the assembly issue (actually gcc inline asm vs cpp)
* fix another thing to get nhc98comp to build
  but don't fix all the warnings or missing COPTS
  - bsiegert@@ please investigate
* break because nhc98comp segfaults (backtrace is useless tho)
  - bsiegert@@ please investigate
* regenerate distinfo while here
@
text
@d1 1
a1 1
# $MirOS: ports/lang/nhc98/Makefile,v 1.5 2009/04/18 19:55:57 bsiegert Exp $
d10 2
a11 2
V=		1.16
DISTNAME=	nhc98-${V}
d16 1
a16 1
MASTER_SITES0=	ftp://ftp.cse.unsw.edu.au/pub/users/dons/nhc98/${V}/
d19 1
a19 1
DISTFILES=	nhc98src-${V}.tar.gz nhc98-${V}-regress.tar.bz2:0
d22 1
a22 1
PATCHFILES=	patch-${V}-typesyn:0 patch-${V}-ghc6:0
@


1.5
log
@Try to build with gcc on non-ghc platforms. However, there is an assembler
error in src/runtime/Integer/asmlong.h:93 -- the file is part of gmp,
incidentally. Break for now.

tg@@: Could you investigate this please?
@
text
@d1 1
a1 1
# $MirOS: ports/lang/nhc98/Makefile,v 1.4 2008/10/04 19:03:14 tg Exp $
d5 1
a5 1
BROKEN=		assembler error in Integer runtime
d26 1
a26 1
CONFIGURE_ARGS=--installdir=${PREFIX}
d30 2
a31 2
.if ${OStype} == "OpenBSD" && (${MACHINE_ARCH} == "i386" || ${MACHINE_ARCH} == "sparc")
MODULES=	lang/ghc
d34 1
a34 1
CONFIGURE_ARGS+=--buildwith=${CC}
d37 1
a37 1
EXTRA_XAKE_FLAGS=	OPT=${CFLAGS:Q}
d39 6
a44 5
REGRESS_DEPENDS=::lang/python/2.2
REGRESS_RESULT=	${WRKSRC}/../${DISTNAME}-regress/actual.result 
REGRESS_FLAGS=	TEST_HC="${WRKSRC}/script/nhc98" WAY="normal"
REGRESS_FLAGS+=	EXTRA_RUNTEST_OPTS="--output-summary=${REGRESS_RESULT}" \
		PYTHON="${LOCALBASE}/bin/python2.2"
@


1.4
log
@mass conversion from
â€¢ ${CC}
â€¢ "${CC}"
â€¢ '${CC}'
â€¢ ${CC:Q}
to ${_PASS_CC:Q} (or without :Q if itâ€™s executed, not assigned), and
same for CXXâ€¦ most of these are VERY UGLY, prone to break with ccache
and maybe even withoutâ€¦
@
text
@d1 1
a1 1
# $MirOS: ports/lang/nhc98/Makefile,v 1.3 2006/09/14 00:10:24 tg Exp $
d5 2
d9 1
a9 1
COMMENT=			portable Haskell compiler
d30 1
a30 1
.if ${MACHINE_ARCH} == "i386" || ${MACHINE_ARCH} == "sparc"
d34 1
a34 1
CONFIGURE_ARGS+=--buildwith=gcc
d37 2
@


1.3
log
@clean up COMMENT and HOMEPAGE; regenerate INDEX (2761, 169 marked as broken, probably many many more) ­ edited by script with manual postprocessing
@
text
@d1 1
a1 1
# $MirOS: ports/lang/nhc98/Makefile,v 1.2 2005/04/10 21:50:17 tg Exp $
a21 2
CC=		gcc

@


1.2
log
@NOPIC_PLATFORMS, LP64_PLATFORMS and general change of
{NOT,ONLY}_FOR_{ARCH{,E,ES},OS} to {NOT,ONLY}_FOR_PLATFORM

some fallout maybe, I hope not
@
text
@d1 1
a1 1
# $MirOS$
d7 1
a7 1
COMMENT=	"portable Haskell compiler"
@


1.1
log
@Initial revision
@
text
@d1 1
d5 2
a7 4

# not for 64 bits
NOT_FOR_ARCHS=	${LP64_ARCHS}

@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
