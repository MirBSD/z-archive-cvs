head	1.6;
access;
symbols;
locks; strict;
comment	@# @;


1.6
date	2014.01.07.13.05.45;	author tg;	state dead;
branches;
next	1.5;
commitid	10052CBFBBB38A00412;

1.5
date	2008.12.21.02.37.31;	author tg;	state Exp;
branches;
next	1.4;
commitid	100494DABC9167B3B82;

1.4
date	2008.11.11.06.49.24;	author tg;	state Exp;
branches;
next	1.3;
commitid	10049192AF433A81CB0;

1.3
date	2008.11.11.05.30.58;	author tg;	state Exp;
branches;
next	1.2;
commitid	100491918A84F0245BD;

1.2
date	2008.11.10.20.30.54;	author tg;	state Exp;
branches;
next	1.1;
commitid	10049189A1037809661;

1.1
date	2008.11.02.17.30.19;	author tg;	state Exp;
branches;
next	;
commitid	100490DE3AE2F9A5E6B;


desc
@@


1.6
log
@kill LLVM+Clang and llvm-gcc ports; see transcript of #MirBSD on Freenode of today for details
if any, these may be resurrected build-depending on gcc… probably 4.8+, at least 4.7

note: gcc 4.4 “bootstrap-only” port is almost finished, as preliminary stage
(though we could choose 4.7 for that, too…)
@
text
@# $MirOS: ports/lang/llvm-gcc/Makefile,v 1.5 2008/12/21 02:37:31 tg Exp $

ONLY_FOR_PLATFORM=	Darwin:*:* MirBSD:*:i386

COMMENT=		Low Level Virtual Machine gcc front-end
SVN_DISTREV=		58935
DASH_VER=		2
CATEGORIES=		lang devel
HOMEPAGE=		http://www.llvm.org/

# GNU GPLv?
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes

.include <mirports.sys.mk>

SVN_DISTDIR=		llvm-gcc4.2
SVN_DISTPATH=		http://llvm.org/svn/llvm-project/llvm-gcc-4.2/trunk
MCZ_FETCH=		lzma

USE_CCACHE=		No
USE_CXX=		Yes
USE_GMAKE=		Yes
VMEM_WARNING=		Yes
MODULES+=		converters/libiconv
BUILD_DEPENDS+=		:bison-*:devel/bison
B_R_DEPENDS+=		:llvm-*:lang/llvm
LIB_DEPENDS+=		ltdl::devel/libtool
LIB_DEPENDS+=		gmp:gmp->=4.1:devel/gmp
LIB_DEPENDS+=		mpfr:mpfr->=2.3.2:math/mpfr
SUBST_VARS+=		OStriplet

CONFIGURE_STYLE=	autoconf no-autoheader
CONFIGURE_ENV+=		LIBTOOL=${LOCALBASE:Q}/bin/libtool \
			M4=/usr/bin/m4
CONFIGURE_ARGS+=	--enable-static \
			${CONFIGURE_SHARED} \
			--disable-libada \
			--enable-libssp \
			--disable-objc-gc \
			--disable-bootstrap \
			--enable-serial-configure \
			--disable-werror \
			--enable-version-specific-runtime-libs \
			--disable-libstdcxx-pch \
			--disable-nls \
			--enable-cxx-flags='-O1 -fno-omit-frame-pointer' \
			--enable-wchar_t \
			--program-prefix=llvm- \
			--enable-llvm=${LOCALBASE:Q} \
			--enable-languages=c,objc,c++,obj-c++,fortran \
			--enable-threads \
			--with-libiconv-prefix=${ICONV_PREFIX:Q} \
			--with-gnu-ld \
			--with-gnu-as \
			--with-system-zlib
EXTRA_XAKE_FLAGS+=	CHECKING_ENABLED=0 \
			ENABLE_OPTIMIZED=1 \
			LIBTOOL=${LOCALBASE:Q}/bin/libtool \
			LLVM_VERSION_INFO=SVN\ r${SVN_DISTREV}-MirPorts-${DASH_VER}
NO_REGRESS=		Yes

.if (${OStype} != "Darwin") && (${MACHINE_ARCH} == "i386")
CONFIGURE_ARGS+=	--with-arch=i486 --with-tune=pentium-mmx
.endif

post-extract:
	-rm -f ${WRKSRC}/GNUmakefile

post-install:
	mv ${PREFIX}/lib/libiberty.a ${PREFIX}/lib/gcc/${OStriplet}/4.2.1/

.include <bsd.port.mk>

_PASS_CC=		${_ORIG_CC}
_PASS_CXX=		${_ORIG_CXX}
@


1.5
log
@fix rpath problem for version specific libs in the compiler configuration;
I believe this is the only way feasible

this will probably be applied to the base compiler sometime as well, and
its libraries be moved and major-bumped (intermixing is an issue anyway)
@
text
@d1 1
a1 1
# $MirOS: ports/lang/llvm-gcc/Makefile,v 1.4 2008/11/11 06:49:24 tg Exp $
@


1.4
log
@use -O2 not -Os, to make llvm-gcc a tad more stable, because at
theirs, nobody cares about the -Os case…
@
text
@d1 1
a1 1
# $MirOS: ports/lang/llvm-gcc/Makefile,v 1.3 2008/11/11 05:30:58 tg Exp $
d7 1
a7 1
DASH_VER=		1
@


1.3
log
@Clean up the port a little
• cut down un unneeded dependencies
• enable threads, workaround enough to make them build
• include some more basic mnbsd configuration
• overhaul mbsd configuration to more match mgcc from base
  (it’s unknown if this one were suitable for native code
  generation, but quite possible)
• enable DWARF2 unwinding (sjlj exceptions didn’t quite work)
• compile fixes for building this with llvm-gcc4.2 gnu99 itself (inlining…)

This compiler has produced a working lang/llvm package.
@
text
@d1 1
a1 1
# $MirOS: ports/lang/llvm-gcc/Makefile,v 1.2 2008/11/10 20:30:54 tg Exp $
a54 1
			--enable-target-optspace \
@


1.2
log
@say hello to llvm-gcc
@
text
@d1 1
a1 1
# $MirOS: ports/lang/llvm-gcc/Makefile,v 1.1 2008/11/02 17:30:19 tg Exp $
d7 1
a28 2
BUILD_DEPENDS+=		:groff-*-!no_x11:textproc/groff
BUILD_DEPENDS+=		:m4-*:lang/m4
d36 2
a37 1
CONFIGURE_ENV+=		LIBTOOL=${LOCALBASE:Q}/bin/libtool
d54 1
a54 1
			--disable-threads \
@


1.1
log
@stub port for llvm-gcc, stalled until llvm port is ready
tech demo for SVN_DISTFILE and MCZ_FETCH
@
text
@d1 1
a1 1
# $MirOS: ports/lang/llvm/Makefile,v 1.2 2008/11/02 03:51:17 tg Exp $
d3 1
a3 1
BROKEN=			porting in progress
d6 1
a6 1
SVN_DISTREV=		58565
d16 3
a18 1
SVN_DISTDIR=		llvm-gcc
d22 1
d25 50
d77 3
@

