head	1.5;
access;
symbols;
locks; strict;
comment	@# @;


1.5
date	2008.08.19.18.07.27;	author tg;	state Exp;
branches;
next	1.4;
commitid	10048AB0BC837149826;

1.4
date	2006.12.29.01.27.39;	author tg;	state Exp;
branches;
next	1.3;
commitid	10045946F0C08823C89;

1.3
date	2006.12.29.01.16.20;	author tg;	state Exp;
branches;
next	1.2;
commitid	10045946C7526B89E2C;

1.2
date	2006.12.29.00.45.26;	author tg;	state Exp;
branches;
next	1.1;
commitid	100459465254AE8C1C5;

1.1
date	2006.11.24.19.49.25;	author tg;	state Exp;
branches;
next	;
commitid	10045674C6F71EC41CC;


desc
@@


1.5
log
@• introduce the GNU libreadline module and pkgviews!
• required to unbreak and fix gnuplot, and do so
• … including time_t crap
@
text
@# $MirOS: ports/lang/opal/Makefile,v 1.4 2006/12/29 01:27:39 tg Exp $

ONLY_FOR_PLATFORM=		MirBSD:*:* OpenBSD:*:*

COMMENT=			functional programming language
CATEGORIES=			devel lang
VERSION=			2.3k
DASH_VER=			1
DISTNAME=			ocs-${VERSION}-src
PKGNAME=			opal-${VERSION}-0
HOMEPAGE=			http://uebb.cs.tu-berlin.de/~opal/
RESPONSIBLE=			Thorsten Glaser <tg@@mirbsd.de>

# LGPL, GPL; documentation only verbatim copying
PERMIT_DISTFILES_CDROM=		Yes
PERMIT_DISTFILES_FTP=		Yes
PERMIT_PACKAGE_CDROM=		Yes
PERMIT_PACKAGE_FTP=		Yes

.include <mirports.sys.mk>

EXTRACT_SUFX=			.tar.bz2
MASTER_SITES=			${HOMEPAGE}
WRKDIST=			${WRKDIR}/ocs
USE_GMAKE=			Yes
USE_X11=			Yes
NO_REGRESS=			Yes
MODULES+=			devel/libreadline
# XXX can use any tcl/tk; should use module?
B_R_DEPENDS+=			:tk->=8.4:x11/tk/8.4
B_R_DEPENDS+=			:bzip2-*:archivers/bzip2
B_R_DEPENDS+=			:gsed-*:textproc/gsed

CPPFLAGS+=			-I${LOCALBASE}/include/tcl8.4 \
				-I${LOCALBASE}/include/tk8.4
LDFLAGS+=			-Wl,-rpath,${LOCALBASE}/lib \
				-Wl,-rpath,${X11BASE}/lib

CONFIGURE_STYLE=		autoconf no-autoheader dest
AUTOCONF_NEW=			Yes
.if ${NO_SHARED_LIBS:L} == "yes"
CONFIGURE_ARGS+=		--disable-dynamic
BROKEN=				oasys needs shared libraries
.else
# This has shlib_dirs issues
CONFIGURE_ARGS+=		--enable-dynamic
.endif
CONFIGURE_ARGS+=		--disable-absolute-pathes \
				--enable-oasys \
				--enable-opalwin \
				--enable-reflections \
				--enable-tivi2 \
				--disable-opaljava \
				--enable-proofchecker \
				--disable-locallinks \
				--with-tcl-lib=-ltcl84 \
				--with-tk-lib=-ltk84 \
				--without-java-lib \
				--without-java-incl \
				--without-pizzahome \
				--with-x
# enabling these requires LaTeX and dvips
CONFIGURE_ARGS+=		--disable-doc \
				--disable-dosfop
# if I ever get hold of the author of this configure script...
CONFIGURE_ARGS+=		--with-cflags=${CFLAGS:M*:Q} \
				--with-ldflags=${LDFLAGS:M*:Q}
CONFIGURE_ENV+=			ac_cv_path_TAR=tar
CONFIGURE_ENV+=			ocs_cv_flag_cc_opt= \
				ocs_cv_flag_cc_debug=-g \
				ocs_cv_flag_cc_profile='-g -pg'

# if I ever get hold of the author of this Makefile...
#NO_BUILD=			Yes
MAKE_ENV+=			SED=gsed

OSARCH=				${OSname}${OSrev}-${MACHINE_ARCH}
SUBST_VARS+=			VERSION OSARCH

do-build:
	sed -e 's#@@PREFIX@@#${TRUEPREFIX}#g' \
	    -e 's#@@VERSION@@#${VERSION}#g' \
	    -e 's#@@OSARCH@@#${OSARCH}#g' \
	    <${FILESDIR}/wrapper >${WRKBUILD}/wrapper

post-install:
	${INSTALL_SCRIPT} ${WRKBUILD}/wrapper ${PREFIX}/bin/
	cd ${PREFIX}/ocs-${VERSION}/bin && for f in *; do \
		ln ${PREFIX}/bin/wrapper ${PREFIX}/bin/$$f; \
	done
	rm -f ${PREFIX}/bin/wrapper

.include <bsd.port.mk>
@


1.4
log
@add an ONLY_FOR_PLATFORM for the BSDs
this won't luck on Mac at all.
@
text
@d1 1
a1 1
# $MirOS: ports/lang/opal/Makefile,v 1.3 2006/12/29 01:16:20 tg Exp $
d8 1
d28 1
a28 1
LIB_DEPENDS+=			readline::devel/libreadline
@


1.3
log
@defeat damaged package name
@
text
@d1 3
a3 1
# $MirOS: ports/lang/opal/Makefile,v 1.2 2006/12/29 00:45:26 tg Exp $
@


1.2
log
@assist the build system by providing appropriate rpaths...
@
text
@d1 1
a1 1
# $MirOS: ports/lang/opal/Makefile,v 1.1 2006/11/24 19:49:25 tg Exp $
d7 1
a7 1
PKGNAME=			opal-${VERSION}
@


1.1
log
@import a, mostly working, kludgy hacked together, port of OPAL,
the functional programming language of TU Berlin, requested by
Przemysław "Zeno" Jozwiak for his studies
@
text
@d1 1
a1 1
# $MirOS$
d33 2
@

