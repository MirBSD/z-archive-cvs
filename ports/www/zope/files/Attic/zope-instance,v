head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2007.04.03.19.46.09;	author tg;	state dead;
branches;
next	1.1;
commitid	1004612AC977E789195;

1.1
date	2005.03.18.16.00.09;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.03.18.16.00.09;	author tg;	state Exp;
branches;
next	;


desc
@@


1.2
log
@• remove ports that are simply broken, don't work, for too long, with no
  update or update-willing person in sight, kde stuff, web2.0 stuff that
  we don't want in ports (just stuff it into /var/www yourself, it isn't
  that difficult, right?), stuff for which no new version exists/will be
  and some obsd cruft; adjust dependencies
• no BUILD_DEPENDS+=RUN_DEPENDS or vice versa any more, *ever*
• fix some other stuff partially

ok bsiegert@@
@
text
@#!@@@@LOCALBASE@@@@/bin/python2.1
#
# $OpenBSD: zope-instance,v 1.3 2001/11/02 03:35:11 matt Exp $
#
# Build a Zope INSTANCE_HOME in the specified directory.
#
# Run this script as the user who will be owning this Zope installation.
# The instance directory must already exist, and be empty.
#
# Matt Behrens <matt@@openbsd.org>
#

zopehome="@@@@PREFIX@@@@/lib/zope"

import os, shutil, sys

if len(sys.argv) != 2:
	print "usage: %s instance-directory" % sys.argv[0]
	sys.exit(0)

instancehome=os.path.abspath(sys.argv[1])

for directory in ("import", "var", "Extensions", "Products"):
	os.mkdir(os.path.join(instancehome, directory))

# Copy the initial Data.fs
datafs = "%s/var/Data.fs" % instancehome
shutil.copyfile("%s/var/Data.fs.in" % zopehome, datafs)
os.chmod(datafs, 0600)

# Import installation modules
sys.path.insert(0, zopehome)
sys.path.insert(0, "%s/inst" % zopehome)
import make_start, zpasswd
python=sys.executable

# Create Zope.cgi
open("%s/Zope.cgi" % instancehome, "w").write(
"""#!%(zopehome)s/pcgi/pcgi-wrapper
PCGI_NAME=Zope
PCGI_MODULE_PATH=%(zopehome)s/lib/python/Zope
PCGI_PUBLISHER=%(zopehome)s/pcgi/pcgi_publisher.py
PCGI_EXE=%(python)s
PCGI_SOCKET_FILE=%(instancehome)s/var/pcgi.soc
PCGI_PID_FILE=%(instancehome)s/var/pcgi.pid
PCGI_ERROR_LOG=%(instancehome)s/var/pcgi.log
PCGI_DISPLAY_ERRORS=1
BOBO_REALM=%(instancehome)s/Zope.cgi
BOBO_DEBUG_MODE=1
INSTANCE_HOME=%(instancehome)s
""" % vars())
os.chmod("%s/Zope.cgi" % instancehome, 04750)

# Create start and stop scripts
make_start.sh(instancehome, '', '')
open("%s/start" % instancehome, "w").write(
"""#!/bin/sh
export INSTANCE_HOME=%(instancehome)s
export PYTHONHOME=%(zopehome)s
exec %(python)s -O $PYTHONHOME/z2.py -D "$@@" -p %(instancehome)s/Zope.cgi
""" % vars())

# Create the admin user
zpasswd.write_inituser(instancehome, '', '')

@


1.1
log
@Initial revision
@
text
@@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
