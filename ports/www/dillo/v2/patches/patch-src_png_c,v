head	1.1;
access;
symbols;
locks; strict;
comment	@# @;


1.1
date	2009.08.24.16.54.24;	author tg;	state Exp;
branches;
next	;
commitid	1004A92C4F616E15527;


desc
@@


1.1
log
@• enable “experimental, ALPHA stage” SSL support
  ‣ http://www.mirbsd.org/ → works, IPv6?
  ‣ https://www.mirbsd.org/ → works, IPv4 (!)
  ‣ http://ca.mirbsd.org/ → works, IPv6 (good)
  ‣ https://ca.mirbsd.org/ → fails, because the server is v6-only
• fix PLIST and packaging of dillorc, dpidrc (fails to install), keysrc
  (was not installed), and layout of sample vs instsalled files
  ‣ automake is now NO LONGER USED
  ‣ a post-install target moves the files to the appropriate places
    for inside the package
  ‣ the @@sample lines have been fixed
• fix conversion to use ~/.etc/dillo/ in some places where it wasn’t done
• fix compilation (MAX was redefined here, too, like in fltk2)
• fix more compiler warnings (missing headers, time_t bug, pointer to
  wrong (mismatched size!) integer types passed to libpng, etc)
• bump DASH_VER
@
text
@$MirOS$
--- src/png.c.orig	Mon Jun 29 18:49:46 2009
+++ src/png.c	Mon Aug 24 16:25:31 2009
@@@@ -65,8 +65,8 @@@@ struct _DilloPng {
    int version;                 /* Secondary Key for the dicache */
 
    double display_exponent;     /* gamma correction */
-   ulong_t width;               /* png image width */
-   ulong_t height;              /* png image height */
+   png_uint_32 width;           /* png image width */
+   png_uint_32 height;          /* png image height */
    png_structp png_ptr;         /* libpng private data */
    png_infop info_ptr;          /* libpng private info */
    uchar_t *image_data;         /* decoded image data    */
@@@@ -138,7 +138,7 @@@@ Png_datainfo_callback(png_structp png_pt
    if (png->width <= 0 || png->height <= 0 ||
        png->width > IMAGE_MAX_AREA / png->height) {
       MSG("Png_datainfo_callback: suspicious image size request %ldx%ld\n",
-          png->width, png->height);
+          (long)png->width, (long)png->height);
       Png_error_handling(png_ptr, "Aborting...");
       return; /* not reached */
    }
@
