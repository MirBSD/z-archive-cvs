head	1.15;
access;
symbols
	tg-opera-9_5x:1.11.0.2;
locks; strict;
comment	@# @;


1.15
date	2011.01.21.17.59.59;	author tg;	state Exp;
branches;
next	1.14;
commitid	1004D39C9A5050B29C1;

1.14
date	2009.05.25.11.03.17;	author tg;	state Exp;
branches;
next	1.13;
commitid	1004A1A7B0B1FA6D13C;

1.13
date	2008.10.05.16.10.06;	author tg;	state Exp;
branches;
next	1.12;
commitid	10048E8E6E26536FCB9;

1.12
date	2008.08.27.09.32.05;	author tg;	state Exp;
branches;
next	1.11;
commitid	10048B51E9E53486F6D;

1.11
date	2007.05.22.19.56.58;	author tg;	state Exp;
branches
	1.11.2.1;
next	1.10;
commitid	10046534B0E7A1BD262;

1.10
date	2007.04.30.12.47.16;	author tg;	state Exp;
branches;
next	1.9;
commitid	1004635E55178AEC4E1;

1.9
date	2006.12.21.13.41.34;	author tg;	state Exp;
branches;
next	1.8;
commitid	100458A8F1D307EEBB7;

1.8
date	2006.12.20.21.39.32;	author tg;	state Exp;
branches;
next	1.7;
commitid	1004589AD455A02A8F2;

1.7
date	2006.06.25.06.26.52;	author tg;	state Exp;
branches;
next	1.6;
commitid	100449E2C915D109F2B;

1.6
date	2006.06.23.14.27.15;	author tg;	state Exp;
branches;
next	1.5;
commitid	100449BFA425092526F;

1.5
date	2006.06.20.18.20.37;	author tg;	state Exp;
branches;
next	1.4;
commitid	10044983C887EA7A83A;

1.4
date	2006.02.01.20.38.49;	author tg;	state Exp;
branches;
next	1.3;
commitid	10043E11C3B4C8B055B;

1.3
date	2006.01.18.11.26.17;	author tg;	state Exp;
branches;
next	1.2;
commitid	10043CE25E462AC2283;

1.2
date	2005.12.16.14.42.58;	author tg;	state Exp;
branches;
next	1.1;
commitid	10043A2D22A7A063572;

1.1
date	2005.03.18.15.59.50;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.11.2.1
date	2008.06.13.00.40.02;	author tg;	state dead;
branches;
next	;
commitid	1004851C1F36E62F8BF;

1.1.7.1
date	2005.03.18.15.59.50;	author tg;	state Exp;
branches;
next	;


desc
@@


1.15
log
@unlimit datasile and nofiles before start
@
text
@#!@@SHELL@@
# $MirOS: ports/www/opera/files/opera.sh,v 1.14 2009/05/25 11:03:17 tg Exp $

ulimit -c 0
ulimit -dS $(ulimit -dH)
ulimit -nS $(ulimit -nH)

cfg=$HOME/.opera/opera6.ini
[[ -e $cfg ]] && if ! fgrep -q "Synchronous DNS Lookup=1" $cfg; then
	print '[Performance]\nSynchronous DNS Lookup=1' >>$cfg
fi

export OPERA_SCRIPT_PATH=$(realpath $0) OPERA_NUM_XSHM=0
export OPERA_BINARYDIR=@@PREFIX@@/libexec/ OPERA_DIR=@@PREFIX@@/share/opera
LD_LIBRARY_PATH=/lib:@@PREFIX@@/libexec:${LD_LIBRARY_PATH}
export LD_LIBRARY_PATH=${LD_LIBRARY_PATH%%:}

exec @@PREFIX@@/libexec/opera "$@@"
@


1.14
log
@disable core dumps
@
text
@d2 1
a2 1
# $MirOS: ports/www/opera/files/opera.sh,v 1.13 2008/10/05 16:10:06 tg Exp $
d5 2
@


1.13
log
@we have required a pretty up-to-date mksh for a while,
so make use of the “realpath” builtin
@
text
@d2 3
a4 1
# $MirOS: ports/www/opera/files/opera.sh,v 1.12 2008/08/27 09:32:05 tg Exp $
@


1.12
log
@Create a new package, fedora-libs, from OpenBSD’s fedora_base and
fedora_motif, containing Fedora Core 4 libraries, by suggestion of
the MidnightBSD developers; convert Opera and AcroRead to use it,
tentatively; this fixes plugins in Opera, for instance, and possi-
bly opens the door for the Opera 9.5x upgrade – which MidnightBSD
doesn’t have yet either. While here sprinkle some uname checks for
mnbsd, fix the emulated ldd, and re-enable plugins/java for Opera

NOTE: This is EXPERIMENTAL.
@
text
@d2 1
a2 1
# $MirOS: ports/www/opera/files/opera.sh,v 1.11 2007/05/22 19:56:58 tg Exp $
d9 1
a9 1
export OPERA_SCRIPT_PATH=$(readlink -nf $0) OPERA_NUM_XSHM=0
@


1.11
log
@• minor update to 9.21 (security stuff only affects win32 platform)
• be more smart
@
text
@d2 1
a2 1
# $MirOS: ports/www/opera/files/opera.sh,v 1.10 2007/04/30 12:47:16 tg Exp $
d11 1
a11 2
LD_LIBRARY_PATH=/dbl:@@PREFIX@@/libexec:${LD_LIBRARY_PATH}
LD_PRELOAD=/dbl/libnss_compat.so.2:/dbl/libnss_dns.so.2:/dbl/libnss_files.so.2:${LD_PRELOAD}
a12 1
export OPERA_LD_PRELOAD=${LD_PRELOAD%%:} LD_PRELOAD=${LD_PRELOAD%%:}
@


1.11.2.1
log
@hm. let's try this again.
@
text
@d2 1
a2 1
# $MirOS: ports/www/opera/files/opera.sh,v 1.11 2007/05/22 19:56:58 tg Exp $
@


1.10
log
@update opera to 9.20, still can't get plugins to work, have to disable new XSHM
@
text
@d2 1
a2 1
# $MirOS: ports/www/opera/files/opera.sh,v 1.9 2006/12/21 13:41:34 tg Exp $
d4 3
a6 5
if ! fgrep "Synchronous DNS Lookup=1" $HOME/.opera/opera6.ini \
    >/dev/null 2>&1; then
	echo 'Warning: read the install notice ("pkg_info -D opera")' >&2
	echo '	 before using the Opera(C) web browser!' >&2
	sleep 3
@


1.9
log
@add additional hints that users should RTFM
@
text
@d2 1
a2 1
# $MirOS: ports/www/opera/files/opera.sh,v 1.8 2006/12/20 21:39:32 tg Exp $
d11 1
a11 1
export OPERA_SCRIPT_PATH=$(readlink -nf $0)
@


1.8
log
@* untested update to 9.10
* bundle "Minimalist Native" theme (XXX can it be selected out of the box?)
* bundle .lu third-party language pack (the only language pack
  available for 9.10-Linux; the 9.10-Windows official packs won't
  work with the Linux binary; more to come...)

remaining issues:
* /etc/opera6rc can't be used, thus pkg/MESSAGE stays :(
* no Java support (someone should make 1.3-linux work)
@
text
@d2 8
a9 1
# $MirOS: ports/www/opera/files/opera.sh,v 1.7 2006/06/25 06:26:52 tg Exp $
@


1.7
log
@add a few more libs to the debian package, and preload the
resolver in opera (now it works w/o redhat-base installed,
but adding that still freaks the plugins, why? systrace is
not helpful at this point any more...)
@
text
@d2 1
a2 1
# $MirOS: ports/www/opera/files/opera.sh,v 1.6 2006/06/23 14:27:15 tg Exp $
d4 6
a9 3
export OPERA_DIR=@@PREFIX@@/share/opera
export LD_LIBRARY_PATH=/dbl:@@PREFIX@@/libexec:${LD_LIBRARY_PATH}
export LD_PRELOAD=/dbl/libnss_compat.so.2:/dbl/libnss_dns.so.2:/dbl/libnss_files.so.2:${LD_PRELOAD}
@


1.6
log
@I originally wanted to make flashplugin work with these changes,
but it doesn't even find libnpp.so, still I commit this because
of the other cleanup changes in this port.
@
text
@d2 1
a2 1
# $MirOS: ports/www/opera/files/opera.sh,v 1.5 2006/06/20 18:20:37 tg Exp $
d6 1
@


1.5
log
@opera 9.0, wfm
@
text
@d2 1
a2 11
# $MirOS: ports/www/opera/files/opera.sh,v 1.4 2006/02/01 20:38:49 tg Exp $
# $OpenBSD: opera.sh,v 1.5 2003/11/09 09:46:26 sturm Exp $

case $0 in /*) OPERA_SCRIPT_PATH=$0;; *) OPERA_SCRIPT_PATH=`/bin/pwd`/$0;; esac
export OPERA_SCRIPT_PATH

PLUGIN_PATH=@@PREFIX@@/lib/opera/plugins
PLUGIN_PATH=${PLUGIN_PATH}:@@LOCALBASE@@/lib/ns-plugins
PLUGIN_PATH=${PLUGIN_PATH}:${HOME}/.netscape/plugins
PLUGIN_PATH=${PLUGIN_PATH}:@@LOCALBASE@@/netscape/plugins
LD_LIBRARY_PATH=/dbl:${LD_LIBRARY_PATH}:@@PREFIX@@/libexec
d5 1
a5 2
export OPERA_PLUGIN_PATH=${OPERA_PLUGIN_PATH-${PLUGIN_PATH}}
export LD_LIBRARY_PATH
@


1.4
log
@revamp compat_linux(8) support library port structure to allow for
undisturbed coexistence of more than one set of libraries and dyld
and patch the opera binary to call /dbl/ld-linux.so.2 instead
@
text
@d2 1
a2 1
# $MirOS: ports/www/opera/files/opera.sh,v 1.3 2006/01/18 11:26:17 tg Exp $
d5 3
@


1.3
log
@depend on emulators/debian
(confirmed it works without emulators/redhat)
@
text
@d2 1
a2 1
# $MirOS: ports/www/opera/files/opera.sh,v 1.2 2005/12/16 14:42:58 tg Exp $
d9 1
a9 1
LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:@@PREFIX@@/libexec
d15 1
a15 1
exec @@PREFIX@@/emul/debian/run @@PREFIX@@/libexec/opera "$@@"
@


1.2
log
@Update Opera to 8.51, mostly from OpenBSD, but
* don't hardcode /usr/local, use $PREFIX
* don't write to /etc, it runs without the samples
* fix... etc.

It works, I can even install the Cocoa theme (but I prefer
the Minimalist Native one), but I can't read the menu text
(neither context menus), I only see empty squares.
@
text
@d2 1
a2 1
# $MirOS$
d15 1
a15 1
exec @@PREFIX@@/libexec/opera "$@@"
@


1.1
log
@Initial revision
@
text
@d1 2
a2 2
#!/bin/sh
#
d9 1
a9 1
LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:/usr/local/libexec
@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
