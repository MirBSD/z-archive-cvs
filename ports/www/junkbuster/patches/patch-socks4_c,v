head	1.1;
branch	1.1.7;
access;
symbols;
locks; strict;
comment	@# @;


1.1
date	2005.03.18.15.59.37;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.03.18.15.59.37;	author tg;	state Exp;
branches;
next	;


desc
@@



1.1
log
@Initial revision
@
text
@$OpenBSD: patch-socks4_c,v 1.2 2001/06/09 02:36:48 angelos Exp $
--- socks4.c.orig	Fri Oct 30 22:58:47 1998
+++ socks4.c	Fri Jun  8 22:19:00 2001
@@@@ -88,7 +88,7 @@@@ socks4_connect(struct gateway *gw, struc
 
 	/* build a socks request for connection to the web server */
 
-	strcpy((char *)&(c->userid), socks_userid);
+	strlcpy((char *)&(c->userid), socks_userid, sizeof(cbuf));
 
 	csiz = sizeof(*c) + sizeof(socks_userid) - 1;
 
@@@@ -103,7 +103,7 @@@@ socks4_connect(struct gateway *gw, struc
 			errno = EINVAL;
 			return(-1);
 		}
-		strcpy(((char *)cbuf) + csiz, http->host);
+		strlcpy(((char *)cbuf) + csiz, http->host, sizeof(cbuf));
 		csiz = n;
 		break;
 	}
@@@@ -162,7 +162,7 @@@@ socks4_connect(struct gateway *gw, struc
 	default:
 		errstr = (char *) cbuf;
 		errno = ENOENT;
-		sprintf(errstr,
+		snprintf(errstr, sizeof(cbuf),
 			"SOCKS request rejected for reason code %d\n", s->cd);
 	}
 
@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
