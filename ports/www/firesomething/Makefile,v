head	1.55;
access;
symbols
	bsiegert-ff3_m20081205:1.28.2.4
	bsiegert-ff3:1.28.0.2
	bsiegert-ff3_BASE:1.28;
locks; strict;
comment	@# @;


1.55
date	2011.09.03.16.39.32;	author tg;	state Exp;
branches;
next	1.54;
commitid	1004E62583A515487C3;

1.54
date	2011.03.30.10.28.11;	author tg;	state Exp;
branches;
next	1.53;
commitid	1004D9305BF07324C2C;

1.53
date	2010.12.12.16.38.47;	author tg;	state Exp;
branches;
next	1.52;
commitid	1004D04FA4429C1C525;

1.52
date	2010.07.22.15.10.31;	author tg;	state Exp;
branches;
next	1.51;
commitid	1004C485EB7168C4697;

1.51
date	2010.02.21.09.36.57;	author bsiegert;	state Exp;
branches;
next	1.50;
commitid	1004B80FEAD6841EF8D;

1.50
date	2009.11.15.01.10.45;	author tg;	state Exp;
branches;
next	1.49;
commitid	1004AFF5529139E387B;

1.49
date	2009.11.14.22.43.09;	author tg;	state Exp;
branches;
next	1.48;
commitid	1004AFF328E40B67220;

1.48
date	2009.08.04.08.26.16;	author tg;	state Exp;
branches;
next	1.47;
commitid	1004A77F0263C611730;

1.47
date	2009.07.09.18.03.05;	author tg;	state Exp;
branches;
next	1.46;
commitid	1004A5630EF6B172D5C;

1.46
date	2009.07.06.19.28.41;	author bsiegert;	state Exp;
branches;
next	1.45;
commitid	1004A52507111AE7658;

1.45
date	2009.07.01.15.25.22;	author tg;	state Exp;
branches;
next	1.44;
commitid	1004A4B7FD75AE46699;

1.44
date	2009.05.17.16.10.07;	author tg;	state Exp;
branches;
next	1.43;
commitid	1004A1036D671D8147D;

1.43
date	2009.04.28.19.29.45;	author bsiegert;	state Exp;
branches;
next	1.42;
commitid	10049F75916533B09CE;

1.42
date	2009.03.28.16.08.10;	author bsiegert;	state Exp;
branches;
next	1.41;
commitid	10049CE4B3272FD053A;

1.41
date	2009.03.23.19.33.33;	author bsiegert;	state Exp;
branches;
next	1.40;
commitid	10049C7E40A329F44C0;

1.40
date	2009.02.09.20.19.25;	author bsiegert;	state Exp;
branches;
next	1.39;
commitid	10049908FA137BAC867;

1.39
date	2008.12.18.21.01.56;	author bsiegert;	state Exp;
branches;
next	1.38;
commitid	100494ABA492A86BBDB;

1.38
date	2008.12.17.21.34.47;	author bsiegert;	state Exp;
branches;
next	1.37;
commitid	1004949706D2DC9AB85;

1.37
date	2008.12.08.22.38.51;	author tg;	state Exp;
branches;
next	1.36;
commitid	100493DA1D97A5FCB92;

1.36
date	2008.12.08.20.31.25;	author bsiegert;	state Exp;
branches;
next	1.35;
commitid	100493D840B224C5BD8;

1.35
date	2008.12.07.22.16.40;	author tg;	state Exp;
branches;
next	1.34;
commitid	100493C4B5661643A46;

1.34
date	2008.12.07.19.56.45;	author bsiegert;	state Exp;
branches;
next	1.33;
commitid	100493C2A8635647F8A;

1.33
date	2008.12.06.16.11.48;	author tg;	state Exp;
branches;
next	1.32;
commitid	100493AA44D310A350E;

1.32
date	2008.12.06.13.35.31;	author tg;	state Exp;
branches;
next	1.31;
commitid	100493A7FA6638D0A04;

1.31
date	2008.12.05.16.26.07;	author bsiegert;	state Exp;
branches;
next	1.30;
commitid	100493955AC37C545FE;

1.30
date	2008.11.14.00.47.20;	author tg;	state Exp;
branches;
next	1.29;
commitid	100491CCAAE5C24A1F9;

1.29
date	2008.11.13.20.18.17;	author tg;	state Exp;
branches;
next	1.28;
commitid	100491C8B6F259B3B0F;

1.28
date	2008.05.26.05.45.51;	author bsiegert;	state Exp;
branches
	1.28.2.1;
next	1.27;
commitid	100483A4E7D5DC5AE92;

1.27
date	2008.05.21.12.23.23;	author tg;	state Exp;
branches;
next	1.26;
commitid	100483414514A3E3F8D;

1.26
date	2008.05.21.06.31.02;	author bsiegert;	state Exp;
branches;
next	1.25;
commitid	1004833C1AE26745CDA;

1.25
date	2008.05.20.01.56.39;	author tg;	state Exp;
branches;
next	1.24;
commitid	10048322F7E467DFAD5;

1.24
date	2008.05.07.22.48.45;	author tg;	state Exp;
branches;
next	1.23;
commitid	100482231C374D9CA0B;

1.23
date	2008.04.02.00.35.17;	author tg;	state Exp;
branches;
next	1.22;
commitid	10047F2D4754F3DBF2C;

1.22
date	2008.03.31.21.33.55;	author bsiegert;	state Exp;
branches;
next	1.21;
commitid	10047F1587B7179AEC2;

1.21
date	2008.03.28.20.26.29;	author bsiegert;	state Exp;
branches;
next	1.20;
commitid	10047ED5481450ADFF3;

1.20
date	2008.03.28.00.02.50;	author tg;	state Exp;
branches;
next	1.19;
commitid	10047EC35BD6F6088FF;

1.19
date	2008.03.27.21.18.10;	author tg;	state Exp;
branches;
next	1.18;
commitid	10047EC0F1D69E56251;

1.18
date	2008.03.27.21.14.07;	author bsiegert;	state Exp;
branches;
next	1.17;
commitid	10047EC0E282DA9C5B5;

1.17
date	2008.03.27.17.04.50;	author tg;	state Exp;
branches;
next	1.16;
commitid	10047EBD3C431B0FC4B;

1.16
date	2007.08.17.20.16.31;	author bsiegert;	state Exp;
branches;
next	1.15;
commitid	10046C6022667CCFD0D;

1.15
date	2007.08.16.20.04.05;	author bsiegert;	state Exp;
branches;
next	1.14;
commitid	10046C4ADBE7F257504;

1.14
date	2007.08.15.20.31.21;	author bsiegert;	state Exp;
branches;
next	1.13;
commitid	10046C362542F37ED30;

1.13
date	2006.12.20.15.32.04;	author tg;	state Exp;
branches;
next	1.12;
commitid	100458956E02A39AB3C;

1.12
date	2006.09.14.00.14.35;	author tg;	state Exp;
branches;
next	1.11;
commitid	10045089C0E234154C3;

1.11
date	2006.07.30.15.07.23;	author bsiegert;	state Exp;
branches;
next	1.10;
commitid	10044CCCAC37A899666;

1.10
date	2006.06.07.09.35.54;	author bsiegert;	state Exp;
branches;
next	1.9;
commitid	10044869DE87310C37C;

1.9
date	2006.05.11.20.55.40;	author bsiegert;	state Exp;
branches;
next	1.8;
commitid	1004463A43D348FDE4A;

1.8
date	2006.02.09.11.15.33;	author tg;	state Exp;
branches;
next	1.7;
commitid	10043EB23217A35557B;

1.7
date	2005.12.18.16.36.46;	author tg;	state Exp;
branches;
next	1.6;
commitid	10043A58BE830AFB807;

1.6
date	2005.07.06.19.21.37;	author bsiegert;	state Exp;
branches;
next	1.5;
commitid	609742cc2f044f70;

1.5
date	2005.04.11.15.57.03;	author tg;	state Exp;
branches;
next	1.4;

1.4
date	2005.04.10.21.51.25;	author tg;	state Exp;
branches;
next	1.3;

1.3
date	2005.03.30.18.13.52;	author bsiegert;	state Exp;
branches;
next	1.2;

1.2
date	2005.03.20.16.56.21;	author bsiegert;	state Exp;
branches;
next	1.1;

1.1
date	2005.03.18.15.59.33;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.28.2.1
date	2008.08.24.14.52.23;	author bsiegert;	state Exp;
branches;
next	1.28.2.2;
commitid	10048B16FD21523F3CF;

1.28.2.2
date	2008.09.06.19.29.00;	author bsiegert;	state Exp;
branches;
next	1.28.2.3;
commitid	10048C2D9F57A0DFCE2;

1.28.2.3
date	2008.12.02.19.40.49;	author bsiegert;	state Exp;
branches;
next	1.28.2.4;
commitid	10049358F044B289775;

1.28.2.4
date	2008.12.04.21.50.54;	author bsiegert;	state Exp;
branches;
next	;
commitid	1004938505A283FEFEC;

1.1.7.1
date	2005.03.18.15.59.33;	author tg;	state Exp;
branches;
next	;


desc
@@


1.55
log
@sync X.509v3 certificate bundles
@
text
@# $MirOS: ports/www/firesomething/Makefile,v 1.54 2011/03/30 10:28:11 tg Exp $
# $OpenBSD: Makefile,v 1.41 2005/11/15 09:21:52 wilfried Exp $

# mnbsd/amd64, mnbsd/sparc64 missing
# darwin extremely difficult, interix impossible
ONLY_FOR_PLATFORM=	MidnightBSD:*:i386 \
			MirBSD:*:i386 MirBSD:*:sparc \
			OpenBSD:*:alpha OpenBSD:*:amd64 OpenBSD:*:i386 \
			OpenBSD:*:powerpc OpenBSD:*:sparc OpenBSD:*:sparc64

COMMENT=		one of the successors to the Netscape browser engine
COMMENT-nssckbi=	X.509v3 CA certificate bundle for NSS (Mirzilla Firetapir)
VER=			3.0.18
DISTNAME=		mozilla
PKGNAME=		firesomething-${VER}-${DASH_VER}
FULLPKGNAME-nssckbi=	nssckbi-1.75-6
CATEGORIES=		www
HOMEPAGE=		http://www.mozilla.org/projects/firefox/

# mozilla public license
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

.include <mirports.sys.mk>

CERTDIR=		${PORTSDIR}/essentials/ca-certificates

MASTER_SITES=		http://ftp.eu.mozilla.org/pub/mozilla.org/firefox/releases/${VER}/source/ \
			http://ftp.mozilla.org/pub/mozilla.org/firefox/releases/${VER}/source/ \
			ftp://releases.mozilla.org/pub/mozilla.org/firefox/releases/${VER}/source/ \
			ftp://archive.mozilla.org/pub/mozilla.org/firefox/releases/${VER}/source/
DISTFILES=		firefox-${VER}-source.tar.bz2
SO_VERSION=		10.0

MULTI_PACKAGES=		-nssckbi #-nspr
SUBPACKAGE?=
PREFER_SUBPKG_INSTALL=	No	# firesomething depends on nssckbi already

MODULES+=		devel/gettext devel/pkgconfig
RUN_DEPENDS+=		:esound-*:audio/esound
BUILD_DEPENDS+=		:libIDL-*:devel/libIDL
BUILD_DEPENDS+=		:zip->=2.3:archivers/zip
BUILD_DEPENDS+=		:python->=2.5.2-7:lang/python/2.5
LIB_DEPENDS+=		cairo:cairo->=1.6:graphics/cairo
LIB_DEPENDS+=		gdk-x11-2.0.0.0,gdk_pixbuf-2.0.0.0,gtk-x11-2.0.0.0::x11/gtk+
LIB_DEPENDS+=		dbus-glib-1::sysutils/dbus-glib

VMEM_WARNING=		Yes
USE_CXX=		Yes
USE_X11=		Yes
USE_GMAKE=		Yes
# Regression tests are too hard to adapt to run here
NO_REGRESS=		Yes
SUBST_VARS=		LOCALBASE SO_EXTENSION SO_VERSION VER

.if ${OStype} == "MidnightBSD"
SO_EXTENSION=
.else
SO_EXTENSION=		.${SO_VERSION}
.endif

.if defined(PACKAGING)
.  if ${SUBPACKAGE} == "-nssckbi"
MODULES:=
LIB_DEPENDS:=
B_R_DEPENDS:=
RUN_DEPENDS:=
.  else
RUN_DEPENDS+=		:nssckbi-*:www/firesomething,-nssckbi
.  endif
.endif

MODGNU_RECURSE_DIRS=	${WRKSRC}/nsprpub ${WRKSRC}
CONFIGURE_STYLE=	autoconf no-autoheader
CONFIGURE_ARGS+=	--with-system-jpeg=${LOCALBASE}	\
			--with-system-png=${PNG_BASE}	\
			--with-system-zlib=/usr/lib	\
			--with-system-sqlite		\
			--with-pthreads			\
			--without-system-nspr		\
			--enable-xft			\
			--enable-optimize=-Os		\
			--enable-default-toolkit=cairo-gtk2	\
			--disable-debug			\
			--disable-tests			\
			--disable-pedantic		\
			--disable-installer		\
			--disable-updater		\
			--disable-crashreporter		\
			--disable-gnomeui		\
			--disable-gnomevfs		\
			--enable-xinerama		\
			--enable-svg			\
			--enable-svg-renderer=cairo	\
			--enable-system-cairo		\
			--enable-canvas

# from browser/config/mozconfig
CONFIGURE_ARGS+=	--enable-application=browser

MAKE_ENV=		MOZ_CO_PROJECT=browser \
			LD_LIBRARY_PATH=${WRKSRC:Q}/dist/bin \
			SO_VERSION=${SO_VERSION:Q}
CONFIGURE_ENV=		${MAKE_ENV}

post-extract:
	@@cp ${FILESDIR}/xptc* ${WRKSRC}/xpcom/reflect/xptcall/src/md/unix/
	cd ${WRKSRC}/security/nss/lib/ckfw/builtins/ && \
	    cp ${CERTDIR:Q}/certdata.{c,txt} . && \
	    touch certdata.txt && sleep 1 && touch certdata.c
	cd ${WRKSRC}/security/coreconf && \
	    cp FreeBSD.mk MidnightBSD.mk && \
	    ln -sf OpenBSD.mk MirBSD.mk

pre-configure:
	@@perl -pi -e 's|_LOCALBASE_|${LOCALBASE}|g; s|_X11BASE_|${X11BASE}|g' \
		${WRKSRC}/browser/app/mozilla.in
	@@perl -pi -e 's|_SO_VERSION_|${SO_VERSION}|g' \
		${WRKSRC}/nsprpub/pr/include/md/_openbsd.h \
		${WRKSRC}/xpcom/components/nsNativeComponentLoader.cpp
	@@perl -pi -e 's|_SO_EXTENSION_|${SO_EXTENSION}|g' \
		${WRKSRC}/browser/installer/unix/packages-static

post-install:
	cd ${PREFIX} && \
	    mv -f firesomething/firefox firesomething/firesomething && \
	    mv -f firesomething/firefox-bin firesomething/firesomething-bin
	cd ${PREFIX}/bin && ln -sf ../firesomething/firesomething firesomething

.include <bsd.port.mk>
@


1.54
log
@refresh
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.53 2010/12/12 16:38:47 tg Exp $
d16 1
a16 1
FULLPKGNAME-nssckbi=	nssckbi-1.75-5
@


1.53
log
@use a central place for NSS ckbi; sync with MirBSD CA bundle
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.52 2010/07/22 15:10:31 tg Exp $
d16 1
a16 1
FULLPKGNAME-nssckbi=	nssckbi-1.75-4
@


1.52
log
@‚Ä¢ update ca-certificates port with latest data
‚Ä¢ update nsckbi in both nss (for package nss) and firesomething (for
  package nssckbi); if nss would create a subpackage nssckbi like
  firesomething does at the moment, and firesomething were to depend
  on nss and nssckbi instead of bringing their own¬π, things would be
  MUCH better as it takes about 2 minutes per certdata.txt and 3-4
  minutes per certdata.c file to commit this

‚ë† maybe just build firesomething with its own nss and nssckbi but
  don‚Äôt include it in the binary package, rather use symlinks to
  the mirpackage for nss and nssckbi? or just depend on the extracted
  nss/nssckbi source tree (there‚Äôs at least one package that extracts
  jpeg and IIRC png during build in ports, so there‚Äôs precedent)

Benny, please consider cleaning up this situation.
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.51 2010/02/21 09:36:57 bsiegert Exp $
d12 1
a12 1
COMMENT-nssckbi=	CA certificate bundle for NSS (Mirzilla Firetapir)
d16 1
a16 1
FULLPKGNAME-nssckbi=	nssckbi-1.75-3
d28 2
d111 1
a111 1
	    cp ${FILESDIR}/certdata.{c,txt} . && \
@


1.51
log
@SECURITY: Update to 3.0.18.

No problems during build.
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.50 2009/11/15 01:10:45 tg Exp $
d16 1
a16 1
FULLPKGNAME-nssckbi=	nssckbi-1.75-2
@


1.50
log
@experimental upgrade (not tested yet)
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.49 2009/11/14 22:43:09 tg Exp $
d13 1
a13 1
VER=			3.0.15
@


1.49
log
@prefer HTTP over FTP-must-DIE-DIE-DIE!
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.48 2009/08/04 08:26:16 tg Exp $
d13 1
a13 1
VER=			3.0.13
d16 1
a16 1
FULLPKGNAME-nssckbi=	nssckbi-1.75-1
@


1.48
log
@‚Ä¢ separate nssckbi (still need to separate nspr) and fix its patchlevel
‚Ä¢ bump to latest 3.0 series while here

tested:
‚Ä¢ eurynome.mirbsd.org - - [04/Aug/2009:08:18:30 +0000] TLSv1:DHE-RSA-AES256-SHA:IPv6"ca.mirbsd.org" "GET / HTTP/1.1" 200 670 "-" "Mozilla/5.0 (X11; U; MirBSD i386; en-US; rv:1.9.0.13) Gecko/2009080319 /3.0.13"
‚Ä¢ not tested on !MirBSD

problems:
‚Ä¢ ‚ÄúGecko/2009080319 /3.0.13‚Äù is missing the Gran Paradiso string! BUG!
‚Ä¢ 2001:c28:102:1:213:e8ff:febc:efcb - - [04/Aug/2009:04:35:48 +0000] TLSv1:DHE-RSA-AES256-SHA:IPv6"www.mirbsd.org" "GET /pics/miniback.gif HTTP/1.1" 200 129 "https://www.mirbsd.org/cvs.cgi/src/share/misc/Attic/bsdstats" "Mozilla/5.0 (X11; U; Linux i686; ja-JP; rv:1.9.1.1) Gecko/20090730 Iceweasel/3.5.1 not Firefox/3.5.1 (Debian-3.5.1-1)"
  has it cooler: ‚ÄúGecko/20090730 Iceweasel/3.5.1 not Firefox/3.5.1 (Debian-3.5.1-1)‚Äù
  we (WISHLIST) could do ‚ÄúGecko/20090730 MirzillaFiretapir/3.0.13 not Firefox/3.0.13 (MirPorts-3.0.13-0)‚Äù
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.47 2009/07/09 18:03:05 tg Exp $
d28 4
a31 4
MASTER_SITES=		ftp://releases.mozilla.org/pub/mozilla.org/firefox/releases/${VER}/source/ \
			ftp://archive.mozilla.org/pub/mozilla.org/firefox/releases/${VER}/source/ \
			http://ftp.eu.mozilla.org/pub/mozilla.org/firefox/releases/${VER}/source/ \
			http://ftp.mozilla.org/pub/mozilla.org/firefox/releases/${VER}/source/
@


1.47
log
@bump
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.46 2009/07/06 19:28:41 bsiegert Exp $
d12 2
a13 2
VER=			3.0.11
DASH_VER=		1
d16 1
d35 4
d62 11
@


1.46
log
@Update to 3.0.11, no further changes
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.45 2009/07/01 15:25:22 tg Exp $
d13 1
a13 1
DASH_VER=		0
@


1.45
log
@sync and bump

XXX should patch mozilla/security/nss/lib/ckfw/builtins/nssckbi.h to
XXX bump the NSS_BUILTINS_LIBRARY_VERSION by 0.0.0.1
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.44 2009/05/17 16:10:07 tg Exp $
d12 2
a13 2
VER=			3.0.10
DASH_VER=		2
@


1.44
log
@‚Ä¢ sync with MirOS base SSL certificate bunch
‚Ä¢ ca-certificates: also provide a bundle PEM file, e.g. for GnuTLSuckers
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.43 2009/04/28 19:29:45 bsiegert Exp $
d13 1
a13 1
DASH_VER=		1
@


1.43
log
@SECURITY: Update to 3.0.10, fixes some important bugs.
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.42 2009/03/28 16:08:10 bsiegert Exp $
d13 1
a13 1
DASH_VER=		0
@


1.42
log
@SECURITY: Update to firesomething-3.0.8-0, high-priority security update
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.41 2009/03/23 19:33:33 bsiegert Exp $
d10 1
d12 1
a12 1
VER=			3.0.8
@


1.41
log
@SECURITY: Firesomething 3.0.7, another high-priority security update
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.40 2009/02/09 20:19:25 bsiegert Exp $
d11 1
a11 1
VER=			3.0.7
@


1.40
log
@SECURITY: Update firesomething to 3.0.6, contains some security fixes
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.39 2008/12/18 21:01:56 bsiegert Exp $
d11 2
a12 2
VER=			3.0.6
DASH_VER=		1
@


1.39
log
@Oops, forgot to update the plist. Bump.
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.38 2008/12/17 21:34:47 bsiegert Exp $
d11 1
a11 1
VER=			3.0.5
@


1.38
log
@SECURITY: Update to 3.0.5-0, critical fixes.

Untested, it is building right now.
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.37 2008/12/08 22:38:51 tg Exp $
d12 1
a12 1
DASH_VER=		0
@


1.37
log
@commit a port which at least packages and installs fine on MidnightBSD

note: it still bugs around because it picks up libraries from mports
because /usr/X11R6 is a symlink to /usr/local... fix pending, but in-
put on ideas how to do so in a sane way is sought
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.36 2008/12/08 20:31:25 bsiegert Exp $
d11 2
a12 2
VER=			3.0.4
DASH_VER=		2
@


1.36
log
@Revert SO_EXTENSION removal. Also check for MidnightBSD and set SO_EXTENSION
accordingly, correct the manifest, and regen patches.
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.34 2008/12/07 19:56:45 bsiegert Exp $
d4 6
a9 1
ONLY_FOR_PLATFORM=	*:*:alpha *:*:i386 *:*:sparc *:*:sparc64 *:*:amd64 *:*:powerpc
d12 1
a12 1
DASH_VER=		1
d50 1
a50 2
.include <mirports.sys.mk>
.if ${OStype:L:Mmidnightbsd}
a93 2

post-patch:
d95 1
a95 1
	    ln -sf FreeBSD.mk MidnightBSD.mk && \
@


1.35
log
@* change SO_EXTENSION back to SO_VERSION
@
text
@d43 8
a50 1
SUBST_VARS=		LOCALBASE SO_VERSION VER
d101 2
a102 1
		${WRKSRC}/xpcom/components/nsNativeComponentLoader.cpp \
@


1.34
log
@Unbreak now that cairo has been committed.
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.33 2008/12/06 16:11:48 tg Exp $
d43 1
a43 2
SUBST_VARS=		LOCALBASE SO_EXTENSION SO_VERSION VER
SO_EXTENSION=		.${SO_VERSION}
@


1.33
log
@mark as broken: depends on cairo-1.6 but only cairo-1.2 is in MirPorts

BENNYYYYYYYYY!
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.32 2008/12/06 13:35:31 tg Exp $
a3 2
BROKEN=			dependency cairo not ported/committed yet

@


1.32
log
@BENNYYYYYYYYYYYYY!

* MASTER_SITES= foo MASTER_SITES= bar baz
  breaks
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.31 2008/12/05 16:26:07 bsiegert Exp $
d4 2
@


1.31
log
@Merge bsiegert-ff3 branch into the trunk, replacing firesomething 2.0.

Also add missing dependency on dbus, MirOS ca patches. Connecting
to https://www.mirbsd.org works fine without a warning.

MidnightBSD people: please test this version on your OS. It _should_ run
but I did not have the opportunity to test it.
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.30 2008/11/14 00:47:20 tg Exp $
d22 1
a22 1
MASTER_SITES=		ftp://archive.mozilla.org/pub/mozilla.org/firefox/releases/${VER}/source/ \
@


1.30
log
@enable the certificate fix, sync patches, remove a few uses of the
trademarked name to make clear this is something different, bump
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.29 2008/11/13 20:18:17 tg Exp $
d6 1
a6 1
VER=			2.0.0.14
d21 1
d26 1
a26 1
SO_VERSION=		9.0
d30 4
a33 3
BUILD_DEPENDS+=		:libIDL-*:devel/libIDL \
			:zip->=2.3:archivers/zip \
			:pkgconfig-*:devel/pkgconfig
d35 1
d46 1
a46 1
MODGNU_RECURSE_DIRS=	${WRKSRC}/nsprpub ${WRKSRC}/directory/c-sdk ${WRKSRC}
d51 1
d56 1
a56 1
			--enable-default-toolkit=gtk2	\
d62 1
d86 1
a86 2
.for dir in security/coreconf directory/c-sdk/config
	cd ${WRKSRC}/${dir} && \
a88 1
.endfor
d95 2
a96 1
		${WRKSRC}/xpcom/components/nsNativeComponentLoader.cpp
d100 1
a100 1
	    mv -f bin/firefox bin/firesomething && \
d102 1
@


1.29
log
@merge PLIST and PLIST.MidnightBSD by rectifying PFRAG.shared into oblivion:
plugins SHOULD NOT be prefixed with @@lib (‚Äúmmake plist‚Äù fails us on that,
compared to e.g. Python extensions, where such is outright dangerous)
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.28 2008/05/26 05:45:51 bsiegert Exp $
d7 1
a7 1
DASH_VER=		0
a23 1
#MASTER_SITES=		${_MASTER_SITE_MIRBSD}
d76 3
@


1.28
log
@SECURITY: Update firesomething to 2.0.0.14-0, fixes a Javascript crash
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.27 2008/05/21 12:23:23 tg Exp $
d41 2
a42 4
SUBST_VARS=		LOCALBASE SO_VERSION VER
.if ${OStype:NMirBSD:NOpenBSD}
PLIST=			${PKGDIR}/PLIST.${OStype}
.endif
@


1.28.2.1
log
@Update Makefile and distinfo for firesomething 3.0.1, fix the patches that
did not apply by hand.
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.28 2008/05/26 05:45:51 bsiegert Exp $
d6 1
a6 1
VER=			3.0.1
a20 1
MASTER_SITES=		ftp://releases.mozilla.org/pub/mozilla.org/firefox/releases/${VER}/source/ \
d26 1
a26 1
SO_VERSION=		10.0
@


1.28.2.2
log
@First prototype of firesomething-3.0.1, builds, installs but does not (yet)
quite work.
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.28.2.1 2008/08/24 14:52:23 bsiegert Exp $
d31 3
a33 4
BUILD_DEPENDS+=		:libIDL-*:devel/libIDL
BUILD_DEPENDS+=		:zip->=2.3:archivers/zip
BUILD_DEPENDS+=		:python->=2.5.2-7:lang/python/2.5
LIB_DEPENDS+=		cairo:cairo->=1.6:graphics/cairo
d47 1
a47 1
MODGNU_RECURSE_DIRS=	${WRKSRC}/nsprpub ${WRKSRC}
d56 1
a56 1
			--enable-default-toolkit=cairo-gtk2	\
a61 1
			--disable-crashreporter		\
d82 2
a83 1
	cd ${WRKSRC}/security/coreconf && \
d86 1
@


1.28.2.3
log
@Okay, I have a working firefox3, even with stack protection. Yay!!!

Now: merge in main, update to 3.0.4.
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.28.2.2 2008/09/06 19:29:00 bsiegert Exp $
d7 1
a7 1
DASH_VER=		2
a52 1
			--with-system-sqlite		\
d93 1
a93 2
		${WRKSRC}/xpcom/components/nsNativeComponentLoader.cpp \
		${WRKSRC}/browser/installer/unix/packages-static
d97 1
a97 1
	    mv -f firesomething/firefox firesomething/firesomething && \
a98 1
	cd ${PREFIX}/bin && ln -sf ../firesomething/firesomething firesomething
@


1.28.2.4
log
@Update to 3.0.4-0. Also override the EULA in the branding file so that it
is NEVER shown, and set the homepage to about:blank. Regen some patches.

This is the first firefox3 version ready for general use. I still have to
merge it into trunk though. NB that it does not yet contain the MirOS
ssl certificate patch.
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.28.2.3 2008/12/02 19:40:49 bsiegert Exp $
d6 2
a7 2
VER=			3.0.4
DASH_VER=		0
@


1.27
log
@Overhaul this by manually editing‚Ä¶ do *not* use yet, I‚Äôll have
to fix this on MidnightBSD. (No, do not use it on MirBSD yet,
either.)

Fixes:

‚Ä¢ bring back diffs to port Makefile
  ‚Ä£ need <mirports.sys.mk> early
  ‚Ä£ PLIST for !OpenBSD !MirBSD differs
  ‚Ä£ s/MODGNU_CONFIG_GUESS_DIRS/MODGNU_RECURSE_DIRS/ (*cough*!)
  ‚Ä£ MidnightBSD support diffs
  ‚Ä£ fix for issue that binary could not be called
‚Ä¢ use += for variables instead of =
  ‚Ä£ CONFIGURE_ARGS, CONFIGURE_ENV¬π, *_DEPENDS, MODULES
  ‚Ä£ not for MAKE_ENV since = and += differ here (<bsd.port.mk> has
    a MAKE_ENV?= stanza)
  ‚Ä£ ‚ë† not here for CONFIGURE_ENV due to use of CONFIGURE_ENV+=MAKE_ENV,
    which is bad style (it would be better to use a common variable and
    add its content to both)
‚Ä¢ yes, the list of OS names in GNUmakefiles is intended to be sorted
  ‚Ä£ pipe through sort -R' ' inside editor
  ‚Ä£ I actually like the fact that M comes before O in the alphabet ‚ò∫
‚Ä¢ bring back MirBSD/sparc support diffs
‚Ä¢ please do a ‚Äúless /usr/ports/graphics/png/pkg/PLIST‚Äù some time

I also have a question about this diff:
‚îÇ-+    OS_RELEASE="3.5" # XXX
‚îÇ++    OS_RELEASE="3.9" # XXX
‚îî ‚Ä£ our kernel is OpenBSD 3.5-current based, and the OpenBSuxulator
    goes up to 3.8 ‚Äì we do not have some syscalls (including their
    libc interface!) from 3.9 onwards. So why is this?
  ‚Ä£ for now, I kept it, as you apparently built firesomething, but‚Ä¶
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.26 2008/05/21 06:31:02 bsiegert Exp $
d6 2
a7 2
VER=			2.0.0.13
DASH_VER=		1
@


1.26
log
@Ladies and Gentlemen, I present firesomething-2.0.0.13.
Patches are hand-merged.

Please verify that it still builds (and works!) on MidnightBSD and regen
PLIST.MidnightBSD.
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.22 2008/03/31 21:33:55 bsiegert Exp $
d7 1
a7 1
DASH_VER=		0
a12 2
SO_VERSION=		9.0

d19 2
d26 1
d29 2
a30 2
RUN_DEPENDS=		:esound-*:audio/esound
BUILD_DEPENDS=		:libIDL-*:devel/libIDL \
d33 1
a33 1
LIB_DEPENDS=		gdk-x11-2.0.0.0,gdk_pixbuf-2.0.0.0,gtk-x11-2.0.0.0::x11/gtk+
d42 3
d46 1
a46 4
MODGNU_CONFIG_GUESS_DIRS=	${WRKSRC} \
				${WRKSRC}/nsprpub \
				${WRKSRC}/directory/c-sdk

d48 2
a49 2
CONFIGURE_ARGS=		--with-system-jpeg=${LOCALBASE}	\
			--with-system-png=${LOCALBASE}	\
d73 2
a74 2
			LD_LIBRARY_PATH="${WRKSRC}/dist/bin" \
			SO_VERSION="${SO_VERSION}"
a76 3
MOB=			${WRKSRC}/dist/bin
MOZ=			${PREFIX}/firesomething

d82 3
a84 1
	cd ${WRKSRC}/${dir} && ln -s OpenBSD.mk MirBSD.mk
d95 3
a97 1
	ln -f ${PREFIX}/bin/firefox ${PREFIX}/bin/firesomething
@


1.25
log
@‚îå‚îÄ‚îÄ‚î§ woo-hoo!
‚îÇcl-218.chi-02.us.sixxs.net - - [20/May/2008:01:54:21 +0000] TLSv1:DHE-RSA-AES256-SHA:"herc.mirbsd.org" "GET /favicon.ico HTTP/1.1" 200 3638 "-" "Mozilla/5.0 (X11; U; MidnightBSD i386; en-US; rv:1.8.0.10) Gecko/20080519 Firefox/1.5.0.10"
‚îî‚îÄ

I actually ported firesomething to MidnightBSD. A little hacky (they don‚Äôt
have fontconfig in Xbase, so I linked against the one from mports, and had
library issues (it links against three (X.org, mports, MirPorts) libintl),
but working. Wheow! Meow! Now that cat can surf without Penguins.

prodded by Stevan Tiefert M.
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.24 2008/05/07 22:48:45 tg Exp $
d6 2
a7 2
VER=			1.5.0.10
DASH_VER=		1
d13 1
a13 1
SO_VERSION=		8.0
a20 2
.include <mirports.sys.mk>

a40 3
.if ${OStype:NMirBSD:NOpenBSD}
PLIST=			${PKGDIR}/PLIST.${OStype}
.endif
d42 3
a44 1
MODGNU_RECURSE_DIRS=	${WRKSRC}/nsprpub ${WRKSRC}
d84 1
a84 3
	cd ${WRKSRC}/${dir} && \
	    ln -sf FreeBSD.mk MidnightBSD.mk && \
	    ln -sf OpenBSD.mk MirBSD.mk
d95 1
a95 3
	cd ${PREFIX} && \
	    mv -f bin/firefox bin/firesomething && \
	    mv -f firesomething/firefox-bin firesomething/firesomething-bin
@


1.24
log
@‚Ä¢ replace MODGNU_CONFIG_GUESS_DIRS with MODGNU_RECURSE_DIRS
‚Ä¢ always place ${WRKSRC} itself at the end of MODGNU_RECURSE_DIRS due to
  recursion issues inside of autoconf itself
‚Ä¢ if MODGNU_RECURSE_DIRS=${WRKSRC} stood in the Makefile, nuke it (default)
‚Ä¢ remove dead reference to MODGNU_TWIDDLE_DIRS
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.23 2008/04/02 00:35:17 tg Exp $
d21 2
d43 3
d87 3
a89 1
	cd ${WRKSRC}/${dir} && ln -sf OpenBSD.mk MirBSD.mk
@


1.23
log
@since bsiegert@@ won‚Äôt do it rather now than later, fix the firesomething
invocation issue myself (not tested)

also, while here, add midnightbsd to most places it‚Äôs needed (definitively
not all, since I can‚Äôt even mmake extract with what I‚Äôve got left on HDD
space), so that they can start hacking on it (look at the last three parts
of patches/patch-nsprpub_configure_in for an idea what is missing)

XXX benny: why don‚Äôt we do EOVERFLOW? we have had it for a while
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.22 2008/03/31 21:33:55 bsiegert Exp $
d42 1
a42 2
MODGNU_CONFIG_GUESS_DIRS=	${WRKSRC} \
				${WRKSRC}/nsprpub
@


1.22
log
@Update to 1.5.0.10-0. This update has taken me MANY HOURS but the fix is just
a small one-liner. I will write a whiny wlog about it.

bin/firesomething still does not work but I have a fix, just too lazy to
apply it now.

Expect firefox 2.0 RSN.
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.21 2008/03/28 20:26:29 bsiegert Exp $
d7 1
a7 1
DASH_VER=		0
d83 1
a83 1
	cd ${WRKSRC}/${dir} && ln -s OpenBSD.mk MirBSD.mk
d94 3
a96 1
	ln -f ${PREFIX}/bin/firefox ${PREFIX}/bin/firesomething
@


1.21
log
@Firesomething 1.5.0.9, wfm
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.20 2008/03/28 00:02:50 tg Exp $
d6 1
a6 1
VER=			1.5.0.9
@


1.20
log
@make aclocal-1.9 happy: quotes
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.19 2008/03/27 21:18:10 tg Exp $
d6 2
a7 2
VER=			1.5.0.8
DASH_VER=		1
d21 4
a24 4
#MASTER_SITES=		http://releases.mozilla.org/pub/mozilla.org/firefox/releases/${VER}/source/ \
#			http://ftp.eu.mozilla.org/pub/mozilla.org/firefox/releases/${VER}/source/ \
#			http://ftp.mozilla.org/pub/mozilla.org/firefox/releases/${VER}/source/
MASTER_SITES=		${_MASTER_SITE_MIRBSD}
@


1.19
log
@since we mirror the distfile AND it has vanished upstream,
adjust MASTER_SITES accordingly
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.18 2008/03/27 21:14:07 bsiegert Exp $
d7 1
@


1.18
log
@unbreak again, distfile is now mirrored here
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.17 2008/03/27 17:04:50 tg Exp $
d20 4
a23 3
MASTER_SITES=		http://releases.mozilla.org/pub/mozilla.org/firefox/releases/${VER}/source/ \
			http://ftp.eu.mozilla.org/pub/mozilla.org/firefox/releases/${VER}/source/ \
			http://ftp.mozilla.org/pub/mozilla.org/firefox/releases/${VER}/source/
@


1.17
log
@mark as broken: unfetchable distfile
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.16 2007/08/17 20:16:31 bsiegert Exp $
a3 2
BROKEN=			unfetchable distfile

@


1.16
log
@A firesomething a day ... 1.5.0.8 today
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.15 2007/08/16 20:04:05 bsiegert Exp $
d4 2
@


1.15
log
@Update to 1.5.0.7-0, still works as before
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.14 2007/08/15 20:31:21 bsiegert Exp $
d6 1
a6 1
VER=			1.5.0.7
@


1.14
log
@Update firesomething to 1.5.0.6-0. Still old and pathetic, I know. I will
now do the incremental updates one by one until I find the one that
introduced the bug that makes new versions not work.

Includes and IDL files are now shipped, hopefully I can build yelp against
it.
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.13 2006/12/20 15:32:04 tg Exp $
d6 1
a6 1
VER=			1.5.0.6
@


1.13
log
@sync DASH_VER usage:
* the dash doesn't belong into the DASH_VER variable,
  it's only a decimal integer value
* DASH_VER already defaults to 0 (admittedly new)
* PKGNAME already defaults to ${DISTNAME}-${DASH_VER}
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.12 2006/09/14 00:14:35 tg Exp $
d6 1
a6 1
VER=			1.5.0.5
d38 1
a38 1
SUBST_VARS=		LOCALBASE SO_VERSION
d91 2
a92 19
do-install:
.for dir in chrome components defaults extensions greprefs res searchplugins
	${INSTALL_DATA_DIR} ${MOZ}/${dir}
	cd ${MOB} && ${TAR} -chf - ${dir} | \
		${TAR} -xf - -C ${MOZ}
.endfor
	cd ${MOB} && ${TAR} -chf - *.so.?.? | \
		${TAR} -xf - -C ${MOZ}
	chmod 444 ${MOZ}/*.so.?.? ${MOZ}/components/*.so.?.? ${MOZ}/components/*.js
	${INSTALL_DATA} ${WRKSRC}/LICENSE ${MOZ}

	${INSTALL_DATA} ${WRKSRC}/browser/app/mozicon16.xpm ${WRKSRC}/browser/app/mozicon50.xpm ${MOZ}
	${INSTALL_SCRIPT} ${MOB}/firefox ${PREFIX}/bin/firesomething
	${INSTALL_SCRIPT} ${MOB}/firefox-config ${PREFIX}/bin/
	ln -f ${PREFIX}/bin/firesomething ${PREFIX}/bin/firefox
	${INSTALL_SCRIPT} ${MOB}/run-mozilla.sh ${MOZ}
	${INSTALL_PROGRAM} ${MOB}/regxpcom ${MOB}/mozilla-xremote-client ${MOZ}
	${INSTALL_PROGRAM} ${MOB}/firefox-bin ${MOZ}/firesomething-bin
	ln -f ${MOZ}/firesomething-bin ${MOZ}/firefox-bin
@


1.12
log
@clean up COMMENT and HOMEPAGE; regenerate INDEX (2761, 169 marked as broken, probably many many more) ≠ edited by script with manual postprocessing
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.11 2006/07/30 15:07:23 bsiegert Exp $
d5 1
a5 1
COMMENT=			one of the successors to the Netscape browser engine
a6 1
DASH_VER=		-0
d8 1
a8 1
PKGNAME=		firesomething-${VER}${DASH_VER}
@


1.11
log
@SECURITY: Update firesomething to 1.5.0.5-0. Fixes: MFSA 2006-44 to
MFSA-2006-56. See
http://www.mozilla.org/projects/security/known-vulnerabilities.html#firefox1.5.0.5
for details.

Note: I did not test this other than to see that all patches still apply.
I'll build it tomorrow but I wanted to get this out now.
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.10 2006/06/07 09:35:54 bsiegert Exp $
d5 1
a5 1
COMMENT=		"one of the successors to the Netscape browser engine"
@


1.10
log
@SECURITY: Update firesomething to 1.5.0.4-0.
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.9 2006/05/11 20:55:40 bsiegert Exp $
d6 1
a6 1
VER=			1.5.0.4
d21 2
a22 1
MASTER_SITES=		http://ftp.eu.mozilla.org/pub/mozilla.org/firefox/releases/${VER}/source/ \
@


1.9
log
@Update firesomething to 1.5.0.3-0.

Our build is "unofficial" for trademark reasons and thus calls itself
"Deer Park" (the code name). The executable is called "firesomething", as
usual.

This probably needs -current, but it runs on my own -stable too (I have
rebuilt ld and src/lib from source). Don't even bother with it on #7.
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.6 2005/07/06 19:21:37 bsiegert Exp $
d6 1
a6 1
VER=			1.5.0.3
d25 1
a25 1
MODULES=		devel/gettext
d71 1
a71 2
CONFIGURE_ENV=		${MAKE_ENV} \
			PKG_CONFIG_PATH="${LOCALBASE}/lib/pkgconfig:${X11BASE}/lib/pkgconfig"
a84 1
#	@@cd ${WRKSRC}/nsprpub && ${SETENV} ${AUTOCONF_ENV} ${AUTOCONF}
@


1.8
log
@Fix a few abuses:
| CONFIGURE_ENV=	CPPFLAGS="-I${LOCALBASE}/include/libpng \
|			    -I${LOCALBASE}/include -I${X11BASE}/include" \
| 			LDFLAGS="-L${LOCALBASE}/lib -L${X11BASE}/lib" \
|			PKGCONFIG_PATH=...

* use Benny's pkgconfig module
  - fixes PKGCONFIG_PATH in all places
  - adds explicit dependencies on pkgconfig where needed
* use a new png module
  - also cought a few implicit dependencies
* use a new freetype1 module in two places (more to come?)
* CPPFLAGS, LDFLAGS are in CONFIGURE_ENV anyway, so correctly
  add to them as CPPFLAGS+=<tab>foo instead
* use EXTRA_{M,X,F}AKE_FLAGS
* CC is given anyway, too
* add MAKEINFO= to gnu style

Still doesn't catch all OpenBSD abuses, but most of them.

Brokenness analysis:
* Automatically done
  - CFLAGS+=CPPFLAGS
  - CXXFLAGS+=CPPFLAGS
  - CPPFLAGS+=-I${LOCALBASE}/include
  - LDFLAGS+=-L${LOCALBASE}/lib
  - CONFIGURE_ENV, MAKE_FLAGS+=
    + LDFLAGS=LDFLAGS
    + CPPFLAGS you get the idea
    + CFLAGS
    + CXXFLAGS
    + CC
    + CXX (if USE_CXX)
* Done if USE_X11=Yes
  - CPPFLAGS+=X11BASE/include
  - LDFLAGS+=X11BASE/lib

Tell me if there are problems, but first try adding
an EXTRA_ before MAKE_FLAGS and FAKE_FLAGS.
Remember EXTRA_XAKE_FLAGS get added to both.
@
text
@d1 2
a2 4
# $MirOS: ports/www/firesomething/Makefile,v 1.7 2005/12/18 16:36:46 tg Exp $
# $OpenBSD: Makefile,v 1.10 2004/08/08 17:19:36 robert Exp $

BROKEN=			Kaput. I suggest ports/www/opera (BSD), K-Meleon (Win), Safari (Mac)
d6 2
a7 2
VERSION=		0.8
DASH_VER=		-1
d9 1
a9 1
PKGNAME=		firesomething-${VERSION}${DASH_VER}
d13 6
a18 4
# MPL; strange Trademark licence policy
PERMIT_PACKAGE_CDROM=	"trademark licencing issues"
PERMIT_PACKAGE_FTP=	"http://mozilla.org/foundation/licensing.html"
PERMIT_DISTFILES_CDROM=	"unsure of licencing implications"
d21 10
a30 11
MASTER_SITES=		http://ftp.eu.mozilla.org/pub/mozilla.org/firefox/releases/${VERSION}/ \
			http://ftp.mozilla.org/pub/firefox/releases/${VERSION}/
DISTFILES=		firefox-source-${VERSION}.tar.bz2

MODULES+=		devel/pkgconfig
BUILD_DEPENDS=		:zip->=2.3:archivers/zip
LIB_DEPENDS=		gtk.1,gdk.1::x11/gtk+1 \
			glib.1,gmodule.1::devel/glib1 \
			IDL.4::devel/ORBit \
			jpeg.62::graphics/jpeg \
			png.3::graphics/png
d38 1
d40 2
a41 3
MODGNU_CONFIG_GUESS_DIRS=	${WRKSRC}/build/autoconf \
				${WRKSRC}/nsprpub/build/autoconf \
				${WRKSRC}/directory/c-sdk/config/autoconf
d48 1
d51 1
d55 10
a64 1
			--disable-installer
d66 7
a72 15
CONFIGURE_ARGS+=	--disable-ldap			\
			--disable-mailnews		\
			--enable-extensions=cookie,xml-rpc,xmlextras,p3p,pref,transformiix,universalchardet,typeaheadfind,webservices \
			--enable-crypto			\
			--disable-composer

# There is no problem with the propolice-enabled gcc3 on amd64 and sparc64,
# but it is reported to still be broken on others. XXX test that!
.if ${MACHINE_ARCH} != "amd64" && ${MACHINE_ARCH} != "sparc64"
CFLAGS+=		-fno-stack-protector
.endif

CONFIGURE_ENV=		MOZ_PHOENIX=1
MAKE_ENV=		MOZ_PHOENIX=1 \
			LD_LIBRARY_PATH="${WRKSRC}/dist/bin"
d86 1
a86 3
.for dir in / nsprpub directory/c-sdk
	@@cd ${WRKSRC}/${dir} && ${SETENV} ${AUTOCONF_ENV} ${AUTOCONF}
.endfor
d89 3
d94 3
a96 3
	${INSTALL_DATA_DIR} ${MOZ}
.for dir in chrome components defaults res searchplugins
	@@cd ${MOB} && ${TAR} -chf - ${dir} | \
d99 1
a99 1
	@@cd ${MOB} && ${TAR} -chf - *.so.1.0 | \
d101 4
a104 1
	@@chmod 444 ${MOZ}/*.so.1.0 ${MOZ}/components/*.so.1.0
d106 6
a111 2
	${INSTALL_SCRIPT} ${MOB}/run-mozilla.sh ${MOB}/mozilla-config ${MOZ}
	${INSTALL_PROGRAM} ${MOB}/regchrome ${MOB}/regxpcom ${MOB}/firefox-bin ${MOZ}
@


1.7
log
@Part 2 of the big commit:
* www/vbegin.php: don't output the UTF-8 BOM for now
* ports/Setup.sh: change order in which path is divined [1]
* ports/books/mirex: convert to CVS_DISTF
* ports/comms/ssfe: increase line length limit and history buffer size
* ports/infrastructure/install/setup.sh: sync path order with Setup.sh [1]
* ports/infrastructure/mk/bsd.port.mk: (_PORTPATH) sync default PATH [1]
* ports/infrastructure/mk/bsd.port.mk: (_UPGRADE_FLAGS) new, default to -a
* ports/infrastructure/mk/bsd.port.mk: (_upgrade) use it
* ports/infrastructure/mk/bsd.port.mk: (reupgrade) new target, set to -a -f
* ports/infrastructure/scripts/mkmcz: don't use $LOCALBASE, trust in PATH
* ports/infrastructure/mk/bsd.port.mk: (_CVS_FETCH) use _PORTPATH
* ports/infrastructure/pkgtools/create: treat /usr/info same as /usr/man
* ports/infrastructure/pkgtools/upgrade: fix path to temp +REQUIRED_BY
* ports/www/firesomething: break, suggest Opera-Linux/K-Meleon/Safari
* src/Makefile, src/gcc/Makefile.lang: if build GCJ, check if X11 installed
* src/Makefile, src/gnu/usr.bin/perl/Makefile.bsd-wrapper: defer h2ph
  execution to end of build
* src/distrib/lists: sync with pre-h2ph change
* src/etc/services: add openvpn, from IANA
* src/gcc/Makefile.inc, Makefile.lang: fragment out NO_*= stuff
* src/gcc/libjava/Makefile.bsd-wrapper: DEBUGPROGS is gone
* src/gnu/usr.bin/perl/Makefile.bsd-wrapper: flesh out h2ph, fix perms
* src/lib/libc/time/localtime.c: fix undefined extern
* ports/net/sirc/Makefile: automatically insert version into CTCP VERSION
* ports/net/sirc/dist/PROGRAMMING: document capab hooks
* ports/net/sirc/dist/dsircp: several hours of perl hacking with Club-Mate
  - publish $msgchannel, $talkserver [2]
  - support for CAPAB: publish $has_capab, $capab_cmd, $capab_response;
    add "capab" hook in reply
  - support for CAPAB IDENTIFY-MSG: publish $has_identifymsg; new
    $unverified, $unverified_m; enable automatically if present;
    change <...> [...] -...- to ´...ª [[...]] ¨...¨
  - /describe nick now looks [*] (or [[*]]) instead of *, /me now looks
    # instead of * if identified, to facilitate this conversion
  - fix abuse of U+0060
  - sort /names [2]
  - fix ^B ^_ ^V [2]
  - remove trailing whitespace on outgoing msgs [2]
  - remove trailing whitespace on incoming msgs
  - fix indentation
  - auto-split overlong lines (partially [2])
  - in NOTICE make nick bold too [2]
  - disable DCC since it crashes
  - beautify CTCP TIME replies
  - add ACCEPT command (for ratbox-ircd, e.g. Freeforge)
* ports/net/sirc/pkg/DESCR: summarise new features

[1] all for the sake of bsiegert@@ wanting to not have to souce a
    SetEnv.sh or SetEnv.csh before building in "default MirPorts"
    (i.e. LOCALBASE=/usr/mpkg SYSCONFDIR=/etc BINOWN=root SUDO=sudo)
[2] adapted from http://co.ordinate.org/sirc/
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.6 2005/07/06 19:21:37 bsiegert Exp $
d25 2
a26 2
BUILD_DEPENDS=		:zip->=2.3:archivers/zip \
			:pkgconfig-*:devel/pkgconfig
d68 1
a68 2
CONFIGURE_ENV=		MOZ_PHOENIX=1 \
			PKG_CONFIG_PATH="${LOCALBASE}/lib/pkgconfig:${X11BASE}/lib/pkgconfig"
@


1.6
log
@Move some packages (those that use DASH_VER) to new patchlevels.
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.4 2005/04/10 21:51:25 tg Exp $
d4 2
@


1.5
log
@the port part of platform refinal
@
text
@d7 1
a7 1
DASH_VER=		p1
@


1.4
log
@NOPIC_PLATFORMS, LP64_PLATFORMS and general change of
{NOT,ONLY}_FOR_{ARCH{,E,ES},OS} to {NOT,ONLY}_FOR_PLATFORM

some fallout maybe, I hope not
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.3 2005/03/30 18:13:52 bsiegert Exp $
d4 1
a4 1
ONLY_FOR_PLATFORM=	*:alpha *:i386 *:sparc *:sparc64 *:amd64 *:powerpc
@


1.3
log
@Covert gtk+ -> gtk+1 dependencies
@
text
@d1 1
a1 1
# $MirOS: ports/www/firesomething/Makefile,v 1.2 2005/03/20 16:56:21 bsiegert Exp $
d4 1
a4 1
ONLY_FOR_ARCHS=		alpha i386 sparc sparc64 amd64 powerpc
@


1.2
log
@glib->glib1 in dependencies

this is getting on my nerves
@
text
@d1 1
a1 1
# $MirOS$
d25 2
a26 2
LIB_DEPENDS=		gtk.1,gdk.1::x11/gtk+ \
			glib.1,gmodule.1::devel/glib1\
@


1.1
log
@Initial revision
@
text
@d26 1
a26 1
			glib.1,gmodule.1::devel/glib \
@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
