head	1.4;
access;
symbols;
locks; strict;
comment	@# @;


1.4
date	2006.11.06.19.16.43;	author tg;	state Exp;
branches;
next	1.3;
commitid	100454F8A0849F78C0E;

1.3
date	2006.11.04.04.12.03;	author tg;	state Exp;
branches;
next	1.2;
commitid	100454C131B2F513360;

1.2
date	2006.11.04.03.09.20;	author tg;	state Exp;
branches;
next	1.1;
commitid	100454C04732D0AB3F2;

1.1
date	2005.06.24.17.41.33;	author tg;	state Exp;
branches;
next	;
commitid	402e42bc45e2e656;


desc
@@


1.4
log
@revive frozen-bubble 1.0, it's less than one tenth the size.
sync patches between the two and fix DESCR.

(no bump to frozen-bubble 2.0 PKGNAME, despite it would be
deserved, since I don't require a recompile.)
@
text
@$MirOS: ports/games/frozen-bubble/patches/patch-c_stuff_Makefile_PL,v 1.3 2006/11/04 04:12:03 tg Exp $
$NetBSD: patch-aa,v 1.4 2003/04/18 08:07:51 salo Exp $
--- c_stuff/Makefile.PL.orig	Thu Oct 19 20:46:12 2006
+++ c_stuff/Makefile.PL	Sat Nov  4 04:09:32 2006
@@@@ -16,7 +16,7 @@@@ $main;
 }
 EOTEST
 	close(CTEST);
-	$r = system("$Config{cc} -o $fname $fname.c $cflags $libs 2>/dev/null 1>/dev/null");
+	$r = system("$Config{cc} -o $fname $fname.c $cflags $libs >>res 2>&1");
 	warn("RUNNING: $Config{cc} -o $fname $fname.c $cflags $libs\n") if $ENV{VERBOSE};
 	unlink($fname, "$fname.c");
 	return $r == 0;
@@@@ -34,8 +34,8 @@@@ system("sdl-config --cflags 2>/dev/null 
 ccompile('#include <SDL.h>
           #include <SDL_mixer.h>',
 	 '',
-	 chomp_(`sdl-config --cflags`),
-	 chomp_(`sdl-config --libs`) . ' -lSDL_mixer')
+	 chomp_($ENV{CFLAGS} . ' ' . $ENV{CPPFLAGS} . ' ' . `sdl-config --cflags`),
+	 chomp_($ENV{LDFLAGS} . ' ' . `sdl-config --libs`) . ' -lSDL_mixer -lvorbisfile -lvorbis -logg')
   or
   die_ 'SDL_mixer is needed (and, version >= 1.2.2)';
 
@@@@ -43,8 +43,8 @@@@ ccompile('#include <SDL.h>
 ccompile('#include <SDL.h>
           #include <SDL_mixer.h>',
 	 'Mix_FadeInMusicPos(NULL, 0, 0, 0);',
-	 chomp_(`sdl-config --cflags`),
-	 chomp_(`sdl-config --libs`) . ' -lSDL_mixer')
+	 chomp_($ENV{CFLAGS} . ' ' . `sdl-config --cflags`),
+	 chomp_($ENV{LDFLAGS} . ' ' . `sdl-config --libs`) . ' -lSDL_mixer -lvorbisfile -lvorbis -logg')
   or
   die_ 'SDL_mixer >= 1.2.2 is needed (impossible to create an executable with function Mix_FadeInMusicPos)';
 
@@@@ -77,6 +77,6 @@@@ WriteMakefile(
     'VERSION_FROM' => 'fb_c_stuff.pm', # finds VERSION
     'OBJECT'       => 'fb_c_stuff.o',
     'INC'          => chomp_(`sdl-config --cflags`) . ' ' . chomp_(`pkg-config SDL_Pango --cflags`) . ' -I.',
-    'OPTIMIZE'     => '-O2 -Wall',
+    'OPTIMIZE'     => chomp_('-O2 -Wall ' . $ENV{CFLAGS}),
     'MAKEFILE'     => 'Makefile_c',
 );
@


1.3
log
@I think I got it right this time, butâ€¦

[SDL Init] perl:/usr/mpkg/libdata/perl5/site_perl/i386-mirbsd/auto/SDL_perl/SDL_perl.so: undefined symbol 'SDL_NumJoysticks'
@
text
@d1 1
a1 1
$MirOS: ports/games/frozen-bubble/patches/patch-c_stuff_Makefile_PL,v 1.2 2006/11/04 03:09:20 tg Exp $
d41 1
a41 1
+    'OPTIMIZE'     => chomp_('-O2 -Wall' . $ENV{CFLAGS}),
@


1.2
log
@maybe update to 2.0
@
text
@d1 1
a1 1
$MirOS: ports/games/frozen-bubble/patches/patch-c_stuff_Makefile_PL,v 1.1 2005/06/24 17:41:33 tg Exp $
d4 1
a4 1
+++ c_stuff/Makefile.PL	Fri Nov  3 23:25:27 2006
@


1.1
log
@*hick*
@
text
@d1 1
a1 1
$MirOS$
d3 2
a4 2
--- c_stuff/Makefile.PL.orig	Thu Apr 18 09:43:58 2002
+++ c_stuff/Makefile.PL	Fri Jun 24 17:36:52 2005
d15 2
a16 2
 ccompile('#include <SDL/SDL.h>
           #include <SDL/SDL_mixer.h>',
d18 1
a18 1
-	 `sdl-config --cflags`,
d23 1
a23 1
   die_ 'SDL_mixer is needed (and, by the way, version >= 1.2.2 will be needed)';
d25 3
a27 3
@@@@ -43,18 +43,18 @@@@ ccompile('#include <SDL/SDL.h>
 ccompile('#include <SDL/SDL.h>
           #include <SDL/SDL_mixer.h>',
d29 1
a29 1
-	 `sdl-config --cflags`,
d34 1
a34 1
   die_ 'SDL_mixer >= 1.2.2 is needed (function Mix_FadeInMusicPos is missing)';
d36 1
a36 5
 
 WriteMakefile(
     'NAME'         => 'fb_c_stuff',
-    'LIBS'         => [ chomp_(`sdl-config --libs`) . ' -lSDL_mixer'],
+    'LIBS'         => [ chomp_($ENV{LDFLAGS} . ' ' . `sdl-config --libs`) . ' -lSDL_mixer -lvorbisfile -lvorbis -logg'],
d39 1
a39 1
     'INC'          => chomp_(`sdl-config --cflags`) . ' -I.',
d41 1
a41 1
+    'OPTIMIZE'     => chomp_($ENV{CFLAGS} . ' -O2 -Wall'),
@

