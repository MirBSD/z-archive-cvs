head	1.15;
access;
symbols;
locks; strict;
comment	@# @;


1.15
date	2010.11.19.17.22.29;	author bsiegert;	state Exp;
branches;
next	1.14;
commitid	1004CE6B24B1D2E2551;

1.14
date	2008.05.07.22.47.56;	author tg;	state Exp;
branches;
next	1.13;
commitid	100482231C374D9CA0B;

1.13
date	2008.03.09.17.22.27;	author tg;	state Exp;
branches;
next	1.12;
commitid	10047D41CAA7E715397;

1.12
date	2007.08.16.20.46.23;	author bsiegert;	state Exp;
branches;
next	1.11;
commitid	10046C4B75446440157;

1.11
date	2006.12.20.15.31.06;	author tg;	state Exp;
branches;
next	1.10;
commitid	100458956E02A39AB3C;

1.10
date	2006.09.14.00.07.48;	author tg;	state Exp;
branches;
next	1.9;
commitid	10045089C0E234154C3;

1.9
date	2006.04.25.20.01.00;	author tg;	state Exp;
branches;
next	1.8;
commitid	100444E800D3870C226;

1.8
date	2006.04.21.15.00.45;	author bsiegert;	state Exp;
branches;
next	1.7;
commitid	1004448F3972D856DBD;

1.7
date	2006.02.09.09.35.43;	author tg;	state Exp;
branches;
next	1.6;
commitid	10043EB0C94610EDE76;

1.6
date	2005.07.26.20.07.37;	author bsiegert;	state Exp;
branches;
next	1.5;
commitid	77a042e69804edcd;

1.5
date	2005.07.25.20.31.58;	author bsiegert;	state Exp;
branches;
next	1.4;
commitid	2a5642e54c1e1e16;

1.4
date	2005.07.06.19.21.27;	author bsiegert;	state Exp;
branches;
next	1.3;
commitid	609742cc2f044f70;

1.3
date	2005.05.19.19.58.28;	author bsiegert;	state Exp;
branches;
next	1.2;
commitid	3beb428cef21361b;

1.2
date	2005.04.10.21.49.16;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.03.18.15.44.07;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.03.18.15.44.07;	author tg;	state Exp;
branches;
next	;


desc
@@


1.15
log
@The download URL at oracle.com changed again. Also mirror the patches
at mirbsd.org for good.
@
text
@# $MirOS: ports/databases/db/Makefile,v 1.14 2008/05/07 22:47:56 tg Exp $

COMMENT=		Berkeley DB, revision 4
COMMENT-doc=		Berkeley DB documentation, revision 4
COMMENT-tcl=		Berkeley DB Tcl library, revision 4
COMMENT-cxx=		Berkeley DB C++ library, revision 4
DESCR=			${PKGDIR}/DESCR

RESPONSIBLE=		Benny Siegert <bsiegert@@gmx.de>

VERSION=		4.2.52.5
DASH_VER=		0
DISTNAME=		db-${VERSION:R}
PKGNAME=		db-${VERSION}-${DASH_VER}
PKGNAME-doc=		db-doc-${VERSION}-${DASH_VER}
PKGNAME-tcl=		db-tcl-${VERSION}-${DASH_VER}
PKGNAME-cxx=		db-cxx-${VERSION}-${DASH_VER}
CATEGORIES=		databases
HOMEPAGE=		http://www.oracle.com/technology/software/products/berkeley-db/
MASTER_SITES=		http://download.oracle.com/berkeley-db/
MASTER_SITES0=		${MASTER_SITES:=patches/db/${VERSION:R}/}
DIST_SUBDIR=		db4

TCL_VERSION=		8.4

# License: BSD + SleepyCat's additions.
# Must purchase license to redistribute if not distributing the source.
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

PATCHFILES=		patch.4.2.52.1:0 patch.4.2.52.2:0
PATCHFILES+=		patch.4.2.52.3:0 patch.4.2.52.4:0
PATCHFILES+=		patch.4.2.52.5:0

MULTI_PACKAGES=		-doc

WRKBUILD=		${WRKSRC}/build_unix
CONFIGURE_STYLE=	autogen
AUTOCONF_NEW=		Yes
AUTOGEN=		${SHELL} -c 'cd dist && . ./s_config'
CONFIGURE_SCRIPT=	${WRKSRC}/dist/configure
CONFIGURE_ARGS+=	--enable-compat185 
CONFIGURE_ARGS+=	--enable-dump185
CONFIGURE_ARGS+=	--enable-static
CONFIGURE_ARGS+=	--includedir=$$\{prefix}/include/db4
CONFIGURE_ARGS+=	${CONFIGURE_SHARED}

MODGNU_RECURSE_DIRS=	${WRKSRC}/dist

PSEUDO_FLAVOURS=	no_tcl no_cxx
FLAVOUR?=
SUBPACKAGE?=

.if ${FLAVOUR:L:Mno_tcl}
CONFIGURE_ARGS+=	--disable-tcl
NO_REGRESS=		Yes
.else
NOT_FOR_PLATFORM=	${NOPIC_PLATFORMS}
MULTI_PACKAGES+=	-tcl
. if !defined(PACKAGING) || ${SUBPACKAGE} == "-tcl"
LIB_DEPENDS+=		tcl84.1.0::lang/tcl/${TCL_VERSION}
. endif
CFLAGS+=		-I${LOCALBASE}/include/tcl${TCL_VERSION}
CONFIGURE_ARGS+=	--enable-tcl 
CONFIGURE_ARGS+=	--with-tcl=${LOCALBASE}/lib/tcl${TCL_VERSION}
# Regression suite requires Tcl.
CONFIGURE_ARGS+=	--enable-test

do-regress:
	cd ${WRKDIST}/build_unix && \
	tclsh${TCL_VERSION} ${FILESDIR}/do-regress.tcl

.endif

.if ${FLAVOUR:L:Mno_cxx}
CONFIGURE_ARGS+=	--disable-cxx
.else
NOT_FOR_PLATFORM=	${NOPIC_PLATFORMS}
MULTI_PACKAGES+=	-cxx
CONFIGURE_ARGS+=	--enable-cxx
USE_CXX=		Yes
.endif

.if defined(PACKAGING) && !empty(SUBPACKAGE) && ${SUBPACKAGE} != "-doc"
RUN_DEPENDS+=		::databases/db
.endif

.include <bsd.port.mk>
@


1.14
log
@â€¢ replace MODGNU_CONFIG_GUESS_DIRS with MODGNU_RECURSE_DIRS
â€¢ always place ${WRKSRC} itself at the end of MODGNU_RECURSE_DIRS due to
  recursion issues inside of autoconf itself
â€¢ if MODGNU_RECURSE_DIRS=${WRKSRC} stood in the Makefile, nuke it (default)
â€¢ remove dead reference to MODGNU_TWIDDLE_DIRS
@
text
@d1 1
a1 1
# $MirOS: ports/databases/db/Makefile,v 1.13 2008/03/09 17:22:27 tg Exp $
d21 1
a21 1
MASTER_SITES0=		http://www.oracle.com/technology/products/berkeley-db/db/update/${VERSION:R}/
@


1.13
log
@bulk convert FLAVOR to FLAVOUR; nuke unused file; convert to $Mdocdate
@
text
@d1 1
a1 1
# $MirOS: ports/databases/db/Makefile,v 1.12 2007/08/16 20:46:23 bsiegert Exp $
d50 1
a50 1
MODGNU_CONFIG_GUESS_DIRS= ${WRKSRC}/dist
d52 1
a52 1
PSEUDO_FLAVOURS=		no_tcl no_cxx
@


1.12
log
@Unbreak build, use build_unix dir provided by upstream.
Fix $CC in Makefile, fix a typo in DESCR.
Integrate .5 patch, use oracle.com homepage---which is TEH SUCK btw.
@
text
@d1 1
a1 1
# $MirOS: ports/databases/db/Makefile,v 1.11 2006/12/20 15:31:06 tg Exp $
d52 2
a53 2
PSEUDO_FLAVORS=		no_tcl no_cxx
FLAVOR?=
d56 1
a56 1
.if ${FLAVOR:L:Mno_tcl}
d77 1
a77 1
.if ${FLAVOR:L:Mno_cxx}
@


1.11
log
@sync DASH_VER usage:
* the dash doesn't belong into the DASH_VER variable,
  it's only a decimal integer value
* DASH_VER already defaults to 0 (admittedly new)
* PKGNAME already defaults to ${DISTNAME}-${DASH_VER}

XXX why is this still broken? I told you months ago
XXX how a separate_build can be done on a per-port basis
@
text
@d1 1
a1 3
# $MirOS: ports/databases/db/Makefile,v 1.10 2006/09/14 00:07:48 tg Exp $

BROKEN=			ask tg@@ to re-add SEPARATE_BUILD
d11 2
a12 2
VERSION=		4.2.52.4
DASH_VER=		2
d19 3
a21 4
HOMEPAGE=		http://www.sleepycat.com/
MASTER_SITES=		ftp://sleepycat1.inetu.net/releases/ \
			${HOMEPAGE}/update/snapshot/
MASTER_SITES0=		${HOMEPAGE}/update/${VERSION:R}/
d35 1
d39 1
a50 1
WRKBUILD=		${WRKDIR}/build
@


1.10
log
@clean up COMMENT and HOMEPAGE; regenerate INDEX (2761, 169 marked as broken, probably many many more) ­ edited by script with manual postprocessing
@
text
@d1 1
a1 1
# $MirOS: ports/databases/db/Makefile,v 1.9 2006/04/25 20:01:00 tg Exp $
d5 4
a8 4
COMMENT=			Berkeley DB, revision 4
COMMENT-doc=			Berkeley DB documentation, revision 4
COMMENT-tcl=			Berkeley DB Tcl library, revision 4
COMMENT-cxx=			Berkeley DB C++ library, revision 4
d13 7
a19 7
VERSION=		4.2.52
DASH_VER=		.4-2
DISTNAME=		db-${VERSION}
PKGNAME=		db-${VERSION}${DASH_VER}
PKGNAME-doc=		db-doc-${VERSION}${DASH_VER}
PKGNAME-tcl=		db-tcl-${VERSION}${DASH_VER}
PKGNAME-cxx=		db-cxx-${VERSION}${DASH_VER}
d24 1
a24 1
MASTER_SITES0=		${HOMEPAGE}/update/${VERSION}/
@


1.9
log
@try this for separate build
@
text
@d1 1
a1 1
# $MirOS: ports/databases/db/Makefile,v 1.8 2006/04/21 15:00:45 bsiegert Exp $
d5 4
a8 4
COMMENT=		"Berkeley DB, revision 4"
COMMENT-doc=		"Berkeley DB documentation, revision 4"
COMMENT-tcl=		"Berkeley DB Tcl library, revision 4"
COMMENT-cxx=		"Berkeley DB C++ library, revision 4"
@


1.8
log
@distfile has been modified upstream, the Java RPC server (which we don't
build anyway) has been removed.

Oh, and this:
BROKEN=			ask tg@@ to re-add SEPARATE_BUILD

You can't build Berkeley DB without using a separate build directory, and
I don't see why I should write the code myself for every fucking port which
needs this. We HAD a working mechanism.
@
text
@d1 1
a1 1
# $MirOS: ports/databases/db/Makefile,v 1.5 2005/07/25 20:31:58 bsiegert Exp $
d52 1
@


1.7
log
@remove SEPARATE_BUILD for once and for good, I'm fed up with
all the trouble it can cause - ports which need it (e.g. the
GCC SC doesnt "support" building gcc with srcdir=objdir) can
set stuff like WRKBUILD themselves.
@
text
@d1 3
a3 1
# $MirOS: ports/databases/db/Makefile,v 1.6 2005/07/26 20:07:37 bsiegert Exp $
@


1.6
log
@fix soname 4.0.2 -> 4.2.0, bump patchlevel
@
text
@d1 1
a1 1
# $MirOS: ports/databases/db/Makefile,v 1.5 2005/07/25 20:31:58 bsiegert Exp $
a41 1
SEPARATE_BUILD=		flavored
@


1.5
log
@Libtoolise plist, bump patchlevel
@
text
@d1 1
a1 1
# $MirOS: ports/databases/db/Makefile,v 1.4 2005/07/06 19:21:27 bsiegert Exp $
d12 1
a12 1
DASH_VER=		.4-1
@


1.4
log
@Move some packages (those that use DASH_VER) to new patchlevels.
@
text
@d1 1
a1 1
# $MirOS: ports/databases/db/Makefile,v 1.3 2005/05/19 19:58:28 bsiegert Exp $
d12 1
a12 1
DASH_VER=		.4-0
@


1.3
log
@After bug report from José António Matias de Jesus, overhaul the port (thanks
btw!).

- add two distpatches
- really use MirLibtool, now that I know how it works (from the eds port)
- fix Darwin compilation and soname
- don't install example programs
- use SEPARATE_BUILD=flavored, _much_ cleaner than before
- remove some kludges
@
text
@d1 1
a1 1
# $MirOS: ports/databases/db/Makefile,v 1.1.7.1 2005/03/18 15:44:07 tg Exp $
d12 1
a12 1
DASH_VER=		.4
@


1.2
log
@NOPIC_PLATFORMS, LP64_PLATFORMS and general change of
{NOT,ONLY}_FOR_{ARCH{,E,ES},OS} to {NOT,ONLY}_FOR_PLATFORM

some fallout maybe, I hope not
@
text
@d12 1
a12 1
DASH_VER=		.2p1
d20 2
a21 1
MASTER_SITES=		${HOMEPAGE}/update/snapshot/
d35 1
d39 5
a43 2
CONFIGURE_STYLE=	gnu
CONFIGURE_SCRIPT=	../dist/configure
d50 1
a50 3
MODGNU_CONFIG_GUESS_DIRS= ${WRKSRC} ${WRKSRC}/dist

WRKBUILD=		${WRKDIST}/build_unix
a89 7
post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/examples/db4
	cd ${WRKSRC}/examples_c; ${INSTALL_DATA} *.c \
		${PREFIX}/share/examples/db4
	cd ${WRKSRC}/examples_cxx; ${INSTALL_DATA} *.cpp \
		${PREFIX}/share/examples/db4

@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $MirOS$
d57 1
a57 1
NOT_FOR_ARCHS=		${NO_SHARED_ARCHS}
d77 1
a77 1
NOT_FOR_ARCHS=		${NO_SHARED_ARCHS}
@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
