head	1.13;
access;
symbols;
locks; strict;
comment	@# @;


1.13
date	2012.10.18.17.10.48;	author tg;	state Exp;
branches;
next	1.12;
commitid	1005080382C3BFC37BC;

1.12
date	2012.10.18.16.41.24;	author tg;	state Exp;
branches;
next	1.11;
commitid	1005080313B0D9D852C;

1.11
date	2009.05.20.19.39.11;	author tg;	state Exp;
branches;
next	1.10;
commitid	1004A145C3E1AD9A78D;

1.10
date	2009.05.20.14.45.24;	author tg;	state Exp;
branches;
next	1.9;
commitid	1004A14177950649403;

1.9
date	2009.01.17.11.43.33;	author tg;	state Exp;
branches;
next	1.8;
commitid	1004971C3F4204C5115;

1.8
date	2008.03.09.17.22.28;	author tg;	state Exp;
branches;
next	1.7;
commitid	10047D41CAA7E715397;

1.7
date	2006.09.14.00.07.50;	author tg;	state Exp;
branches;
next	1.6;
commitid	10045089C0E234154C3;

1.6
date	2006.02.09.09.35.43;	author tg;	state Exp;
branches;
next	1.5;
commitid	10043EB0C94610EDE76;

1.5
date	2005.10.13.23.25.33;	author tg;	state Exp;
branches;
next	1.4;
commitid	ec9434eecf99c0c;

1.4
date	2005.10.13.23.01.52;	author tg;	state Exp;
branches;
next	1.3;
commitid	27a0434ee7332f37;

1.3
date	2005.07.07.21.18.26;	author bsiegert;	state Exp;
branches;
next	1.2;
commitid	66bc42cd9a7ea714;

1.2
date	2005.05.04.12.06.05;	author tg;	state Exp;
branches;
next	1.1;
commitid	c454278bac3f6fd;

1.1
date	2005.03.18.15.44.10;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.03.18.15.44.10;	author tg;	state Exp;
branches;
next	;


desc
@@


1.13
log
@shuffle files around to avoid dead symlink(7)s
@
text
@# $MirOS: ports/databases/openldap/Makefile,v 1.12 2012/10/18 16:41:24 tg Exp $
# $OpenBSD: Makefile,v 1.40 2004/04/04 21:53:37 jakob Exp $

COMMENT=		Open source LDAP software (client)
COMMENT-server=		Open source LDAP software (server)
VERSION=		2.2.26
DASH_VER=		5

DISTNAME=		openldap-${VERSION}
FULLPKGNAME=		openldap-client-${VERSION}-${DASH_VER}
PKGNAME-server=		openldap-server-${VERSION}-${DASH_VER}
CATEGORIES=		databases net
HOMEPAGE=		http://www.openldap.org/

# OpenLDAP Public License (BSD-style, must contain copy of LICENSE)
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

MASTER_SITES=	ftp://ftp.OpenLDAP.org/pub/OpenLDAP/openldap-release/ \
		ftp://ftp.net.lut.ac.uk/openldap/openldap-release/ \
		ftp://sunsite.cnlab-switch.ch/mirror/OpenLDAP/openldap-release/ \
		ftp://mirror.aarnet.edu.au/pub/OpenLDAP/openldap-release/ \
		ftp://gd.tuwien.ac.at/infosys/network/OpenLDAP/openldap-release/ \
		http://www.unibase.cz/ldapcz/Programy/Free/OpenLDAP/openldap-release/ \
		ftp://ftp.ntua.gr/mirror/OpenLDAP/openldap-release/ \
		ftp://ftp.shellhung.org/pub/OpenLDAP/openldap-release/

EXTRACT_SUFX=		.tgz

CONFIGURE_STYLE=	autoconf

__MAKEFLAGS_HACKERY=	no
.include <mirports.sys.mk>
.if ${__SYSTEM_PORTS:L} == "yes"
LOCALSTATEDIR=		/var
.else
LOCALSTATEDIR=		${LOCALBASE}/db
.endif
SUBST_VARS+=		LOCALSTATEDIR

CONFIGURE_ARGS+=	\
			--localstatedir=${LOCALSTATEDIR:Q} \
			--sysconfdir=${SYSCONFDIR:Q} \
			--enable-proctitle \
			--with-threads \
			--enable-debug \
			--enable-ipv6 \
			--enable-syslog \
			--with-tls \
			--enable-slapd \
			--enable-cleartext \
			--enable-crypt \
			--enable-phonetic \
			--enable-rewrite \
			--disable-wrappers \
			--disable-sql \
			--enable-dnssrv \
			--enable-ldap \
			--enable-ldbm \
			--enable-meta \
			--enable-monitor \
			--enable-null \
			--enable-passwd \
			--disable-perl \
			--enable-shell \
			--enable-slurpd \
			${CONFIGURE_SHARED}

FLAVOURS=		sasl
FLAVOUR?=

REGRESS_TARGET=		test

MULTI_PACKAGES=		-server
SUBPACKAGE?=

.if ${FLAVOUR:L:Msasl}
CONFIGURE_ARGS+=	--with-cyrus-sasl \
			--enable-spasswd
LIB_DEPENDS+=		sasl2::security/cyrus-sasl2
CPPFLAGS+=		-I${LOCALBASE:Q}/include/sasl
.else
CONFIGURE_ARGS+=	--without-cyrus-sasl \
			--disable-spasswd
.endif

.if ${FLAVOUR:L:Mbdb}
CONFIGURE_ARGS+=	--enable-bdb
BUILD_DEPENDS+=   	:db-4.*:databases/db
CPPFLAGS+=		-I${LOCALBASE:Q}/include/db4
LDFLAGS+=		-L${LOCALBASE:Q}/lib/db4
LIBS+=			-ldb
.else
CONFIGURE_ARGS+=	--disable-bdb
.endif

CONFIGURE_ENV+=		LIBS=${LIBS:Q}

.if ${SUBPACKAGE} == "-server"
RUN_DEPENDS+=		openldap:openldap-client-${VERSION}:databases/openldap
.endif

post-configure:
	@@cd ${WRKBUILD} && ${MAKE_PROGRAM} depend

post-install:
	mv ${DESTDIR}${SYSCONFDIR}/openldap ${PREFIX}/share/examples/
	chown -R ${SHAREOWN}:${SHAREGRP} ${PREFIX}/share/examples/openldap
	${INSTALL_DATA} ${WRKSRC}/LICENSE ${PREFIX}/share/openldap/
	@@rmdir ${DESTDIR}${LOCALSTATEDIR}/{openldap-{data,slurp},run}

.include <bsd.port.mk>
@


1.12
log
@add a way to disable adding stuff to .MAKEFLAGS
for badly behaved sub-makes
@
text
@d1 1
a1 1
# $MirOS: ports/databases/openldap/Makefile,v 1.11 2009/05/20 19:39:11 tg Exp $
d7 1
a7 1
DASH_VER=		4
@


1.11
log
@first step at modernising; actually /var (or the localbased equivalent)
is a much better choice at localstatedir (and probably the default), and
we've been advocating sudo for a decade or so now

XXX this port is a mess and the source code broken; after an update,
XXX a throughout warning cleanup must be done
@
text
@d1 1
a1 1
# $MirOS: ports/databases/openldap/Makefile,v 1.10 2009/05/20 14:45:24 tg Exp $
d34 1
@


1.10
log
@â€¢ use a more sane (not tabcompletion-wrecking) LOCALSTATEDIR
â€¢ fix 1024-byte-per-line segfault issue (now it segfaults >2000 bytesâ€¦)
@
text
@d1 1
a1 1
# $MirOS: ports/databases/openldap/Makefile,v 1.9 2009/01/17 11:43:33 tg Exp $
d7 1
a7 1
DASH_VER=		3
d36 1
a36 1
LOCALSTATEDIR=		/var/openldap
d38 1
a38 1
LOCALSTATEDIR=		${LOCALBASE}/db/openldap
d111 1
a111 1
	@@rm -rf ${DESTDIR}${LOCALSTATEDIR}
@


1.9
log
@gah, this is so antiquated
â€¢ Makefile: re-indent, quote, bring up to current standards
â€¢ distinfo: regen while here
â€¢ INSTALL-server: replace with a MESSAGE-server
â€¢ MESSAGE-server:
  â€£ /usr/local â†’ ${PREFIX}
  â€£ use a rc.conf.local â€œslapd=YESâ€ scheme to activate
  â€£ â€œchown user.groupâ€ has not worked for the last four years or so
â€¢ make mental note that this needs an update

problems noticed during setting up a sendmail with LDAP interconnection
at work yesterday (it does operate finely now, as Univention UCS slurpd
slave, though)
@
text
@d1 1
a1 1
# $MirOS: ports/databases/openldap/Makefile,v 1.8 2008/03/09 17:22:28 tg Exp $
d7 1
a7 1
DASH_VER=		2
d36 1
a36 1
LOCALSTATEDIR=		/var/ldap
d38 1
a38 1
LOCALSTATEDIR=		${LOCALBASE}/db/ldap
@


1.8
log
@bulk convert FLAVOR to FLAVOUR; nuke unused file; convert to $Mdocdate
@
text
@d1 1
a1 1
# $MirOS: ports/databases/openldap/Makefile,v 1.7 2006/09/14 00:07:50 tg Exp $
d4 10
a13 11
COMMENT=			Open source LDAP software (client)
COMMENT-server=			Open source LDAP software (server)
VERSION=	2.2.26
PL=		1

DISTNAME=	openldap-${VERSION}
PKGNAME=	openldap-client-${VERSION}-${PL}
FULLPKGNAME=	${PKGNAME}
PKGNAME-server=	openldap-server-${VERSION}-${PL}
CATEGORIES=	databases net
HOMEPAGE=	http://www.openldap.org/
d43 2
a44 2
			--localstatedir=${LOCALSTATEDIR} \
			--sysconfdir=${SYSCONFDIR} \
d82 1
a82 1
CPPFLAGS+=		-I${LOCALBASE}/include/sasl
d91 2
a92 2
CPPFLAGS+=		-I${LOCALBASE}/include/db4
LDFLAGS+=		-L${LOCALBASE}/lib/db4
d98 1
a98 1
CONFIGURE_ENV+=		LIBS="${LIBS}"
d101 1
a101 1
RUN_DEPENDS=		openldap:openldap-client-${VERSION}:databases/openldap
@


1.7
log
@clean up COMMENT and HOMEPAGE; regenerate INDEX (2761, 169 marked as broken, probably many many more) ­ edited by script with manual postprocessing
@
text
@d1 1
a1 1
# $MirOS: ports/databases/openldap/Makefile,v 1.6 2006/02/09 09:35:43 tg Exp $
d71 2
a72 2
FLAVORS=		sasl
FLAVOR?=
d79 1
a79 1
.if ${FLAVOR:L:Msasl}
d89 1
a89 1
.if ${FLAVOR:L:Mbdb}
@


1.6
log
@remove SEPARATE_BUILD for once and for good, I'm fed up with
all the trouble it can cause - ports which need it (e.g. the
GCC SC doesnt "support" building gcc with srcdir=objdir) can
set stuff like WRKBUILD themselves.
@
text
@d1 1
a1 1
# $MirOS: ports/databases/openldap/Makefile,v 1.5 2005/10/13 23:25:33 tg Exp $
d4 2
a5 2
COMMENT=	"Open source LDAP software (client)"
COMMENT-server=	"Open source LDAP software (server)"
@


1.5
log
@libtoolise PLIST, substitute LOCALSTATEDIR
@
text
@d1 1
a1 1
# $MirOS: ports/databases/openldap/Makefile,v 1.4 2005/10/13 23:01:52 tg Exp $
a32 1
SEPARATE_BUILD=		concurrent
@


1.4
log
@* bump patchlevel
* disable perl backend again, it makes problems
* make /var/ldap only the LOCALSTATEDIR if this instance of
  mirports is the "master", else use LOCALBASE/db/ldap/
* ; -> && while here
@
text
@d1 1
a1 1
# $MirOS: ports/databases/openldap/Makefile,v 1.3 2005/07/07 21:18:26 bsiegert Exp $
d42 1
@


1.3
log
@Semi-automatic update of the remaining ports to the new patchlevel format.

Please correct mistakes if you find them :).
@
text
@d1 1
a1 1
# $MirOS: ports/databases/openldap/Makefile,v 1.1.7.1 2005/03/18 15:44:10 tg Exp $
d7 1
d10 3
a12 2
FULLPKGNAME=	openldap-client-${VERSION}-0
PKGNAME-server=	openldap-server-${VERSION}-0
d36 7
d44 1
a44 1
			--localstatedir=/var/ldap \
d66 1
a66 1
			--enable-perl \
d106 1
a106 1
	@@cd ${WRKBUILD}; ${MAKE_PROGRAM} depend
d112 1
a112 1
	@@rm -rf ${DESTDIR}/var/ldap
@


1.2
log
@update to latest stable version
@
text
@d9 2
a10 2
FULLPKGNAME=	openldap-client-${VERSION}
PKGNAME-server=	openldap-server-${VERSION}
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $MirOS$
d6 1
a6 1
VERSION=	2.2.22
@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
