head	1.4;
access;
symbols;
locks; strict;
comment	@# @;


1.4
date	2011.03.08.19.08.13;	author tg;	state Exp;
branches;
next	1.3;
commitid	1004D767EB44F3A68F8;

1.3
date	2009.09.06.16.42.12;	author tg;	state Exp;
branches;
next	1.2;
commitid	1004AA3E67269C76863;

1.2
date	2009.09.06.16.31.09;	author tg;	state Exp;
branches;
next	1.1;
commitid	1004AA3E385782410B4;

1.1
date	2005.03.18.15.51.57;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.03.18.15.51.57;	author tg;	state Exp;
branches;
next	;


desc
@@


1.4
log
@update, but keep multibyte disabled after analysis
@
text
@# $MirOS: ports/shells/zsh/Makefile,v 1.3 2009/09/06 16:42:12 tg Exp $
# $OpenBSD: Makefile,v 1.50 2009/06/03 14:35:48 pea Exp $

COMMENT=		Z shell, Bourne shell-compatible
VSN=			4.3.11
DISTNAME=		zsh-${VSN}
CATEGORIES=		shells
HOMEPAGE=		http://www.zsh.org/

# BSD
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

# from Debian
_PATCHFILES=		${.CURDIR}/0003-regex-match-crash-fix.diff
PATCHFILES=
PATCH_DIST_STRIP=	-p1

MASTER_SITES=		${MASTER_SITE_SOURCEFORGE:=zsh/}

MODULES+=		converters/libiconv
MODULES+=		devel/libncursesw
LIB_DEPENDS+=		pcre::devel/pcre

CONFIGURE_STYLE=	autoconf
AUTOCONF_NEW=		Yes
MODGNU_TYPESCAN=	brk sbrk mknod ioctl
CONFIGURE_ARGS+=	${CONFIGURE_SHARED:S/shared/dynamic/} \
			--enable-zsh-mem \
			--enable-zsh-secure-free \
			--enable-etcdir=${SYSCONFDIR:Q} \
			--enable-maildir-support \
			--with-tcsetpgrp \
			--disable-multibyte \
			--enable-pcre \
			--disable-gdbm
INSTALL_TARGET=		install install.info

# required for regression tests
PORTHOME=		${WRKDIR}
REGRESS_FLAGS=		INSTALL_PROGRAM="install -c -s -m 755" \
			INSTALL_DATA="install -c -m 644" \
			INSTALL="install -c" \
			TMPPREFIX=${WRKBUILD:Q}/tmp \
			TERM=xterm

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/zsh/${VSN}/scripts \
	    ${PREFIX}/share/examples/zsh
	${INSTALL_DATA} ${.CURDIR}/zprofile ${PREFIX}/share/examples/zsh/

.include <bsd.port.mk>
@


1.3
log
@disable security hol^W^Wmultibyte support ⇒ unbreak
37 successful test scripts, 0 failures, 1 skipped
@
text
@d1 1
a1 1
# $MirOS: ports/shells/zsh/Makefile,v 1.2 2009/09/06 16:31:09 tg Exp $
d5 1
a5 2
VSN=			4.3.10
DASH_VER=		1
d16 6
a21 8
MASTER_SITES=		${HOMEPAGE}pub/ \
			http://mirrors.dotsrc.org/zsh/ \
			http://www.math.technion.ac.il/pub/zsh/ \
			ftp://ftp.zsh.org/zsh/ \
			ftp://ftp.fu-berlin.de/pub/unix/shells/zsh/ \
			ftp://ftp.demon.nl/pub/mirrors/zsh/ \
			ftp://sunsite.icm.edu.pl/pub/unix/shells/zsh/ \
			http://zsh.raveland.org/
d39 1
d43 2
a44 2
REGRESS_FLAGS=		INSTALL_PROGRAM="install -c -s -m 555" \
			INSTALL_DATA="install -c -m 444" \
@


1.2
log
@commit an updated zsh, mostly taken from OpenBSD, with a few MirBSD
modifications – just so that it compiles, runs, and almost passes the
testsuite (MidnightBSD and Interix will need more patches; Darwin should
work as-is).

MirBSD testsuite results:
37 successful test scripts, 1 failure, 0 skipped

The reason for this file is documented at the bottom of ./SECURITY
because it led to discovering (at least) one buffer overflow hole
in the multibyte code (and to me not wanting to poke in this code
any longer).
@
text
@d1 1
a1 1
# $MirOS$
a3 2
BROKEN=			see ${.CURDIR}/SECURITY for why

d6 1
d39 1
a39 1
			--enable-multibyte \
@


1.1
log
@Initial revision
@
text
@d2 1
d4 54
a57 1
.include <bsd.port.subdir.mk>
@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
