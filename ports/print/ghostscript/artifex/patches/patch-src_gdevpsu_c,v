head	1.1;
access;
symbols;
locks; strict;
comment	@# @;


1.1
date	2007.03.15.23.18.33;	author tg;	state Exp;
branches;
next	;
commitid	10045F9D4145DCD12DB;


desc
@@


1.1
log
@fix a few time_t bugs

XXX ugly #1:
big-endian time_t64 ILP32 boxen are wrong in zdevcal.c
(but sparc is time_t32, luckily)
(and thank the creator we don't have pdp endian arches)

XXX ugly #2:
|    char buf1[4+1+2+1+2+1]; /* yyyy-mm-dd\0 */
|    sprintf(buf1,
|            "%04ld-%02d-%02d",
|            (long)(tms.tm_year + 1900), tms.tm_mon + 1, tms.tm_mday);
@
text
@$MirOS$
--- src/gdevpsu.c.orig	Mon Mar 13 16:17:56 2006
+++ src/gdevpsu.c	Thu Mar 15 23:09:53 2007
@@@@ -186,8 +186,8 @@@@ psw_begin_file_header(FILE *f, const gx_
 
 	time(&t);
 	tms = *localtime(&t);
-	fprintf(f, "%%%%CreationDate: %d/%02d/%02d %02d:%02d:%02d\n",
-		tms.tm_year + 1900, tms.tm_mon + 1, tms.tm_mday,
+	fprintf(f, "%%%%CreationDate: %ld/%02d/%02d %02d:%02d:%02d\n",
+		(long)(tms.tm_year + 1900), tms.tm_mon + 1, tms.tm_mday,
 		tms.tm_hour, tms.tm_min, tms.tm_sec);
     }
     if (ascii)
@
