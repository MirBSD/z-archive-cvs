head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2005.12.16.01.07.13;	author bsiegert;	state dead;
branches;
next	1.1;
commitid	10043A2129A671E20EC;

1.1
date	2005.03.18.15.51.00;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.03.18.15.51.00;	author tg;	state Exp;
branches;
next	;


desc
@@


1.2
log
@This was broken on MirOS-current as it uses unsupported behavior: it
compiles libcupsimage agains libjpg and libpng and then "forgets" to link
them into the executables. This triggers a linker bug in my snapshot and
causes a segfault in ld.

There is some unsupported libtool stuff in the cups Makefiles. Bring it up
to shape and unconditionally use it (MirLibtool) for the build. Works for
me.

Also remove INSTALL/DEINSTALL and replace it by @@sample. Bump patchlevel.
@
text
@#!/bin/sh
# $MirOS: ports/print/cups/pkg/INSTALL,v 1.1 2005/03/18 15:51:00 tg Exp $
#
# Pre/post-installation setup of CUPS

PATH=/bin:/usr/bin:/sbin:/usr/sbin
PREFIX=${PKG_PREFIX:-/usr/local}


do_notice_etc_install()
{
    echo
    echo "+---------------"
    echo "| You appear to already have CUPS configuration files in"
    echo "| ${SYSCONFDIR}/cups."
    echo "|"
    echo "| The configuration files have been preserved. If you want to"
    echo "| start from the default setup, you should perform these steps"
    echo "| as root:"
    echo "|"
    echo "|       rm -rf ${SYSCONFDIR}/cups"
    echo "|       cp -Rp ${PREFIX}/share/examples/cups ${SYSCONFDIR}"
}

do_notice_var_install()
{
    echo "|"
    echo "| You appear to already have CUPS spool directories in"
    echo "| /var/spool/cups."
    echo "|"
    echo "| The spool directories have been preserved. If you want to"
    echo "| start from the default setup, you should perform these steps"
    echo "| as root:"
    echo "|"
    echo "|       rm -rf /var/spool/cups"
    echo "|       install -d -m 0700 -o _cups -g _cups /var/spool/cups"
    echo "|       install -d -m 1700 -o _cups -g _cups /var/spool/cups/tmp"
    echo "+---------------"
    echo
}

do_etc_install()
{
    cp -Rp ${PREFIX}/share/examples/cups ${SYSCONFDIR}
    echo
    echo "+---------------"
    echo "| CUPS configuration files have been installed in"
    echo "| ${SYSCONFDIR}/cups."
}

do_var_install()
{ 
    install -d -o _cups -g _cups -m 0700 /var/spool/cups
    install -d -o _cups -g _cups -m 1700 /var/spool/cups/tmp
    echo "|"
    echo "| CUPS spool directories have been installed in"
    echo "| /var/spool/cups."
    echo "+---------------"
    echo
}

# verify proper execution
#
if [ $# -ne 2 ]; then
    echo "usage: $0 distname { PRE-INSTALL | POST-INSTALL }" >&2
    exit 1
fi

# Verify/process the command
#
case $2 in
    PRE-INSTALL)
        ;;
    POST-INSTALL)
        if [ -d ${SYSCONFDIR}/cups ]; then
            do_notice_etc_install
        else
            do_etc_install
        fi

        if [ -d /var/spool/cups ]; then
            do_notice_var_install
        else
            do_var_install
        fi
        mkdir -p /var/log/cups
        ;;
    *)
        echo "usage: $0 distname { PRE-INSTALL | POST-INSTALL }" >&2
        exit 1
        ;;
esac

exit 0
@


1.1
log
@Initial revision
@
text
@d2 1
a2 1
# $MirOS$
@


1.1.7.1
log
@Import the MirPorts Framework, many files moved or renamed though, no KDE/QT
@
text
@@
