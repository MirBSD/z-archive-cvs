head	1.7;
access;
symbols;
locks; strict;
comment	@# @;


1.7
date	2013.07.28.18.01.46;	author tg;	state Exp;
branches;
next	1.6;
commitid	10051F55CA26ED73BD2;

1.6
date	2013.01.02.22.26.09;	author tg;	state Exp;
branches;
next	1.5;
commitid	10050E4B4151D531E24;

1.5
date	2008.08.26.19.21.10;	author tg;	state Exp;
branches;
next	1.4;
commitid	10048B457B51A0E2BCA;

1.4
date	2008.04.01.15.47.02;	author tg;	state Exp;
branches;
next	1.3;
commitid	10047F259090D420D79;

1.3
date	2007.03.11.20.41.15;	author tg;	state Exp;
branches;
next	1.2;
commitid	10045F469817828FE77;

1.2
date	2006.09.11.01.02.03;	author tg;	state Exp;
branches;
next	1.1;
commitid	1004504B56803FF6E46;

1.1
date	2006.09.09.14.33.28;	author tg;	state Exp;
branches;
next	;
commitid	1004502D0C13B4F4233;


desc
@@


1.7
log
@SECURITY update to new upstream version: contains mitigation code
for side-channel attacks (only relevant for running MirBSD inside
a Virtual Machine on a system that has access to either other VMs
or Dom0 for (other) users, AIUI)
@
text
@$MirOS: ports/security/gnupg/patches/patch-configure_ac,v 1.6 2013/01/02 22:26:09 tg Exp $
--- configure.ac.orig	Thu Jul 25 08:37:16 2013
+++ configure.ac	Sun Jul 28 17:53:00 2013
@@@@ -33,12 +33,11 @@@@ m4_define([mym4_version], [1.4.14])
 # flag indicating a development version (mym4_isgit).  Note that the
 # m4 processing is done by autoconf and not during the configure run.
 m4_define([mym4_revision],
-          m4_esyscmd([git rev-parse --short HEAD | tr -d '\n\r']))
+[])
 m4_define([mym4_revision_dec],
-          m4_esyscmd_s([echo $((0x$(echo ]mym4_revision[|head -c 4)))]))
+[])
 m4_define([mym4_betastring],
-          m4_esyscmd_s([git describe --match 'gnupg-1.[0-9].*[0-9]' --long|\
-                        awk -F- '$3!=0{print"-beta"$3}']))
+[])
 m4_define([mym4_isgit],m4_if(mym4_betastring,[],[no],[yes]))
 m4_define([mym4_full_version],[mym4_version[]mym4_betastring])
 
@@@@ -844,9 +843,9 @@@@ AC_DEFINE_UNQUOTED(PRINTABLE_OS_NAME, "$
 NAME_OF_DEV_RANDOM="/dev/random"
 NAME_OF_DEV_URANDOM="/dev/urandom"
 case "${host}" in
-    *-openbsd*)
+    *-mirbsd* | *-openbsd*)
         NAME_OF_DEV_RANDOM="/dev/srandom"
-        NAME_OF_DEV_URANDOM="/dev/urandom"
+        NAME_OF_DEV_URANDOM="/dev/arandom"
         ;;
 esac
 AC_DEFINE_UNQUOTED(NAME_OF_DEV_RANDOM, "$NAME_OF_DEV_RANDOM",
@@@@ -856,6 +855,9 @@@@ AC_DEFINE_UNQUOTED(NAME_OF_DEV_URANDOM, 
 AC_SUBST(MPI_OPT_FLAGS)
 
 
+dnl Normally implied by GNU gettext, but we exclude that.
+AC_CHECK_HEADERS([sys/param.h])
+
 dnl Checks for libraries.
 
 
@@@@ -863,14 +865,14 @@@@ dnl Checks for libraries.
 #                       needs to find this string.  Without
 #                       it "make distcheck" may fail.
 AM_PO_SUBDIRS
-AM_GNU_GETTEXT_VERSION([0.18.1])
-if test "$try_gettext" = yes; then
-  AM_GNU_GETTEXT(,[need-ngettext])
-  # gettext requires some extra checks.  These really should be part of
-  # the basic AM_GNU_GETTEXT macro.  TODO: move other gettext-specific
-  # function checks to here.
-  AC_CHECK_FUNCS(strchr)
-else
+dnl AM_GNU_GETTEXT_VERSION([0.18.1])
+dnl if test "$try_gettext" = yes; then
+dnl   AM_GNU_GETTEXT(,[need-ngettext])
+dnl   # gettext requires some extra checks.  These really should be part of
+dnl   # the basic AM_GNU_GETTEXT macro.  TODO: move other gettext-specific
+dnl   # function checks to here.
+dnl   AC_CHECK_FUNCS(strchr)
+dnl else
   enable_nls=no
   USE_NLS=no
   USE_INCLUDED_LIBINTL=no
@@@@ -880,7 +882,7 @@@@ else
   AC_SUBST(USE_INCLUDED_LIBINTL)
   AC_SUBST(BUILD_INCLUDED_LIBINTL)
   AC_SUBST(POSUB)
-fi
+dnl fi
 
 
 if test "$try_extensions" = yes || test x"$card_support" = xyes ; then
@@@@ -1017,6 +1019,16 @@@@ if test x"$use_sha512" = xyes ; then
 fi
 
 AM_CONDITIONAL(USE_SHA512, test x"$use_sha512" = xyes)
+
+AC_CHECK_HEADERS([sys/sysctl.h], [], [], [#if HAVE_SYS_PARAM_H
+#include <sys/param.h>
+#endif])
+AC_CHECK_HEADERS([uvm/uvm_swap_encrypt.h], [], [], [#if HAVE_SYS_PARAM_H
+#include <sys/param.h>
+#endif
+#ifdef HAVE_SYS_SYSCTL_H
+#include <sys/sysctl.h>
+#endif])
 
 dnl Checks for library functions.
 AC_CHECK_DECLS(getpagesize)
@


1.6
log
@update GnuPG to fix CVE-2012-6085

also, IDEA is no longer patented, we can include it
@
text
@d1 18
a18 13
$MirOS: ports/security/gnupg/patches/patch-configure_ac,v 1.5 2008/08/26 19:21:10 tg Exp $
--- configure.ac.orig	Thu Dec 20 18:04:02 2012
+++ configure.ac	Wed Jan  2 21:56:10 2013
@@@@ -28,10 +28,6 @@@@ min_automake_version="1.9.3"
 m4_define([my_version], [1.4.13])
 m4_define([my_issvn], [no])
 
-m4_define([svn_revision], m4_esyscmd([printf "%d" $(svn info 2>/dev/null \
-          | sed -n '/^Revision:/ s/[^0-9]//gp'|head -1)]))
-m4_define([git_revision], m4_esyscmd([git branch -v 2>/dev/null \
-          | awk '/^\* / {printf "%s",$3}']))
 m4_define([my_full_version], [my_version[]m4_if(my_issvn,[yes],
           [m4_if(git_revision,[],[-svn[]svn_revision],[-git[]git_revision])])])
d20 1
a20 1
@@@@ -837,9 +833,9 @@@@ AC_DEFINE_UNQUOTED(PRINTABLE_OS_NAME, "$
d32 1
a32 1
@@@@ -849,6 +845,9 @@@@ AC_DEFINE_UNQUOTED(NAME_OF_DEV_URANDOM, 
d42 1
a42 1
@@@@ -856,14 +855,14 @@@@ dnl Checks for libraries.
d65 1
a65 1
@@@@ -873,7 +872,7 @@@@ else
d74 1
a74 1
@@@@ -1010,6 +1009,16 @@@@ if test x"$use_sha512" = xyes ; then
@


1.5
log
@don't run svn here either
@
text
@d1 5
a5 5
$MirOS: ports/security/gnupg/patches/patch-configure_ac,v 1.4 2008/04/01 15:47:02 tg Exp $
--- configure.ac.orig	Wed Mar 26 17:26:26 2008
+++ configure.ac	Tue Aug 26 19:20:43 2008
@@@@ -28,9 +28,6 @@@@ min_automake_version="1.9.3"
 m4_define([my_version], [1.4.9])
d8 8
a15 8
-m4_define([svn_revision], m4_esyscmd([echo $((svn info 2>/dev/null \
-          || echo 'Revision: 0')|sed -n '/^Revision:/ s/[^0-9]//gp'|head -1)| \
-          tr -d '\n']))
 AC_INIT([gnupg], my_version[]m4_if(my_issvn,[yes],[-svn[]svn_revision]),
         [bug-gnupg@@gnu.org])
 # Set development_version to yes if the minor number is odd or you
@@@@ -826,12 +823,12 @@@@ AC_DEFINE_UNQUOTED(PRINTABLE_OS_NAME, "$
 #
d18 1
a18 1
-case "${host}" in
d20 1
a20 1
+if test -e /dev/srandom; then
d23 3
a25 6
-        ;;
-esac
+fi
+if test -e /dev/arandom; then
+	NAME_OF_DEV_URANDOM="/dev/arandom"
+fi
d27 43
a69 3
                    [defined to the name of the strong random device])
 AC_DEFINE_UNQUOTED(NAME_OF_DEV_URANDOM, "$NAME_OF_DEV_URANDOM",
@@@@ -979,6 +976,16 @@@@ if test x"$use_sha512" = xyes ; then
@


1.4
log
@SECURITY update to 1.4.9:
• cf. http://www.heise.de/newsticker/GnuPG-1-4-9-und-2-0-9-beheben-Schwachstelle--/meldung/105821
• passes regression test
• no longer use libusb on mirbsd/sparc
• unify arch handling (move openbsd/m68k test into mpi config patch)
• add midnightbsd/i386 support (they require a pentium at least, according
  to nightlily, so they get the 586 asm code instead of our 386er)
• add midnightbsd/sparc64 support (same as other bsds: disable asm)
• quell macro redefinition warning in mpi code (MIN, MAX)

XXX maybe disable asm on mirbsd/sparc?
@
text
@d1 1
a1 1
$MirOS: ports/security/gnupg/patches/patch-configure_ac,v 1.3 2007/03/11 20:41:15 tg Exp $
d3 12
a14 2
+++ configure.ac	Tue Apr  1 15:22:25 2008
@@@@ -826,12 +826,12 @@@@ AC_DEFINE_UNQUOTED(PRINTABLE_OS_NAME, "$
d32 1
a32 1
@@@@ -979,6 +979,16 @@@@ if test x"$use_sha512" = xyes ; then
@


1.3
log
@update to 1.4.7, add mailto: keyserver protocol, more docs
@
text
@d1 4
a4 4
$MirOS: ports/security/gnupg/patches/patch-configure_ac,v 1.2 2006/09/11 01:02:03 tg Exp $
--- configure.ac.orig	Mon Mar  5 09:09:20 2007
+++ configure.ac	Sun Mar 11 20:13:05 2007
@@@@ -796,12 +796,12 @@@@ AC_DEFINE_UNQUOTED(PRINTABLE_OS_NAME, "$
d22 1
a22 1
@@@@ -947,6 +947,16 @@@@ if test x"$use_sha512" = xyes ; then
@


1.2
log
@* fix time_t format string issues
* if vm.swapencrypt=1 don't issue secmem warning
  (why didn't the openbsd guys add a simple patch like this?)
* sync MESSAGE with reality
* fix regression test suite (1 fail in verify, but the test
  actually doesn't fail, no idea what's going wrong there,
  maybe a hidden bash dependency?)
* bump patchlevel
@
text
@d1 4
a4 4
$MirOS: ports/security/gnupg/patches/patch-configure_ac,v 1.1 2006/09/09 14:33:28 tg Exp $
--- configure.ac.orig	Tue Aug  1 10:40:32 2006
+++ configure.ac	Mon Sep 11 00:41:33 2006
@@@@ -734,12 +734,12 @@@@ AC_DEFINE_UNQUOTED(PRINTABLE_OS_NAME, "$
d22 1
a22 1
@@@@ -885,6 +885,16 @@@@ if test x"$use_sha512" = xyes ; then
@


1.1
log
@fix random device
@
text
@d1 3
a3 3
$MirOS$
--- configure.ac.orig	Sat Sep  9 14:19:08 2006
+++ configure.ac	Sat Sep  9 14:23:57 2006
d22 17
@

