head	1.2;
access;
symbols
	MIRBSD_10:1.1.0.2
	MIRBSD_10_BASE:1.1;
locks; strict;
comment	@ * @;


1.2
date	2013.10.31.20.06.10;	author tg;	state Exp;
branches;
next	1.1;
commitid	1005272B7081B0E5655;

1.1
date	2007.05.07.14.06.07;	author tg;	state Exp;
branches;
next	;
commitid	100463F322D3CC3A59A;


desc
@@


1.2
log
@adapt most __attribute__((…)) occurrences to new KNF style(9)
@
text
@/* $MirOS: src/include/whirlpool.h,v 1.1 2007/05/07 14:06:07 tg Exp $ */

#ifndef _WHIRLPOOL_H
#define _WHIRLPOOL_H

#define WHIRLPOOL_BLOCK_LENGTH		64
#define WHIRLPOOL_DIGEST_LENGTH		64
#define WHIRLPOOL_DIGEST_STRING_LENGTH	(WHIRLPOOL_DIGEST_LENGTH * 2 + 1)

typedef struct {
	uint8_t bitLength[32];	/* number of hashed bits (256-bit counter) */
	uint8_t buffer[WHIRLPOOL_BLOCK_LENGTH];	/* buffer of data to hash */
	int bufferBits;		/* current number of bits on the buffer */
	int bufferPos;		/* current (possibly incomplete) byte slot */
	uint64_t hash[WHIRLPOOL_DIGEST_LENGTH / 8];	/* the hashing state */
} WHIRLPOOL_CTX;

#include <sys/cdefs.h>

__BEGIN_DECLS
void WHIRLPOOLInit(WHIRLPOOL_CTX *);
void WHIRLPOOLPad(WHIRLPOOL_CTX *);
void WHIRLPOOLUpdate(WHIRLPOOL_CTX *, const uint8_t *, size_t)
	__attribute__((__bounded__(__string__, 2, 3)));
void WHIRLPOOLFinal(uint8_t *, WHIRLPOOL_CTX *)
	__attribute__((__bounded__(__minbytes__, 1, WHIRLPOOL_DIGEST_LENGTH)));
char *WHIRLPOOLEnd(WHIRLPOOL_CTX *, char *)
	__attribute__((__bounded__(__minbytes__, 2, WHIRLPOOL_DIGEST_STRING_LENGTH)));
char *WHIRLPOOLFile(const char *, char *)
	__attribute__((__bounded__(__minbytes__, 2, WHIRLPOOL_DIGEST_STRING_LENGTH)));
char *WHIRLPOOLFileChunk(const char *, char *, off_t, off_t)
	__attribute__((__bounded__(__minbytes__, 2, WHIRLPOOL_DIGEST_STRING_LENGTH)));
char *WHIRLPOOLData(const uint8_t *, size_t, char *)
	__attribute__((__bounded__(__string__, 1, 2)))
	__attribute__((__bounded__(__minbytes__, 3, WHIRLPOOL_DIGEST_STRING_LENGTH)));
__END_DECLS

#endif
@


1.1
log
@introduce the whirlpool hash function (finally!)
code taken from TNF pkgsrc® pkgtools/digest tool
actual source is the public domain reference implementation

XXX test this on big-endian platforms
XXX adjust mirmake

this libc addition rides on yesterday's minor bump
@
text
@d1 1
a1 1
/* $MirOS: src/include/tiger.h,v 1.1 2006/09/17 19:28:58 tg Exp $ */
d24 1
a24 1
	__attribute__((bounded (string, 2, 3)));
d26 1
a26 1
	__attribute__((bounded (minbytes, 1, WHIRLPOOL_DIGEST_LENGTH)));
d28 1
a28 1
	__attribute__((bounded (minbytes, 2, WHIRLPOOL_DIGEST_STRING_LENGTH)));
d30 1
a30 1
	__attribute__((bounded (minbytes, 2, WHIRLPOOL_DIGEST_STRING_LENGTH)));
d32 1
a32 1
	__attribute__((bounded (minbytes, 2, WHIRLPOOL_DIGEST_STRING_LENGTH)));
d34 2
a35 2
	__attribute__((bounded (string, 1, 2)))
	__attribute__((bounded (minbytes, 3, WHIRLPOOL_DIGEST_STRING_LENGTH)));
@

