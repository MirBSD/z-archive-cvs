head	1.2;
access;
symbols
	MIRBSD_10:1.1.0.2
	MIRBSD_10_BASE:1.1;
locks; strict;
comment	@ * @;


1.2
date	2013.10.31.20.06.09;	author tg;	state Exp;
branches;
next	1.1;
commitid	1005272B7081B0E5655;

1.1
date	2006.09.17.19.28.58;	author tg;	state Exp;
branches;
next	;
commitid	100450DA20303EFF79D;


desc
@@


1.2
log
@adapt most __attribute__((â€¦)) occurrences to new KNF style(9)
@
text
@/* $MirOS: src/include/tiger.h,v 1.1 2006/09/17 19:28:58 tg Exp $ */

#ifndef _TIGER_H
#define _TIGER_H

#define TIGER_BLOCK_LENGTH		64
#define TIGER_DIGEST_LENGTH		24
#define TIGER_DIGEST_STRING_LENGTH	(TIGER_DIGEST_LENGTH * 2 + 1)

typedef struct {
	uint64_t digest[3];
	uint64_t count;
	uint8_t buffer[TIGER_BLOCK_LENGTH];
} TIGER_CTX;

#include <sys/cdefs.h>

__BEGIN_DECLS
void TIGERInit(TIGER_CTX *);
void TIGERPad(TIGER_CTX *);
void TIGERTransform(uint64_t *, const uint8_t *)
	__attribute__((__bounded__(__minbytes__, 1, 24)))
	__attribute__((__bounded__(__minbytes__, 2, TIGER_BLOCK_LENGTH)));
void TIGERUpdate(TIGER_CTX *, const uint8_t *, size_t)
	__attribute__((__bounded__(__string__, 2, 3)));
void TIGERFinal(uint8_t *, TIGER_CTX *)
	__attribute__((__bounded__(__minbytes__, 1, TIGER_DIGEST_LENGTH)));
char *TIGEREnd(TIGER_CTX *, char *)
	__attribute__((__bounded__(__minbytes__, 2, TIGER_DIGEST_STRING_LENGTH)));
char *TIGERFile(const char *, char *)
	__attribute__((__bounded__(__minbytes__, 2, TIGER_DIGEST_STRING_LENGTH)));
char *TIGERFileChunk(const char *, char *, off_t, off_t)
	__attribute__((__bounded__(__minbytes__, 2, TIGER_DIGEST_STRING_LENGTH)));
char *TIGERData(const uint8_t *, size_t, char *)
	__attribute__((__bounded__(__string__, 1, 2)))
	__attribute__((__bounded__(__minbytes__, 3, TIGER_DIGEST_STRING_LENGTH)));
__END_DECLS

#endif
@


1.1
log
@add the SFV (from cksfv) and TIGER hashes
@
text
@d1 1
a1 1
/* $MirOS$ */
d22 2
a23 2
	__attribute__((bounded (minbytes, 1, 24)))
	__attribute__((bounded (minbytes, 2, TIGER_BLOCK_LENGTH)));
d25 1
a25 1
	__attribute__((bounded (string, 2, 3)));
d27 1
a27 1
	__attribute__((bounded (minbytes, 1, TIGER_DIGEST_LENGTH)));
d29 1
a29 1
	__attribute__((bounded (minbytes, 2, TIGER_DIGEST_STRING_LENGTH)));
d31 1
a31 1
	__attribute__((bounded (minbytes, 2, TIGER_DIGEST_STRING_LENGTH)));
d33 1
a33 1
	__attribute__((bounded (minbytes, 2, TIGER_DIGEST_STRING_LENGTH)));
d35 2
a36 2
	__attribute__((bounded (string, 1, 2)))
	__attribute__((bounded (minbytes, 3, TIGER_DIGEST_STRING_LENGTH)));
@

