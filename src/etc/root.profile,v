head	1.14;
access;
symbols
	MIRBSD_10:1.6.0.2
	MIRBSD_10_BASE:1.6;
locks; strict;
comment	@# @;


1.14
date	2016.03.25.19.49.15;	author tg;	state Exp;
branches;
next	1.13;
commitid	10056F596401CDD6854;

1.13
date	2009.07.18.14.09.07;	author tg;	state Exp;
branches;
next	1.12;
commitid	1004A61D73A7953CBB8;

1.12
date	2008.12.28.06.58.08;	author tg;	state Exp;
branches;
next	1.11;
commitid	100495723822BDEA4C3;

1.11
date	2008.05.25.22.10.19;	author tg;	state Exp;
branches;
next	1.10;
commitid	1004839E3D035A9D5E9;

1.10
date	2008.05.25.21.59.00;	author tg;	state Exp;
branches;
next	1.9;
commitid	1004839E12369535CEE;

1.9
date	2008.05.15.14.29.35;	author tg;	state Exp;
branches;
next	1.8;
commitid	100482C48D4295EA6BE;

1.8
date	2008.05.07.12.16.12;	author tg;	state Exp;
branches;
next	1.7;
commitid	10048219D991FE06744;

1.7
date	2008.03.27.13.48.27;	author tg;	state Exp;
branches;
next	1.6;
commitid	10047EBA5A25F1AA7E1;

1.6
date	2007.08.01.13.07.37;	author tg;	state Exp;
branches;
next	1.5;
commitid	10046B085A163D9CD4C;

1.5
date	2007.06.15.23.43.46;	author tg;	state Exp;
branches;
next	1.4;
commitid	1004673243117F9CB1F;

1.4
date	2007.05.24.22.31.34;	author tg;	state Exp;
branches;
next	1.3;
commitid	1004656125771A38F2A;

1.3
date	2007.02.19.03.03.28;	author tg;	state Exp;
branches;
next	1.2;
commitid	10045D913776373EBF0;

1.2
date	2006.10.18.23.02.23;	author tg;	state Exp;
branches;
next	1.1;
commitid	1004536B28C0A359F9A;

1.1
date	2006.09.24.18.13.38;	author tg;	state Exp;
branches;
next	;
commitid	1004516CAD629499454;


desc
@@


1.14
log
@prepare most scripts for locale tracking; drop some TZ=UTC; use modern mksh
@
text
@# $MirSecuCron$

PATH=/sbin:/usr/sbin:/bin:/usr/bin
HOME=/
LC_ALL=C
PS1='# '
export PATH HOME LC_ALL PS1
umask 022

# this is only run if /etc/profile has not been executed
if test -z "$OSNAME"; then
	i=TERM=vt100
	if test -x /usr/bin/tset; then
		i=$(ulimit -c 0; /usr/bin/tset -sQ \?$TERM)
		TERM=vt100
	fi
	eval $i
	unset i HISTFILE
	EDITOR=/bin/ed
	USER=root
	USER_ID=0
	export EDITOR TERM USER
fi

Lretrocfg() {		# retrieve kernel config file
	typeset Tin
	typeset Tout
	Tin=
	Tout=
	if Tin=$(mktemp /tmp/Lretrocfg.iXXXXXXXXXX) && \
	    Tout=$(mktemp /tmp/Lretrocfg.oXXXXXXXXXX); then
		if $SUDO zcat -f ${1:-/bsd} >$Tin 2>/dev/null && \
		    objcopy -O binary --set-section-flags .config.gz=alloc \
		    -j .config.gz $Tin $Tout >/dev/null 2>&1; then
			zcat <$Tout
		else
			print -u2 Error: no .config.gz stored in "${1:-/bsd}"
		fi
	else
		print -u2 Error: cannot mktemp
	fi
	rm -f $Tin $Tout
}

print '
	**********************************
	Do not login as root, use sudo(8)!
	**********************************
'
: $MirOS: src/etc/root.profile,v 1.13 2009/07/18 14:09:07 tg Exp $
@


1.13
log
@prevent data corruption from /etc/security’s automated backup cronjob
by using “MirSecuCron” as RCS ID for these and preventing it from ex-
panding any of the default keywords

also, add RCS IDs to almost all configuration files and enhance the
default changelist file
@
text
@d5 1
a5 1
LC_CTYPE=en_US.UTF-8
d7 1
a7 1
export PATH HOME LC_CTYPE PS1
d50 1
a50 1
: $MirOS: src/etc/root.profile,v 1.12 2008/12/28 06:58:08 tg Exp $
@


1.12
log
@I guess this not only counts as cat abuse, but also
makes problems with tempfiles (for here documents)
in single user mode
@
text
@d1 2
d50 1
a50 1
: $MirOS: src/etc/root.profile,v 1.11 2008/05/25 22:10:19 tg Exp $
@


1.11
log
@give root a PS1, a LC_CTYPE, etc. and shorten out /etc/profile accordingly
@
text
@d43 1
a43 2
/bin/cat <<-'EOF'

d47 2
a48 3

EOF
: $MirOS$
@


1.10
log
@mention that people shan’t login as root, again
(this used to be in ~root/.cshrc IIRC, and even
BSD/OS had it)
@
text
@d1 6
a6 3
# $MirOS: src/etc/root.profile,v 1.9 2008/05/15 14:29:35 tg Exp $
#-
# initialisation for bourne shell (worst case)
a9 5
	PATH=/sbin:/usr/sbin:/bin:/usr/bin:/usr/dbin:/usr/dsbin
	HOME=/
	PS1='# '
	export PATH HOME PS1
	umask 022
d20 1
a20 1
	export EDITOR TERM USER USER_ID
d50 1
a50 1
:
@


1.9
log
@do not use $USER_ID as a significator if /etc/profile has been run
in expectation of upcoming changes
@
text
@d1 1
a1 1
# $MirOS: src/etc/root.profile,v 1.8 2008/05/07 12:16:12 tg Exp $
d44 9
@


1.8
log
@remove all references to /root
@
text
@d1 1
a1 1
# $MirOS: src/etc/root.profile,v 1.7 2008/03/27 13:48:27 tg Exp $
d6 1
a6 1
if test -z "$USER_ID"; then
@


1.7
log
@add /usr/dbin, /usr/dsbin to the path: usually before /bin and /sbin except
in the root+single user case (etc/root.profile, etc/profile + SINGLE)
@
text
@d1 1
a1 1
# $MirOS: src/etc/root.profile,v 1.6 2007/08/01 13:07:37 tg Exp $
a8 1
	test -d /root && HOME=/root
@


1.6
log
@don't do the $COLORTERM dance any more,
mc is fine enough to distinguish between vt220 and wsvt25
@
text
@d1 1
a1 1
# $MirOS: src/etc/root.profile,v 1.5 2007/06/15 23:43:46 tg Exp $
d7 1
a7 1
	PATH=/sbin:/usr/sbin:/bin:/usr/bin
@


1.5
log
@fixup for integer, typeset, local
(not regenerating MAKEDEVs because they use #!/bin/mksh but still, for style)
@
text
@d1 1
a1 1
# $MirOS: src/etc/root.profile,v 1.4 2007/05/24 22:31:34 tg Exp $
d19 1
a19 1
	unset i COLORTERM HISTFILE
@


1.4
log
@add some, since we don't have .mkshrc for root
@
text
@d1 1
a1 1
# $MirOS: src/etc/root.profile,v 1.3 2007/02/19 03:03:28 tg Exp $
d27 2
a28 2
	local Tin
	local Tout
@


1.3
log
@* begin __CRAZY cleanup of config(8), not yet completed
  due to time constraints
* store the kernel config as section .config.gz, gzip'd
@
text
@d1 1
a1 1
# $MirOS: src/etc/root.profile,v 1.2 2006/10/18 23:02:23 tg Exp $
d10 2
a11 1
	export PATH HOME
d21 3
a23 1
	export TERM EDITOR
@


1.2
log
@use zcat -f, that cats .gz .Z and uncompressed as well.
@
text
@d1 1
a1 1
# $MirOS: src/etc/root.profile,v 1.1 2006/09/24 18:13:38 tg Exp $
d24 17
a40 1
	$SUDO zcat -f ${1:-/bsd} | strings -n4 | sed -n 's/^=CF=//p'
@


1.1
log
@* nuke root mail (ok bsiegert@@)
* simplify root .profile and secure it
@
text
@d1 1
a1 1
# $MirOS: src/etc/root/dot.profile,v 1.8 2006/04/05 18:51:55 tg Exp $
d24 1
a24 1
	$SUDO cat ${1:-/bsd} | strings -n4 | sed -n 's/^=CF=//p'
@

