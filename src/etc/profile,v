head	1.70;
access;
symbols
	MIRBSD_10:1.54.0.2
	MIRBSD_10_BASE:1.54
	MIRBSD_9_BASE:1.20
	MIRBSD_8:1.12.0.2
	MIRBSD_8_BASE:1.12
	mirbsd:1.1.7;
locks; strict;
comment	@# @;


1.70
date	2019.04.23.18.16.31;	author tg;	state Exp;
branches;
next	1.69;
commitid	1005CBF5691554B1356;

1.69
date	2017.01.29.01.06.45;	author tg;	state Exp;
branches;
next	1.68;
commitid	100588D402A1B3FF0D4;

1.68
date	2016.03.25.19.49.15;	author tg;	state Exp;
branches;
next	1.67;
commitid	10056F596401CDD6854;

1.67
date	2015.07.18.22.53.25;	author tg;	state Exp;
branches;
next	1.66;
commitid	10055AAD8F86A52B628;

1.66
date	2009.11.15.11.49.17;	author tg;	state Exp;
branches;
next	1.65;
commitid	1004AFFEAD54EA70F55;

1.65
date	2009.09.06.17.09.27;	author tg;	state Exp;
branches;
next	1.64;
commitid	1004AA3ECD43C11CE0F;

1.64
date	2009.09.06.15.08.00;	author tg;	state Exp;
branches;
next	1.63;
commitid	1004AA3D05820A532B0;

1.63
date	2009.07.18.14.09.04;	author tg;	state Exp;
branches;
next	1.62;
commitid	1004A61D73A7953CBB8;

1.62
date	2009.03.29.13.04.16;	author tg;	state Exp;
branches;
next	1.61;
commitid	10049CF71B654F9EF54;

1.61
date	2009.01.13.21.11.20;	author tg;	state Exp;
branches;
next	1.60;
commitid	100496D03705A75BAB6;

1.60
date	2008.08.27.09.38.56;	author tg;	state Exp;
branches;
next	1.59;
commitid	10048B520AC1B6C3868;

1.59
date	2008.05.25.22.10.19;	author tg;	state Exp;
branches;
next	1.58;
commitid	1004839E3D035A9D5E9;

1.58
date	2008.05.15.15.24.07;	author tg;	state Exp;
branches;
next	1.57;
commitid	100482C558039271D26;

1.57
date	2008.05.13.01.15.07;	author tg;	state Exp;
branches;
next	1.56;
commitid	1004828EBAA39FFB522;

1.56
date	2008.05.07.12.16.12;	author tg;	state Exp;
branches;
next	1.55;
commitid	10048219D991FE06744;

1.55
date	2008.03.27.13.48.27;	author tg;	state Exp;
branches;
next	1.54;
commitid	10047EBA5A25F1AA7E1;

1.54
date	2007.08.01.13.07.37;	author tg;	state Exp;
branches
	1.54.2.1;
next	1.53;
commitid	10046B085A163D9CD4C;

1.53
date	2007.06.30.01.45.57;	author tg;	state Exp;
branches;
next	1.52;
commitid	1004685B5E70E7E62D2;

1.52
date	2007.06.15.21.56.15;	author tg;	state Exp;
branches;
next	1.51;
commitid	10046730B1008A56439;

1.51
date	2007.05.22.18.52.08;	author tg;	state Exp;
branches;
next	1.50;
commitid	10046533B8B29A5DD50;

1.50
date	2007.05.20.12.12.10;	author tg;	state Exp;
branches;
next	1.49;
commitid	10046503B2D16EADE98;

1.49
date	2007.04.17.20.04.07;	author tg;	state Exp;
branches;
next	1.48;
commitid	100462527BF45B87F5C;

1.48
date	2007.04.16.18.54.37;	author tg;	state Exp;
branches;
next	1.47;
commitid	1004623C5744FDC6F8B;

1.47
date	2007.04.16.18.05.43;	author tg;	state Exp;
branches;
next	1.46;
commitid	1004623BB01689CE86C;

1.46
date	2007.02.13.15.03.01;	author tg;	state Exp;
branches;
next	1.45;
commitid	10045D1D3265383677D;

1.45
date	2007.02.08.21.53.07;	author tg;	state Exp;
branches;
next	1.44;
commitid	10045CB9BC50A8E7A5F;

1.44
date	2007.02.07.22.30.11;	author tg;	state Exp;
branches;
next	1.43;
commitid	10045CA530877EAB08D;

1.43
date	2007.02.02.02.02.48;	author tg;	state Exp;
branches;
next	1.42;
commitid	10045C29BDF0B74723C;

1.42
date	2007.02.02.01.54.01;	author tg;	state Exp;
branches;
next	1.41;
commitid	10045C299AC33FF169A;

1.41
date	2007.01.18.19.41.29;	author tg;	state Exp;
branches;
next	1.40;
commitid	10045AFCD277BF0DD96;

1.40
date	2007.01.11.03.01.55;	author tg;	state Exp;
branches;
next	1.39;
commitid	10045A5A8A64DD5DF05;

1.39
date	2007.01.09.01.30.52;	author tg;	state Exp;
branches;
next	1.38;
commitid	10045A2F0446F2B1378;

1.38
date	2007.01.06.00.32.22;	author tg;	state Exp;
branches;
next	1.37;
commitid	100459EEE2613951DC3;

1.37
date	2006.11.17.17.48.36;	author tg;	state Exp;
branches;
next	1.36;
commitid	100455DF59D3ECBA586;

1.36
date	2006.11.17.03.34.52;	author tg;	state Exp;
branches;
next	1.35;
commitid	100455D2DE3056F3AA8;

1.35
date	2006.11.16.21.42.00;	author tg;	state Exp;
branches;
next	1.34;
commitid	100455CDA882E3D124F;

1.34
date	2006.10.18.19.47.53;	author tg;	state Exp;
branches;
next	1.33;
commitid	100453685007BC3BB2A;

1.33
date	2006.10.17.21.48.59;	author tg;	state Exp;
branches;
next	1.32;
commitid	10045354FCD01C045FE;

1.32
date	2006.09.20.22.01.34;	author tg;	state Exp;
branches;
next	1.31;
commitid	1004511B9F33BAA69F7;

1.31
date	2006.08.14.20.32.43;	author tg;	state Exp;
branches;
next	1.30;
commitid	10044E0DDB73A5BD9FD;

1.30
date	2006.08.09.20.54.49;	author tg;	state Exp;
branches;
next	1.29;
commitid	10044DA4BAC7A85289A;

1.29
date	2006.08.07.17.20.31;	author tg;	state Exp;
branches;
next	1.28;
commitid	10044D776701324514E;

1.28
date	2006.07.23.18.44.25;	author tg;	state Exp;
branches;
next	1.27;
commitid	10044C3C31D4538E6DA;

1.27
date	2006.07.21.16.44.21;	author tg;	state Exp;
branches;
next	1.26;
commitid	10044C1042B69459C02;

1.26
date	2006.07.08.19.59.57;	author tg;	state Exp;
branches;
next	1.25;
commitid	10044B00ECA4B5250E8;

1.25
date	2006.07.06.00.43.27;	author tg;	state Exp;
branches;
next	1.24;
commitid	10044AC5C8740CD1D4C;

1.24
date	2006.07.04.01.16.33;	author tg;	state Exp;
branches;
next	1.23;
commitid	10044A9C15A072E52B6;

1.23
date	2006.07.03.12.37.35;	author tg;	state Exp;
branches;
next	1.22;
commitid	10044A90FA00961EE6B;

1.22
date	2006.07.03.12.35.26;	author tg;	state Exp;
branches;
next	1.21;
commitid	10044A90F226C257488;

1.21
date	2006.07.03.12.34.53;	author tg;	state Exp;
branches;
next	1.20;
commitid	10044A90EFD0AC8BCA3;

1.20
date	2006.06.18.20.17.02;	author tg;	state Exp;
branches;
next	1.19;
commitid	1004495B4CF4AB5120B;

1.19
date	2006.06.17.00.36.13;	author tg;	state Exp;
branches;
next	1.18;
commitid	10044934E8A172B2655;

1.18
date	2006.06.02.21.06.28;	author tg;	state Exp;
branches;
next	1.17;
commitid	1004480A8604FF7D3FF;

1.17
date	2006.04.12.12.13.12;	author tg;	state Exp;
branches;
next	1.16;
commitid	100443CEEBE254670C1;

1.16
date	2006.03.28.13.22.57;	author tg;	state Exp;
branches;
next	1.15;
commitid	100442938B8014C1597;

1.15
date	2006.01.03.02.22.45;	author tg;	state Exp;
branches;
next	1.14;
commitid	10043B9DFFE6322B9CB;

1.14
date	2006.01.03.02.16.29;	author tg;	state Exp;
branches;
next	1.13;
commitid	10043B9DE8D30748B25;

1.13
date	2006.01.03.02.15.24;	author tg;	state Exp;
branches;
next	1.12;
commitid	10043B9DE074A473EBF;

1.12
date	2005.12.18.05.40.49;	author tg;	state Exp;
branches;
next	1.11;
commitid	10043A4F667678BAA40;

1.11
date	2005.12.18.04.53.12;	author tg;	state Exp;
branches;
next	1.10;
commitid	10043A4EB496D19883A;

1.10
date	2005.12.18.03.39.16;	author tg;	state Exp;
branches;
next	1.9;
commitid	10043A4D9D86126C7A4;

1.9
date	2005.09.23.09.26.09;	author tg;	state Exp;
branches;
next	1.8;
commitid	15f4333ca27b342;

1.8
date	2005.07.31.13.46.09;	author tg;	state Exp;
branches;
next	1.7;
commitid	306142ecd6306ba6;

1.7
date	2005.07.26.17.40.38;	author tg;	state Exp;
branches;
next	1.6;
commitid	4a6942e675984dc2;

1.6
date	2005.07.23.14.24.22;	author tg;	state Exp;
branches;
next	1.5;
commitid	545c42e25301a27c;

1.5
date	2005.07.23.13.55.04;	author tg;	state Exp;
branches;
next	1.4;
commitid	4f3e42e24ab9c87a;

1.4
date	2005.06.26.17.09.32;	author tg;	state Exp;
branches;
next	1.3;
commitid	69ec42bee15d1b5c;

1.3
date	2005.06.26.16.57.12;	author tg;	state Exp;
branches;
next	1.2;
commitid	6df142bede3590ec;

1.2
date	2005.05.06.17.37.33;	author tg;	state Exp;
branches;
next	1.1;
commitid	da427bab65964f;

1.1
date	2005.03.06.16.33.39;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.54.2.1
date	2008.05.19.18.37.04;	author tg;	state Exp;
branches;
next	;
commitid	1004831C8D36C5EF97D;

1.1.7.1
date	2005.03.06.16.33.39;	author tg;	state Exp;
branches;
next	;


desc
@@


1.70
log
@do not auto-include root in sshagent_autostart (plus some fixups)
@
text
@# $MirSecuCron$
# $MirOS: src/etc/profile,v 1.69 2017/01/29 01:06:45 tg Exp $

PATH=/sbin:/bin:/usr/sbin:/usr/bin:/usr/local/bin:/usr/mpkg/bin
umask 022
[ -z "$KSH_VERSION$ZSH_VERSION" ] && alias print='echo -e'
: ${HOME:=/} ${OSNAME:=MirBSD}
export HOME PATH
[ -s "$HOME/.profile.preinit" ] && . $HOME/.profile.preinit

[ -z "$TERM" -o x"$TERM" = x"unknown" ] && if [ -x /usr/bin/tset ]; then
	x=$(ulimit -c 0; /usr/bin/tset -sQ \?vt220)
	TERM=vt100
	eval $x
else
	TERM=vt220
fi
stty newcrt werase '^W' intr '^C' kill '^U' erase '^?' status '^T'

if [ -n "$USER" ]; then
	PATH=~/.etc/bin:/usr/local/bin:/usr/mpkg/bin:/usr/bin:/bin:/usr/X11R6/bin:/usr/sbin:/sbin:/usr/mpkg/sbin:/usr/games
	PS1='$ '
fi
_shellok=
BROWSER=lynx
CVSUMASK=002
EDITOR=/bin/ed
IRCNAME="MirOS packages a kernel, userland and the attitude"
IRCPORT=6667
IRCSERVER=irc.eu.freenode.net
unset LC_ALL
LC_CTYPE=en_US.UTF-8
PAGER=/usr/bin/less
if [ -n "$KSH_VERSION" ]; then
	test -z "$USER" || PS1="\$PWD $PS1"
	alias which='whence -p'
	_shellok=1
elif [ -n "$BASH_VERSION" ]; then
	set -o emacs
	shopt -s extglob
	[[ $TERM = screen ]] && \
		X_COLOUR=$X_COLOUR'[1;36;40m\]screen:\['
	if [[ $OSTYPE = linux-gnu || $OSTYPE = Linux ]]; then
		# compat_linux(8)
		PS1='\['$X_COLOUR'[31m\]Linux!\[[0m\]\u@@\h:\w \$ '
		[[ -e /emul/linux/bin/ls ]] && alias ls='/bin/ls --color'
	else
		# native via ports
		PS1='\['$X_COLOUR'[34m\]bash!\[[0m\]\u@@\h:\w \$ '
	fi
	[[ -n $NOCOLOURPROMPT ]] && PS1='bash:\u@@\h:\w \$ '
	_shellok=1
elif [ -n "$ZSH_VERSION" ]; then
	PS1='%n@@%m:%~ %# '
	if [[ -n $NOCOLOURPROMPT ]]; then
		PS1='zsh:'$PS1
		RPS1='%(?..%?)'
	else
		PS1='%B%F{4}zsh!%f%b'$PS1
		RPS1='%(?..%B%F{1}%?%f%b)'
	fi
	_shellok=1
fi
XDG_CACHE_HOME=$HOME/.etc/xdg/cache
XDG_CONFIG_HOME=$HOME/.etc/xdg/config
XDG_DATA_HOME=$HOME/.etc/xdg/data
export BROWSER CVSUMASK EDITOR HOME IRCNAME IRCPORT IRCSERVER LC_CTYPE OSNAME
export PAGER TERM XDG_CACHE_HOME XDG_CONFIG_HOME XDG_DATA_HOME
unset HISTFILE NOCOLOURPROMPT x
test -n "$_shellok" || return 0
unset _shellok
[[ -n $KSH_VERSION$ZSH_VERSION ]] && alias cls='print -n \\033c'
# convenience aliases and functions:
[[ -x /emul/linux/bin/bash ]] && alias lx='/emul/linux/bin/bash --login'
function bye {
	[[ $1 = k ]] && ssh-agent -k
	typeset M='\033c'
	[ $? -ne 0 ] && M='\033c Warning: ssh-agent returned error!\n'
	print -n -- "$M"
	exit
	logout
}

# dict.leo.org German ⇄ English
ge() {
	local _q _IFS

	_IFS=$IFS
	IFS=+
	_q="$*"
	IFS=$_IFS
	${BROWSER:-lynx} "http://dict.leo.org/?search=$_q"
}

# pipe into pastebin
ixio() {
	curl -n -F 'f:1=<-' http://ix.io
}
sprunge() {
	curl -F 'sprunge=<-' http://sprunge.us
}

if test -n "$USER_ID" && test -O /var/run/ssh-agent/$USER_ID; then
	_dir=/var/run/ssh-agent/$USER_ID
	# If the agent is not running, remove stale files
	[[ -e $_dir/socket ]] || rm -f $_dir/{agent,keyread}
	# Start ssh-agent if it is not already started
	[[ -e $_dir/agent || -S $SSH_AUTH_SOCK ]] || \
	    (cd /; ssh-agent -s -a $_dir/socket) >$_dir/agent
	# Do the following only if ssh-agent is running
	if [[ -e $_dir/socket ]]; then
		# Read configuration file if it exists
		[[ -s $_dir/agent ]] && . $_dir/agent >&2
		# Read in the keys, if not already done
		[[ -e $_dir/keyread ]] || ssh-add | tee $_dir/keyread
	fi
	unset _dir
fi

: $MirOS: src/etc/profile,v 1.69 2017/01/29 01:06:45 tg Exp $
@


1.69
log
@add/update a few functions

XXX these files need a full review, maybe even rethought…
@
text
@d2 1
a2 1
# $MirOS: src/etc/profile,v 1.67 2015/07/18 22:53:25 tg Exp $
d103 1
a103 1
if [ -O /var/run/ssh-agent/$USER_ID ]; then
d120 1
a120 1
: $MirOS: src/etc/profile,v 1.67 2015/07/18 22:53:25 tg Exp $
@


1.68
log
@prepare most scripts for locale tracking; drop some TZ=UTC; use modern mksh
@
text
@d83 18
a100 2
function ge {		# German ⇄ English
	$BROWSER "http://dict.leo.org/?search=$*"
@


1.67
log
@do n̲o̲t̲ export PS1!
@
text
@d2 1
a2 1
# $MirOS: src/etc/profile,v 1.66 2009/11/15 11:49:17 tg Exp $
d31 1
d104 1
a104 1
: $MirOS: src/etc/profile,v 1.66 2009/11/15 11:49:17 tg Exp $
@


1.66
log
@make “Start ssh-agent if it is not already started” also apply to “ssh -A”
@
text
@d2 1
a2 1
# $MirOS: src/etc/profile,v 1.65 2009/09/06 17:09:27 tg Exp $
d67 1
a67 1
export PAGER PS1 TERM XDG_CACHE_HOME XDG_CONFIG_HOME XDG_DATA_HOME
d103 1
a103 1
: $MirOS: src/etc/profile,v 1.65 2009/09/06 17:09:27 tg Exp $
@


1.65
log
@feature completeness (prompt, aliases, functions) for zsh
@
text
@d2 1
a2 1
# $MirOS: src/etc/profile,v 1.64 2009/09/06 15:08:00 tg Exp $
d91 1
a91 1
	[[ -e $_dir/agent ]] || \
d103 1
a103 1
: $MirOS: src/etc/profile,v 1.64 2009/09/06 15:08:00 tg Exp $
@


1.64
log
@• better Bourne shell, csh, tcsh, zsh compatibility
• RCS IDs
@
text
@d2 1
a2 1
# $MirOS$
d52 10
d71 1
a71 1
[[ -n $KSH_VERSION ]] && alias cls='print -n \\033c'
d103 1
a103 1
: $MirOS: src/etc/profile,v 1.63 2009/07/18 14:09:04 tg Exp $
@


1.63
log
@prevent data corruption from /etc/security’s automated backup cronjob
by using “MirSecuCron” as RCS ID for these and preventing it from ex-
panding any of the default keywords

also, add RCS IDs to almost all configuration files and enhance the
default changelist file
@
text
@d2 1
d6 1
a6 1
[ -z "$KSH_VERSION" ] && alias print='echo -e'
d18 1
a18 1
stty newcrt werase ^W intr ^C kill ^U erase ^? status ^T
d93 1
a93 1
: $MirOS: src/etc/profile,v 1.62 2009/03/29 13:04:16 tg Exp $
@


1.62
log
@• take care of dbins
• #!/bin/mksh shebang, in most places
• rcsid while here
@
text
@d1 1
a1 1
# $Id$
d92 1
a92 1
: $MirOS: src/etc/profile,v 1.61 2009/01/13 21:11:20 tg Exp $
@


1.61
log
@stty in rc has no effect, in profile works even in uxterm and screen
status is what I want, but the others don’t seem to hurt
@
text
@d1 3
a3 1
PATH=/sbin:/bin:/usr/sbin:/usr/bin:/usr/dbin:/usr/dsbin:/usr/local/bin:/usr/mpkg/bin
d20 1
a20 1
	PATH=~/.etc/bin:/usr/local/bin:/usr/mpkg/bin:/usr/bin:/usr/dbin:/bin:/usr/X11R6/bin:/usr/sbin:/usr/dsbin:/sbin:/usr/mpkg/sbin:/usr/games
d92 1
a92 1
: $MirOS: src/etc/profile,v 1.60 2008/08/27 09:38:56 tg Exp $
@


1.60
log
@only then do ls --color default if /emul/linux/bin/ls exists, since it
does no longer come with the linuxulator libs package (XXX may want to
change this back)
@
text
@d15 1
d90 1
a90 1
: $MirOS: src/etc/profile,v 1.59 2008/05/25 22:10:19 tg Exp $
@


1.59
log
@give root a PS1, a LC_CTYPE, etc. and shorten out /etc/profile accordingly
@
text
@d41 1
a41 1
		alias ls='/bin/ls --color'
d89 1
a89 1
: $MirOS: src/etc/profile,v 1.58 2008/05/15 15:24:07 tg Exp $
@


1.58
log
@mksh:
* initialise the integers PPID, OPTIND, RANDOM, SECONDS, and TMOUT to base-10
* bring back PGRP as base-10 integer to the process group via getpgrp(2)
* initialise USER_ID as base-10 integer to the effective user id as retrieved
  from geteuid(2) = $(id -u)
* use $USER_ID in dot.mkshrc instead of spawning an id(1) process
  -> dot.mkshrc,v 1.34 now requires mksh R34
* convert more int to bool where appropriate
* remove dead code - getpgrp(2) cannot fail
* sync manual page to reality
* bump to mksh R34(beta) - feature freeze

XXX check if our_pgrp in jobs.c is still really needed, the setpgid call
XXX probably just makes us our own pgrp leader, and we might have to use
XXX and update kshpgrp accordingly - need feedback/help here but I think
XXX this simplification should be possible if I grok the code correctly.

etc/profile:
* adjust to $USER_ID changes in mksh (speed-up here, too)

mksh.hts:
* sync changelog
@
text
@d1 1
d4 2
a5 1
: ${HOME:=/}
d16 1
a16 12
PS1='# '
test -n "$USER_ID" || if test -x /usr/bin/id; then
	USER_ID=$(ulimit -c 0; /usr/bin/id -u 2>/dev/null)
else
	USER_ID=0
fi
if [ -z "$USER" ]; then
	PATH=/sbin:/bin:/usr/sbin:/usr/bin:/usr/dbin:/usr/dsbin:/usr/local/bin:/usr/mpkg/bin
	PS1='SINGLE:$PWD # '
elif [ $USER_ID -eq 0 ]; then
	PATH=/usr/sbin:/usr/dsbin:/sbin:/usr/bin:/usr/dbin:/bin:/usr/X11R6/bin:/usr/local/bin:/usr/mpkg/bin
else
a19 1
export PATH
a27 3
#: ${OSNAME:=$(ulimit -c 0; uname -s 2>/dev/null)}
#: ${OSNAME:=unknown}
: ${OSNAME:=MirBSD}
d53 1
a53 1
export PAGER PS1 TERM USER_ID XDG_CACHE_HOME XDG_CONFIG_HOME XDG_DATA_HOME
d55 1
a55 1
test -z "$_shellok" && return	# positive test so that we can return true
d89 1
a89 1
: $MirOS: src/etc/profile,v 1.57 2008/05/13 01:15:07 tg Exp $
@


1.57
log
@.oO(WTF?) speed up login shells
@
text
@d15 5
a19 3
USER_ID=
[ -x /usr/bin/id ] && USER_ID=$(ulimit -c 0; /usr/bin/id -u 2>/dev/null)
: ${USER_ID:=0}
d102 1
a102 1
: $MirOS: src/etc/profile,v 1.56 2008/05/07 12:16:12 tg Exp $
@


1.56
log
@remove all references to /root
@
text
@d36 3
a38 2
: ${OSNAME:=$(ulimit -c 0; uname -s 2>/dev/null)}
: ${OSNAME:=unknown}
d100 1
a100 1
: $MirOS: src/etc/profile,v 1.55 2008/03/27 13:48:27 tg Exp $
@


1.55
log
@add /usr/dbin, /usr/dsbin to the path: usually before /bin and /sbin except
in the root+single user case (etc/root.profile, etc/profile + SINGLE)
@
text
@d3 1
a3 1
: ${HOME:=/root}
d19 1
a19 1
	PATH=/sbin:/bin:/usr/sbin:/usr/bin:/root/.etc/bin:/usr/dbin:/usr/dsbin:/usr/local/bin:/usr/mpkg/bin
d22 1
a22 1
	PATH=/root/.etc/bin:/usr/sbin:/usr/dsbin:/sbin:/usr/bin:/usr/dbin:/bin:/usr/X11R6/bin:/usr/local/bin:/usr/mpkg/bin
d99 1
a99 1
: $MirOS: src/etc/profile,v 1.54 2007/08/01 13:07:37 tg Exp $
@


1.54
log
@don't do the $COLORTERM dance any more,
mc is fine enough to distinguish between vt220 and wsvt25
@
text
@d19 1
a19 1
	PATH=/sbin:/bin:/usr/sbin:/usr/bin:/root/.etc/bin:/usr/local/bin:/usr/mpkg/bin
d22 1
a22 1
	PATH=/root/.etc/bin:/usr/sbin:/sbin:/usr/bin:/bin:/usr/X11R6/bin:/usr/local/bin:/usr/mpkg/bin
d24 1
a24 1
	PATH=~/.etc/bin:/usr/local/bin:/usr/mpkg/bin:/usr/bin:/bin:/usr/X11R6/bin:/usr/sbin:/sbin:/usr/mpkg/sbin:/usr/games
d99 1
a99 1
: $MirOS: src/etc/profile,v 1.53 2007/06/30 01:45:57 tg Exp $
@


1.54.2.1
log
@MFC: handle the case of mksh R34 defining $USER_ID already more efficiently
@
text
@d15 3
a17 5
test -n "$USER_ID" || if test -x /usr/bin/id; then
	USER_ID=$(ulimit -c 0; /usr/bin/id -u 2>/dev/null)
else
	USER_ID=0
fi
d99 1
a99 1
: $MirOS: src/etc/profile,v 1.54 2007/08/01 13:07:37 tg Exp $
@


1.53
log
@fix single-user mode prompt
@
text
@a12 9
case $TERM:$COLORTERM in
*:NO|ansi-nt*|vt*|xterm-r6:*)
	unset COLORTERM
	;;
interix:*|screen:*|wsvt*|xterm*)
	COLORTERM=1
	export COLORTERM
	;;
esac
a20 1
	unset COLORTERM
d56 1
a56 1
	[[ -n $NOCOLOURPROMPT || -z $COLORTERM ]] && PS1='bash:\u@@\h:\w \$ '
d99 1
a99 1
: $MirOS: src/etc/profile,v 1.52 2007/06/15 21:56:15 tg Exp $
@


1.52
log
@be non-mk sh friendly
@
text
@d50 1
a50 1
	PS1="\$PWD $PS1"
d109 1
a109 1
: $MirOS: src/etc/profile,v 1.51 2007/05/22 18:52:08 tg Exp $
@


1.51
log
@run ssh-agent in / to not prevent umounting other filesystems
@
text
@d82 1
a82 1
	local M='\033c'
d109 1
a109 1
: $MirOS: src/etc/profile,v 1.50 2007/05/20 12:12:10 tg Exp $
@


1.50
log
@prefer reliability
@
text
@d93 1
d95 1
a95 2
	[[ -e /var/run/ssh-agent/$USER_ID/socket ]] || \
	    rm -f /var/run/ssh-agent/$USER_ID/{agent,keyread}
d97 2
a98 3
	[[ -e /var/run/ssh-agent/$USER_ID/agent ]] || \
	    ssh-agent -s -a /var/run/ssh-agent/$USER_ID/socket \
	    >/var/run/ssh-agent/$USER_ID/agent
d100 1
a100 1
	if [[ -e /var/run/ssh-agent/$USER_ID/socket ]]; then
d102 1
a102 2
		[[ -s /var/run/ssh-agent/$USER_ID/agent ]] && \
		    . /var/run/ssh-agent/$USER_ID/agent >&2
d104 1
a104 2
		[[ -e /var/run/ssh-agent/$USER_ID/keyread ]] || \
		    ssh-add | tee /var/run/ssh-agent/$USER_ID/keyread
d106 1
d109 1
a109 1
: $MirOS: src/etc/profile,v 1.49 2007/04/17 20:04:07 tg Exp $
@


1.49
log
@change our coding style for shell:

we already do not 'function\nfoo\n{' for shell, like style(9) requires for
C programming, but 'function foo\n{' instead. however, we could treat the
function keyword as indentation initialiser and use 'function foo {' (on a
line for itself) – it looks different, unusual, but acceptable, and mksh's
own output (dumping with the “functions” builtin) does that too (although,
its indentation style sucks, but is legible enough)
@
text
@d43 2
a44 2
IRCSERVER=irc4.mirbsd.org	# irc.mirbsd.org = IPv4+IPv6; irc6.* = v6 only
IRCPORT=6667			# use ircs.mirbsd.org:6668 for SSL encryption
d111 1
a111 1
: $MirOS: src/etc/profile,v 1.48 2007/04/16 18:54:37 tg Exp $
@


1.48
log
@• from a MirOS point of view:
  place most stuff from /etc/profile in /etc/skel/.mkshrc; admins must make
  sure to copy this file to users' homes on upgrade (benefit: non-login but
  interactive shells also get all the goodies); fix some quoting; simplify,
  reformat, change comments
• from an mksh point of view:
  slight internal changes in dot.mkshrc; external commands are now prefixed
  with “ulimit -c 0”; $TERM is defined; improvement in determining the host
  name (e.g. on Debian if a FQDN is not given); declare locals as such both
  in $PS1 and outside; remove superfluous quoting, quote properly; simplify
  hd alias, add rot13 alias; place RCS ID at the bottom
@
text
@d80 1
a80 2
function bye
{
d88 1
a88 2
function ge		# German ⇄ English
{
d111 1
a111 1
: $MirOS$
@


1.47
log
@ulynx is superfluous, klynx obscure (could be ~/.profile stuff)
@
text
@a0 2
# $MirOS: src/etc/profile,v 1.46 2007/02/13 15:03:01 tg Exp $
#-
d3 1
d13 1
a13 1
case "${TERM}:$COLORTERM" in
d18 2
a19 1
	COLORTERM=1; export COLORTERM
d23 1
a23 3
[ -z "$HOME" ] && HOME=/root
PS1='$PWD $ '
PSX='# '
d26 1
a26 1
[ -z "$USER_ID" ] && USER_ID=0
d35 1
a35 1
	PSX='$ '
d38 1
a41 1
[ -z "$HOSTNAME" ] && HOSTNAME=$(ulimit -c 0; hostname -s 2>/dev/null)
d46 2
a47 2
[ -z "$OSNAME" ] && OSNAME=$(ulimit -c 0; uname -s 2>/dev/null)
OSNAME=${OSNAME:-unknown}
a48 1
PS1=$PSX
d50 1
a50 14
	PS1='$(((rv=$?)) && print $rv\|)${USER:=$(id -un)}@@${HOSTNAME:=nil}:$(
		local pfx=~ wd=${PWD:-$(pwd)}
		[[ ${wd#$pfx} = $wd || $pfx = ?(/) ]] || wd=\~${wd#$pfx}
		pfx=; let n="( (n = ${COLUMNS:-80} / 3) < 7 ? 7 : n)"
		while (( (${#pfx} + ${#wd}) > n )); do
			if [[ $wd = */* ]]; then
				pfx=.../
				wd="${wd#*/}"
			else
				pfx=...
				wd="${wd#?????}"
			fi
		done
		print -r -- "$pfx$wd")'" $PSX"
d72 4
a75 10
export BROWSER CVSUMASK EDITOR HOME HOSTNAME IRCNAME IRCPORT IRCSERVER
export LC_CTYPE OSNAME PAGER PS1 TERM USER USER_ID XDG_CACHE_HOME
export XDG_CONFIG_HOME XDG_DATA_HOME
unset HISTFILE NOCOLOURPROMPT PSX x
alias cls='print -n \\033c'
alias la='ls -Fa'
test $USER_ID -eq 0 && alias l=la || alias l='ls -F'
alias ll='l -l'
alias lo='la -lo'
test x"$_shellok" = x"1" || return
d77 2
a79 1
which rot13 >/dev/null 2>&1 || alias rot13='tr A-Za-z N-ZA-Mn-za-m'
d89 1
a89 1
function ge		# German English
a92 8
function Lstripcom	# strip comments (and whitespace) from file(s)
{
	cat "$@@" | while read _line; do
		set -o noglob
		_line=${_line%%#*}
		[[ -n $_line ]] && print -r -- $_line
	done
}
d112 2
@


1.46
log
@move ssh-agent stuff to /var/run where it's also cleaned at boot,
like /tmp, but not cleaned during cron.daily… *grr*
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.45 2007/02/08 21:53:07 tg Exp $
a113 9
function ulynx		# uxterm lynx (UTF-8)
{
	command lynx -display_charset utf8 "$@@"
}
function klynx		# kterm lynx (EUC-JP)
{
	( sleep 1; cls; print -n 'Press Ctrl-L!' ) 2>/dev/null &
	command lynx -display_charset euc-jp "$@@"
}
@


1.45
log
@always export LC_CTYPE=en_US.UTF-8 since we don't can anything else
agreed bsiegert@@
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.44 2007/02/07 22:30:11 tg Exp $
d132 1
a132 1
if [ -O /tmp/ssh-agent/$USER_ID ]; then
d134 2
a135 2
	[[ -e /tmp/ssh-agent/$USER_ID/socket ]] || \
	    rm -f /tmp/ssh-agent/$USER_ID/{agent,keyread}
d137 3
a139 3
	[[ -e /tmp/ssh-agent/$USER_ID/agent ]] || \
	    ssh-agent -s -a /tmp/ssh-agent/$USER_ID/socket \
	    >/tmp/ssh-agent/$USER_ID/agent
d141 1
a141 1
	if [[ -e /tmp/ssh-agent/$USER_ID/socket ]]; then
d143 2
a144 2
		[[ -s /tmp/ssh-agent/$USER_ID/agent ]] && \
		    . /tmp/ssh-agent/$USER_ID/agent >&2
d146 2
a147 2
		[[ -e /tmp/ssh-agent/$USER_ID/keyread ]] || \
		    ssh-add | tee /tmp/ssh-agent/$USER_ID/keyread
@


1.44
log
@with no support for latin1 left, default to utf-8 everywhere
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.43 2007/02/02 02:02:48 tg Exp $
a42 1
unset HISTFILE
d47 1
d89 1
a89 1
export OSNAME PAGER PS1 TERM USER USER_ID XDG_CACHE_HOME
d91 1
a91 1
unset NOCOLOURPROMPT PSX x
@


1.43
log
@speed up
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.42 2007/02/02 01:54:01 tg Exp $
a13 7
LC_CTYPE=${LC_ALL:-${LC_CTYPE:-${LANG}}}
test -n "$LC_CTYPE" || if /usr/sbin/wsconfig -Uq 2>&-; then
	LC_CTYPE=en_US.UTF-8
	set -o utf8-hack 2>&-
else
	LC_CTYPE=C
fi
d40 1
d89 1
a89 1
export LC_CTYPE OSNAME PAGER PS1 TERM USER USER_ID XDG_CACHE_HOME
a131 8
[[ $BROWSER = lynx* ]] && unset BROWSER
if [[ $LC_CTYPE = *@@(UTF|utf)?(-)8 ]]; then
	: ${BROWSER:=lynx -display_charset utf8}
else
	: ${BROWSER:=lynx}
fi
[[ $BROWSER = lynx* ]] && alias lynx="$BROWSER"

@


1.42
log
@* use which(1), not builtin whence -p, to please GNU bash
* sync irc server commentary with updated reality
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.41 2007/01/18 19:41:29 tg Exp $
d50 1
a50 1
HOSTNAME=$(ulimit -c 0; hostname -s 2>/dev/null)
d54 1
a54 1
OSNAME=$(ulimit -c 0; uname -s 2>/dev/null)
d73 1
a138 2
# [[ $(locale charmap) = UTF-8 ]]	# locale charmap = non-SUSv3 extension
# but below saves us a fork, only works due to LC_CTYPE=${...:-${... above tho
@


1.41
log
@* patch applications that adhere to the XDG specification¹ to use ~/.etc/
* create² XDG base directories
* tell XDG applications of ${LOCALBASE} and ${SYSCONFDIR}

¹) http://standards.freedesktop.org/basedir-spec/basedir-spec-0.6.html
²) even though the spec, pointed to me by Jonathan "ciruZ" Schleifer
   (thanks), says that's not necessary and they'll do it themselves
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.40 2007/01/11 03:01:55 tg Exp $
d52 2
a53 3
IRCSERVER=irc4.mirbsd.org	# irc.mirbsd.org supports IPv4 and IPv6 though
				# irc*.66h.42h.de:6666 = irc*.mirbsd.org:6667
IRCPORT=6667			# irc*.{mirbsd.org,66h.42h.de}:6668 support SSL
d105 1
a105 1
whence -p rot13 >&- || alias rot13='tr A-Za-z N-ZA-Mn-za-m'
@


1.40
log
@add a rot13 alias, for we don't have it in base any more,
and it's the only bsd "game" which has some actual use. dasr
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.39 2007/01/09 01:30:52 tg Exp $
d91 3
d95 2
a96 1
export LC_CTYPE OSNAME PAGER PS1 TERM USER USER_ID
@


1.39
log
@irc{,4,6}.mirbsd.org guarantee port 6666 + 6667 non-SSL, 6668 SSL
irc{,4,6}.66h.42h.de are the same, except port 6667 isn't guaranteed
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.38 2007/01/06 00:32:22 tg Exp $
d102 1
@


1.38
log
@correct check for utf-8
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.37 2006/11/17 17:48:36 tg Exp $
d53 2
a54 1
IRCPORT=6666			# irc*.mirbsd.org support SSL on port 6668 too
@


1.37
log
@* use full path for wsconfig that early
* _do_ export LC_CTYPE and make sure it has a (correct) value
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.36 2006/11/17 03:34:52 tg Exp $
d133 3
a135 1
if [[ $LC_CTYPE = en_US.UTF-8 ]]; then
@


1.36
log
@check for utf-8 as early as possible, due to the typing effect
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.35 2006/11/16 21:42:00 tg Exp $
d14 2
a15 1
test -n "$LC_ALL$LC_CTYPE$LANG" || if wsconfig -Uq 2>&-; then
d91 1
a91 1
export OSNAME PAGER PS1 TERM USER USER_ID
@


1.35
log
@if no locale information (ctype) is known, use wsconfig(8) (no TFM yet)
to determine if it's utf-8 or not (if wsconfig fails, we assume not, to
not change existing behaviour)

we don't export LC_CTYPE here because we want to check again also in
(interactive) subshells; also we only do it for mksh/bash and set -U
for newer mkshs
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.34 2006/10/18 19:47:53 tg Exp $
d14 6
a98 6
[[ -n $LC_ALL || -n $LC_CTYPE || -n $LANG ]] || if wsconfig -Uq 2>&-; then
	LC_CTYPE=en_US.UTF-8
	set -o utf8-hack 2>&-
else
	LC_CTYPE=C
fi
@


1.34
log
@correct lynx vs ulynx handling
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.33 2006/10/17 21:48:59 tg Exp $
d93 6
@


1.33
log
@check for LC_CTYPE and default $BROWSER accordingly
XXX we need locale(1) or something like that
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.32 2006/09/20 22:01:34 tg Exp $
d125 1
d127 1
a127 1
	: ${BROWSER:=ulynx}
d131 1
@


1.32
log
@support running ssh-agent without any keys, so users can store
their ssh session multiplexing sockets in /tmp/ssh-agent/$UID
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.31 2006/08/14 20:32:43 tg Exp $
a39 1
BROWSER=/usr/bin/lynx
d105 1
a105 1
	${BROWSER:-lynx} "http://dict.leo.org/?search=$*"
d109 1
a109 1
	lynx -display_charset utf8 "$@@"
d114 1
a114 1
	lynx -display_charset euc-jp "$@@"
d125 6
@


1.31
log
@rewrite stripcom/Lstripcom function, making use of the 'last command
of a pipeline is executed in a subshell' trick, don't use co-process
(because that's verbose twice in an interactive shell profile), move
the noglob block into the while and rid the redundant +o and local.
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.30 2006/08/09 20:54:49 tg Exp $
d128 2
a129 3
	[[ ! -e /tmp/ssh-agent/$USER_ID/socket ]] \
	    && rm -f /tmp/ssh-agent/$USER_ID/{agent,keyread} \
	    ~/.etc/ssh/.{ctl,pid}.*
d131 3
a133 4
	if [[ ! -e /tmp/ssh-agent/$USER_ID/agent ]]; then
		ssh-agent -s -a /tmp/ssh-agent/$USER_ID/socket \
		    >/tmp/ssh-agent/$USER_ID/agent
	fi
d137 2
a138 2
		[[ -e /tmp/ssh-agent/$USER_ID/agent ]] \
		    && . /tmp/ssh-agent/$USER_ID/agent >&2
d140 2
a141 4
		if [[ ! -e /tmp/ssh-agent/$USER_ID/keyread ]]; then
			ssh-add
			touch /tmp/ssh-agent/$USER_ID/keyread
		fi
@


1.30
log
@sync stripcom function
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.29 2006/08/07 17:20:31 tg Exp $
d117 1
a117 1
function Lstripcom	# strip comments (and whitespace) from file/stdin
d119 2
a120 4
	local _line
	set -o noglob
	cat "$@@" |&
	while read -p _line; do
a123 1
	set +o noglob
@


1.29
log
@fix path (sync with cron daily)
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.28 2006/07/23 18:44:25 tg Exp $
d117 1
a117 1
function Lstripcom	# strip comments from file
d121 2
a122 1
	cat "$@@" | while read _line; do
@


1.28
log
@* get dot.mkshrc sample from Debian mksh-27.4-2
* sync dot.mkshrc sample with FreeWRT r383
* add some stuff from src/etc/profile and contrib/samples/etc_profile
* sync the latter two with reality and shorten
* teach the user in the mksh installation instructions to install the sample

NB: the sample is also covered by the MirOS licence
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.27 2006/07/21 16:44:21 tg Exp $
d128 1
a128 1
if [ -O /tmp/.ssh-agent/$USER_ID ]; then
d130 2
a131 2
	[[ ! -e /tmp/.ssh-agent/$USER_ID/socket ]] \
	    && rm -f /tmp/.ssh-agent/$USER_ID/{agent,keyread} \
d134 3
a136 3
	if [[ ! -e /tmp/.ssh-agent/$USER_ID/agent ]]; then
		ssh-agent -s -a /tmp/.ssh-agent/$USER_ID/socket \
		    >/tmp/.ssh-agent/$USER_ID/agent
d139 1
a139 1
	if [[ -e /tmp/.ssh-agent/$USER_ID/socket ]]; then
d141 2
a142 2
		[[ -e /tmp/.ssh-agent/$USER_ID/agent ]] \
		    && . /tmp/.ssh-agent/$USER_ID/agent >&2
d144 1
a144 1
		if [[ ! -e /tmp/.ssh-agent/$USER_ID/keyread ]]; then
d146 1
a146 1
			touch /tmp/.ssh-agent/$USER_ID/keyread
@


1.27
log
@use irc.mirbsd.org i.p.v. irc.66h.42h.de
also set default port to 6666
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.26 2006/07/08 19:59:57 tg Exp $
d66 1
a66 2
		print -r -- "$pfx$wd")'" $(if (( $(id -u) )); then
			print \$; else print \#; fi) "
@


1.26
log
@save a few bytes; sync with FreeWRT revision 180
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.25 2006/07/06 00:43:27 tg Exp $
d46 2
a47 1
IRCSERVER=irc4.66h.42h.de	# irc.66h.42h.de supports IPv4 and IPv6 though
d85 2
a86 2
export BROWSER CVSUMASK EDITOR HOME HOSTNAME IRCNAME IRCSERVER OSNAME
export PAGER PS1 TERM USER USER_ID
@


1.25
log
@the 'lo' alias should include -a -l and -o
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.24 2006/07/04 01:16:33 tg Exp $
d53 1
a53 1
		typeset pfx=~ wd=${PWD:-$(pwd)}
d98 1
a98 1
	typeset M='\033c'
d119 1
a119 1
	typeset _line
@


1.24
log
@sync with FreeWRT rev 169:
* save a few bytes in /etc/profile and the environment
* we use USER, so define it if unset
* export HOSTNAME and USER if defined by us

tested with mksh and ash
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.23 2006/07/03 12:37:35 tg Exp $
d91 1
a91 1
alias lo='ll -o'
@


1.23
log
@save another byte
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.22 2006/07/03 12:35:26 tg Exp $
a44 1
HOSTNAME=${HOSTNAME:-noFQDN}
d52 15
a66 5
	__shortpath() {
		pwd	# Dummy, see below, but enough to work
	}
	[[ -n $USER ]] && \
	    PS1='$(((rv=$?)) && print $rv\|)'"\$USER@@$HOSTNAME:\$(__shortpath 2>/dev/null||echo \$PWD) $PSX"
d85 1
a85 1
export PAGER PS1 TERM USER_ID
a94 17
[[ -n $KSH_VERSION ]] && function __shortpath {
	typeset tilde=~ path=${1:-${PWD:-$(pwd)}}
	typeset dots= path2=${path#$tilde}
	[[ $path2 = $path || -z $tilde || $tilde = / ]] || path=\~$path2
	let cmax="${COLUMNS:-80} / 3"
	(( cmax < 7 )) && let cmax=7
	while (( (${#dots} + ${#path}) > cmax )); do
		if [[ $path = *@@(/)* ]]; then
			dots=.../
			path="${path#*/}"
		else
			dots=...
			path="${path#?????}"
		fi
	done
	print -nr -- "$dots$path"
}
@


1.22
log
@save another 2 bytes
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.21 2006/07/03 12:34:53 tg Exp $
d89 1
a89 1
	[[ $path2 = $path || -z $tilde || $tilde = / ]] || path='~'$path2
@


1.21
log
@shave off one byte
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.20 2006/06/18 20:17:02 tg Exp $
d57 1
a57 1
	    PS1='$(((rv=$?)) && print $rv\|)'"\${USER}@@$HOSTNAME:\$(__shortpath 2>/dev/null||echo \$PWD) $PSX"
@


1.20
log
@fix for HOME=/ and HOME=''
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.19 2006/06/17 00:36:13 tg Exp $
d57 1
a57 1
	    PS1='$(((rv=$?)) && print "$rv|")'"\${USER}@@$HOSTNAME:\$(__shortpath 2>/dev/null||echo \$PWD) $PSX"
@


1.19
log
@bash-like feeling for $HOME
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.18 2006/06/02 21:06:28 tg Exp $
d89 1
a89 1
	[[ $path2 = $path ]] || path='~'$path2
@


1.18
log
@put exit status of last command (if non-zero) into $PS1
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.17 2006/04/12 12:13:12 tg Exp $
d87 3
a89 1
	typeset dots= path=${1:-${PWD:-$(pwd)}}
@


1.17
log
@* dot.Xresources: sync with skeleton version
* profile: 'xterm-r6' is now our secret code for monochrome xterms
  ('xterm-xfree86' is the colour xterm; it contains co#8 in terminfo)
* dot.Xresources: make BXTerm really black'n'white
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.16 2006/03/28 13:22:57 tg Exp $
d57 1
a57 1
	    PS1="\${USER}@@$HOSTNAME:\$(__shortpath 2>/dev/null||echo \$PWD) $PSX"
@


1.16
log
@* remove more evil from the base system
* move Lretrocfg function to root .profile while here
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.15 2006/01/03 02:22:45 tg Exp $
d15 1
a15 1
*:NO|ansi-nt*|vt*)
@


1.15
log
@better legible bash examples
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.14 2006/01/03 02:16:29 tg Exp $
a109 8
function ggs		# Google Search
{
	${BROWSER:-lynx} "http://www.google.com/search?hl=la&num=100&safe=off&q=$*"
}
function ggr		# Google GRoups
{
	${BROWSER:-lynx} "http://groups.google.com/groups?hl=la&num=100&safe=off&as_umsgid=$*"
}
a132 4
function Lretrocfg	# retrieve kernel config file
{
	$SUDO cat ${1:-/bsd} | strings -n4 | sed -n 's/^=CF=//p'
}
@


1.14
log
@remove unused curly braces (and more quotes)
@
text
@d1 2
a2 2
# $MirOS: src/etc/profile,v 1.13 2006/01/03 02:15:24 tg Exp $

d63 1
a63 1
		X_COLOUR=$X_COLOUR'[5;34;40m\]screen:\[[0m'
d66 1
a66 1
		PS1='\['$X_COLOUR'[1;31m\]Linux!\[[0m\]\u@@\h:\w \$ '
@


1.13
log
@* move function __shortpath into function block
* exit early if ash (can't parse functions correctly)
* only 'l' and 'la' now show slashes at end of directories, 'ls' doesn't
  (for compatibility reasons)
* remove a few unneeded quotes and use [[ ... ]] while here
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.12 2005/12/18 05:40:49 tg Exp $
d5 1
a5 1
[ -s "${HOME}/.profile.preinit" ] && . ${HOME}/.profile.preinit
d14 1
a14 1
case "${TERM}:${COLORTERM}" in
d31 1
a31 1
	PS1='SINGLE:${PWD} # '
d63 1
a63 1
		X_COLOUR="${X_COLOUR}"'[5;34;40m\]screen:\[[0m'
d66 1
a66 1
		PS1='\['"${X_COLOUR}"'[1;31m\]Linux!\[[0m\]\u@@\h:\w \$ '
d70 1
a70 1
		PS1='\['"${X_COLOUR}"'[34m\]bash!\[[0m\]\u@@\h:\w \$ '
@


1.12
log
@clean old PID files and CTL sockets for ssh-agent/ssh connection multiplexing
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.11 2005/12/18 04:53:12 tg Exp $
d27 1
a27 1
[ -x /usr/bin/id ] && USER_ID="$(ulimit -c 0; /usr/bin/id -u 2>/dev/null)"
d44 2
a45 2
HOSTNAME="$(ulimit -c 0; hostname -s 2>/dev/null)"
HOSTNAME="${HOSTNAME:-noFQDN}"
d48 2
a49 2
OSNAME="$(ulimit -c 0; uname -s 2>/dev/null)"
OSNAME="${OSNAME:-unknown}"
d51 1
d53 2
a54 14
	function __shortpath {
		typeset dots= path="${1:-${PWD:-$(pwd)}}"
		let cmax="${COLUMNS:-80} / 3"
		(( cmax < 7 )) && let cmax=7
		while (( (${#dots} + ${#path}) > cmax )); do
			if [[ $path = *@@(/)* ]]; then
				dots=.../
				path="${path#*/}"
			else
				dots=...
				path="${path#?????}"
			fi
		done
		print -nr -- "$dots$path"
d58 1
a58 1
	alias ls='/bin/ls -F'
d67 1
a67 1
		alias ls='/bin/ls -F --color'
a70 1
		alias ls='/bin/ls -F'
d73 1
a73 2
else
	PS1="$PSX"
d79 2
a80 2
alias la='ls -a'
[ $USER_ID -eq 0 ] && alias l=la || alias l=ls
d83 18
a100 1
[ -x /emul/linux/bin/bash ] && alias lx='/emul/linux/bin/bash --login'
d148 1
a148 1
	[ ! -e /tmp/.ssh-agent/$USER_ID/socket ] \
d152 1
a152 1
	if [ ! -e /tmp/.ssh-agent/$USER_ID/agent ]; then
d157 1
a157 1
	if [ -e /tmp/.ssh-agent/$USER_ID/socket ]; then
d159 1
a159 1
		[ -e /tmp/.ssh-agent/$USER_ID/agent ] \
d162 1
a162 1
		if [ ! -e /tmp/.ssh-agent/$USER_ID/keyread ]; then
@


1.11
log
@IRC server
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.10 2005/12/18 03:39:16 tg Exp $
d145 2
a146 1
	    && rm -f /tmp/.ssh-agent/$USER_ID/{agent,keyread}
@


1.10
log
@change PATH to list /usr/mpkg/bin before /usr/bin (and some other stuff)
so that you can 'cd /usr/ports; make setup' and then use it without ANY
SetEnv stuff at all
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.9 2005/09/23 09:26:09 tg Exp $
d47 1
a47 2
#IRCSERVER=irc.66h.42h.de
IRCSERVER=irc.holarse.de		# IPv4 only XXX bugbug
@


1.9
log
@occurences of /usr/local without /usr/mpkg
which were not yet noticed by bsiegert@@
but need to be changed for new MirPorts default
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.8 2005/07/31 13:46:09 tg Exp $
d36 1
a36 1
	PATH=~/.etc/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/X11R6/bin:/usr/local/bin:/usr/mpkg/bin:/usr/games
@


1.8
log
@* ksh
* use typeset for locals
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.7 2005/07/26 17:40:38 tg Exp $
d30 1
a30 1
	PATH=/sbin:/bin:/usr/sbin:/usr/bin:/root/.etc/bin:/usr/local/bin
d34 1
a34 1
	PATH=/root/.etc/bin:/usr/sbin:/sbin:/usr/bin:/bin:/usr/X11R6/bin:/usr/local/bin
d36 1
a36 1
	PATH=~/.etc/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/X11R6/bin:/usr/local/bin:/usr/games
@


1.7
log
@fix case of non-existing __shortpath function better
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.6 2005/07/23 14:24:22 tg Exp $
d100 2
a101 2
	[ "$1" = k ] && ssh-agent -k
	M='\033c'
d130 1
a130 2
	local _line

@


1.6
log
@* fix for $MIROS removal from environment
* work with TERM=unknown
* simplify ksh $PS1 by using a function (saves more bytes)
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.5 2005/07/23 13:55:04 tg Exp $
d69 1
a69 1
	    PS1="\${USER}@@$HOSTNAME:\$(__shortpath) $PSX"
@


1.5
log
@* removal of a lot of MirCustomisations ;-) in /etc/profile,
  while keeping the SuSE-like approach of having it feature-rich by default
* speed up /etc/profile a lot
* be more compatible to ash and similar

User-visible changes:
* "print" is now automatically aliased for all non-ksh shells
* the ansi-nt terminal is black/white
* setting COLORTERM to NO in ~/.profile.preinit actually works
* root's path does not include /usr/games any more
* EDITOR is now always ed(1) unless defined otherwise in ~/.profile;
  jstar/jupp is no longer probed
* for ksh(1), set -o emacs +o emacs-usemeta is no longer performed,
  because mksh(1) defaults to these and ksh(1) is being phased out
* for bash(1), set -o emacs and shopt -s extglob are now default
* ash(1) and similar now can be recognised by the prompt
* a lot less variables cluttering the environmental space
* loadimage() is gone, please add it to your ~/.profile if desired
* Lretrocfg now accepts $SUDO to read /bsd
* Lretrocfg handles stdin by passing -
* sshagent_autostart now *must* use numerical UIDs, update your
  /etc/rc.conf.local accordingly
* /etc/profile.local and ~/.profile.local are no longer sourced
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.4 2005/06/26 17:09:32 tg Exp $
d3 2
d7 1
a7 3
[ -z "$KSH_VERSION" ] && alias print='echo -e'
umask 022
[ -z "$TERM" ] && if test -x /usr/bin/tset; then
d53 8
a60 9
	[[ ${COLUMNS:-1} -le 1 ]] && export COLUMNS=80
	[[ -n $USER ]] && \
	    PS1='${USER}@@'"$HOSTNAME"':$(
		local _PWD_TEMP="$PWD";
		local _PWD_TEMP2=
		while (( (${#_PWD_TEMP2} + ${#_PWD_TEMP}) > (COLUMNS / 3))); do
			if [[ $_PWD_TEMP = *@@(/)* ]]; then
				_PWD_TEMP2=".../"
				_PWD_TEMP="${_PWD_TEMP#*/}";
d62 2
a63 2
				_PWD_TEMP2="..."
				_PWD_TEMP="${_PWD_TEMP#?????}";
d66 4
a69 2
		print "${_PWD_TEMP2}${_PWD_TEMP}"
	    )'" $PSX"
@


1.4
log
@less(1) is definitely the pager
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.3 2005/06/26 16:57:12 tg Exp $
d5 1
a5 1
[ -n "$BASH_VERSION" ] && alias print='echo -e'
d8 3
a10 6
	MIROS=$(ulimit -c 0; /usr/bin/tset -sQ \?vt220)
	if [ -z "$MIROS" ]; then
		export TERM=vt100
	else
		eval $MIROS
	fi
d12 1
a12 1
	export TERM=vt220
d15 3
d19 1
a19 4
	export COLORTERM=1
	;;
*:NO|vt*)
	unset COLORTERM
a22 6
if [ -x /usr/bin/id ]; then
	USER_ID="$(ulimit -c 0; /usr/bin/id -u 2>/dev/null)"
	[ -z "$USER_ID" ] && USER_ID=0
else
	USER_ID=0
fi
d24 5
a28 1
export USER_ID HOME
d30 2
a31 1
	export PATH=/sbin:/bin:/usr/sbin:/usr/bin:/root/.etc/bin:/usr/local/bin
d34 1
a34 1
	export PATH=/root/.etc/bin:/usr/sbin:/sbin:/usr/bin:/bin:/usr/X11R6/bin:/usr/local/bin:/usr/games
d36 2
a37 1
	export PATH=~/.etc/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/X11R6/bin:/usr/local/bin:/usr/games
d39 5
a43 5
export PS1='SINGLE:${PWD} # '
export CVSUMASK=002 BROWSER=/usr/bin/lynx PAGER=/usr/bin/less
#export IRCSERVER=irc.66h.42h.de
export IRCSERVER=irc.holarse.de		# IPv4 only XXX bugbug
export IRCNAME="MirOS packages a kernel, userland and the attitude"
d45 4
d50 2
a51 7
export HOSTNAME="${HOSTNAME:-noFQDN}" OSNAME="${OSNAME:-unknown}"
EDITOR="$(whence -p jupp 2>/dev/null)" || \
    EDITOR="$(whence -p jstar 2>/dev/null)" || \
    EDITOR=/usr/local/bin/jupp
[ -x "$EDITOR" ] || EDITOR=ed; export EDITOR
MIROS=
[ "$OSTYPE" = "linux-gnu" -o "$OSTYPE" = "Linux" ] && MIROS="-linux"
a52 1
	set +o sh +o vi +o posix
d54 15
a68 13
	[ -n "$USER" ] && \
	    PS1='${USER}@@'"${HOSTNAME}"':$(local _PWD_TEMP="$PWD";
	    local _PWD_TEMP2=
	    while (( (${#_PWD_TEMP2} + ${#_PWD_TEMP}) > (COLUMNS / 3))); do
		if [[ $_PWD_TEMP = *@@(/)* ]]; then
			_PWD_TEMP2=".../"
			_PWD_TEMP="${_PWD_TEMP#*/}";
		else
			_PWD_TEMP2="..."
			_PWD_TEMP="${_PWD_TEMP#?????}";
		fi; done;
	    print "${_PWD_TEMP2}${_PWD_TEMP}")'"$(if [ $USER_ID -eq 0 ]; then
	    print ' # '; else print ' $ '; fi)"
a69 1
	export PS1 MIROS=ksh$MIROS
d71 6
a76 3
	[ x"$TERM" = x"screen" ] && \
		export X_COLOUR="${X_COLOUR}"'[5;34;40m\]screen:\[[0m'
	if [ "$OSTYPE" = "linux-gnu" -o "$OSTYPE" = "Linux" ]; then
d80 1
d84 1
a84 2
	[ -n "$NOCOLOURPROMPT" ] && PS1=${MIROS}':\u@@\h:\w \$ '
	export PS1 MIROS=bash$MIROS
d86 1
a86 1
	export MIROS=ash$MIROS
d88 4
d96 2
a97 2
alias cls='print -n \\033c'
function bye		# cu ;-)
a126 10
function loadimage	# call xloadimage by URI
{
	for fi in "$@@"; do
		if [ -e "$fi" ]; then
			xloadimage "$fi"
		else
			ftp -mo - "$fi" | xloadimage stdin
		fi
	done
}
d140 1
a140 1
	strings -n4 ${1:-/bsd} | sed -n 's/^=CF=//p'
d142 2
a143 7
[ -x /emul/linux/bin/bash ] && alias lx='/emul/linux/bin/bash --login'
unset HISTFILE
set -o emacs
set +o emacs-usemeta 2>/dev/null
USER_NAME=_nonexistent
[ -x /usr/bin/id ] && USER_NAME=$(id -un 2>/dev/null)
if [ -O /tmp/.ssh-agent/$USER_NAME ]; then
d145 2
a146 2
	[ ! -e /tmp/.ssh-agent/$USER_NAME/socket ] \
	    && rm -f /tmp/.ssh-agent/$USER_NAME/{agent,keyread}
d148 3
a150 3
	if [ ! -e /tmp/.ssh-agent/$USER_NAME/agent ]; then
		ssh-agent -s -a /tmp/.ssh-agent/$USER_NAME/socket \
		    >/tmp/.ssh-agent/$USER_NAME/agent
d153 1
a153 1
	if [ -e /tmp/.ssh-agent/$USER_NAME/socket ]; then
d155 2
a156 2
		[ -e /tmp/.ssh-agent/$USER_NAME/agent ] \
		    && . /tmp/.ssh-agent/$USER_NAME/agent >&2
d158 1
a158 1
		if [ ! -e /tmp/.ssh-agent/$USER_NAME/keyread ]; then
d160 1
a160 1
			touch /tmp/.ssh-agent/$USER_NAME/keyread
a163 4
unset USER_NAME NOSETPATH

[ -f /etc/profile.local ] && . /etc/profile.local
[ -f ~/.profile.local ] && . ~/.profile.local
@


1.3
log
@irc.66h.42h.de is our preferred server
however, use irc.holarse.de for now, looks like a bug
(no route to host doesn't retry with v4) in sirc to me
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.2 2005/05/06 17:37:33 tg Exp $
d43 1
a43 1
export CVSUMASK=002 BROWSER=/usr/bin/lynx
@


1.2
log
@don't default $PAGER because pkg_add behaves differently then
@
text
@d1 1
a1 1
# $MirOS: src/etc/profile,v 1.1.7.1 2005/03/06 16:33:39 tg Exp $
d44 2
a45 1
export IRCSERVER=irc6.oftc.net
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $MirOS$
d43 1
a43 1
export CVSUMASK=002
a48 1
export PAGER=less BROWSER=lynx
@


1.1.7.1
log
@Add some missing files, such as some ISDN4BSD stuff,
documentation, tmac and tab files, TAI64 etc.
@
text
@@
