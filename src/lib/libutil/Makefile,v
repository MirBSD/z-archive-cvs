head	1.6;
access;
symbols
	MIRBSD_10:1.5.0.2
	MIRBSD_10_BASE:1.5
	MIRBSD_9_BASE:1.3
	MIRBSD_8:1.3.0.2
	MIRBSD_8_BASE:1.3
	cvs-200507211800:1.1.1.2
	openbsd:1.1.1;
locks; strict;
comment	@# @;


1.6
date	2010.01.07.22.34.55;	author tg;	state Exp;
branches;
next	1.5;
commitid	1004B46615B7479BC1B;

1.5
date	2007.06.21.14.40.19;	author tg;	state Exp;
branches;
next	1.4;
commitid	100467A8D2C4D7EEFFE;

1.4
date	2007.05.17.18.38.35;	author tg;	state Exp;
branches;
next	1.3;
commitid	100464CA0BC3310E768;

1.3
date	2005.10.21.11.02.57;	author tg;	state Exp;
branches;
next	1.2;
commitid	6c0b4358cac0ef88;

1.2
date	2005.03.06.20.29.37;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.02.05.17.26.15;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.02.05.17.26.15;	author tg;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2005.07.21.20.56.28;	author tg;	state Exp;
branches;
next	;
commitid	560042e0092f571e;


desc
@@


1.6
log
@facilitate code and data sharing: move some passwd(8) functions
sources by other stuff into libc or libutil; make commons out of
things like digits, base64 data or code, etc. (publish the data
parts as well, justin case) plus do some const cleanup
@
text
@# $MirOS: src/lib/libutil/Makefile,v 1.5 2007/06/21 14:40:19 tg Exp $
# $OpenBSD: Makefile,v 1.28 2004/07/13 21:09:48 millert Exp $
# $NetBSD: Makefile,v 1.8 1996/05/16 07:03:28 thorpej Exp $

SHLIB_VERSION?=	14.1
LIB=		util
CPPFLAGS+=	-DLIBC_SCCS

HDRS=	util.h
SRCS=	check_expire.c getmaxpartitions.c getrawpartition.c login.c \
	login_tty.c logout.c logwtmp.c opendev.c passwd.c pty.c readlabel.c \
	login_fbtab.c uucplock.c fparseln.c opendisk.c pidfile.c \
	fmt_scaled.c local_passwd.c pwd_check.c

MAN=	check_expire.3 getmaxpartitions.3 getrawpartition.3 login.3 opendev.3 \
	openpty.3 pw_init.3 pw_lock.3 readlabelfs.3 uucplock.3 \
	fparseln.3 opendisk.3 login_fbtab.3 pidfile.3 fmt_scaled.3

MLINKS+=login.3 logout.3
MLINKS+=login.3 logwtmp.3
MLINKS+=check_expire.3 login_check_expire.3
MLINKS+=openpty.3 login_tty.3
MLINKS+=openpty.3 forkpty.3
MLINKS+=pw_init.3 pw_setdir.3
MLINKS+=pw_init.3 pw_file.3
MLINKS+=pw_init.3 pw_edit.3
MLINKS+=pw_init.3 pw_prompt.3
MLINKS+=pw_init.3 pw_copy.3
MLINKS+=pw_init.3 pw_scan.3
MLINKS+=pw_init.3 pw_error.3
MLINKS+=pw_lock.3 pw_mkdb.3
MLINKS+=pw_lock.3 pw_abort.3
MLINKS+=uucplock.3 uu_lock.3
MLINKS+=uucplock.3 uu_unlock.3
MLINKS+=uucplock.3 uu_lockerr.3
MLINKS+=uucplock.3 uu_lock_txfr.3
MLINKS+=fmt_scaled.3 scan_scaled.3

.include <bsd.lib.mk>
@


1.5
log
@• libedit, libm, libocurses, libsectok, libskey, libssl, libusbhid, libutil:
  do something I should've long done and bump their majors – ABI changes are
  not only removals (or changes) of T/D symbols but also additions(!) of U
  symbols (i.e. imports); these changed during the <ctype.h> changes from a
  while ago and depend on newer libc; I did an nm(1) comparision against #9
  (release) to allow upgrading by source
• libc, uname: since I'm bumping a lot of other shlibs, it's a good time to
  bump the libc major as well and finally get rid of that struct utsname bug
  I introduced when I had no idea what I was doing, in MirOS #1 or so…
• libpthread: requires a major bump if libc major is bumped, or so they say
• bump os patchlevel

agreed bsiegert@@
XXX any more changes to do before release?
@
text
@d1 1
a1 1
# $MirOS: src/lib/libutil/Makefile,v 1.4 2007/05/17 18:38:35 tg Exp $
d5 1
a5 1
SHLIB_VERSION?=	14.0
d13 1
a13 1
	fmt_scaled.c
@


1.4
log
@more includes-target overhaul:
• document it
• do it for <bsd.prog.mk> too
• move it to <bsd.sys.mk>, handle generation by <bsd.subdir.mk>
• add /usr/include/openssl to mtree(8) base system tree file
• have all libs and flex use the generic target
• clean them up; repair a few bugs
@
text
@d1 1
a1 1
# $MirOS: src/lib/libutil/Makefile,v 1.3 2005/10/21 11:02:57 tg Exp $
d5 1
a5 1
SHLIB_VERSION?=	13.0
@


1.3
log
@* merge bin and lib completely
* convert some ancient RCSID styles etc. to more modern stuff
* fix use of CDIAGFLAGS+=, CFLAGS+= and COPTS+= to the correct
  variant (include bsd.own.mk _then_ COPTS+=) so they're added
  after any user-specified flags
  (this is probably lurking in more places than I can imagine)
* fix some indenting, comments, etc.
* make stuff compile (fix warnings/errors)
* add script to review _all_ shlib_version after an openbsd import
* remove two more obsolete /usr/lib/debug/ references
* bin/ps: comment out some SMP code
@
text
@d1 1
a1 1
# $MirOS: src/lib/libutil/Makefile,v 1.2 2005/03/06 20:29:37 tg Exp $
a38 9
includes:
	@@cd ${.CURDIR}; for i in $(HDRS); do \
	    j="cmp -s $$i ${DESTDIR}/usr/include/$$i || \
		${INSTALL} ${INSTALL_COPY} -o ${BINOWN} -g ${BINGRP} -m 444 $$i \
		${DESTDIR}/usr/include"; \
	    echo $$j; \
	    eval "$$j"; \
	done

@


1.2
log
@merge src/lib
@
text
@d1 2
a2 2
# $MirOS$
# $OpenBSD: Makefile,v 1.27 2003/07/23 23:10:25 deraadt Exp $
d5 1
a5 1
SHLIB_VERSION?=	12.0
d16 2
a17 3
	openpty.3 pw_init.3 pw_lock.3 readlabelfs.3 pw_getconf.3 \
	uucplock.3 fparseln.3 opendisk.3 login_fbtab.3 pidfile.3 \
	fmt_scaled.3
@


1.1
log
@Initial revision
@
text
@d1 7
a7 5
#	$OpenBSD: Makefile,v 1.27 2003/07/23 23:10:25 deraadt Exp $
#	$NetBSD: Makefile,v 1.8 1996/05/16 07:03:28 thorpej Exp $

LIB=	util
CFLAGS+=-DLIBC_SCCS
@


1.1.1.1
log
@Import the OpenBSD foundation of MirOS BSD
@
text
@@


1.1.1.2
log
@Import almost everything (no ancontrol, ifconfig, pfctl, wicontrol)
of (the undeleted parts of) OpenBSD-current's userland of about 3 hours ago.
Warning: this introduces major breakage!
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.28 2004/07/13 21:09:48 millert Exp $
d14 3
a16 2
	openpty.3 pw_init.3 pw_lock.3 readlabelfs.3 uucplock.3 \
	fparseln.3 opendisk.3 login_fbtab.3 pidfile.3 fmt_scaled.3
@

