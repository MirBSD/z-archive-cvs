head	1.16;
access;
symbols
	MIRBSD_10:1.9.0.2
	MIRBSD_10_BASE:1.9
	MIRBSD_9_BASE:1.4
	MIRBSD_8:1.3.0.2
	MIRBSD_8_BASE:1.3
	mirbsd:1.1.7;
locks; strict;
comment	@# @;


1.16
date	2017.04.15.15.26.44;	author tg;	state Exp;
branches;
next	1.15;
commitid	10058F23BCC5ED04858;

1.15
date	2013.08.06.18.49.25;	author tg;	state Exp;
branches;
next	1.14;
commitid	1005201454765C5CF06;

1.14
date	2013.08.06.17.06.23;	author tg;	state Exp;
branches;
next	1.13;
commitid	10052012D144F7753C5;

1.13
date	2013.08.05.22.06.12;	author tg;	state Exp;
branches;
next	1.12;
commitid	100520021D16E80D23B;

1.12
date	2009.03.15.20.08.43;	author tg;	state Exp;
branches;
next	1.11;
commitid	10049BD605834002F74;

1.11
date	2008.10.22.19.11.48;	author tg;	state Exp;
branches;
next	1.10;
commitid	10048FF7AEF54F9B169;

1.10
date	2008.03.23.17.54.52;	author tg;	state Exp;
branches;
next	1.9;
commitid	10047E6997C6BB35CA9;

1.9
date	2007.07.05.22.18.13;	author tg;	state Exp;
branches;
next	1.8;
commitid	100468D6E281DB5974F;

1.8
date	2007.05.22.20.16.55;	author tg;	state Exp;
branches;
next	1.7;
commitid	10046534FC40047F72A;

1.7
date	2007.05.17.18.38.34;	author tg;	state Exp;
branches;
next	1.6;
commitid	100464CA0BC3310E768;

1.6
date	2007.05.08.21.52.54;	author tg;	state Exp;
branches;
next	1.5;
commitid	1004640F14A456E3051;

1.5
date	2006.06.29.17.14.22;	author tg;	state Exp;
branches;
next	1.4;
commitid	10044A40A7D396C3456;

1.4
date	2006.06.09.00.30.26;	author tg;	state Exp;
branches;
next	1.3;
commitid	1004488C1225295157F;

1.3
date	2005.10.21.11.02.51;	author tg;	state Exp;
branches;
next	1.2;
commitid	6c0b4358cac0ef88;

1.2
date	2005.04.22.21.57.08;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.03.06.16.33.39;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.03.06.16.33.39;	author tg;	state Exp;
branches;
next	;


desc
@@


1.16
log
@a rather slow fastmerge…
@
text
@# $MirOS: src/lib/libpng/Makefile,v 1.15 2013/08/06 18:49:25 tg Exp $

SHLIB_VERSION?= 10.1
LIB=		png
SRCS=		png.c pngerror.c pngget.c pngmem.c pngpread.c \
		pngread.c pngrio.c pngrtran.c pngrutil.c pngset.c \
		pngtrans.c pngwio.c pngwrite.c pngwtran.c pngwutil.c
DPADD+=		${LIBM} ${LIBZ}
LDADD+=		-lm -lz
MAN=		libpng.3 libpngpf.3 png.5
HDRS=		png.h pngconf.h

.include <bsd.own.mk>
COPTS+=		-Wall
CPPFLAGS+=	-DPNG_PEDANTIC_WARNINGS
CPPFLAGS+=	-DPNG_DEPRECATED= -DPNG_DEPSTRUCT= -DPNG_PRIVATE=

afterinstall:
	${INSTALL} ${INSTALL_COPY} -o ${BINOWN} -g ${BINGRP} -m ${NONBINMODE} \
	    ${.CURDIR}/libpng.pc ${DESTDIR}/usr/libdata/pkgconfig/

.include <bsd.lib.mk>
@


1.15
log
@merge, rebase/minify, fix
@
text
@d1 1
a1 1
# $MirOS: src/lib/libpng/Makefile,v 1.14 2013/08/06 17:06:23 tg Exp $
d3 1
a3 1
SHLIB_VERSION?= 10.0
@


1.14
log
@get rid of the now useless ZLIB_CONST
@
text
@d1 1
a1 1
# $MirOS: src/lib/libpng/Makefile,v 1.13 2013/08/05 22:06:12 tg Exp $
d3 1
a3 1
SHLIB_VERSION?= 9.1
d15 2
a16 3

# broken API
CFLAGS_png.o+=	-Wno-cast-qual
@


1.13
log
@-DZCONST=const → -DZLIB_CONST

XXX sys/conf/Makefile.inc does it twice?
@
text
@d1 1
a1 1
# $MirOS: src/lib/libpng/Makefile,v 1.12 2009/03/15 20:08:43 tg Exp $
a14 1
CPPFLAGS+=	-DZLIB_CONST
@


1.12
log
@SECURITY update; prodded by bsiegert@@
@
text
@d1 1
a1 1
# $MirOS: src/lib/libpng/Makefile,v 1.11 2008/10/22 19:11:48 tg Exp $
d15 1
a15 1
CPPFLAGS+=	-DZCONST=const
@


1.11
log
@merge libpng upgrade

major version bump because function signature of png_decompress_chunk
changed (return value to void)
@
text
@d1 1
a1 1
# $MirOS: src/lib/libpng/Makefile,v 1.10 2008/03/23 17:54:52 tg Exp $
d3 1
a3 1
SHLIB_VERSION?= 9.0
@


1.10
log
@merge and fix for __CRAZY=Yes
@
text
@d1 1
a1 1
# $MirOS: src/lib/libpng/Makefile,v 1.9 2007/07/05 22:18:13 tg Exp $
d3 1
a3 1
SHLIB_VERSION?= 8.0
@


1.9
log
@move /usr/share/pkgconfig/ -> /usr/libdata/pkgconfig/
by suggestion of bsiegert@@
@
text
@d1 1
a1 1
# $MirOS: src/lib/libpng/Makefile,v 1.8 2007/05/22 20:16:55 tg Exp $
d3 1
a3 1
SHLIB_VERSION?= 7.1
d15 4
a18 1
CPPFLAGS+=	-DPNG_NO_ASSEMBLER_CODE -DZCONST=const
@


1.8
log
@add a pkg-config data file for the in-tree libpng, too
@
text
@d1 1
a1 1
# $MirOS: src/lib/libpng/Makefile,v 1.7 2007/05/17 18:38:34 tg Exp $
d19 1
a19 1
	    ${.CURDIR}/libpng.pc ${DESTDIR}/usr/share/pkgconfig/
@


1.7
log
@more includes-target overhaul:
• document it
• do it for <bsd.prog.mk> too
• move it to <bsd.sys.mk>, handle generation by <bsd.subdir.mk>
• add /usr/include/openssl to mtree(8) base system tree file
• have all libs and flex use the generic target
• clean them up; repair a few bugs
@
text
@d1 1
a1 1
# $MirOS: src/lib/libpng/Makefile,v 1.6 2007/05/08 21:52:54 tg Exp $
d17 4
@


1.6
log
@ZCONST
@
text
@d1 1
a1 1
# $MirOS: src/lib/libpng/Makefile,v 1.5 2006/06/29 17:14:22 tg Exp $
d11 1
a11 1
INCS=		png.h pngconf.h
a16 8
includes:
.for _i in ${INCS}
	cd ${.CURDIR}; cmp -s ${_i} ${DESTDIR}/usr/include/${_i} \
	    >/dev/null 2>&1 || ${INSTALL} ${INSTALL_COPY} \
	    -o ${BINOWN} -g ${BINGRP} -m ${NONBINMODE} \
	    ${_i} ${DESTDIR}/usr/include/
.endfor

@


1.5
log
@merge libpng-1.2.12
@
text
@d1 1
a1 1
# $MirOS: src/lib/libpng/Makefile,v 1.4 2006/06/09 00:30:26 tg Exp $
d15 1
a15 1
CPPFLAGS+=	-DPNG_NO_ASSEMBLER_CODE
@


1.4
log
@sync, fix CPPFLAGS
no shlib vsn change (only change local data->rodata, no external syms)
@
text
@d1 1
a1 1
# $MirOS: src/lib/libpng/Makefile,v 1.3 2005/10/21 11:02:51 tg Exp $
d3 1
a3 1
SHLIB_VERSION?= 7.0
@


1.3
log
@* merge bin and lib completely
* convert some ancient RCSID styles etc. to more modern stuff
* fix use of CDIAGFLAGS+=, CFLAGS+= and COPTS+= to the correct
  variant (include bsd.own.mk _then_ COPTS+=) so they're added
  after any user-specified flags
  (this is probably lurking in more places than I can imagine)
* fix some indenting, comments, etc.
* make stuff compile (fix warnings/errors)
* add script to review _all_ shlib_version after an openbsd import
* remove two more obsolete /usr/lib/debug/ references
* bin/ps: comment out some SMP code
@
text
@d1 1
a1 1
# $MirOS: src/lib/libpng/Makefile,v 1.2 2005/04/22 21:57:08 tg Exp $
d15 1
a15 1
CPPFLAGS+=	-DPNG_NO_ASSEMBLER_CODE -DPNG_USE_PNGGCCRD
@


1.2
log
@do a DT_NEEDED, bump major to 7.0 to be in sync with MirPorts

"why don't we do that then?" bsiegert@@
@
text
@d1 1
a1 1
# $MirOS: src/lib/libpng/Makefile,v 1.1.7.1 2005/03/06 16:33:39 tg Exp $
d13 2
a14 1
CFLAGS+=	-Wall
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $MirOS$
d3 1
a3 1
SHLIB_VERSION?= 6.0
d8 2
@


1.1.7.1
log
@Add some missing files, such as some ISDN4BSD stuff,
documentation, tmac and tab files, TAI64 etc.
@
text
@@
