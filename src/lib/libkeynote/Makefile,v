head	1.5;
access;
symbols
	MIRBSD_10:1.5.0.2
	MIRBSD_10_BASE:1.5
	MIRBSD_9_BASE:1.3
	MIRBSD_8:1.3.0.2
	MIRBSD_8_BASE:1.3
	cvs-200507211800:1.1.1.2
	openbsd:1.1.1;
locks; strict;
comment	@# @;


1.5
date	2007.05.17.18.38.32;	author tg;	state Exp;
branches;
next	1.4;
commitid	100464CA0BC3310E768;

1.4
date	2007.04.28.00.12.44;	author tg;	state Exp;
branches;
next	1.3;
commitid	1004632918E6CE6474D;

1.3
date	2005.10.21.11.02.45;	author tg;	state Exp;
branches;
next	1.2;
commitid	6c0b4358cac0ef88;

1.2
date	2005.03.06.20.29.07;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.02.05.17.25.14;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.02.05.17.25.14;	author tg;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2005.07.21.20.53.57;	author tg;	state Exp;
branches;
next	;
commitid	560042e0092f571e;


desc
@@


1.5
log
@more includes-target overhaul:
• document it
• do it for <bsd.prog.mk> too
• move it to <bsd.sys.mk>, handle generation by <bsd.subdir.mk>
• add /usr/include/openssl to mtree(8) base system tree file
• have all libs and flex use the generic target
• clean them up; repair a few bugs
@
text
@# $MirOS: src/lib/libkeynote/Makefile,v 1.4 2007/04/28 00:12:44 tg Exp $
# $OpenBSD: Makefile,v 1.15 2004/06/25 05:06:49 msf Exp $

LIB=	keynote
MAN=	keynote.3 keynote.4 keynote.5
MLINKS=	keynote.3 kn_init.3 keynote.3 kn_add_assertion.3 \
        keynote.3 kn_remove_assertion.3 keynote.3 kn_add_action.3 \
        keynote.3 kn_remove_action.3 keynote.3 kn_add_authorizer.3 \
        keynote.3 kn_remove_authorizer.3 keynote.3 kn_do_query.3 \
        keynote.3 kn_get_failed.3 keynote.3 kn_cleanup_action_environment.3 \
        keynote.3 kn_close.3 keynote.3 kn_query.3 keynote.3 \
        kn_read_asserts.3 keynote.3 kn_keycompare.3 keynote.3 \
        kn_get_authorizer.3 keynote.3 kn_get_licensees.3 keynote.3 \
        kn_encode_base64.3 keynote.3 kn_decode_base64.3 keynote.3 \
        kn_encode_hex.3 keynote.3 kn_decode_hex.3 keynote.3 \
        kn_encode_key.3 keynote.3 kn_decode_key.3 keynote.3 \
        kn_sign_assertion.3 keynote.3 kn_verify_assertion.3 \
	keynote.3 kn_free_key.3 keynote.3 kn_get_string.3
NOPIC=		yes
.include <bsd.own.mk>
COPTS+=		-Wall
CPPFLAGS+=	-I.
LFLAGS=		-Cr -Pkn -s -i
YFLAGS=		-d -p kn -b k

HDRS=	keynote.h
SRCS=	k.tab.c lex.kn.c environment.c parse_assertion.c signature.c auxil.c \
	base64.c

CLEANFILES+=	k.tab.c k.tab.h lex.kn.c

k.tab.c: keynote.y keynote.h signature.h
	${YACC.y} ${.CURDIR}/keynote.y

lex.kn.c: keynote.l keynote.y keynote.h assertion.h signature.h
	${LEX.l} ${.CURDIR}/keynote.l

.include <bsd.lib.mk>
@


1.4
log
@more lex/yacc overhaul, tentatively
@
text
@d1 1
a1 1
# $MirOS: src/lib/libkeynote/Makefile,v 1.3 2005/10/21 11:02:45 tg Exp $
a37 9
includes:
	@@@@cd ${.CURDIR}; for i in $(HDRS); do \
	    j="cmp -s $$i ${DESTDIR}/usr/include/$$i || \
		${INSTALL} ${INSTALL_COPY} -o ${BINOWN} -g ${BINGRP} -m 444 \
		$$i ${DESTDIR}/usr/include"; \
	    echo $$j; \
	    eval "$$j"; \
	done

@


1.3
log
@* merge bin and lib completely
* convert some ancient RCSID styles etc. to more modern stuff
* fix use of CDIAGFLAGS+=, CFLAGS+= and COPTS+= to the correct
  variant (include bsd.own.mk _then_ COPTS+=) so they're added
  after any user-specified flags
  (this is probably lurking in more places than I can imagine)
* fix some indenting, comments, etc.
* make stuff compile (fix warnings/errors)
* add script to review _all_ shlib_version after an openbsd import
* remove two more obsolete /usr/lib/debug/ references
* bin/ps: comment out some SMP code
@
text
@d1 1
a1 1
# $MirOS: src/lib/libkeynote/Makefile,v 1.2 2005/03/06 20:29:07 tg Exp $
d23 2
a24 2
LEXFLAGS=	-Cr -Pkn -s -i
YACCFLAGS=	-d -p kn -b k
d30 1
a30 1
CLEANFILES+= k.tab.c lex.kn.c k.tab.h
d33 1
a33 1
	$(YACC.y) $(YACCFLAGS) ${.CURDIR}/keynote.y
d36 1
a36 1
	$(LEX.l) $(LEXFLAGS) ${.CURDIR}/keynote.l
@


1.2
log
@merge src/lib
@
text
@d1 2
a2 2
# $MirOS$
# $OpenBSD: Makefile,v 1.14 2000/05/18 08:35:36 angelos Exp $
d19 6
a24 5
NOPIC=	yes
CFLAGS+= -Wall
CPPFLAGS+= -DCRYPTO -DHAVE_CONFIG_H -I.
LEXFLAGS = -Cr -Pkn -s -i
YACCFLAGS = -d -p kn -b k
@


1.1
log
@Initial revision
@
text
@d1 2
a2 1
#	$OpenBSD: Makefile,v 1.14 2000/05/18 08:35:36 angelos Exp $
d19 3
a21 2
NOPIC=	
CFLAGS+= -Wall -DCRYPTO -DHAVE_CONFIG_H -I. -I${.CURDIR}
@


1.1.1.1
log
@Import the OpenBSD foundation of MirOS BSD
@
text
@@


1.1.1.2
log
@Import almost everything (no ancontrol, ifconfig, pfctl, wicontrol)
of (the undeleted parts of) OpenBSD-current's userland of about 3 hours ago.
Warning: this introduces major breakage!
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.15 2004/06/25 05:06:49 msf Exp $
d19 1
a19 1
CFLAGS+= -Wall -I. -I${.CURDIR}
@

