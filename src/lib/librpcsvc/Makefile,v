head	1.3;
access;
symbols
	MIRBSD_10:1.3.0.2
	MIRBSD_10_BASE:1.3
	MIRBSD_9_BASE:1.2
	MIRBSD_8:1.2.0.2
	MIRBSD_8_BASE:1.2
	cvs-200507211800:1.1.1.1
	openbsd:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2007.05.17.18.38.34;	author tg;	state Exp;
branches;
next	1.2;
commitid	100464CA0BC3310E768;

1.2
date	2005.03.06.20.29.22;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.02.05.17.25.32;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.02.05.17.25.32;	author tg;	state Exp;
branches;
next	;


desc
@@


1.3
log
@more includes-target overhaul:
• document it
• do it for <bsd.prog.mk> too
• move it to <bsd.sys.mk>, handle generation by <bsd.subdir.mk>
• add /usr/include/openssl to mtree(8) base system tree file
• have all libs and flex use the generic target
• clean them up; repair a few bugs
@
text
@# $MirOS: src/lib/librpcsvc/Makefile,v 1.2 2005/03/06 20:29:22 tg Exp $
# $OpenBSD: Makefile,v 1.7 2003/06/23 18:50:53 mickey Exp $

RPCSRCS=	bootparam_prot.x klm_prot.x mount.x nfs_prot.x \
		nlm_prot.x rex.x rnusers.x rusers.x rquota.x rstat.x rwall.x \
		sm_inter.x spray.x
SRCS=		${RPCSRCS:R:S/$/.c/g}
CLEANFILES+=	${SRCS} ${RPCSRCS:R:S/$/.h/g}

LIB=		rpcsvc
NOMAN=		yes
NOPIC=		yes

all:		${RPCSRCS:R:S/$/.h/g}
beforedepend:	${RPCSRCS:R:S/$/.h/g}
prereq:		${RPCSRCS:R:S/$/.h/g}

HDRDST=		${DESTDIR}/usr/include/rpcsvc
HDRS=		${RPCSRCS} ${RPCSRCS:R:S/$/.h/g:S!^!${.OBJDIR}/!}

# new suffixes have to go afterwards, because bsd.lib.mk clears them
.include <bsd.lib.mk>
.SUFFIXES: .x .c .h

.x.c:
	rpcgen -C -c ${.IMPSRC} -o ${.TARGET}

.x.h:
	rpcgen -C -h ${.IMPSRC} -o ${.TARGET}
@


1.2
log
@merge src/lib
@
text
@d1 1
a1 1
# $MirOS$
d8 1
a8 2
HDRS=           ${RPCSRCS:R:S/$/.h/g}
CLEANFILES+=	${SRCS} ${HDRS}
d14 6
a19 20
all:		${HDRS}
beforedepend:	${HDRS}
prereq:		${HDRS}

includes:	${HDRS}
	${INSTALL} -d -o ${BINOWN} -g ${BINGRP} -m 755 \
		${DESTDIR}/usr/include/rpcsvc
	@@echo installing rpc .h and .x files
	@@(cd ${.CURDIR}; for i in $(RPCSRCS); do \
	    cmp -s $(.CURDIR)/$$i ${DESTDIR}/usr/include/rpcsvc/$$i || \
		{ j="${INSTALL} ${INSTALL_COPY} -o ${BINOWN} -g ${BINGRP} -m 444 $$i \
		${DESTDIR}/usr/include/rpcsvc"; \
		echo $$j; $$j; } \
	done)
	@@sleep 1; for i in $(HDRS); do \
	    cmp -s $$i ${DESTDIR}/usr/include/rpcsvc/$$i || \
		{ j="${INSTALL} ${INSTALL_COPY} -o ${BINOWN} -g ${BINGRP} -m 444 $$i \
		${DESTDIR}/usr/include/rpcsvc"; \
		echo $$j; $$j; } \
	done
@


1.1
log
@Initial revision
@
text
@d1 2
a2 2
#	$OpenBSD: Makefile,v 1.7 2003/06/23 18:50:53 mickey Exp $

d6 1
a6 1
		sm_inter.x spray.x yp.x yppasswd.x
d12 2
a13 2
NOMAN=
NOPIC=
d17 1
@


1.1.1.1
log
@Import the OpenBSD foundation of MirOS BSD
@
text
@@
