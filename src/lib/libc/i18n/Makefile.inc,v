head	1.38;
access;
symbols
	MIRBSD_10:1.26.0.2
	MIRBSD_10_BASE:1.26
	MIRBSD_9_BASE:1.19
	MIRBSD_8:1.7.0.2
	MIRBSD_8_BASE:1.7;
locks; strict;
comment	@# @;


1.38
date	2014.02.19.16.59.30;	author tg;	state Exp;
branches;
next	1.37;
commitid	1005304E30900931FDD;

1.37
date	2011.10.16.20.54.57;	author tg;	state Exp;
branches;
next	1.36;
commitid	1004E9B44886C295CB9;

1.36
date	2008.11.30.13.34.56;	author tg;	state Exp;
branches;
next	1.35;
commitid	10049329697676B60B9;

1.35
date	2008.11.30.13.20.38;	author tg;	state Exp;
branches;
next	1.34;
commitid	1004932932F74A83D24;

1.34
date	2008.11.22.14.14.19;	author tg;	state Exp;
branches;
next	1.33;
commitid	100492813C86CB73B13;

1.33
date	2008.11.22.14.00.50;	author tg;	state Exp;
branches;
next	1.32;
commitid	1004928108117E0B7FB;

1.32
date	2008.11.22.13.51.09;	author tg;	state Exp;
branches;
next	1.31;
commitid	10049280E475B552D73;

1.31
date	2008.11.22.12.56.21;	author tg;	state Exp;
branches;
next	1.30;
commitid	100492801345F76EB54;

1.30
date	2008.11.22.09.02.33;	author tg;	state Exp;
branches;
next	1.29;
commitid	1004927CA84091CE619;

1.29
date	2008.08.17.00.19.08;	author tg;	state Exp;
branches;
next	1.28;
commitid	10048A76D6E14FD6E0B;

1.28
date	2008.08.01.23.24.02;	author tg;	state Exp;
branches;
next	1.27;
commitid	10048939B085B2C5840;

1.27
date	2008.08.01.22.04.56;	author tg;	state Exp;
branches;
next	1.26;
commitid	1004893889978AC31F7;

1.26
date	2007.02.06.15.52.00;	author tg;	state Exp;
branches;
next	1.25;
commitid	10045C8A3FD0635CC8D;

1.25
date	2006.11.21.20.15.31;	author tg;	state Exp;
branches;
next	1.24;
commitid	10045635E587418AB20;

1.24
date	2006.11.21.01.04.09;	author tg;	state Exp;
branches;
next	1.23;
commitid	100456250830E53C5DB;

1.23
date	2006.11.20.23.56.43;	author tg;	state Exp;
branches;
next	1.22;
commitid	100456240C065961156;

1.22
date	2006.11.20.23.50.48;	author tg;	state Exp;
branches;
next	1.21;
commitid	10045623E721D637299;

1.21
date	2006.11.01.19.49.33;	author tg;	state Exp;
branches;
next	1.20;
commitid	1004548F9C65A1BC3D7;

1.20
date	2006.07.03.16.14.42;	author tg;	state Exp;
branches;
next	1.19;
commitid	10044A942475753D29B;

1.19
date	2006.06.03.22.14.51;	author tg;	state Exp;
branches;
next	1.18;
commitid	100448209CA1BB5B72A;

1.18
date	2006.06.02.12.58.52;	author tg;	state Exp;
branches;
next	1.17;
commitid	1004480361F5ADF3731;

1.17
date	2006.06.01.22.55.35;	author tg;	state Exp;
branches;
next	1.16;
commitid	100447F705B5E27FA21;

1.16
date	2006.06.01.22.47.34;	author tg;	state Exp;
branches;
next	1.15;
commitid	100447F6E8C1C87BA83;

1.15
date	2006.06.01.22.42.37;	author tg;	state Exp;
branches;
next	1.14;
commitid	100447F6D124881EFA8;

1.14
date	2006.06.01.22.30.09;	author tg;	state Exp;
branches;
next	1.13;
commitid	100447F6A5E5E5D04C9;

1.13
date	2006.06.01.22.17.20;	author tg;	state Exp;
branches;
next	1.12;
commitid	100447F676243262322;

1.12
date	2006.06.01.22.03.16;	author tg;	state Exp;
branches;
next	1.11;
commitid	100447F641E589322F2;

1.11
date	2006.06.01.21.59.49;	author tg;	state Exp;
branches;
next	1.10;
commitid	100447F635D342911F2;

1.10
date	2006.06.01.21.58.12;	author tg;	state Exp;
branches;
next	1.9;
commitid	100447F62F21BBF9816;

1.9
date	2006.05.26.13.52.06;	author tg;	state Exp;
branches;
next	1.8;
commitid	1004477080477AA6B13;

1.8
date	2006.01.30.13.01.44;	author tg;	state Exp;
branches;
next	1.7;
commitid	10043DE0E35275412D7;

1.7
date	2005.10.11.21.58.33;	author tg;	state Exp;
branches;
next	1.6;
commitid	1617434c35889d09;

1.6
date	2005.09.30.22.13.55;	author tg;	state Exp;
branches;
next	1.5;
commitid	3c62433db87ae478;

1.5
date	2005.09.30.21.45.26;	author tg;	state Exp;
branches;
next	1.4;
commitid	1c3c433db1f25546;

1.4
date	2005.09.22.21.48.02;	author tg;	state Exp;
branches;
next	1.3;
commitid	6bf433326990602;

1.3
date	2005.09.22.21.43.34;	author tg;	state Exp;
branches;
next	1.2;
commitid	7413433325976a18;

1.2
date	2005.09.22.21.39.21;	author tg;	state Exp;
branches;
next	1.1;
commitid	7f1943332498cd25;

1.1
date	2005.09.22.21.21.09;	author tg;	state Exp;
branches;
next	;
commitid	57fb4333204cad7f;


desc
@@


1.38
log
@move some of our custom functions from libc to libmbfun (preparing a libc major bump); drop plan9-like rune functions
@
text
@# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.37 2011/10/16 20:54:57 tg Exp $

.PATH: ${LIBCSRCDIR}/i18n
.PATH: ${LIBCSRCDIR}/locale

CLEANFILES+=	${MIRI18N_GEND}

SRCS+=	${MIRI18N_GEND}
SRCS+=	tbl_att0.c
SRCS+=	tbl_attr.c
SRCS+=	tbl_towl.c
SRCS+=	tbl_towt.c
SRCS+=	tbl_towu.c
SRCS+=	tbl_wnop.c

SRCS+=	catalogues.c
SRCS+=	charsets.c
SRCS+=	langinfo.c
SRCS+=	mbcurmax.c

SRCS+=	btowc.c
SRCS+=	iswctype.c
SRCS+=	mblen.c
SRCS+=	mbrlen.c
SRCS+=	mbrtowc.c
SRCS+=	mbsinit.c
SRCS+=	mbslen.c
SRCS+=	mbsrtowcs.c
SRCS+=	mbstowcs.c
SRCS+=	mbtowc.c
SRCS+=	towctrans.c
SRCS+=	wcsftime.c
SRCS+=	wcsrtombs.c
SRCS+=	wcstombs.c
SRCS+=	wcswidth.c
SRCS+=	wctob.c
SRCS+=	wctomb.c
SRCS+=	wctrans.c
SRCS+=	wctype.c
SRCS+=	wcwidth.c

UIF_NUSRCS+=	mbsnrtowcs.c mbsrtowcs.c -DMBSNRTOWCS
UIF_NUSRCS+=	wcsnrtombs.c wcsrtombs.c -DWCSNRTOMBS

.for _i in alnum alpha blank cntrl digit graph lower print punct space \
    title upper xdigit
MIRI18N_GEND+=	isw${_i}.c

isw${_i}.c: iswTYPE.c
	sed 's!@@@@TYPE@@@@!${_i}!g' <$> >$@@
.endfor

.for _i in lower upper
MIRI18N_GEND+=	tow${_i}.c

tow${_i}.c: towTYPE.c
	sed 's!@@@@TYPE@@@@!${_i}!g' <$> >$@@
.endfor

SRCS+=	towtitle.c

MAN+=	catgets.3
MLINKS+=catgets.3 catopen.3
MLINKS+=catgets.3 catclose.3

# from ../locale/
CPPFLAGS+= -I${LIBCSRCDIR}/locale

SRCS+=	wcstod.c
SRCS+=	wcstol.c
SRCS+=	wcstoll.c
SRCS+=	wcstoul.c
SRCS+=	wcstoull.c

.ifdef __CRAZY
CFLAGS_wcstod.o+=	-Wno-cast-qual
CFLAGS_wcstol.o+=	-Wno-cast-qual
CFLAGS_wcstoll.o+=	-Wno-cast-qual
CFLAGS_wcstoul.o+=	-Wno-cast-qual
CFLAGS_wcstoull.o+=	-Wno-cast-qual
.endif

MAN+=	btowc.3
MAN+=	iswalnum.3
MAN+=	iswctype.3
MAN+=	iswoctet.3
MAN+=	mblen.3
MAN+=	mbrlen.3
MAN+=	mbrtowc.3
MAN+=	mbsinit.3
MAN+=	mbsrtowcs.3
MAN+=	mbstowcs.3
MAN+=	mbtowc.3
MAN+=	nl_langinfo.3
MAN+=	optu8to16.3
MAN+=	setlocale.3
MAN+=	towctrans.3
MAN+=	towlower.3
MAN+=	wcrtomb.3
MAN+=	wcsrtombs.3
MAN+=	wcstombs.3
MAN+=	wctob.3
MAN+=	wctomb.3
MAN+=	wctrans.3
MAN+=	wctype.3
MLINKS+=iswalnum.3 iswalpha.3
MLINKS+=iswalnum.3 iswblank.3
MLINKS+=iswalnum.3 iswcntrl.3
MLINKS+=iswalnum.3 iswdigit.3
MLINKS+=iswalnum.3 iswgraph.3
MLINKS+=iswalnum.3 iswlower.3
MLINKS+=iswalnum.3 iswprint.3
MLINKS+=iswalnum.3 iswpunct.3
MLINKS+=iswalnum.3 iswspace.3
MLINKS+=iswalnum.3 iswupper.3
MLINKS+=iswalnum.3 iswxdigit.3
MLINKS+=setlocale.3 localeconv.3
MLINKS+=towlower.3 towupper.3
MLINKS+=mbsrtowcs.3 mbsnrtowcs.3
MLINKS+=mbsrtowcs.3 mbsnrtowcsvis.3
MLINKS+=optu8to16.3 optu8to16vis.3
MLINKS+=wcrtomb.3 optu16to8.3
MLINKS+=wcsrtombs.3 wcsnrtombs.3

beforedepend: ${MIRI18N_GEND}
@


1.37
log
@fix accidental three-month-but-for-a-day ABI breakage of libc:
cid 1004E2319B430931994 renamed UNIFDEF_SRCS use of kern to not
interfere with users’ use of it, but libc relied on that…
rename these to UIF_NUSRCS which kern guarantees
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.36 2008/11/30 13:34:56 tg Exp $
a30 1
SRCS+=	optu8to16vis.c
a42 1
UIF_NUSRCS+=	mbsnrtowcsvis.c mbsrtowcs.c -DMBSNRTOWCSVIS
a44 42
SRCS+=		ambstowcs.c
SRCS+=		awcstombs.c
UIF_NUSRCS+=	ambsntowcs.c ambstowcs.c -DL_ambsntowcs
UIF_NUSRCS+=	awcsntombs.c awcstombs.c -DL_awcsntombs
MAN+=		ambstowcs.3
MLINKS+=	ambstowcs.3 awcstombs.3
MLINKS+=	ambstowcs.3 ambsntowcs.3
MLINKS+=	ambstowcs.3 awcsntombs.3

# MirOS reimplementation of the Plan 9 rune stuff API
UIF_NUSRCS+=	p9¾_chartorune.c runestuff.c -DL_chartorune
UIF_NUSRCS+=	p9¾_fullrune.c runestuff.c -DL_fullrune
UIF_NUSRCS+=	p9¾_isalpharune.c runestuff.c -DL_isalpharune
UIF_NUSRCS+=	p9¾_islowerrune.c runestuff.c -DL_islowerrune
UIF_NUSRCS+=	p9¾_isspacerune.c runestuff.c -DL_isspacerune
UIF_NUSRCS+=	p9¾_istitlerune.c runestuff.c -DL_istitlerune
UIF_NUSRCS+=	p9¾_isupperrune.c runestuff.c -DL_isupperrune
UIF_NUSRCS+=	p9¾_runelen.c runestuff.c -DL_runelen
UIF_NUSRCS+=	p9¾_runenlen.c runestuff.c -DL_runenlen
UIF_NUSRCS+=	p9¾_runestrcat.c runestuff.c -DL_runestrcat
UIF_NUSRCS+=	p9¾_runestrchr.c runestuff.c -DL_runestrchr
UIF_NUSRCS+=	p9¾_runestrcmp.c runestuff.c -DL_runestrcmp
UIF_NUSRCS+=	p9¾_runestrcpy.c runestuff.c -DL_runestrcpy
UIF_NUSRCS+=	p9¾_runestrdup.c runestuff.c -DL_runestrdup
UIF_NUSRCS+=	p9¾_runestrecpy.c runestuff.c -DL_runestrecpy
UIF_NUSRCS+=	p9¾_runestrlen.c runestuff.c -DL_runestrlen
UIF_NUSRCS+=	p9¾_runestrncat.c runestuff.c -DL_runestrncat
UIF_NUSRCS+=	p9¾_runestrncmp.c runestuff.c -DL_runestrncmp
UIF_NUSRCS+=	p9¾_runestrncpy.c runestuff.c -DL_runestrncpy
UIF_NUSRCS+=	p9¾_runestrrchr.c runestuff.c -DL_runestrrchr
UIF_NUSRCS+=	p9¾_runestrstr.c runestuff.c -DL_runestrstr
UIF_NUSRCS+=	p9¾_runetochar.c runestuff.c -DL_runetochar
UIF_NUSRCS+=	p9¾_tolowerrune.c runestuff.c -DL_tolowerrune
UIF_NUSRCS+=	p9¾_totitlerune.c runestuff.c -DL_totitlerune
UIF_NUSRCS+=	p9¾_toupperrune.c runestuff.c -DL_toupperrune
UIF_NUSRCS+=	p9¾_utfecpy.c runestuff.c -DL_utfecpy
UIF_NUSRCS+=	p9¾_utflen.c runestuff.c -DL_utflen
UIF_NUSRCS+=	p9¾_utfnlen.c runestuff.c -DL_utfnlen
UIF_NUSRCS+=	p9¾_utfrrune.c runestuff.c -DL_utfrrune
UIF_NUSRCS+=	p9¾_utfrune.c runestuff.c -DL_utfrune
UIF_NUSRCS+=	p9¾_utfutf.c runestuff.c -DL_utfutf

@


1.36
log
@typo
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.35 2008/11/30 13:20:38 tg Exp $
d43 3
a45 3
UNIFDEF_SRCS+=	mbsnrtowcs.c mbsrtowcs.c -DMBSNRTOWCS
UNIFDEF_SRCS+=	mbsnrtowcsvis.c mbsrtowcs.c -DMBSNRTOWCSVIS
UNIFDEF_SRCS+=	wcsnrtombs.c wcsrtombs.c -DWCSNRTOMBS
d49 2
a50 2
UNIFDEF_SRCS+=	ambsntowcs.c ambstowcs.c -DL_ambsntowcs
UNIFDEF_SRCS+=	awcsntombs.c awcstombs.c -DL_awcsntombs
d57 31
a87 31
UNIFDEF_SRCS+=	p9¾_chartorune.c runestuff.c -DL_chartorune
UNIFDEF_SRCS+=	p9¾_fullrune.c runestuff.c -DL_fullrune
UNIFDEF_SRCS+=	p9¾_isalpharune.c runestuff.c -DL_isalpharune
UNIFDEF_SRCS+=	p9¾_islowerrune.c runestuff.c -DL_islowerrune
UNIFDEF_SRCS+=	p9¾_isspacerune.c runestuff.c -DL_isspacerune
UNIFDEF_SRCS+=	p9¾_istitlerune.c runestuff.c -DL_istitlerune
UNIFDEF_SRCS+=	p9¾_isupperrune.c runestuff.c -DL_isupperrune
UNIFDEF_SRCS+=	p9¾_runelen.c runestuff.c -DL_runelen
UNIFDEF_SRCS+=	p9¾_runenlen.c runestuff.c -DL_runenlen
UNIFDEF_SRCS+=	p9¾_runestrcat.c runestuff.c -DL_runestrcat
UNIFDEF_SRCS+=	p9¾_runestrchr.c runestuff.c -DL_runestrchr
UNIFDEF_SRCS+=	p9¾_runestrcmp.c runestuff.c -DL_runestrcmp
UNIFDEF_SRCS+=	p9¾_runestrcpy.c runestuff.c -DL_runestrcpy
UNIFDEF_SRCS+=	p9¾_runestrdup.c runestuff.c -DL_runestrdup
UNIFDEF_SRCS+=	p9¾_runestrecpy.c runestuff.c -DL_runestrecpy
UNIFDEF_SRCS+=	p9¾_runestrlen.c runestuff.c -DL_runestrlen
UNIFDEF_SRCS+=	p9¾_runestrncat.c runestuff.c -DL_runestrncat
UNIFDEF_SRCS+=	p9¾_runestrncmp.c runestuff.c -DL_runestrncmp
UNIFDEF_SRCS+=	p9¾_runestrncpy.c runestuff.c -DL_runestrncpy
UNIFDEF_SRCS+=	p9¾_runestrrchr.c runestuff.c -DL_runestrrchr
UNIFDEF_SRCS+=	p9¾_runestrstr.c runestuff.c -DL_runestrstr
UNIFDEF_SRCS+=	p9¾_runetochar.c runestuff.c -DL_runetochar
UNIFDEF_SRCS+=	p9¾_tolowerrune.c runestuff.c -DL_tolowerrune
UNIFDEF_SRCS+=	p9¾_totitlerune.c runestuff.c -DL_totitlerune
UNIFDEF_SRCS+=	p9¾_toupperrune.c runestuff.c -DL_toupperrune
UNIFDEF_SRCS+=	p9¾_utfecpy.c runestuff.c -DL_utfecpy
UNIFDEF_SRCS+=	p9¾_utflen.c runestuff.c -DL_utflen
UNIFDEF_SRCS+=	p9¾_utfnlen.c runestuff.c -DL_utfnlen
UNIFDEF_SRCS+=	p9¾_utfrrune.c runestuff.c -DL_utfrrune
UNIFDEF_SRCS+=	p9¾_utfrune.c runestuff.c -DL_utfrune
UNIFDEF_SRCS+=	p9¾_utfutf.c runestuff.c -DL_utfutf
@


1.35
log
@istitle/totitle implementation, sans table
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.34 2008/11/22 14:14:19 tg Exp $
d89 1
a89 1
.for _i in alnum alpha blank cntrl digit graph lower print punct space \\
@


1.34
log
@write a manual page at least for our own extensions
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.33 2008/11/22 14:00:50 tg Exp $
d12 1
d89 2
a90 2
.for _i in alnum alpha blank cntrl digit graph lower print punct space upper \
    xdigit
d104 2
@


1.33
log
@• add the awcstombs(3) to match the ambstowcs(3)
  and the awcsntombs(3) to match the ambsntowcs(3)
• fix ambsntowcs(3) NUL- and awcsntombs(3) WNUL-termination of output
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.32 2008/11/22 13:51:09 tg Exp $
d50 4
@


1.32
log
@when going to add local extensions to libc anyway (#if __OPENBSD_VISIBLE),
simplify the rest too; since we bump the minor today anyway, add it now…
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.31 2008/11/22 12:56:21 tg Exp $
d47 1
d49 1
@


1.31
log
@for fun, implement Plan 9's Rune API (with some int/long converted
to size_t/Rune/wint_t/wchar_t where they make sense, and with the
appropriate warn_references for runestrcpy and runestrcat, which
recommend wcslcpy and wcslcat now, as usual)

ABI is complete, two functions need to be filled out (Unicode Title case)

XXX if there are any functions missing which a Plan 9 fan desires,
XXX said fan shall contact me ASAP SVP
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.30 2008/11/22 09:02:33 tg Exp $
d46 3
@


1.30
log
@new macro: iswoctet(3)

use of this macro also fixes a bug in optu8to16vis(3) which could
errorneously map 0xFF80…0xFFFF wide characters to raw octets
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.29 2008/08/17 00:19:08 tg Exp $
d46 33
@


1.29
log
@extended conversion functions: “forgiving” variants of mbrtowc¹ and
mbsnrtowcs² encoding raw octets as if they were from codepage 1252,
or ISO-8859-1, into Unicode, instead of the PUA OPTU-16 range.

① called optu8to16vis with semantics of optu8to16
② called mbsnrtowcsvis with semantics of mbsnrtowcs

Note: mbtowc, mbstowcs and mbsrtowcs can be emulated by calling
mbrtowc(vis) and mbsnrtowcs(vis), respectively, with appropriate
arguments. The semantics have been chosen to not exactly match
the standard since the extensions are reasonably easy to use and
granted since these functions are not standardised anyway.
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.28 2008/08/01 23:24:02 tg Exp $
d85 1
@


1.28
log
@• OPTU-8 ⇐⇒ OPTU-16 conversion routines (libc, kernel, !bootloader)
• optu16to8(3) replaces wcrtomb(3) in libc
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.27 2008/08/01 22:04:56 tg Exp $
d30 1
d43 1
d118 2
@


1.27
log
@documentation before implementation, tonight
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.26 2007/02/06 15:52:00 tg Exp $
a30 1
SRCS+=	wcrtomb.c
@


1.26
log
@change UNIFDEF_SRCS(dest,source,flags) third argument to be a
comma-separated list of -Dfoo -Ubar flags passed to unifdef(1)
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.25 2006/11/21 20:15:31 tg Exp $
d92 1
d117 1
@


1.25
log
@lib/libc/locale/Makefile.inc is actually unused, thus (add a warning and)
place MLINKS for lib/libc/locale/*.3 stuff in lib/libc/i18n/Makefile.inc,
and correct a typo in the dist set
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.24 2006/11/21 01:04:09 tg Exp $
d42 2
a43 2
UNIFDEF_SRCS+=	mbsnrtowcs.c mbsrtowcs.c MBSNRTOWCS
UNIFDEF_SRCS+=	wcsnrtombs.c wcsrtombs.c WCSNRTOMBS
@


1.24
log
@get rid of the need to have several stub files consisting just of a
define and an include; simplify a lot; rewrite some code to simplify
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.23 2006/11/20 23:56:43 tg Exp $
d115 2
@


1.23
log
@only disable certain warnings to help __CRAZY builds if we're
indeed building with __CRAZY=yes
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.22 2006/11/20 23:50:48 tg Exp $
d42 2
a43 2
SRCS+=	mbsnrtowcs.c
SRCS+=	wcsnrtombs.c
@


1.22
log
@implement mbsnrtowcs(3) and wcsnrtombs(3) - including manual pages

these are only visible if any of
	_GNU_SOURCE and not __STRICT_ANSI__ (gcc -ansi)
	(_OPENBSD_SOURCE or _NETBSD_SOURCE) and none of (_ANSI_SOURCE,
	    XPG and POSIX stuff) and not __STRICT_ANSI__ (gcc -ansi)
	_ALL_SOURCE and not __STRICT_ANSI__ (gcc -ansi)
are defined, since they're GNU (and MirOS) extensions
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.21 2006/11/01 19:49:33 tg Exp $
d73 1
d79 1
@


1.21
log
@* the non-wide ctype stuff now also uses the wctype structure
  (saves duplicate rodata) and has been rewritten from scratch
* the non-inline version of the non-wide ctype stuff honours
  the MIR18N_C_CSET definition now as well
* tolower/toupper also rewritten from scratch, honouring the
  MIR18N_C_CSET definition (there is no inline version, and
  _tolower/_toupper are same stupid as usual), much smaller
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.20 2006/07/03 16:14:42 tg Exp $
d42 3
@


1.20
log
@GNU fileutils internally uses an
int mbsnwidth (const char *string, size_t nbytes, int flags);

remove our libc-internal mbswidth() because implementors
"usually" do want to roll their own - e.g. to cope with
invalid characters in multibyte sequences their own way.
keep it in Attic/ for reference tho.

bump libc major
sorry guys
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.19 2006/06/03 22:14:51 tg Exp $
d9 1
@


1.19
log
@move int __mb_cur_max(void) from isutf8.c to mbcurmax.c,
bool __locale_is_utf8 from isutf8.c to charsets.c because
if it's used setlocale(3) is always pulled in anyway
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.18 2006/06/02 12:58:52 tg Exp $
a27 1
SRCS+=	mbswidth.c
@


1.18
log
@enable the new functions
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.17 2006/06/01 22:55:35 tg Exp $
a15 1
SRCS+=	isutf8.c
d17 1
@


1.17
log
@cunningly write towctrans(3) according to manpage, SUSv3 spec
(online docs) and iswctype.c, considering our special situation
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.16 2006/06/01 22:47:34 tg Exp $
d25 1
d28 1
d32 1
@


1.16
log
@towlower/towupper, implemented like iswTYPE,
based upon manual page, just calling towctrans(3)
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.15 2006/06/01 22:42:37 tg Exp $
d28 1
a38 2
SRCS+=	multibyte.c

d85 1
@


1.15
log
@* write an iswctype(3) from scratch, based upon manual page,
  the UCD-autogenerated attribute tables and Bruno's defines
  but without the special cases for the C locale
* don't include locale/Makefile.inc any more, revert it
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.14 2006/06/01 22:30:09 tg Exp $
d48 7
@


1.14
log
@add a cunning (small, not even worth the adv clause ;) isw*() implementation
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.13 2006/06/01 22:17:20 tg Exp $
d4 1
a4 3

# for OpenBSD's manual pages and strto<num> sources
.include "${LIBCSRCDIR}/locale/Makefile.inc"
d20 1
d52 49
@


1.13
log
@move freely licenced functions from libhaible into libc;
add missing wcsxfrm(3); sort and style; remove some stubs
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.12 2006/06/01 22:03:16 tg Exp $
d8 3
d41 8
d52 2
@


1.12
log
@move UCD-generated attribute tables from libhaible to libc;
sync required definitions appropriately
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.11 2006/06/01 21:59:49 tg Exp $
a12 1
SRCS+=	btowc.c
d17 4
d23 3
d27 3
d31 4
@


1.11
log
@move catgets(3) man page for stub catalogue functions into libc
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.10 2006/06/01 21:58:12 tg Exp $
d8 5
@


1.10
log
@move Makefile entries for a few reachover functions
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.9 2006/05/26 13:52:06 tg Exp $
d19 4
@


1.9
log
@move mbsinit(3) into libc from libhaible;
it's written by myself and thus miros licenced
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.8 2006/01/30 13:01:44 tg Exp $
d5 1
a5 1
# for OpenBSD's manual pages
@


1.8
log
@add (some) OpenBSD I18N manual pages to build

XXX fix multibyte.c or better port libutf8
XXX add nl_langinfo(CODESET)
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.7 2005/10/11 21:58:33 tg Exp $
d14 1
@


1.7
log
@re-add libc/stdlib/Attic/multibyte.c to make libX11 not complain
and add some more stubs to make wine-990225 build
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.6 2005/09/30 22:13:55 tg Exp $
d5 3
@


1.6
log
@replace __libc_mb_cur_max variable by the (__locale_is_utf8 ? 3 : 1)
equation in the MB_CUR_MAX macro; expose MB_LEN_MAX in <stdlib.h> too,
prevent duplicate definitions. Adjust includes appropriately - <locale.h>
is not needed any more.
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.5 2005/09/30 21:45:26 tg Exp $
d13 2
@


1.5
log
@* write mbrtowc and wcrtomb (mostly according to POSIX spec)
  so our libc at least builds again
* fix all files for __CRAZY=yes build
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.4 2005/09/22 21:48:02 tg Exp $
a9 1
SRCS+=	mbcurmax.c
@


1.4
log
@* flesh out some functions and globals into their own files to save space
* add RCS IDs
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.3 2005/09/22 21:43:34 tg Exp $
d11 2
@


1.3
log
@the next one... even easier
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.2 2005/09/22 21:39:21 tg Exp $
d8 1
d10 1
@


1.2
log
@the first one of the actual support functions
@
text
@d1 1
a1 1
# $MirOS: src/lib/libc/i18n/Makefile.inc,v 1.1 2005/09/22 21:21:09 tg Exp $
d9 1
@


1.1
log
@split gen/i18n.c into categorised files, no functional change
@
text
@d1 1
a1 1
# $MirOS$
d5 4
a8 1
SRCS+=	catalogues.c charsets.c langinfo.c
@

