head	1.5;
access;
symbols
	MIRBSD_10:1.3.0.2
	MIRBSD_10_BASE:1.3
	MIRBSD_9_BASE:1.3
	MIRBSD_8:1.1.1.1.0.2
	MIRBSD_8_BASE:1.1.1.1
	cvs-200507211800:1.1.1.1
	openbsd:1.1.1;
locks; strict;
comment	@ * @;


1.5
date	2008.07.26.19.21.54;	author tg;	state Exp;
branches;
next	1.4;
commitid	100488B795B4D7A98BE;

1.4
date	2008.06.13.15.12.33;	author tg;	state Exp;
branches;
next	1.3;
commitid	10048528E7265FA5FDF;

1.3
date	2006.04.06.10.50.38;	author tg;	state Exp;
branches;
next	1.2;
commitid	1004434F24E300C5CA7;

1.2
date	2006.04.06.00.53.48;	author tg;	state Exp;
branches;
next	1.1;
commitid	100443466A513CDE7E7;

1.1
date	2005.02.05.17.30.24;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.02.05.17.30.24;	author tg;	state Exp;
branches;
next	;


desc
@@


1.5
log
@add auto-personalising of kernels, with support for old kernels unchanged
@
text
@/**	$MirOS: src/usr.sbin/config/ukc.h,v 1.4 2008/06/13 15:12:33 tg Exp $ */
/*	$OpenBSD: ukc.h,v 1.11 2003/06/25 21:10:12 deraadt Exp $ */

/*
 * Copyright (c) 1999-2001 Mats O Jansson.  All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
 * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
 * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
 * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
 * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
 * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef _UKC_H
#define _UKC_H

#define P_LOCNAMES	0
#define S_LOCNAMP	1
#define SA_CFROOTS	2
#define I_CFROOTS_SIZE	3
#define I_PV_SIZE	4
#define SA_PV		5
#define P_CFDATA	6
#define P_KERNEL_TEXT	7
#define P_VERSION	8
#define IA_EXTRALOC	9
#define I_NEXTRALOC	10
#define I_UEXTRALOC	11
#define	I_HISTLEN	12
#define	CA_HISTORY	13
#define TZ_TZ		14
#define P_PDEVNAMES	15
#define I_PDEVSIZE	16
#define S_PDEVINIT	17
#define I_NMBCLUSTERS	18
#define I_BUFCACHEPCT	19
#define I_NKMEMPG	20
#define I_SHMSEG	21
#define I_SHMMAXPGS	22
#define I_ROOTDEV	23
#define I_ROOTDEV_OV	24
#define P_ENTROPY	25
#define NLENTRIES	26

#ifdef UKC_MAIN
struct nlist nl[] = {
	{ "_locnames" },
	{ "_locnamp" },
	{ "_cfroots" },
	{ "_cfroots_size" },
	{ "_pv_size" },
	{ "_pv" },
	{ "_cfdata" },
	{ "_kernel_text" },
	{ "_version" },
	{ "_extraloc" },
	{ "_nextraloc" },
	{ "_uextraloc" },
	{ "_userconf_histlen" },
	{ "_userconf_history" },
	{ "_tz" },
	{ "_pdevnames" },
	{ "_pdevnames_size" },
	{ "_pdevinit" },
	{ "_nmbclust" },
	{ "_bufcachepercent" },
	{ "_nkmempages" },
	{ "_shmseg" },
	{ "_shmmaxpgs" },
	{ "_rootdev" },
	{ "_rootdev_override" },
	{ "_initial_entropy" },
	{ NULL },
};
struct nlist knl[] = {
	{ "_locnames" },
	{ "_locnamp" },
	{ "_cfroots" },
	{ "_cfroots_size" },
	{ "_pv_size" },
	{ "_pv" },
	{ "_cfdata" },
	{ "_kernel_text" },
	{ "_version" },
	{ "_extraloc" },
	{ "_nextraloc" },
	{ "_uextraloc" },
	{ "_userconf_histlen" },
	{ "_userconf_history" },
	{ "_tz" },
	{ "_pdevnames" },
	{ "_pdevnames_size" },
	{ "_pdevinit" },
	{ "_nmbclust" },
	{ "_bufcachepercent" },
	{ "_nkmempages" },
	{ "_shmseg" },
	{ "_shmmaxpgs" },
	{ "_rootdev" },
	{ "_rootdev_override" },
	{ "_initial_entropy" },
	{ NULL },
};
int	maxdev = 0;
int	totdev = 0;
int	maxpseudo = 0;
int	maxlocnames = 0;
int	base = 16;
int	cnt = -1;
int	lines = 18;
int	oldkernel = 0;
int	nopdev = 0;
#else
extern struct nlist nl[];
extern int maxdev;
extern int totdev;
extern int maxpseudo;
extern int maxlocnames;
extern int base;
extern int cnt;
extern int lines;
extern int oldkernel;
extern int nopdev;
#endif

struct cfdata   *get_cfdata(int);
short	        *get_locnamp(int);
caddr_t	        *get_locnames(int);
int	        *get_extraloc(int);
char	        *get_pdevnames(int);
struct pdevinit *get_pdevinit(int);

int	more(void);
void	pnum(int);
void	pdevnam(short);
void	pdev(short);
int	number(const char *, int *);
int	device(char *, int *, short *, short *);
int	attr(char *, int *);
void	modify(const char *, int *);
void	change(int);
void	disable(int);
void	enable(int);
void	show(void);
void	common_attr_val(short, int *, char);
void	show_attr(char *);
void	common_dev(char *, int, short, short, char);
void	common_attr(char *, int, char);
void	add_read(const char *, char, char *, int, int *);
void	add(char *, int, short, short);

int	config(void);
void	process_history(int, char *);

#define UC_CHANGE 'c'
#define UC_DISABLE 'd'
#define UC_ENABLE 'e'
#define UC_FIND 'f'
#define UC_SHOW 's'

#endif /* _UTIL_H */
@


1.4
log
@warning cleanup
@
text
@d1 1
a1 1
/**	$MirOS: src/usr.sbin/config/ukc.h,v 1.3 2006/04/06 10:50:38 tg Exp $ */
d56 2
a57 1
#define NLENTRIES	25
d86 1
d115 1
@


1.3
log
@implement rootdev_override to prevent our hand-written changed rootdev
to be overwritten from something derived from the boot loader in case
of 'config bsd swap generic'

XXX this is dangerous if you set the rootdev to NODEV on a non-generic
XXX but it might still work (reset to generic) and isn't too supported
@
text
@d1 1
a1 1
/**	$MirOS: src/usr.sbin/config/ukc.h,v 1.2 2006/04/06 00:53:48 tg Exp $ */
d151 1
a151 1
void	modify(char *, int *);
d160 1
a160 1
void	add_read(char *, char, char *, int, int *);
@


1.2
log
@implement a new command: "rootdev"
XXX someone do swapdev and dumpdev!
@
text
@d1 1
a1 1
/**	$MirOS$ */
d55 2
a56 1
#define NLENTRIES	24
d84 1
d112 1
@


1.1
log
@Initial revision
@
text
@d1 1
d54 2
a55 1
#define NLENTRIES	23
d82 1
d109 1
a169 2


@


1.1.1.1
log
@Import the OpenBSD foundation of MirOS BSD
@
text
@@
