head	1.5;
access;
symbols
	MIRBSD_10:1.2.0.2
	MIRBSD_10_BASE:1.2;
locks; strict;
comment	@ * @;


1.5
date	2011.11.21.20.49.39;	author tg;	state Exp;
branches;
next	1.4;
commitid	1004ECAB97840AE2593;

1.4
date	2011.11.20.22.02.43;	author tg;	state Exp;
branches;
next	1.3;
commitid	1004EC9791917D34AD7;

1.3
date	2010.07.03.18.33.57;	author tg;	state Exp;
branches;
next	1.2;
commitid	1004C2F828601C66EBF;

1.2
date	2007.08.16.10.38.29;	author tg;	state Exp;
branches;
next	1.1;
commitid	10046C428EB50B824CD;

1.1
date	2007.08.10.23.52.24;	author tg;	state Exp;
branches;
next	;
commitid	10046BCFA4E557A719B;


desc
@@


1.5
log
@refactoro
@
text
@/* $MirOS: src/usr.sbin/rdate/rdate.h,v 1.4 2011/11/20 22:02:43 tg Exp $ */

/* This macro is not implemented on all operating systems */
#ifndef	SA_LEN
#define	SA_LEN(x)	(((x)->sa_family == AF_INET6) ? \
			    sizeof(struct sockaddr_in6) : \
			    (((x)->sa_family == AF_INET) ? \
				sizeof(struct sockaddr_in) : \
				sizeof(struct sockaddr)))
#endif

#ifdef EXT_A4R
extern u_int32_t arc4random(void);
#endif

#ifndef SYSKERN_MIRTIME_H
time_t timet2posix(time_t);
#endif

void ntp_client(const char *, int, struct timeval *, struct timeval *,
    int, int);
void rfc868time_client (const char *, int, struct timeval *,
    struct timeval *);

extern int debug;

const char *log_sockaddr(struct sockaddr *);
double gettime(void);
@


1.4
log
@convert to MirTime API
@
text
@d1 1
a1 1
/* $MirOS: src/usr.sbin/rdate/rdate.h,v 1.3 2010/07/03 18:33:57 tg Exp $ */
d16 4
d28 1
@


1.3
log
@• put log_sockaddr() into a shared file (XXX share more rdate⇐⇒ntpd)
• make rdate -d output the destination IP sending packets to
@
text
@d1 1
a1 1
/* $MirOS: src/usr.sbin/rdate/rdate.h,v 1.2 2007/08/16 10:38:29 tg Exp $ */
a15 6
#ifdef __MirBSD__
#define tick2utc(tv)	tai2utc(timet2tai(tv))
#else
extern time_t tick2utc(time_t);		/* from ntpleaps.c */
#endif

@


1.2
log
@• add option -3 to use (S)NTPv3 – we just change the version field for now,
  no idea if that’s ok with the RFC, but it WFM
• fix displaying of IPv4-address-decoded refid
@
text
@d1 1
a1 1
/* $MirOS: src/usr.sbin/rdate/rdate.h,v 1.1 2007/08/10 23:52:24 tg Exp $ */
d28 2
@


1.1
log
@told ya it needs a .h file
@
text
@d1 1
a1 1
/* $MirOS$ */
d22 2
a23 1
void ntp_client(const char *, int, struct timeval *, struct timeval *, int);
@

