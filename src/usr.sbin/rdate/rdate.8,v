head	1.11;
access;
symbols
	MIRBSD_10:1.7.0.2
	MIRBSD_10_BASE:1.7
	MIRBSD_9_BASE:1.4
	MIRBSD_8:1.3.0.2
	MIRBSD_8_BASE:1.3
	cvs-200507211800:1.1.1.2
	openbsd:1.1.1;
locks; strict;
comment	@.\" @;


1.11
date	2018.12.25.19.38.33;	author tg;	state Exp;
branches;
next	1.10;
commitid	1005C22871909EC7FE2;

1.10
date	2016.02.11.20.12.28;	author tg;	state Exp;
branches;
next	1.9;
commitid	10056BCEAFF41919B5B;

1.9
date	2009.11.22.15.55.27;	author tg;	state Exp;
branches;
next	1.8;
commitid	1004B095EF92797429F;

1.8
date	2009.08.01.18.37.07;	author tg;	state Exp;
branches;
next	1.7;
commitid	1004A748B6314E43CA3;

1.7
date	2007.08.16.10.38.29;	author tg;	state Exp;
branches;
next	1.6;
commitid	10046C428EB50B824CD;

1.6
date	2007.08.10.23.01.03;	author tg;	state Exp;
branches;
next	1.5;
commitid	10046BCEE3D44DE3A31;

1.5
date	2006.08.28.13.15.44;	author tg;	state Exp;
branches;
next	1.4;
commitid	10044F2EC8D774FC8BB;

1.4
date	2006.05.29.23.38.32;	author tg;	state Exp;
branches;
next	1.3;
commitid	100447B85B916A0A64A;

1.3
date	2005.10.27.11.58.39;	author tg;	state Exp;
branches;
next	1.2;
commitid	77604360c0d42ca3;

1.2
date	2005.03.13.19.17.21;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.02.05.17.31.06;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.02.05.17.31.06;	author tg;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2005.07.21.21.03.50;	author tg;	state Exp;
branches;
next	;
commitid	560042e0092f571e;


desc
@@


1.11
log
@update from contrib/samples/portmdoc,v 1.11
@
text
@.\"	$MirOS: src/usr.sbin/rdate/rdate.8,v 1.10 2016/02/11 20:12:28 tg Exp $
.\"	$OpenBSD: rdate.8,v 1.29 2004/07/09 19:33:08 jmc Exp $
.\"	$NetBSD: rdate.8,v 1.4 1996/04/08 20:55:17 jtc Exp $
.\"
.\" Copyright (c) 1994 Christos Zoulas
.\" Copyright (c) 2002, 2005, 2006, 2008, 2009, 2016, 2018 mirabilos
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by Christos Zoulas.
.\" 4. The name of the author may not be used to endorse or promote products
.\"    derived from this software without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
.\" IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
.\" OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
.\" IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
.\" INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
.\" NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
.\" DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
.\" THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
.\" (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
.\" THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
.\"-
.\" Try to make GNU groff and AT&T nroff more compatible
.\" * ` generates ‘ in gnroff, so use \`
.\" * ' generates ’ in gnroff, \' generates ´, so use \*(aq
.\" * - generates ‐ in gnroff, \- generates −, so .tr it to -
.\"   thus use - for hyphens and \- for minus signs and option dashes
.\" * ~ is size-reduced and placed atop in groff, so use \*(TI
.\" * ^ is size-reduced and placed atop in groff, so use \*(ha
.\" * \(en does not work in nroff, so use \*(en
.\" * <>| are problematic, so redefine and use \*(Lt\*(Gt\*(Ba
.\" Also make sure to use \& *before* a punctuation char that is to not
.\" be interpreted as punctuation, and especially with two-letter words
.\" but also (after) a period that does not end a sentence (“e.g.\&”).
.\" The section after the "doc" macropackage has been loaded contains
.\" additional code to convene between the UCB mdoc macropackage (and
.\" its variant as BSD mdoc in groff) and the GNU mdoc macropackage.
.\"
.ie \n(.g \{\
.	if \*[.T]ascii .tr \-\N'45'
.	if \*[.T]latin1 .tr \-\N'45'
.	if \*[.T]utf8 .tr \-\N'45'
.	ds <= \[<=]
.	ds >= \[>=]
.	ds Rq \[rq]
.	ds Lq \[lq]
.	ds sL \(aq
.	ds sR \(aq
.	if \*[.T]utf8 .ds sL `
.	if \*[.T]ps .ds sL `
.	if \*[.T]utf8 .ds sR '
.	if \*[.T]ps .ds sR '
.	ds aq \(aq
.	ds TI \(ti
.	ds ha \(ha
.	ds en \(en
.\}
.el \{\
.	ds aq '
.	ds TI ~
.	ds ha ^
.	ds en \(em
.\}
.\"
.\" Implement .Dd with the Mdocdate RCS keyword
.\"
.rn Dd xD
.de Dd
.ie \\$1$Mdocdate: \{\
.	xD \\$2 \\$3, \\$4
.\}
.el .xD \\$1 \\$2 \\$3 \\$4 \\$5 \\$6 \\$7 \\$8
..
.\"
.\" .Dd must come before definition of .Mx, because when called
.\" with -mandoc, it might implement .Mx itself, but we want to
.\" use our own definition. And .Dd must come *first*, always.
.\"
.Dd $Mdocdate: December 25 2018 $
.\"
.\" Check which macro package we use, and do other -mdoc setup.
.\"
.ie \n(.g \{\
.	if \*[.T]utf8 .tr \[la]\*(Lt
.	if \*[.T]utf8 .tr \[ra]\*(Gt
.	ie d volume-ds-1 .ds tT gnu
.	el .ie d doc-volume-ds-1 .ds tT gnp
.	el .ds tT bsd
.\}
.el .ds tT ucb
.\"
.\" Implement .Mx (MirBSD)
.\"
.ie "\*(tT"gnu" \{\
.	eo
.	de Mx
.	nr curr-font \n[.f]
.	nr curr-size \n[.ps]
.	ds str-Mx \f[\n[curr-font]]\s[\n[curr-size]u]
.	ds str-Mx1 \*[Tn-font-size]\%MirBSD\*[str-Mx]
.	if !\n[arg-limit] \
.	if \n[.$] \{\
.	ds macro-name Mx
.	parse-args \$@@
.	\}
.	if (\n[arg-limit] > \n[arg-ptr]) \{\
.	nr arg-ptr +1
.	ie (\n[type\n[arg-ptr]] == 2) \
.	as str-Mx1 \~\*[arg\n[arg-ptr]]
.	el \
.	nr arg-ptr -1
.	\}
.	ds arg\n[arg-ptr] "\*[str-Mx1]
.	nr type\n[arg-ptr] 2
.	ds space\n[arg-ptr] "\*[space]
.	nr num-args (\n[arg-limit] - \n[arg-ptr])
.	nr arg-limit \n[arg-ptr]
.	if \n[num-args] \
.	parse-space-vector
.	print-recursive
..
.	ec
.	ds sP \s0
.	ds tN \*[Tn-font-size]
.\}
.el .ie "\*(tT"gnp" \{\
.	eo
.	de Mx
.	nr doc-curr-font \n[.f]
.	nr doc-curr-size \n[.ps]
.	ds doc-str-Mx \f[\n[doc-curr-font]]\s[\n[doc-curr-size]u]
.	ds doc-str-Mx1 \*[doc-Tn-font-size]\%MirBSD\*[doc-str-Mx]
.	if !\n[doc-arg-limit] \
.	if \n[.$] \{\
.	ds doc-macro-name Mx
.	doc-parse-args \$@@
.	\}
.	if (\n[doc-arg-limit] > \n[doc-arg-ptr]) \{\
.	nr doc-arg-ptr +1
.	ie (\n[doc-type\n[doc-arg-ptr]] == 2) \
.	as doc-str-Mx1 \~\*[doc-arg\n[doc-arg-ptr]]
.	el \
.	nr doc-arg-ptr -1
.	\}
.	ds doc-arg\n[doc-arg-ptr] "\*[doc-str-Mx1]
.	nr doc-type\n[doc-arg-ptr] 2
.	ds doc-space\n[doc-arg-ptr] "\*[doc-space]
.	nr doc-num-args (\n[doc-arg-limit] - \n[doc-arg-ptr])
.	nr doc-arg-limit \n[doc-arg-ptr]
.	if \n[doc-num-args] \
.	doc-parse-space-vector
.	doc-print-recursive
..
.	ec
.	ds sP \s0
.	ds tN \*[doc-Tn-font-size]
.\}
.el \{\
.	de Mx
.	nr cF \\n(.f
.	nr cZ \\n(.s
.	ds aa \&\f\\n(cF\s\\n(cZ
.	if \\n(aC==0 \{\
.		ie \\n(.$==0 \&MirBSD\\*(aa
.		el .aV \\$1 \\$2 \\$3 \\$4 \\$5 \\$6 \\$7 \\$8 \\$9
.	\}
.	if \\n(aC>\\n(aP \{\
.		nr aP \\n(aP+1
.		ie \\n(C\\n(aP==2 \{\
.			as b1 \&MirBSD\ #\&\\*(A\\n(aP\\*(aa
.			ie \\n(aC>\\n(aP \{\
.				nr aP \\n(aP+1
.				nR
.			\}
.			el .aZ
.		\}
.		el \{\
.			as b1 \&MirBSD\\*(aa
.			nR
.		\}
.	\}
..
.\}
.\"-
.Dt RDATE 8
.Os
.Sh NAME
.Nm rdate
.Nd set the system's date from a remote host
.Sh SYNOPSIS
.Nm rdate
.Op Fl 346adnprsv
.Op Fl P Ar ntpport
.Ar host
.Sh DESCRIPTION
.Nm
displays and sets the local date and time from the
host name or address given as the argument.
The time source may be an RFC 868 TCP protocol server,
which is usually implemented as a built-in service of
.Xr inetd 8 ,
or an RFC 2030 protocol SNTP/NTP server.
By default,
.Nm
uses the RFC 868 TCP protocol.
.Pp
The options are as follows:
.Bl -tag -width Ds
.It Fl 3
Sets the NTP protocol version to 3.
.It Fl 4
Forces
.Nm
to use IPv4 addresses only.
.It Fl 6
Forces
.Nm
to use IPv6 addresses only.
.It Fl a
Use the
.Xr adjtime 2
call to gradually skew the local time to the
remote time rather than just hopping.
.It Fl d
Debug the SNTP exchange.
If given twice, debug each packet received.
.It Fl n
Use SNTP (RFC 2030) instead of the RFC 868 time protocol.
.It Fl P Ar ntpport
With
.Fl n ,
use the UDP port
.Ar ntpport
instead of the default
.Dv 123 .
.It Fl p
Do not set, just print the remote time.
.It Fl r
Show the remainder from the last
.Xr adjtime 2
call.
.It Fl s
Do not print the time.
If set, any previous
.Fl v
options will be ignored.
.It Fl v
Verbose output.
Always show the adjustment.
Put this on a command line to reset all previous
.Fl s
options.
.El
.Sh FILES
.Bl -tag -width /var/log/wtmp -compact
.It Pa /var/log/wtmp
record of date resets and time changes
.El
.Sh SEE ALSO
.Xr date 1 ,
.Xr adjtime 2 ,
.Xr crontab 1 ,
.Xr gettimeofday 2 ,
.Xr symlink 7 ,
.Xr inetd 8 ,
.Xr ntpd 8 ,
.Xr timed 8
@


1.10
log
@merge most recent portmdoc into a̲l̲l̲ of its users; fixup .\& into \&. like
in mksh(1), for Schillix ditroff
@
text
@d1 1
a1 1
.\"	$MirOS: src/usr.sbin/rdate/rdate.8,v 1.8 2009/08/01 18:37:07 tg Exp $
d6 1
a6 1
.\" Copyright (c) 2002, 2005, 2006, 2008, 2009, 2016 mirabilos
d90 1
a90 1
.Dd $Mdocdate: August 1 2009 $
d98 1
d111 1
a111 1
.	ds str-Mx1 \*[Tn-font-size]\%MirOS\*[str-Mx]
d137 32
d175 1
a175 1
.		ie \\n(.$==0 \&MirOS\\*(aa
d181 1
a181 1
.			as b1 \&MirOS\ #\&\\*(A\\n(aP\\*(aa
d189 1
a189 1
.			as b1 \&MirOS\\*(aa
@


1.9
log
@update to contrib/samples/portmdoc,v 1.6
@
text
@d6 1
a6 1
.\" Copyright (c) 2002, 2005, 2006, 2008, 2009 Thorsten Glaser
d42 4
d90 1
a90 1
.Dd $Mdocdate: November 17 2009 $
d92 1
a92 1
.\" Check which macro package we use
d95 2
@


1.8
log
@use portmdoc for Mdocdate and .Mx
@
text
@d1 1
a1 1
.\"	$MirOS: src/usr.sbin/rdate/rdate.8,v 1.7 2007/08/16 10:38:29 tg Exp $
d42 3
d86 9
a94 1
.Dd $Mdocdate: December 27 2008 $
d98 53
a150 14
.de Mx
.nr cF \\n(.f
.nr cZ \\n(.s
.ds aa \&\f\\n(cF\s\\n(cZ
.if \\n(aC==0 \{\
.	ie \\n(.$==0 \&MirOS\\*(aa
.	el .aV \\$1 \\$2 \\$3 \\$4 \\$5 \\$6 \\$7 \\$8 \\$9
.\}
.if \\n(aC>\\n(aP \{\
.	nr aP \\n(aP+1
.	ie \\n(C\\n(aP==2 \{\
.		as b1 \&MirOS\ #\&\\*(A\\n(aP\\*(aa
.		ie \\n(aC>\\n(aP \{\
.			nr aP \\n(aP+1
a152 5
.		el .aZ
.	\}
.	el \{\
.		as b1 \&MirOS\\*(aa
.		nR
d154 1
a155 1
..
@


1.7
log
@• add option -3 to use (S)NTPv3 – we just change the version field for now,
  no idea if that’s ok with the RFC, but it WFM
• fix displaying of IPv4-address-decoded refid
@
text
@d1 1
a1 1
.\"	$MirOS: src/usr.sbin/rdate/rdate.8,v 1.6 2007/08/10 23:01:03 tg Exp $
d6 1
a6 1
.\" Copyright (c) 2002, 2005, 2006 Thorsten Glaser
d33 9
d43 69
a111 1
.Dd $Mdocdate: August 10 2007 $
@


1.6
log
@ntp port support here too
XXX needs a .h file…
@
text
@d1 1
a1 1
.\"	$MirOS: src/usr.sbin/rdate/rdate.8,v 1.5 2006/08/28 13:15:44 tg Exp $
d34 1
a34 1
.Dd $Mdocdate$
d42 1
a42 1
.Op Fl 46adnprsv
d59 2
@


1.5
log
@I need my debug modus (rdate -nd[d]p)
@
text
@d1 1
a1 1
.\"	$MirOS: src/usr.sbin/rdate/rdate.8,v 1.4 2006/05/29 23:38:32 tg Exp $
d34 1
a34 1
.Dd August 28, 2006
d43 1
d77 7
@


1.4
log
@use libtz for determining whether we should correct leap
seconds, instead of relying on the user to provide -c, and
use it to know the exact amount of leap seconds to correct
for (if any)

we only lose one thing: RFC 868 leap second correction (but
then, you don't want to use that anyway, and if you use it,
you better know whether the server you're synching against
is using a POSIX or "right" timezone)
@
text
@d1 1
a1 1
.\"	$MirOS: src/usr.sbin/rdate/rdate.8,v 1.3 2005/10/27 11:58:39 tg Exp $
d34 1
a34 1
.Dd April 30, 1994
d42 1
a42 1
.Op Fl 46anprsv
d71 3
@


1.3
log
@* merge OpenBSD import
* rewrite tai2utc from libc:taitime.c
* please __CRAZY=yes
* reduce diff against OpenBSD
* retain some functionality
@
text
@d1 1
a1 1
.\"	$MirOS: src/usr.sbin/rdate/rdate.8,v 1.2 2005/03/13 19:17:21 tg Exp $
d6 1
a6 1
.\" Copyright (c) 2002, 2005 Thorsten Glaser
d42 1
a42 1
.Op Fl 46acnprsv
a70 12
.It Fl c
Correct leap seconds.
Usually required when synchronising to an NTP server.
See below for an example.
.Pp
When synchronizing using the RFC 868 protocol, use this option only if the
server does not correctly account for leap seconds (i.e. if his
.Pa /etc/localtime
link is set to a POSIX, not a RIGHT, time zone).
You can determine if you need this parameter if you sync against an NTP
server (with this parameter) or (recommended) check with a local radio
controlled watch or phone service.
a95 19
.Sh EXAMPLES
To get the legal time in Germany, set the
.Pa /etc/localtime
symlink to
.Pa /usr/share/zoneinfo/right/Europe/Berlin
and issue the following command:
.Pp
.D1 Li "# rdate -ncv ptbtime1.ptb.de"
.Pp
The command of course assumes you have a working internet connection
and DNS set up to connect to the server at
.Sy Physikalisch-Technische Bundesanstalt
in Braunschweig, Germany, which makes legal time for this country.
.Pp
To gradually adjust time once an hour after the first
.Qq step
adjustment, put the following line into root's crontab:
.Pp
.D1 Li "58  *  *  *  *  rdate -ncav ptbtime1.ptb.de | logger -t NTP"
@


1.2
log
@fast merge src/usr.sbin
@
text
@d1 2
a2 2
.\"	$MirOS$
.\"	$OpenBSD: rdate.8,v 1.26 2004/02/18 20:10:53 jmc Exp $
d6 1
a6 1
.\" Copyright (c) 2002 Thorsten Glaser
d51 1
a51 1
or an RFC 1361 protocol SNTP/NTP server.
d73 1
a73 1
Usually required when synchronizing to an NTP server.
d84 1
a84 1
Use SNTP (RFC 1361) instead of the RFC 868 time protocol.
a126 4
.Pp
Note that a line similar to the line above is already active
by default in root's crontab of
.Mx .
d128 1
d133 3
a135 1
.Xr inetd 8
@


1.1
log
@Initial revision
@
text
@d1 1
d6 1
d42 1
a42 1
.Op Fl 46acnpsv
d73 3
a75 1
Sometimes required when synchronizing to an NTP server.
d77 3
a79 1
server does not correctly account for leap seconds.
d87 4
d93 3
d99 3
d120 1
a120 1
in Braunschweig, Germany.
d127 4
d133 1
d135 1
@


1.1.1.1
log
@Import the OpenBSD foundation of MirOS BSD
@
text
@@


1.1.1.2
log
@Import almost everything (no ancontrol, ifconfig, pfctl, wicontrol)
of (the undeleted parts of) OpenBSD-current's userland of about 3 hours ago.
Warning: this introduces major breakage!
@
text
@d1 1
a1 1
.\"	$OpenBSD: rdate.8,v 1.29 2004/07/09 19:33:08 jmc Exp $
d49 1
a49 1
or an RFC 2030 protocol SNTP/NTP server.
d78 1
a78 1
Use SNTP (RFC 2030) instead of the RFC 868 time protocol.
a111 1
.Xr date 1 ,
d113 2
a114 3
.Xr inetd 8 ,
.Xr ntpd 8 ,
.Xr timed 8
@

