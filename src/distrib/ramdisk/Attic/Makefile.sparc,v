head	1.4;
access;
symbols;
locks; strict;
comment	@# @;


1.4
date	2006.08.17.19.34.23;	author tg;	state dead;
branches;
next	1.3;
commitid	10044E4C48801BF3A85;

1.3
date	2006.08.17.12.49.49;	author tg;	state Exp;
branches;
next	1.2;
commitid	10044E465F34DECEC49;

1.2
date	2006.07.24.00.52.41;	author tg;	state Exp;
branches;
next	1.1;
commitid	10044C419CC4DA4352C;

1.1
date	2006.07.24.00.24.02;	author tg;	state Exp;
branches;
next	;
commitid	10044C4132D5626FCF6;


desc
@@


1.4
log
@move stuff required for images from miniroot/ and ramdisk/ to common/

PS: now's probably the time to not merge these with openbsd any more

PPS: this commit sponsored by johl's DEC VT320 @@9600,8n1 on NetBSD 1.6.1/pmax
@
text
@# $MirOS: src/distrib/ramdisk/Makefile.sparc,v 1.3 2006/08/17 12:49:49 tg Exp $
# $OpenBSD: Makefile.inc,v 1.14 2002/05/01 19:21:28 mickey Exp $

#INSTALLBOOT?=	${DESTDIR}/usr/mdec/installboot
RAWLABEL=
AOUT_BSDRD=	Yes
IMAGESIZE=	3584

cdrom-mdcopy:
#	cp ${BOOTXX} workdir/v${OSrev}/${MACHINE}/
	ln workdir/v${OSrev}/${MACHINE}/bsd.rd workdir/vmunix	# for kicks

# XXX is this really necessary?
cdrom-mdboot:
	test ! -e ${TMPMOUNT} || (cd ${.CURDIR}; ${MAKE} unconfig)
	mkdir -p ${TMPMOUNT}
	${SUDO} vnconfig -v -c ${VND} ${CDROM}
	${SUDO} disklabel -w ${VND} fakecdrom "MirOS BSD/sparc "
	${SUDO} ${DESTDIR}/usr/mdec/installboot -v $$(fgrep \
	    workdir/etc/boot.ldr mkisofs.log | while read start end rest; do \
		print -- -s $$start -e $$end; done) dummy ${BOOTXX} ${VND_CRDEV}
	${SUDO} vnconfig -v -u ${VND}
	${SUDO} rm -rf ${TMPMOUNT}
@


1.3
log
@remove stuff apparently not needed
the disklabel seems to be needed and does collide with an i386 MBR/PBR tho
@
text
@d1 1
a1 1
# $MirOS: src/distrib/ramdisk/Makefile.sparc,v 1.2 2006/07/24 00:52:41 tg Exp $
@


1.2
log
@add ISO9660 CD-R functionality to the new ramdisk Makefile as well
i386-big, boot.cfg-*, 00-README will be done later together with lists
@
text
@d1 1
a1 1
# $MirOS: src/distrib/ramdisk/Makefile.sparc,v 1.1 2006/07/24 00:24:02 tg Exp $
a18 1
	${SUDO} mount -r -t cd9660 ${VND_DEV} ${TMPMOUNT}
d21 1
a21 3
		print -- -s $$start -e $$end; done) \
	    ${TMPMOUNT}/etc/boot.ldr ${BOOTXX} ${VND_CRDEV}
	${SUDO} umount ${TMPMOUNT}
@


1.1
log
@preliminary steps at unifying the ramdisk building
@
text
@d1 1
a1 1
# $MirOS$
d8 19
@

