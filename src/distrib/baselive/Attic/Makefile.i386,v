head	1.9;
access;
symbols
	MIRBSD_10:1.6.0.2
	MIRBSD_10_BASE:1.6;
locks; strict;
comment	@# @;


1.9
date	2008.10.21.21.03.33;	author tg;	state dead;
branches;
next	1.8;
commitid	10048FE43B158335A05;

1.8
date	2008.07.17.11.48.34;	author tg;	state Exp;
branches;
next	1.7;
commitid	100487F31A8758BCEBB;

1.7
date	2008.07.10.01.33.15;	author tg;	state Exp;
branches;
next	1.6;
commitid	100487566D945691CD6;

1.6
date	2007.07.11.16.14.44;	author tg;	state Exp;
branches;
next	1.5;
commitid	1004695020B36572937;

1.5
date	2007.03.26.17.41.29;	author tg;	state Exp;
branches;
next	1.4;
commitid	100460805D11B9E1D35;

1.4
date	2006.10.13.19.18.02;	author tg;	state Exp;
branches;
next	1.3;
commitid	100452FE67757921301;

1.3
date	2006.10.02.22.38.13;	author tg;	state Exp;
branches;
next	1.2;
commitid	100452194D0378AE099;

1.2
date	2006.10.02.07.03.16;	author tg;	state Exp;
branches;
next	1.1;
commitid	1004520B9C458C2C177;

1.1
date	2006.08.19.19.06.04;	author tg;	state Exp;
branches;
next	;
commitid	10044E7612775A7059F;


desc
@@


1.9
log
@modernise, simplify
commit before testing (as backup)
@
text
@# $MirOS: src/distrib/baselive/Makefile.i386,v 1.8 2008/07/17 11:48:34 tg Exp $

KERNEL_PREP=	print 'rootdev 6 0\nquit' | config -ef bsd.tmp
BOOT=		${REALOBJDIR}/../../sys/arch/i386/stand/liveboot/boot
CDROM_MDOPTS=	-b boot.iso -c boot.cat \
		-no-emul-boot -boot-load-size 4 -boot-info-table

it: do-cdrom

bsd: ${BSDOBJDIR}/distrib/generic/bsd
	cp -f $> $@@

unpack-md:
	${SUDO} cp ${.CURDIR}/${MACHINE}/boot.* ${WRKDIR}/

cdrom-mdcopy:
	${SUDO} cp ${BOOT} ${WRKDIR}/boot.iso
	cd ${WRKDIR} && cksum -a cksum -a rmd160 -a tiger boot.iso >>CKSUM

MIINSTALLBOOT?=	${BSDSRCDIR}/usr.sbin/installboot/bxinst.
CHAINSECTOR?=	24

cdrom-mdboot:
	if [[ -s ${WRKDIR}/loot ]]; then \
		fgrep ${WRKDIR}/boot.ldr mkisofs.log | \
		    ${MKSH} ${MIINSTALLBOOT}i386 -S 2 | \
		    dd of=${CDROM} conv=notrunc bs=512 seek=${CHAINSECTOR} \
		    2>/dev/null; \
		fgrep ${WRKDIR}/loot mkisofs.log | \
		    ${MKSH} ${MIINSTALLBOOT}sparc -0 ${CHAINSECTOR} -S 2 | \
		    dd of=${CDROM} conv=notrunc 2>/dev/null; \
	else \
		${DESTDIR}/usr/mdec/installboot -v -h 16 -s 63 -I $$(fgrep \
		    ${WRKDIR}/boot.ldr mkisofs.log | \
		    while read start end rest; do \
			print -- $$start $$end; done) ${BOOTXX} ${CDROM}; \
	fi
@


1.8
log
@pasto
@
text
@d1 1
a1 1
# $MirOS: src/distrib/baselive/Makefile.i386,v 1.7 2008/07/10 01:33:15 tg Exp $
@


1.7
log
@automatise the creation of shared live(i386)+install(i386)+install(sparc)
CDs more
@
text
@d1 1
a1 1
# $MirOS: src/distrib/baselive/Makefile.i386,v 1.6 2007/07/11 16:14:44 tg Exp $
d30 1
a30 1
		    ${MKSH} ${MIINSTALLBOOT}-0 ${CHAINSECTOR} -S 2 | \
@


1.6
log
@at least TRY some geometry
@
text
@d1 1
a1 1
# $MirOS: src/distrib/baselive/Makefile.i386,v 1.5 2007/03/26 17:41:29 tg Exp $
d20 3
d24 14
a37 3
	${DESTDIR}/usr/mdec/installboot -v -h 16 -s 63 -I $$(fgrep \
	    ${WRKDIR}/boot.ldr mkisofs.log | while read start end rest; do \
		print -- $$start $$end; done) ${BOOTXX} ${CDROM}
@


1.5
log
@oversaw this in commitid 10045F145644159D152
@
text
@d1 1
a1 1
# $MirOS: src/distrib/baselive/Makefile.i386,v 1.4 2006/10/13 19:18:02 tg Exp $
d21 1
a21 1
	${DESTDIR}/usr/mdec/installboot -v -I $$(fgrep \
@


1.4
log
@move /etc/boot.cfg and friends to /
agreed bsiegert@@
@
text
@d1 1
a1 1
# $MirOS: src/distrib/baselive/Makefile.i386,v 1.3 2006/10/02 22:38:13 tg Exp $
d18 1
a18 1
	cd ${WRKDIR}; rmd160 boot.iso >>RMD160
@


1.3
log
@fix up and (on i386) enable the baselive CD; still not installer-augmented
@
text
@d1 1
a1 1
# $MirOS: src/distrib/baselive/Makefile.i386,v 1.2 2006/10/02 07:03:16 tg Exp $
d5 1
a5 1
CDROM_MDOPTS=	-b etc/boot.iso -c etc/boot.cat \
d14 1
a14 1
	${SUDO} cp ${.CURDIR}/${MACHINE}/boot.* ${WRKDIR}/etc/
d17 2
a18 2
	${SUDO} cp ${BOOT} ${WRKDIR}/etc/boot.iso
	cd ${WRKDIR}; rmd160 etc/boot.iso >>RMD160
d22 1
a22 1
	    ${WRKDIR}/etc/boot.ldr mkisofs.log | while read start end rest; do \
@


1.2
log
@start bringing the live CD into shape
@
text
@d1 1
a1 1
# $MirOS: src/distrib/baselive/Makefile.i386,v 1.1 2006/08/19 19:06:04 tg Exp $
d8 2
@


1.1
log
@start adding stuff from ../contrib/ towards a new structure live cd
@
text
@d1 1
a1 1
# $MirOS$
d16 1
@

