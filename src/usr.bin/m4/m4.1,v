head	1.4;
access;
symbols
	cvs-200911172100:1.1.1.6
	cvs-200908101645:1.1.1.5
	cvs-200810051545:1.1.1.4
	MIRBSD_10:1.1.1.3.0.2
	MIRBSD_10_BASE:1.1.1.3
	OPENBSD_4_0:1.1.1.3
	MIRBSD_9_BASE:1.1.1.2
	MIRBSD_8:1.1.1.2.0.2
	MIRBSD_8_BASE:1.1.1.2
	cvs-200507211800:1.1.1.2
	cvs-200504170300:1.1.1.2
	openbsd:1.1.1;
locks; strict;
comment	@.\" @;


1.4
date	2009.11.21.21.54.53;	author tg;	state Exp;
branches;
next	1.3;
commitid	1004B086187654C2542;

1.3
date	2009.11.17.20.58.28;	author tg;	state Exp;
branches;
next	1.2;
commitid	1004B030E6331AD46CC;

1.2
date	2009.11.17.19.55.58;	author bsiegert;	state Exp;
branches;
next	1.1;
commitid	1004B02FFBC169D69B3;

1.1
date	2005.02.05.17.29.42;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.02.05.17.29.42;	author tg;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2005.04.17.03.31.27;	author tg;	state Exp;
branches;
next	1.1.1.3;

1.1.1.3
date	2006.09.20.19.06.52;	author tg;	state Exp;
branches;
next	1.1.1.4;
commitid	10045119150397FC669;

1.1.1.4
date	2008.10.05.15.56.01;	author tg;	state Exp;
branches;
next	1.1.1.5;
commitid	10048E8E3980BD9A84E;

1.1.1.5
date	2009.08.10.16.56.44;	author tg;	state Exp;
branches;
next	1.1.1.6;
commitid	1004A80515B7479E593;

1.1.1.6
date	2009.11.17.21.01.43;	author tg;	state Exp;
branches;
next	;
commitid	1004B030F47588DC904;


desc
@@


1.4
log
@let 'errprint' in 'm4 -g' mode behave like GNU’s
the wording in both OUR manpage and SUSv4 is not specific about it,
and GNU m4’s texinfo page explicitly warns about this
@
text
@.\"	$MirOS$
.\"	@@(#) $OpenBSD: m4.1,v 1.56 2009/10/14 17:19:47 sthen Exp $
.\"
.\" Copyright (c) 1989, 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" This code is derived from software contributed to Berkeley by
.\" Ozan Yigit at York University.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.Dd $Mdocdate: November 17 2009 $
.Dt M4 1
.Os
.Sh NAME
.Nm m4
.Nd macro language processor
.Sh SYNOPSIS
.Nm m4
.Op Fl gPs
.Oo
.Sm off
.Fl D Ar name Op No = Ar value
.Sm on
.Oc
.Op Fl d Ar flags
.Op Fl I Ar dirname
.Op Fl o Ar filename
.Bk -words
.Op Fl t Ar macro
.Op Fl U Ns Ar name
.Op Ar
.Ek
.Sh DESCRIPTION
The
.Nm m4
utility is a macro processor that can be used as a front end to any
language (e.g., C, ratfor, fortran, lex, and yacc).
If no input files are given,
.Nm m4
reads from the standard input,
otherwise files specified on the command line are
processed in the given order.
Input files can be regular files, files in the m4 include paths, or a
single dash
.Pq Sq - ,
denoting standard input.
.Nm m4
writes
the processed text to the standard output, unless told otherwise.
.Pp
Macro calls have the form name(argument1[, argument2, ..., argumentN]).
.Pp
There cannot be any space following the macro name and the open
parenthesis
.Pq Sq ( .
If the macro name is not followed by an open
parenthesis it is processed with no arguments.
.Pp
Macro names consist of a leading alphabetic or underscore
possibly followed by alphanumeric or underscore characters, e.g.,
valid macro names match the pattern
.Dq [a-zA-Z_][a-zA-Z0-9_]* .
.Pp
In arguments to macros, leading unquoted space, tab, and newline
.Pq Sq \en
characters are ignored.
To quote strings, use left and right single quotes
.Po e.g.,\ \&
.Sq "\ this is a string with a leading space"
.Pc .
You can change the quote characters with the
.Ic changequote
built-in macro.
.Pp
Most built-ins don't make any sense without arguments, and hence are not
recognized as special when not followed by an open parenthesis.
.Pp
The options are as follows:
.Bl -tag -width Ds
.It Fl D Ns Ar name Ns Oo
.Pf = Ns Ar value
.Oc
Define the symbol
.Ar name
to have some value (or
.Dv NULL ) .
.It Fl d Ar "flags"
Set trace flags.
.Ar flags
may hold the following:
.Bl -tag -width Ds
.It Ar a
print macro arguments.
.It Ar c
print macro expansion over several lines.
.It Ar e
print result of macro expansion.
.It Ar f
print filename location.
.It Ar l
print line number.
.It Ar q
quote arguments and expansion with the current quotes.
.It Ar t
start with all macros traced.
.It Ar x
number macro expansions.
.It Ar V
turn on all options.
.El
.Pp
By default, trace is set to
.Qq eq .
.It Fl g
Activate GNU-m4 compatibility mode.
In this mode, translit handles simple character
ranges (e.g., a-z), regular expressions mimic emacs behavior,
multiple m4wrap calls are handled as a stack,
the number of diversions is unlimited,
empty names for macro definitions are allowed,
.Fn errprint
does not output a trailing space or newline,
and eval understands
.Sq 0rbase:value
numbers.
.It Fl I Ar "dirname"
Add directory
.Ar dirname
to the include path.
.It Fl o Ar filename
Send trace output to
.Ar filename .
.It Fl P
Prefix all built-in macros with
.Sq m4_ .
For example, instead of writing
.Ic define ,
use
.Ic m4_define .
.It Fl s
Output line synchronization directives, suitable for
.Xr cpp 1 .
.It Fl t Ar macro
Turn tracing on for
.Ar macro .
.It Fl "U" Ns Ar "name"
Undefine the symbol
.Ar name .
.El
.Sh SYNTAX
.Nm m4
provides the following built-in macros.
They may be redefined, losing their original meaning.
Return values are null unless otherwise stated.
.Bl -tag -width changequote
.It Fn builtin name
Calls a built-in by its
.Fa name ,
overriding possible redefinitions.
.It Fn changecom startcomment endcomment
Changes the start comment and end comment sequences.
Comment sequences may be up to five characters long.
The default values are the hash sign
and the newline character.
.Bd -literal -offset indent
# This is a comment
.Ed
.Pp
With no arguments, comments are turned off.
With one single argument, the end comment sequence is set
to the newline character.
.It Fn changequote beginquote endquote
Defines the open quote and close quote sequences.
Quote sequences may be up to five characters long.
The default values are the backquote character and the quote
character.
.Bd -literal -offset indent
`Here is a quoted string'
.Ed
.Pp
With no arguments, the default quotes are restored.
With one single argument, the close quote sequence is set
to the newline character.
.It Fn decr arg
Decrements the argument
.Fa arg
by 1.
The argument
.Fa arg
must be a valid numeric string.
.It Fn define name value
Define a new macro named by the first argument
.Fa name
to have the
value of the second argument
.Fa value .
Each occurrence of
.Sq $n
(where
.Ar n
is 0 through 9) is replaced by the
.Ar n Ns 'th
argument.
.Sq $0
is the name of the calling macro.
Undefined arguments are replaced by a null string.
.Sq $#
is replaced by the number of arguments;
.Sq $*
is replaced by all arguments comma separated;
.Sq $@@
is the same as
.Sq $*
but all arguments are quoted against further expansion.
.It Fn defn name ...
Returns the quoted definition for each argument.
This can be used to rename
macro definitions (even for built-in macros).
.It Fn divert num
There are 10 output queues (numbered 0-9).
At the end of processing
.Nm m4
concatenates all the queues in numerical order to produce the
final output.
Initially the output queue is 0.
The divert
macro allows you to select a new output queue (an invalid argument
passed to divert causes output to be discarded).
.It Ic divnum
Returns the current output queue number.
.It Ic dnl
Discard input characters up to and including the next newline.
.It Fn dumpdef name ...
Prints the names and definitions for the named items, or for everything
if no arguments are passed.
.It Fn errprint msg
Prints the first argument on the standard error output stream.
.It Fn esyscmd cmd
Passes its first argument to a shell and returns the shell's standard output.
Note that the shell shares its standard input and standard error with
.Nm m4 .
.It Fn eval expr
Computes the first argument as an arithmetic expression using 32-bit
arithmetic.
Operators are the standard C ternary, arithmetic, logical,
shift, relational, bitwise, and parentheses operators.
You can specify
octal, decimal, and hexadecimal numbers as in C.
The second argument (if any)
specifies the radix for the result and the third argument (if any)
specifies the minimum number of digits in the result.
.It Fn expr expr
This is an alias for
.Ic eval .
.It Fn format formatstring arg1 ...
Returns
.Fa formatstring
with escape sequences substituted with
.Fa arg1
and following arguments, in a way similar to
.Xr printf 3 .
This built-in is only available in GNU-m4 compatibility mode, and the only
parameters implemented are there for autoconf compatibility:
left-padding flag, an optional field width, a maximum field width,
*-specified field widths, and the %s and %c data type.
.It Fn ifdef name yes no
If the macro named by the first argument is defined then return the second
argument, otherwise the third.
If there is no third argument, the value is
.Dv NULL .
The word
.Qq unix
is predefined.
.It Fn ifelse a b yes ...
If the first argument
.Fa a
matches the second argument
.Fa b
then
.Fn ifelse
returns
the third argument
.Fa yes .
If the match fails the three arguments are
discarded and the next three arguments are used until there is
zero or one arguments left, either this last argument or
.Dv NULL
is returned if no other matches were found.
.It Fn include name
Returns the contents of the file specified in the first argument.
If the file is not found as is, look through the include path:
first the directories specified with
.Fl I
on the command line, then the environment variable
.Ev M4PATH ,
as a colon-separated list of directories.
Include aborts with an error message if the file cannot be included.
.It Fn incr arg
Increments the argument by 1.
The argument must be a valid numeric string.
.It Fn index string substring
Returns the index of the second argument in the first argument (e.g.,
.Ic index(the quick brown fox jumped, fox)
returns 16).
If the second
argument is not found index returns \-1.
.It Fn indir macro arg1 ...
Indirectly calls the macro whose name is passed as the first argument,
with the remaining arguments passed as first, ... arguments.
.It Fn len arg
Returns the number of characters in the first argument.
Extra arguments
are ignored.
.It Fn m4exit code
Immediately exits with the return value specified by the first argument,
0 if none.
.It Fn m4wrap todo
Allows you to define what happens at the final
.Dv EOF ,
usually for cleanup purposes (e.g.,
.Ic m4wrap("cleanup(tempfile)")
causes the macro cleanup to be
invoked after all other processing is done).
.Pp
Multiple calls to
.Fn m4wrap
get inserted in sequence at the final
.Dv EOF .
.It Fn maketemp template
Invokes
.Xr mkstemp 3
on the first argument, and returns the modified string.
This can be used to create unique
temporary file names.
.It Fn paste file
Includes the contents of the file specified by the first argument without
any macro processing.
Aborts with an error message if the file cannot be
included.
.It Fn patsubst string regexp replacement
Substitutes a regular expression in a string with a replacement string.
Usual substitution patterns apply: an ampersand
.Pq Sq \&&
is replaced by the string matching the regular expression.
The string
.Sq \e# ,
where
.Sq #
is a digit, is replaced by the corresponding back-reference.
.It Fn popdef arg ...
Restores the
.Ic pushdef Ns ed
definition for each argument.
.It Fn pushdef macro def
Takes the same arguments as
.Ic define ,
but it saves the definition on a
stack for later retrieval by
.Fn popdef .
.It Fn regexp string regexp replacement
Finds a regular expression in a string.
If no further arguments are given,
it returns the first match position or \-1 if no match.
If a third argument
is provided, it returns the replacement string, with sub-patterns replaced.
.It Fn shift arg1 ...
Returns all but the first argument, the remaining arguments are
quoted and pushed back with commas in between.
The quoting
nullifies the effect of the extra scan that will subsequently be
performed.
.It Fn sinclude file
Similar to
.Ic include ,
except it ignores any errors.
.It Fn spaste file
Similar to
.Fn paste ,
except it ignores any errors.
.It Fn substr string offset length
Returns a substring of the first argument starting at the offset specified
by the second argument and the length specified by the third argument.
If no third argument is present it returns the rest of the string.
.It Fn syscmd cmd
Passes the first argument to the shell.
Nothing is returned.
.It Ic sysval
Returns the return value from the last
.Ic syscmd .
.It Fn traceon arg ...
Enables tracing of macro expansions for the given arguments, or for all
macros if no argument is given.
.It Fn traceoff arg ...
Disables tracing of macro expansions for the given arguments, or for all
macros if no argument is given.
.It Fn translit string mapfrom mapto
Transliterate the characters in the first argument from the set
given by the second argument to the set given by the third.
You cannot use
.Xr tr 1
style abbreviations.
.It Fn undefine name1 ...
Removes the definition for the macros specified by its arguments.
.It Fn undivert arg ...
Flushes the named output queues (or all queues if no arguments).
.It Ic unix
A pre-defined macro for testing the OS platform.
.It Ic __line__
Returns the current file's line number.
.It Ic __file__
Returns the current file's name.
.El
.Sh STANDARDS
The
.Nm
utility is compliant with the
.St -p1003.1-2008
specification.
.Pp
The flags
.Op Fl dgIot
and the macros
.Ic builtin ,
.Ic esyscmd ,
.Ic expr ,
.Ic format ,
.Ic indir ,
.Ic paste ,
.Ic patsubst ,
.Ic regexp ,
.Ic spaste ,
.Ic unix ,
.Ic __line__ ,
and
.Ic __file__
are extensions to that specification.
.Pp
The output format of tracing and of
.Ic dumpdef
are not specified in any standard,
are likely to change and should not be relied upon.
The current format of tracing is closely modelled on
.Nm gnu-m4 ,
to allow
.Nm autoconf
to work.
.Pp
The built-ins
.Ic pushdef
and
.Ic popdef
handle macro definitions as a stack.
However,
.Ic define
interacts with the stack in an undefined way.
In this implementation,
.Ic define
replaces the top-most definition only.
Other implementations may erase all definitions on the stack instead.
.Pp
All built-ins do expand without arguments in many other
.Nm m4 .
.Pp
Many other
.Nm
have dire size limitations with respect to buffer sizes.
.Sh AUTHORS
.An -nosplit
.An Ozan Yigit Aq oz@@sis.yorku.ca
and
.An Richard A. O'Keefe Aq ok@@goanna.cs.rmit.OZ.AU .
.Pp
GNU-m4 compatibility extensions by
.An Marc Espie Aq espie@@cvs.openbsd.org .
@


1.3
log
@revert commitid 1004B02FFBC169D69B3 by bsiegert@@

this is not subversion; cvs has vendor branches, and we use them;
your commit incidentally switched the HEAD tag from 1.1 to 1.3,
meaning more work in the future for me when merging m4... thanks.
@
text
@d1 2
a2 1
.\"	@@(#) $OpenBSD: m4.1,v 1.55 2009/02/08 17:15:10 jmc Exp $
d34 1
a34 1
.Dd $Mdocdate: August 10 2009 $
d42 1
a42 1
.Op Fl gs
d144 2
d156 7
@


1.2
log
@Pull in recent changes from OpenBSD, essentially the following:

Support the -P option from gnu m4, which prefixes builtins with the
string m4_.
@
text
@d1 1
a1 1
.\"	@@(#) $OpenBSD: m4.1,v 1.56 2009/10/14 17:19:47 sthen Exp $
d41 1
a41 1
.Op Fl gPs
a152 7
.It Fl P
Prefix all built-in macros with
.Sq m4_ .
For example, instead of writing
.Ic define ,
use
.Ic m4_define .
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
.\"	@@(#) $OpenBSD: m4.1,v 1.35 2004/02/17 19:28:31 miod Exp $
d33 1
a33 1
.Dd January 26, 1993
d41 6
d48 1
a48 1
.Op Fl t Ar name
d50 2
a51 5
.Op Fl g
.Op Fl s
.Oo
.Fl D Ns Ar name Ns Op Ar =value
.Oc
d53 2
a54 1
.Op Fl I Ar dirname
d60 1
d62 10
a71 2
reads from the standard input and writes
the processed text to the standard output.
d103 1
a103 1
.Ar =value
a108 7
.It Fl "U" Ns Ar "name"
Undefine the symbol
.Ar name .
.It Fl I Ar "dirname"
Add directory
.Ar dirname
to the include path.
d136 14
d153 10
d166 3
a168 9
.It Fl g
Activate GNU-m4 compatibility mode.
In this mode, changequote with
two empty parameters deactivates quotes, translit handles simple character
ranges (e.g., a-z), regular expressions mimic emacs behavior,
and the number of diversions is unlimited.
.It Fl s
Output line synchronization directives, suitable for
.Xr cpp 1 .
d175 9
a183 7
.Bl -tag -width changequotexxx
.It Ic builtin
Calls a built-in by its name, overriding possible redefinitions.
.It Ic changecom
Change the start and end comment sequences.
The default is the pound sign
.Pq Sq #
d185 32
a216 13
With no arguments comments are turned off.
The maximum length for a comment marker is five characters.
.It Ic changequote
Defines the quote symbols to be the first and second arguments.
The symbols may be up to five characters long.
If no arguments are
given it restores the default open and close single quotes.
.It Ic decr
Decrements the argument by 1.
The argument must be a valid numeric string.
.It Ic define
Define a new macro named by the first argument to have the
value of the second argument.
d235 1
a235 1
.It Ic defn
d239 1
a239 1
.It Ic divert
d253 1
a253 1
.It Ic dumpdef
d256 1
a256 1
.It Ic errprint
d258 1
a258 1
.It Ic esyscmd
d262 1
a262 1
.It Ic eval
d272 1
a272 1
.It Ic expr
d275 12
a286 1
.It Ic ifdef
d294 7
a300 3
.It Ic ifelse
If the first argument matches the second argument then
.Ic ifelse
d302 2
a303 1
the third argument.
d309 1
a309 1
.It Ic include
d318 1
a318 1
.It Ic incr
d321 1
a321 1
.It Ic index
d327 1
a327 1
.It Ic indir
d330 1
a330 1
.It Ic len
d334 1
a334 1
.It Ic m4exit
d337 1
a337 1
.It Ic m4wrap
d344 6
a349 1
.It Ic maketemp
d355 1
a355 1
.It Ic paste
d360 1
a360 1
.It Ic patsubst
d370 1
a370 1
.It Ic popdef
d374 1
a374 1
.It Ic pushdef
d379 2
a380 2
.Ic popdef .
.It Ic regexp
d386 1
a386 1
.It Ic shift
d392 1
a392 1
.It Ic sinclude
d396 1
a396 1
.It Ic spaste
d398 1
a398 1
.Ic paste ,
d400 1
a400 1
.It Ic substr
d404 1
a404 1
.It Ic syscmd
d410 1
a410 1
.It Ic traceon
d413 1
a413 1
.It Ic traceoff
d416 1
a416 1
.It Ic translit
d422 1
a422 1
.It Ic undefine
d424 1
a424 1
.It Ic undivert
d434 1
d436 21
a456 17
follows the Single Unix 2 specification, along with a few extensions taken
from
.Nm gnu-m4 .
.Pp
The
.Fl s
option
.Po
.Xr cpp 1 's
#line directives
.Pc
is currently not supported.
Flags
.Fl I ,
.Fl d ,
.Fl t
are non-standard.
a480 13
For portability, one should not use the macros
.Ic builtin ,
.Ic esycmd ,
.Ic expr ,
.Ic indir ,
.Ic paste ,
.Ic patsubst ,
.Ic regexp ,
.Ic spaste ,
.Ic unix ,
.Ic __line__ ,
.Ic __file__ .
.Pp
d488 1
@


1.1.1.1
log
@Import the OpenBSD foundation of MirOS BSD
@
text
@@


1.1.1.2
log
@some more updates/fixes from obsd
@
text
@d1 1
a1 1
.\"	@@(#) $OpenBSD: m4.1,v 1.38 2005/03/02 10:12:15 espie Exp $
a140 1
multiple m4wrap calls are handled as a stack,
d151 4
a154 6
.Bl -tag -width changequote
.It Fn builtin name
Calls a built-in by its
.Fa name ,
overriding possible redefinitions.
.It Fn changecom startcomment endcomment
d161 1
a161 1
.It Fn changequote beginquote endquote
d166 6
a171 13
.It Fn decr arg
Decrements the argument
.Fa arg
by 1.
The argument
.Fa arg
must be a valid numeric string.
.It Fn define name value
Define a new macro named by the first argument
.Fa name
to have the
value of the second argument
.Fa value .
d190 1
a190 1
.It Fn defn name ...
d194 1
a194 1
.It Fn divert num
d208 1
a208 1
.It Fn dumpdef name ...
d211 1
a211 1
.It Fn errprint msg
d213 1
a213 1
.It Fn esyscmd cmd
d217 1
a217 1
.It Fn eval expr
d227 1
a227 1
.It Fn expr expr
d230 1
a230 1
.It Fn ifdef name yes no
d238 3
a240 7
.It Fn ifelse a b yes ...
If the first argument
.Fa a
matches the second argument
.Fa b
then
.Fn ifelse
d242 1
a242 2
the third argument
.Fa yes .
d248 1
a248 1
.It Fn include name
d257 1
a257 1
.It Fn incr arg
d260 1
a260 1
.It Fn index string substring
d266 1
a266 1
.It Fn indir macro arg1 ...
d269 1
a269 1
.It Fn len arg
d273 1
a273 1
.It Fn m4exit code
d276 1
a276 1
.It Fn m4wrap todo
d283 1
a283 6
.Pp
Multiple calls to
.Fn m4wrap
get inserted in sequence at the final
.Dv EOF .
.It Fn maketemp template
d289 1
a289 1
.It Fn paste file
d294 1
a294 1
.It Fn patsubst string regexp replacement
d304 1
a304 1
.It Fn popdef arg ...
d308 1
a308 1
.It Fn pushdef macro def
d313 2
a314 2
.Fn popdef .
.It Fn regexp string regexp replacement
d320 1
a320 1
.It Fn shift arg1 ...
d326 1
a326 1
.It Fn sinclude file
d330 1
a330 1
.It Fn spaste file
d332 1
a332 1
.Fn paste ,
d334 1
a334 1
.It Fn substr string offset length
d338 1
a338 1
.It Fn syscmd cmd
d344 1
a344 1
.It Fn traceon arg ...
d347 1
a347 1
.It Fn traceoff arg ...
d350 1
a350 1
.It Fn translit string mapfrom mapto
d356 1
a356 1
.It Fn undefine name1 ...
d358 1
a358 1
.It Fn undivert arg ...
@


1.1.1.3
log
@import a few security-wise relevant changes right now
@
text
@d1 1
a1 1
.\"	@@(#) $OpenBSD: m4.1,v 1.46 2006/08/29 18:40:49 mbalmer Exp $
d41 5
a45 1
.Op Fl gs
d47 1
a47 3
.Sm off
.Fl D Ar name Op No = Ar value
.Sm on
d49 1
a49 1
.Op Fl d Ar flags
a50 5
.Op Fl o Ar filename
.Bk -words
.Op Fl t Ar macro
.Op Fl U Ns Ar name
.Ek
d90 1
a90 1
.Pf = Ns Ar value
d96 7
d130 6
d138 2
a139 1
In this mode, translit handles simple character
a142 7
.It Fl I Ar "dirname"
Add directory
.Ar dirname
to the include path.
.It Fl o Ar filename
Send trace output to
.Ar filename .
a145 6
.It Fl t Ar macro
Turn tracing on for
.Ar macro .
.It Fl "U" Ns Ar "name"
Undefine the symbol
.Ar name .
d158 3
a160 3
Changes the start comment and end comment sequences.
Comment sequences may be up to five characters long.
The default values are the hash sign
d162 2
a163 7
.Bd -literal -offset indent
# This is a comment
.Ed
.Pp
With no arguments, comments are turned off.
With one single argument, the end comment sequence is set
to the newline character.
d165 4
a168 11
Defines the open quote and close quote sequences.
Quote sequences may be up to five characters long.
The default values are the backquote character and the quote
character.
.Bd -literal -offset indent
`Here is a quoted string'
.Ed
.Pp
With no arguments, the default quotes are restored.
With one single argument, the close quote sequence is set
to the newline character.
a239 10
.It Fn format formatstring arg1 ...
Returns
.Fa formatstring
with escape sequences substituted with
.Fa arg1
and following arguments, in a way similar to
.Xr printf 3 .
This built-in is only available in GNU-m4 compatibility mode, and the
left-padding flag, an optional field width and the %s data type
are the only supported parameters.
d389 2
a390 4
is expected to be
.St -p1003.1-2004
compliant,
along with a few extensions taken from
d393 8
d432 1
a432 1
.Ic esyscmd ,
a433 1
.Ic format ,
a449 1
.An -nosplit
@


1.1.1.4
log
@Import OpenBSD’s latest m4 changes, in which Marc Espie fixed autoconf-2.62
@
text
@d1 1
a1 1
.\"	@@(#) $OpenBSD: m4.1,v 1.54 2008/08/22 01:06:31 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: August 22 2008 $
a52 1
.Op Ar
a58 1
If no input files are given,
d60 2
a61 10
reads from the standard input,
otherwise files specified on the command line are
processed in the given order.
Input files can be regular files, files in the m4 include paths, or a
single dash
.Pq Sq - ,
denoting standard input.
.Nm m4
writes
the processed text to the standard output, unless told otherwise.
d131 1
a131 5
the number of diversions is unlimited,
empty names for macro definitions are allowed,
and eval understands
.Sq 0rbase:value
numbers.
d261 3
a263 4
This built-in is only available in GNU-m4 compatibility mode, and the only
parameters implemented are there for autoconf compatibility:
left-padding flag, an optional field width, a maximum field width,
*-specified field widths, and the %s and %c data type.
a411 1
The
d413 1
a413 1
utility is compliant with the
d415 9
a423 19
specification.
.Pp
The flags
.Op Fl dgIot
and the macros
.Ic builtin ,
.Ic esyscmd ,
.Ic expr ,
.Ic format ,
.Ic indir ,
.Ic paste ,
.Ic patsubst ,
.Ic regexp ,
.Ic spaste ,
.Ic unix ,
.Ic __line__ ,
and
.Ic __file__
are extensions to that specification.
d448 14
@


1.1.1.5
log
@... and the newer m4 fixing a SIGSEGV
@
text
@d1 1
a1 1
.\"	@@(#) $OpenBSD: m4.1,v 1.55 2009/02/08 17:15:10 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: February 8 2009 $
d430 1
a430 1
.St -p1003.1-2008
@


1.1.1.6
log
@Import new m4(1) from OpenBSD
@
text
@d1 1
a1 1
.\"	@@(#) $OpenBSD: m4.1,v 1.56 2009/10/14 17:19:47 sthen Exp $
d33 1
a33 1
.Dd $Mdocdate: October 14 2009 $
d41 1
a41 1
.Op Fl gPs
a152 7
.It Fl P
Prefix all built-in macros with
.Sq m4_ .
For example, instead of writing
.Ic define ,
use
.Ic m4_define .
@


