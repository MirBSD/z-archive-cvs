head	1.2;
access;
symbols
	MIRBSD_10:1.1.1.3.0.2
	MIRBSD_10_BASE:1.1.1.3
	cvs-200707101400:1.1.1.3
	MIRBSD_9_BASE:1.1.1.2
	MIRBSD_8:1.1.1.2.0.2
	MIRBSD_8_BASE:1.1.1.2
	cvs-200507211800:1.1.1.2
	openbsd:1.1.1;
locks; strict;
comment	@# @;


1.2
date	2018.04.28.04.15.41;	author tg;	state Exp;
branches;
next	1.1;
commitid	1005AE3F5803D703009;

1.1
date	2005.02.05.17.29.30;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.02.05.17.29.30;	author tg;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2005.07.21.20.59.14;	author tg;	state Exp;
branches;
next	1.1.1.3;
commitid	560042e0092f571e;

1.1.1.3
date	2007.07.10.14.08.20;	author tg;	state Exp;
branches;
next	;
commitid	100469392DB1BA5159C;


desc
@@


1.2
log
@add OSABI into file output; clean up
@
text
@#	$MirOS$
#	$OpenBSD: elf,v 1.15 2006/10/12 03:32:32 drahn Exp $

#------------------------------------------------------------------------------
# elf:  file(1) magic for ELF executables
#
# We have to check the byte order flag to see what byte order all the
# other stuff in the header is in.
#
# MIPS RS3000 may also be for MIPS RS2000.
# What're the correct byte orders for the nCUBE and the Fujitsu VPP500?
#
# updated by Daniel Quinlan (quinlan@@yggdrasil.com)
0	string		\177ELF		ELF
>4	byte		0		invalid class
>4	byte		1		32-bit
>4	byte		2		64-bit
>7	byte		0		(SYSV)
>7	byte		1		(HP-UX)
>7	byte		2		(NetBSD)
>7	byte		3		(GNU/Linux)
>7	byte		4		(GNU/Hurd)
>7	byte		5		(86Open common IA32 ABI)
>7	byte		6		(Solaris)
>7	byte		7		(Monterey)
>7	byte		8		(IRIX)
>7	byte		9		(FreeBSD)
>7	byte		10		(TRU64)
>7	byte		11		(Novell Modesto)
>7	byte		12		(OpenBSD)
>7	byte		97		(ARM OSABI)
>7	byte		255		(standalone (embedded) application)
>5	byte		0		invalid byte order
>5	byte		1		LSB
>>16	leshort		0		no file type,
>>16	leshort		1		relocatable,
>>16	leshort		2		executable,
>>16	leshort		3		shared object,
# only for MIPS
>>18	leshort		8
# only for 32-bit
>>>4	byte		1
>>>>36	lelong&0xf0000000	0x00000000	MIPS-I,
>>>>36	lelong&0xf0000000	0x10000000	MIPS-II,
>>>>36	lelong&0xf0000000	0x20000000	MIPS-III,
>>>>36	lelong&0xf0000000	0x30000000	MIPS-IV,
>>>>36	lelong&0xf0000000	0x40000000	MIPS-V,
>>>>36	lelong&0xf0000000	0x60000000	MIPS32,
>>>>36	lelong&0xf0000000	0x70000000	MIPS64,
>>>>36	lelong&0xf0000000	0x80000000	MIPS32 rel2,
>>>>36	lelong&0xf0000000	0x90000000	MIPS64 rel2,
# only for 64-bit
>>>4	byte		2
>>>>48	lelong&0xf0000000	0x00000000	MIPS-I,
>>>>48	lelong&0xf0000000	0x10000000	MIPS-II,
>>>>48	lelong&0xf0000000	0x20000000	MIPS-III,
>>>>48	lelong&0xf0000000	0x30000000	MIPS-IV,
>>>>48	lelong&0xf0000000	0x40000000	MIPS-V,
>>>>48	lelong&0xf0000000	0x60000000	MIPS32,
>>>>48	lelong&0xf0000000	0x70000000	MIPS64 ,
>>>>48	lelong&0xf0000000	0x80000000	MIPS32 rel2,
>>>>48	lelong&0xf0000000	0x90000000	MIPS64 rel2,
# Core handling from Peter Tobias <tobias@@server.et-inf.fho-emden.de>
>>16	leshort		4		core file
>>>400  lelong          >0              (signal %d),
>>16	leshort		&0xff00		processor-specific,
>>18	leshort		0		no machine,
>>18	leshort		1		AT&T WE32100 - invalid byte order,
>>18	leshort		2		SPARC - invalid byte order,
>>18	leshort		3		Intel 80386,
>>18	leshort		4		Motorola 68000 - invalid byte order,
>>18	leshort		5		Motorola 88000 - invalid byte order,
>>18	leshort		6		Intel 80486,
>>18	leshort		7		Intel 80860,
# >>18	leshort		8		MIPS,
>>18	leshort		9		Amdahl - invalid byte order,
>>18	leshort		10		MIPS R4K (deprecated) - invalid byte order,
>>18	leshort		11		RS6000 (or SPARC v9 64-bit unoffical) - invalid byte order,
>>18	leshort		15		PA-RISC - invalid byte order,
>>18	leshort		16		nCUBE,
>>18	leshort		17		VPP500,
>>18	leshort		18		SPARC32PLUS - invalid byte order,
>>18	leshort		20		PowerPC,
>>18	leshort		40		ARM,
>>18	leshort		41		DEC ALPHA,
>>18	leshort		42		SH,
>>18	leshort		43		SPARC64 - invalid byte order,
>>18	leshort		62		AMD64,
>>18	leshort		75		VAX,
>>18	leshort		0x9026		DEC ALPHA,
>>20	lelong		0		invalid version
>>20	lelong		1		version 1
>>36	lelong		1		MathCoPro/FPU/MAU Required
>5	byte		2		MSB
>>16	beshort		0		no file type,
>>16	beshort		1		relocatable,
>>16	beshort		2		executable,
>>16	beshort		3		shared object,
# only for MIPS
>>18	beshort		8
# only for 32-bit
>>>4	byte		1
>>>>36	belong&0xf0000000	0x00000000	MIPS-I,
>>>>36	belong&0xf0000000	0x10000000	MIPS-II,
>>>>36	belong&0xf0000000	0x20000000	MIPS-III,
>>>>36	belong&0xf0000000	0x30000000	MIPS-IV,
>>>>36	belong&0xf0000000	0x40000000	MIPS-V,
>>>>36	belong&0xf0000000	0x60000000	MIPS32,
>>>>36	belong&0xf0000000	0x70000000	MIPS64,
>>>>36	belong&0xf0000000	0x80000000	MIPS32 rel2,
>>>>36	belong&0xf0000000	0x90000000	MIPS64 rel2,
# only for 64-bit
>>>4	byte		2
>>>>48	belong&0xf0000000	0x00000000	MIPS-I,
>>>>48	belong&0xf0000000	0x10000000	MIPS-II,
>>>>48	belong&0xf0000000	0x20000000	MIPS-III,
>>>>48	belong&0xf0000000	0x30000000	MIPS-IV,
>>>>48	belong&0xf0000000	0x40000000	MIPS-V,
>>>>48	belong&0xf0000000	0x60000000	MIPS32,
>>>>48	belong&0xf0000000	0x70000000	MIPS64 ,
>>>>48	belong&0xf0000000	0x80000000	MIPS32 rel2,
>>>>48	belong&0xf0000000	0x90000000	MIPS64 rel2,
>>16	beshort		4		core file,
>>>400	lelong		>0		(signal %d),
>>16	beshort		&0xff00		processor-specific,
>>18	beshort		0		no machine,
>>18	beshort		1		AT&T WE32100,
>>18	beshort		2		SPARC,
>>18	beshort		3		Intel 80386 - invalid byte order,
>>18	beshort		4		Motorola 68000,
>>18	beshort		5		Motorola 88000,
>>18	beshort		6		Intel 80486 - invalid byte order,
>>18	beshort		7		Intel 80860,
# >>18	beshort		8		MIPS,
>>18	beshort		9		Amdahl,
>>18	beshort		10		MIPS R4K (deprecated),
>>18	beshort		11		RS6000 (or SPARC v9 64-bit unoffical),
>>18	beshort		15		PA-RISC,
>>18	beshort		16		nCUBE,
>>18	beshort		17		VPP500,
>>18	beshort		18		SPARC32PLUS,
>>18	beshort		20		PowerPC,
>>18	beshort		40		ARM,
>>18	beshort		41		DEC ALPHA,
>>18	beshort		42		SH - invalid byte order,
>>18	beshort		43		SPARC64,
>>18	beshort		62		AMD64 - invalid byte order,
>>18	beshort		75		VAX - invalid byte order,
>>18	beshort		0x9026		DEC ALPHA,
>>20	belong		0		invalid version
>>20	belong		1		version 1
>>36	belong		1		MathCoPro/FPU/MAU Required
@


1.1
log
@Initial revision
@
text
@d1 2
a2 1
#	$OpenBSD: elf,v 1.12 2004/10/23 16:59:25 grange Exp $
d18 15
d35 4
d43 9
a51 9
>>>>36	lelong&0xf0000000	0x00000000	MIPS-I
>>>>36	lelong&0xf0000000	0x10000000	MIPS-II
>>>>36	lelong&0xf0000000	0x20000000	MIPS-III
>>>>36	lelong&0xf0000000	0x30000000	MIPS-IV
>>>>36	lelong&0xf0000000	0x40000000	MIPS-V
>>>>36	lelong&0xf0000000	0x60000000	MIPS32
>>>>36	lelong&0xf0000000	0x70000000	MIPS64
>>>>36	lelong&0xf0000000	0x80000000	MIPS32 rel2
>>>>36	lelong&0xf0000000	0x90000000	MIPS64 rel2
d54 9
a62 13
>>>>48	lelong&0xf0000000	0x00000000	MIPS-I
>>>>48	lelong&0xf0000000	0x10000000	MIPS-II
>>>>48	lelong&0xf0000000	0x20000000	MIPS-III
>>>>48	lelong&0xf0000000	0x30000000	MIPS-IV
>>>>48	lelong&0xf0000000	0x40000000	MIPS-V
>>>>48	lelong&0xf0000000	0x60000000	MIPS32
>>>>48	lelong&0xf0000000	0x70000000	MIPS64 
>>>>48	lelong&0xf0000000	0x80000000	MIPS32 rel2
>>>>48	lelong&0xf0000000	0x90000000	MIPS64 rel2
>>16	leshort		0		no file type,
>>16	leshort		1		relocatable,
>>16	leshort		2		executable,
>>16	leshort		3		shared object,
d75 1
a75 1
>>18	leshort		8		MIPS,
d77 2
a78 2
>>18	leshort		10		MIPS (deprecated),
>>18	leshort		11		RS6000 - invalid byte order,
d82 1
a82 1
>>18	leshort		18		SPARC32PLUS,
d85 2
d90 1
a90 1
>>18	leshort		0x9026		Alpha,
d95 4
d103 9
a111 9
>>>>36	belong&0xf0000000	0x00000000	MIPS-I
>>>>36	belong&0xf0000000	0x10000000	MIPS-II
>>>>36	belong&0xf0000000	0x20000000	MIPS-III
>>>>36	belong&0xf0000000	0x30000000	MIPS-IV
>>>>36	belong&0xf0000000	0x40000000	MIPS-V
>>>>36	belong&0xf0000000	0x60000000	MIPS32
>>>>36	belong&0xf0000000	0x70000000	MIPS64
>>>>36	belong&0xf0000000	0x80000000	MIPS32 rel2
>>>>36	belong&0xf0000000	0x90000000	MIPS64 rel2
d114 9
a122 13
>>>>48	belong&0xf0000000	0x00000000	MIPS-I
>>>>48	belong&0xf0000000	0x10000000	MIPS-II
>>>>48	belong&0xf0000000	0x20000000	MIPS-III
>>>>48	belong&0xf0000000	0x30000000	MIPS-IV
>>>>48	belong&0xf0000000	0x40000000	MIPS-V
>>>>48	belong&0xf0000000	0x60000000	MIPS32
>>>>48	belong&0xf0000000	0x70000000	MIPS64 
>>>>48	belong&0xf0000000	0x80000000	MIPS32 rel2
>>>>48	belong&0xf0000000	0x90000000	MIPS64 rel2
>>16	beshort		0		no file type,
>>16	beshort		1		relocatable,
>>16	beshort		2		executable,
>>16	beshort		3		shared object,
d134 1
a134 1
>>18	beshort		8		MIPS,
d136 2
a137 2
>>18	beshort		10		MIPS (deprecated),
>>18	beshort		11		RS6000,
d144 2
d149 1
a149 1
>>18	beshort		0x9026		Alpha,
@


1.1.1.1
log
@Import the OpenBSD foundation of MirOS BSD
@
text
@@


1.1.1.2
log
@Import almost everything (no ancontrol, ifconfig, pfctl, wicontrol)
of (the undeleted parts of) OpenBSD-current's userland of about 3 hours ago.
Warning: this introduces major breakage!
@
text
@d1 1
a1 1
#	$OpenBSD: elf,v 1.14 2004/10/27 18:12:44 pefo Exp $
a18 4
>>16	leshort		0		no file type,
>>16	leshort		1		relocatable,
>>16	leshort		2		executable,
>>16	leshort		3		shared object,
d23 9
a31 9
>>>>36	lelong&0xf0000000	0x00000000	MIPS-I,
>>>>36	lelong&0xf0000000	0x10000000	MIPS-II,
>>>>36	lelong&0xf0000000	0x20000000	MIPS-III,
>>>>36	lelong&0xf0000000	0x30000000	MIPS-IV,
>>>>36	lelong&0xf0000000	0x40000000	MIPS-V,
>>>>36	lelong&0xf0000000	0x60000000	MIPS32,
>>>>36	lelong&0xf0000000	0x70000000	MIPS64,
>>>>36	lelong&0xf0000000	0x80000000	MIPS32 rel2,
>>>>36	lelong&0xf0000000	0x90000000	MIPS64 rel2,
d34 13
a46 9
>>>>48	lelong&0xf0000000	0x00000000	MIPS-I,
>>>>48	lelong&0xf0000000	0x10000000	MIPS-II,
>>>>48	lelong&0xf0000000	0x20000000	MIPS-III,
>>>>48	lelong&0xf0000000	0x30000000	MIPS-IV,
>>>>48	lelong&0xf0000000	0x40000000	MIPS-V,
>>>>48	lelong&0xf0000000	0x60000000	MIPS32,
>>>>48	lelong&0xf0000000	0x70000000	MIPS64 ,
>>>>48	lelong&0xf0000000	0x80000000	MIPS32 rel2,
>>>>48	lelong&0xf0000000	0x90000000	MIPS64 rel2,
d59 1
a59 1
# >>18	leshort		8		MIPS,
a76 4
>>16	beshort		0		no file type,
>>16	beshort		1		relocatable,
>>16	beshort		2		executable,
>>16	beshort		3		shared object,
d81 9
a89 9
>>>>36	belong&0xf0000000	0x00000000	MIPS-I,
>>>>36	belong&0xf0000000	0x10000000	MIPS-II,
>>>>36	belong&0xf0000000	0x20000000	MIPS-III,
>>>>36	belong&0xf0000000	0x30000000	MIPS-IV,
>>>>36	belong&0xf0000000	0x40000000	MIPS-V,
>>>>36	belong&0xf0000000	0x60000000	MIPS32,
>>>>36	belong&0xf0000000	0x70000000	MIPS64,
>>>>36	belong&0xf0000000	0x80000000	MIPS32 rel2,
>>>>36	belong&0xf0000000	0x90000000	MIPS64 rel2,
d92 13
a104 9
>>>>48	belong&0xf0000000	0x00000000	MIPS-I,
>>>>48	belong&0xf0000000	0x10000000	MIPS-II,
>>>>48	belong&0xf0000000	0x20000000	MIPS-III,
>>>>48	belong&0xf0000000	0x30000000	MIPS-IV,
>>>>48	belong&0xf0000000	0x40000000	MIPS-V,
>>>>48	belong&0xf0000000	0x60000000	MIPS32,
>>>>48	belong&0xf0000000	0x70000000	MIPS64 ,
>>>>48	belong&0xf0000000	0x80000000	MIPS32 rel2,
>>>>48	belong&0xf0000000	0x90000000	MIPS64 rel2,
d116 1
a116 1
# >>18	beshort		8		MIPS,
@


1.1.1.3
log
@I've been waiting for them to fix the security issues in file(1) for MONTHS
@
text
@d1 1
a1 1
#	$OpenBSD: elf,v 1.15 2006/10/12 03:32:32 drahn Exp $
a68 1
>>18	leshort		42		SH
a125 1
>>18	beshort		42		SH - invalid byte order,
@


