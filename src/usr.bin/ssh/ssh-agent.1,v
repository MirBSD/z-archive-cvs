head	1.9;
access;
symbols
	cvs-200910041320:1.1.1.8
	cvs-200903221200:1.1.1.7
	cvs-200812162015:1.1.1.7
	cvs-200804031830:1.1.1.6
	MIRBSD_10:1.7.0.2
	MIRBSD_10_BASE:1.7
	cvs-200803022030:1.1.1.6
	cvs-200709131337:1.1.1.6
	cvs-200709021830:1.1.1.5
	cvs-200708201200:1.1.1.5
	cvs-200706161500:1.1.1.5
	cvs-200705192215:1.1.1.4
	cvs-200704292000:1.1.1.4
	cvs-200703080900:1.1.1.4
	cvs-200701251600:1.1.1.4
	cvs-200612111600:1.1.1.4
	cvs-200611090230:1.1.1.4
	OPENBSD_4_0:1.1.1.4
	MIRBSD_9_BASE:1.4
	cvs-200606162342:1.1.1.3
	cvs-200606022000:1.1.1.3
	cvs-200604191000:1.1.1.3
	cvs-200602220045:1.1.1.3
	MIRBSD_8:1.4.0.2
	MIRBSD_8_BASE:1.4
	cvs-200512201942:1.1.1.3
	cvs-200511231930:1.1.1.2
	cvs-200507211800:1.1.1.2
	cvs-200506221550:1.1.1.2
	cvs-200505050030:1.1.1.2
	cvs-200504291700:1.1.1.2
	cvs-200504261445:1.1.1.2
	cvs-200504141900:1.1.1.1
	openbsd:1.1.1;
locks; strict;
comment	@.\" @;


1.9
date	2009.10.04.14.29.09;	author tg;	state Exp;
branches;
next	1.8;
commitid	1004AC8B1276FC00211;

1.8
date	2008.12.16.20.55.28;	author tg;	state Exp;
branches;
next	1.7;
commitid	100494815C97ECEEDBF;

1.7
date	2007.09.13.13.52.54;	author tg;	state Exp;
branches;
next	1.6;
commitid	10046E940B668DE9A0B;

1.6
date	2007.06.16.15.41.51;	author tg;	state Exp;
branches;
next	1.5;
commitid	100467404D10F2EE204;

1.5
date	2006.09.20.21.41.05;	author tg;	state Exp;
branches;
next	1.4;
commitid	1004511B578580E7F04;

1.4
date	2005.12.20.19.57.35;	author tg;	state Exp;
branches;
next	1.3;
commitid	10043A8623F4C1F637E;

1.3
date	2005.04.26.15.21.50;	author tg;	state Exp;
branches;
next	1.2;

1.2
date	2005.03.13.18.33.31;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.02.05.17.29.55;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.02.05.17.29.55;	author tg;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2005.04.26.14.55.02;	author tg;	state Exp;
branches;
next	1.1.1.3;

1.1.1.3
date	2005.12.20.19.43.45;	author tg;	state Exp;
branches;
next	1.1.1.4;
commitid	10043A85EF81EF097CF;

1.1.1.4
date	2006.09.20.19.06.50;	author tg;	state Exp;
branches;
next	1.1.1.5;
commitid	10045119150397FC669;

1.1.1.5
date	2007.06.16.15.11.13;	author tg;	state Exp;
branches;
next	1.1.1.6;
commitid	1004673FD85114A3F32;

1.1.1.6
date	2007.09.13.13.39.04;	author tg;	state Exp;
branches;
next	1.1.1.7;
commitid	10046E93D7724AAC1F8;

1.1.1.7
date	2008.12.16.20.15.34;	author tg;	state Exp;
branches;
next	1.1.1.8;
commitid	10049480C7A2701F5C0;

1.1.1.8
date	2009.10.04.13.25.45;	author tg;	state Exp;
branches;
next	;
commitid	1004AC8A2663BC008C5;


desc
@@


1.9
log
@• merge newer OpenSSH
• KNF in our diff – style(9)
• some const cleanliness (build with __CRAZY=Yes mostly)
@
text
@.\" $MirOS: src/usr.bin/ssh/ssh-agent.1,v 1.8 2008/12/16 20:55:28 tg Exp $
.\" $OpenBSD: ssh-agent.1,v 1.47 2009/03/26 08:38:39 sobrado Exp $
.\"
.\" Author: Tatu Ylonen <ylo@@cs.hut.fi>
.\" Copyright (c) 1995 Tatu Ylonen <ylo@@cs.hut.fi>, Espoo, Finland
.\"                    All rights reserved
.\"
.\" As far as I am concerned, the code I have written for this software
.\" can be used freely for any purpose.  Any derived versions of this
.\" software must be clearly marked as such, and if the derived work is
.\" incompatible with the protocol description in the RFC file, it must be
.\" called by a name other than "ssh" or "Secure Shell".
.\"
.\" Copyright (c) 1999,2000 Markus Friedl.  All rights reserved.
.\" Copyright (c) 1999 Aaron Campbell.  All rights reserved.
.\" Copyright (c) 1999 Theo de Raadt.  All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
.\" IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
.\" OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
.\" IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
.\" INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
.\" NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
.\" DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
.\" THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
.\" (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
.\" THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
.\"
.Dd $Mdocdate: October 4 2009 $
.Dt SSH-AGENT 1
.Os
.Sh NAME
.Nm ssh-agent
.Nd authentication agent
.Sh SYNOPSIS
.Nm ssh-agent
.Op Fl c Li | Fl s
.Op Fl d
.Op Fl a Ar bind_address
.Op Fl t Ar life
.Op Ar command Op Ar arg ...
.Nm ssh-agent
.Op Fl c Li | Fl s
.Fl k
.Sh DESCRIPTION
.Nm
is a program to hold private keys used for public key authentication
(RSA, DSA).
The idea is that
.Nm
is started in the beginning of an X-session or a login session, and
all other windows or programs are started as clients to the ssh-agent
program.
Through use of environment variables the agent can be located
and automatically used for authentication when logging in to other
machines using
.Xr ssh 1 .
.Pp
The options are as follows:
.Bl -tag -width Ds
.It Fl a Ar bind_address
Bind the agent to the unix-domain socket
.Ar bind_address .
The default is
.Pa /tmp/ssh-XXXXXXXXXX/agent.\*(Ltppid\*(Gt .
.It Fl c
Generate C-shell commands on
.Dv stdout .
This is the default if
.Ev SHELL
looks like it's a csh style of shell.
.It Fl d
Debug mode.
When this option is specified
.Nm
will not fork.
.It Fl k
Kill the current agent (given by the
.Ev SSH_AGENT_PID
environment variable).
.It Fl s
Generate Bourne shell commands on
.Dv stdout .
This is the default if
.Ev SHELL
does not look like it's a csh style of shell.
.It Fl t Ar life
Set a default value for the maximum lifetime of identities added to the agent.
The lifetime may be specified in seconds or in a time format specified in
.Xr sshd_config 5 .
A lifetime specified for an identity with
.Xr ssh-add 1
overrides this value.
Without this option the default maximum lifetime is forever.
.El
.Pp
If a commandline is given, this is executed as a subprocess of the agent.
When the command dies, so does the agent.
.Pp
The agent initially does not have any private keys.
Keys are added using
.Xr ssh-add 1 .
When executed without arguments,
.Xr ssh-add 1
adds the files
.Pa ~/.etc/ssh/id_rsa ,
.Pa ~/.etc/ssh/id_dsa
and
.Pa ~/.etc/ssh/identity .
If the identity has a passphrase,
.Xr ssh-add 1
asks for the passphrase (using a small X11 application if running
under X11, or from the terminal if running without X).
It then sends the identity to the agent.
Several identities can be stored in the
agent; the agent can automatically use any of these identities.
.Ic ssh-add -l
displays the identities currently held by the agent.
.Pp
The idea is that the agent is run in the user's local PC, laptop, or
terminal.
Authentication data need not be stored on any other
machine, and authentication passphrases never go over the network.
However, the connection to the agent is forwarded over SSH
remote logins, and the user can thus use the privileges given by the
identities anywhere in the network in a secure way.
.Pp
There are two main ways to get an agent set up:
The first is that the agent starts a new subcommand into which some environment
variables are exported, eg
.Cm ssh-agent xterm & .
The second is that the agent prints the needed shell commands (either
.Xr sh 1
or
.Xr csh 1
syntax can be generated) which can be evaluated in the calling shell, eg
.Cm eval $(ssh-agent -s)
for Bourne-type shells such as
.Xr sh 1
or
.Xr ksh 1
and
.Cm eval $(ssh-agent -c)
for
.Xr csh 1
and derivatives.
.Pp
Later
.Xr ssh 1
looks at these variables and uses them to establish a connection to the agent.
.Pp
The agent will never send a private key over its request channel.
Instead, operations that require a private key will be performed
by the agent, and the result will be returned to the requester.
This way, private keys are not exposed to clients using the agent.
.Pp
A unix-domain socket is created
and the name of this socket is stored in the
.Ev SSH_AUTH_SOCK
environment
variable.
The socket is made accessible only to the current user.
This method is easily abused by root or another instance of the same
user.
.Pp
The
.Ev SSH_AGENT_PID
environment variable holds the agent's process ID.
.Pp
The agent exits automatically when the command given on the command
line terminates.
.Sh FILES
.Bl -tag -width Ds
.It Pa ~/.etc/ssh/identity
Contains the protocol version 1 RSA authentication identity of the user.
.It Pa ~/.etc/ssh/id_dsa
Contains the protocol version 2 DSA authentication identity of the user.
.It Pa ~/.etc/ssh/id_rsa
Contains the protocol version 2 RSA authentication identity of the user.
.It Pa /tmp/ssh-XXXXXXXXXX/agent.\*(Ltppid\*(Gt
Unix-domain sockets used to contain the connection to the
authentication agent.
These sockets should only be readable by the owner.
The sockets should get automatically removed when the agent exits.
.El
.Sh SEE ALSO
.Xr ssh 1 ,
.Xr ssh-add 1 ,
.Xr ssh-keygen 1 ,
.Xr sshd 8
.Sh AUTHORS
OpenSSH is a derivative of the original and free
ssh 1.2.12 release by Tatu Ylonen.
Aaron Campbell, Bob Beck, Markus Friedl, Niels Provos,
Theo de Raadt and Dug Song
removed many bugs, re-added newer features and
created OpenSSH.
Markus Friedl contributed the support for SSH
protocol versions 1.5 and 2.0.
@


1.8
log
@fastmerge, do not use yet!
@
text
@d1 2
a2 2
.\" $MirOS: src/usr.bin/ssh/ssh-agent.1,v 1.7 2007/09/13 13:52:54 tg Exp $
.\" $OpenBSD: ssh-agent.1,v 1.46 2007/09/09 11:38:01 sobrado Exp $
d38 1
a38 1
.Dd $Mdocdate: December 16 2008 $
d145 1
a145 1
syntax can be generated) which can be evalled in the calling shell, eg
@


1.7
log
@merge and make UMAC-64 default message integrity whatever
@
text
@d1 1
a1 1
.\" $MirOS: src/usr.bin/ssh/ssh-agent.1,v 1.6 2007/06/16 15:41:51 tg Exp $
d38 1
a38 1
.Dd $Mdocdate: September 13 2007 $
@


1.6
log
@sync’n’bump
@
text
@d1 2
a2 2
.\" $MirOS: src/usr.bin/ssh/ssh-agent.1,v 1.5 2006/09/20 21:41:05 tg Exp $
.\" $OpenBSD: ssh-agent.1,v 1.45 2007/05/31 19:20:16 jmc Exp $
d38 1
a38 1
.Dd $Mdocdate: June 16 2007 $
d46 2
a48 1
.Op Fl c Li | Fl s
d50 1
a50 2
.Op Fl d
.Op Ar command Op Ar args ...
d81 9
a95 4
.It Fl k
Kill the current agent (given by the
.Ev SSH_AGENT_PID
environment variable).
a103 5
.It Fl d
Debug mode.
When this option is specified
.Nm
will not fork.
@


1.5
log
@finish merging
@
text
@d1 2
a2 2
.\" $MirOS: src/usr.bin/ssh/ssh-agent.1,v 1.4 2005/12/20 19:57:35 tg Exp $
.\" $OpenBSD: ssh-agent.1,v 1.44 2006/07/18 08:03:09 jmc Exp $
d38 1
a38 1
.Dd September 25, 1999
@


1.4
log
@fastmerge, bump version
@
text
@d1 2
a2 2
.\" $MirOS: src/usr.bin/ssh/ssh-agent.1,v 1.3 2005/04/26 15:21:50 tg Exp $
.\" $OpenBSD: ssh-agent.1,v 1.43 2005/11/28 06:02:56 dtucker Exp $
d74 1
a74 1
.Pa /tmp/ssh-XXXXXXXXXX/agent.<ppid> .
d189 1
a189 1
.It Pa /tmp/ssh-XXXXXXXXXX/agent.<ppid>
@


1.3
log
@* merge
* standardise on british spelling
* bump version
@
text
@d1 2
a2 2
.\" $MirOS: src/usr.bin/ssh/ssh-agent.1,v 1.2 2005/03/13 18:33:31 tg Exp $
.\" $OpenBSD: ssh-agent.1,v 1.42 2005/04/21 06:17:50 djm Exp $
d74 1
a74 1
.Pa /tmp/ssh-XXXXXXXX/agent.<ppid> .
d94 1
a94 1
.Xr sshd 8 .
d189 1
a189 1
.It Pa /tmp/ssh-XXXXXXXX/agent.<ppid>
@


1.2
log
@merge src/usr.bin
@
text
@d1 2
a2 2
.\" $MirOS$
.\" $OpenBSD: ssh-agent.1,v 1.41 2004/07/11 17:48:47 deraadt Exp $
d115 2
a116 2
.Pa $HOME/.etc/ssh/id_rsa ,
.Pa $HOME/.etc/ssh/id_dsa
d118 1
a118 1
.Pa $HOME/.etc/ssh/identity .
d183 1
a183 1
.It Pa $HOME/.etc/ssh/identity
d185 1
a185 1
.It Pa $HOME/.etc/ssh/id_dsa
d187 1
a187 1
.It Pa $HOME/.etc/ssh/id_rsa
@


1.1
log
@Initial revision
@
text
@d1 1
d115 2
a116 2
.Pa $HOME/.ssh/id_rsa ,
.Pa $HOME/.ssh/id_dsa
d118 1
a118 1
.Pa $HOME/.ssh/identity .
d146 1
a146 1
.Cm eval `ssh-agent -s`
d152 1
a152 1
.Cm eval `ssh-agent -c`
d183 1
a183 1
.It Pa $HOME/.ssh/identity
d185 1
a185 1
.It Pa $HOME/.ssh/id_dsa
d187 1
a187 1
.It Pa $HOME/.ssh/id_rsa
@


1.1.1.1
log
@Import the OpenBSD foundation of MirOS BSD
@
text
@@


1.1.1.2
log
@latest fixes from OpenBSD, last update for #8 if nothing weird happens
@
text
@d1 1
a1 1
.\" $OpenBSD: ssh-agent.1,v 1.42 2005/04/21 06:17:50 djm Exp $
d114 2
a115 2
.Pa ~/.ssh/id_rsa ,
.Pa ~/.ssh/id_dsa
d117 1
a117 1
.Pa ~/.ssh/identity .
d182 1
a182 1
.It Pa ~/.ssh/identity
d184 1
a184 1
.It Pa ~/.ssh/id_dsa
d186 1
a186 1
.It Pa ~/.ssh/id_rsa
@


1.1.1.3
log
@OpenSSH is the last missing piece to update before the release
@
text
@d1 1
a1 1
.\" $OpenBSD: ssh-agent.1,v 1.43 2005/11/28 06:02:56 dtucker Exp $
d73 1
a73 1
.Pa /tmp/ssh-XXXXXXXXXX/agent.<ppid> .
d93 1
a93 1
.Xr sshd_config 5 .
d188 1
a188 1
.It Pa /tmp/ssh-XXXXXXXXXX/agent.<ppid>
@


1.1.1.4
log
@import a few security-wise relevant changes right now
@
text
@d1 1
a1 1
.\" $OpenBSD: ssh-agent.1,v 1.44 2006/07/18 08:03:09 jmc Exp $
d73 1
a73 1
.Pa /tmp/ssh-XXXXXXXXXX/agent.\*(Ltppid\*(Gt .
d188 1
a188 1
.It Pa /tmp/ssh-XXXXXXXXXX/agent.\*(Ltppid\*(Gt
@


1.1.1.5
log
@Import latest OpenSSH and OpenBSD-libssl
@
text
@d1 1
a1 1
.\" $OpenBSD: ssh-agent.1,v 1.45 2007/05/31 19:20:16 jmc Exp $
d37 1
a37 1
.Dd $Mdocdate$
@


1.1.1.6
log
@Import latest OpenSSH upgrades
@
text
@d1 1
a1 1
.\" $OpenBSD: ssh-agent.1,v 1.46 2007/09/09 11:38:01 sobrado Exp $
d37 1
a37 1
.Dd $Mdocdate: May 31 2007 $
d45 1
d47 1
d49 1
a49 3
.Op Fl a Ar bind_address
.Op Fl t Ar life
.Op Ar command Op Ar arg ...
a79 9
.It Fl d
Debug mode.
When this option is specified
.Nm
will not fork.
.It Fl k
Kill the current agent (given by the
.Ev SSH_AGENT_PID
environment variable).
d86 4
d98 5
@


1.1.1.7
log
@OpenSSH-current
@
text
@d37 1
a37 1
.Dd $Mdocdate: September 9 2007 $
@


1.1.1.8
log
@Let’s play the version number game – OpenSSH 5.3-current
@
text
@d1 1
a1 1
.\" $OpenBSD: ssh-agent.1,v 1.47 2009/03/26 08:38:39 sobrado Exp $
d37 1
a37 1
.Dd $Mdocdate: March 26 2009 $
d144 1
a144 1
syntax can be generated) which can be evaluated in the calling shell, eg
@


