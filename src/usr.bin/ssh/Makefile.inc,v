head	1.16;
access;
symbols
	cvs-200910041320:1.1.1.3
	cvs-200903221200:1.1.1.3
	cvs-200812162015:1.1.1.3
	cvs-200804031830:1.1.1.2
	MIRBSD_10:1.9.0.2
	MIRBSD_10_BASE:1.9
	cvs-200803022030:1.1.1.2
	cvs-200709131337:1.1.1.2
	cvs-200709021830:1.1.1.2
	cvs-200708201200:1.1.1.2
	cvs-200706161500:1.1.1.2
	cvs-200705192215:1.1.1.2
	cvs-200704292000:1.1.1.2
	cvs-200703080900:1.1.1.2
	cvs-200701251600:1.1.1.2
	cvs-200612111600:1.1.1.2
	cvs-200611090230:1.1.1.2
	OPENBSD_4_0:1.1.1.2
	MIRBSD_9_BASE:1.5
	cvs-200606162342:1.1.1.2
	cvs-200606022000:1.1.1.2
	cvs-200604191000:1.1.1.2
	cvs-200602220045:1.1.1.2
	MIRBSD_8:1.4.0.2
	MIRBSD_8_BASE:1.4
	cvs-200512201942:1.1.1.2
	cvs-200511231930:1.1.1.2
	cvs-200507211800:1.1.1.2
	cvs-200506221550:1.1.1.2
	cvs-200505050030:1.1.1.1
	cvs-200504291700:1.1.1.1
	cvs-200504261445:1.1.1.1
	cvs-200504141900:1.1.1.1
	openbsd:1.1.1;
locks; strict;
comment	@# @;


1.16
date	2016.01.14.19.23.00;	author tg;	state Exp;
branches;
next	1.15;
commitid	1005697F5AA3EA7E36D;

1.15
date	2014.03.28.22.31.54;	author tg;	state Exp;
branches;
next	1.14;
commitid	1005335F87233372394;

1.14
date	2013.08.06.17.06.28;	author tg;	state Exp;
branches;
next	1.13;
commitid	10052012D144F7753C5;

1.13
date	2013.08.05.22.06.19;	author tg;	state Exp;
branches;
next	1.12;
commitid	100520021D16E80D23B;

1.12
date	2009.10.04.20.48.34;	author tg;	state Exp;
branches;
next	1.11;
commitid	1004AC90A324358B9B6;

1.11
date	2008.12.16.20.55.17;	author tg;	state Exp;
branches;
next	1.10;
commitid	100494815C97ECEEDBF;

1.10
date	2008.11.23.07.02.12;	author tg;	state Exp;
branches;
next	1.9;
commitid	1004928FFD87A76C1C3;

1.9
date	2007.06.27.13.41.48;	author tg;	state Exp;
branches;
next	1.8;
commitid	1004682692D6A25C670;

1.8
date	2007.06.27.13.40.22;	author tg;	state Exp;
branches;
next	1.7;
commitid	100468268873E6EF4ED;

1.7
date	2007.06.27.10.50.42;	author tg;	state Exp;
branches;
next	1.6;
commitid	100468241093DBB48AE;

1.6
date	2007.05.08.21.52.56;	author tg;	state Exp;
branches;
next	1.5;
commitid	1004640F14A456E3051;

1.5
date	2006.02.22.02.16.43;	author tg;	state Exp;
branches;
next	1.4;
commitid	10043FBC991512A442B;

1.4
date	2005.06.22.16.11.38;	author tg;	state Exp;
branches;
next	1.3;
commitid	598b42b98dcf335f;

1.3
date	2005.04.15.16.28.27;	author tg;	state Exp;
branches;
next	1.2;

1.2
date	2005.03.13.18.33.29;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.02.05.17.29.52;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.02.05.17.29.52;	author tg;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2005.06.22.15.56.23;	author tg;	state Exp;
branches;
next	1.1.1.3;
commitid	181342b98a38fe99;

1.1.1.3
date	2008.12.16.20.15.31;	author tg;	state Exp;
branches;
next	;
commitid	10049480C7A2701F5C0;


desc
@@


1.16
log
@drop roaming code completely
@
text
@# $MirOS: src/usr.bin/ssh/Makefile.inc,v 1.15 2014/03/28 22:31:54 tg Exp $
# $OpenBSD: Makefile.inc,v 1.33 2008/11/04 08:22:12 djm Exp $

.ifndef _MODSRC_USR_BIN_SSH_MAKEFILE_INC
_MODSRC_USR_BIN_SSH_MAKEFILE_INC=1

CPPFLAGS+=	-I${.CURDIR}/..

CFLAGS+=	-Wall
CFLAGS+=	-Wpointer-arith
CFLAGS+=	-Wno-uninitialized
CFLAGS+=	-Wstrict-prototypes
CFLAGS+=	-Wmissing-prototypes
CFLAGS+=	-Wunused
CFLAGS+=	-Wsign-compare
CFLAGS+=	-Wbounded
CFLAGS+=	-Wshadow

CDIAGFLAGS+=	-Wno-cast-qual

#DEBUG=-g

#CPPFLAGS+=	-DSMARTCARD
#LDADD+=	-lsectok

.include <bsd.obj.mk>

.if exists(${.CURDIR}/../lib/${__objdir})
LDADD+=		-L${.CURDIR}/../lib/${__objdir} -lssh
DPADD+=		${.CURDIR}/../lib/${__objdir}/libssh.a
.else
LDADD+=		-L${.CURDIR}/../lib -lssh
DPADD+=		${.CURDIR}/../lib/libssh.a
.endif

.if exists(../Makefile.inc)
.  include "../Makefile.inc"
.endif

.endif
@


1.15
log
@replicate commit “remove experimental, never-enabled JPAKE code; ok markus@@” (djm, 2014/01/29 06:18:35) from upstream
@
text
@d1 1
a1 1
# $MirOS: src/usr.bin/ssh/Makefile.inc,v 1.14 2013/08/06 17:06:28 tg Exp $
a30 4
LD_R_ON=	-L${.CURDIR}/../libroaming_on/${__objdir} -lroaming_on
DP_R_ON=	${.CURDIR}/../libroaming_on/${__objdir}/libroaming_on.a
LD_R_OFF=	-L${.CURDIR}/../libroaming_off/${__objdir} -lroaming_off
DP_R_OFF=	${.CURDIR}/../libroaming_off/${__objdir}/libroaming_off.a
a33 4
LD_R_ON=	-L${.CURDIR}/../libroaming_on -lroaming_on
DP_R_ON=	${.CURDIR}/../libroaming_on/libroaming_on.a
LD_R_OFF=	-L${.CURDIR}/../libroaming_off -lroaming_off
DP_R_OFF=	${.CURDIR}/../libroaming_off/libroaming_off.a
@


1.14
log
@get rid of the now useless ZLIB_CONST
@
text
@d1 1
a1 1
# $MirOS: src/usr.bin/ssh/Makefile.inc,v 1.13 2013/08/05 22:06:19 tg Exp $
a22 2
#CPPFLAGS+=	-DJPAKE

@


1.13
log
@-DZCONST=const → -DZLIB_CONST

XXX sys/conf/Makefile.inc does it twice?
@
text
@d1 1
a1 1
# $MirOS: src/usr.bin/ssh/Makefile.inc,v 1.12 2009/10/04 20:48:34 tg Exp $
a7 1
CPPFLAGS+=	-DZLIB_CONST
@


1.12
log
@attempt to unbreak OgreSSH...
@
text
@d1 1
a1 1
# $MirOS: src/usr.bin/ssh/Makefile.inc,v 1.11 2008/12/16 20:55:17 tg Exp $
d8 1
a8 1
CPPFLAGS+=	-DZCONST=const
@


1.11
log
@fastmerge, do not use yet!
@
text
@d1 1
a1 1
# $MirOS: src/usr.bin/ssh/Makefile.inc,v 1.10 2008/11/23 07:02:12 tg Exp $
d32 6
a37 2
LDADD+=         -L${.CURDIR}/../lib/${__objdir} -lssh
DPADD+=         ${.CURDIR}/../lib/${__objdir}/libssh.a
d39 6
a44 2
LDADD+=         -L${.CURDIR}/../lib -lssh
DPADD+=         ${.CURDIR}/../lib/libssh.a
@


1.10
log
@building sshd as pie/pic has no benefit yet without the kernel patch,
and, from what I gather how OpenBSD does things, -fPIE will be impli-
cit unless -fPIC is given, so this stanza is unneccessary
@
text
@d1 2
a2 2
# $MirOS: src/usr.bin/ssh/Makefile.inc,v 1.9 2007/06/27 13:41:48 tg Exp $
# $OpenBSD: Makefile.inc,v 1.30 2005/06/17 02:45:19 djm Exp $
d24 2
@


1.9
log
@add -DPIC, from bsiegert@@, 10x
@
text
@d1 1
a1 1
# $MirOS: src/usr.bin/ssh/Makefile.inc,v 1.8 2007/06/27 13:40:22 tg Exp $
a40 2
COPTS+=		${PICFLAG} -DPIC

@


1.8
log
@• -pie didn't imply -fPIC, so add ${PICFLAG} to cflags
• since PIC is enough to do address space randomisation for shared
  libraries, and PIE didn't add any benefit, but wrecked NULL pointer
  checks due to mapping from address 0 onwards, revert PIE and only
  use PIC

to make PIE more useful, more kernel patches would be required
(which actually sounds like a plan ☻)
@
text
@d1 1
a1 1
# $MirOS: src/usr.bin/ssh/Makefile.inc,v 1.7 2007/06/27 10:50:42 tg Exp $
d41 1
a41 1
COPTS+=		${PICFLAG}
@


1.7
log
@bake OpenSSH (MirBSD SecureShell) as pies by default, like Debian
@
text
@d1 1
a1 1
# $MirOS: src/usr.bin/ssh/Makefile.inc,v 1.6 2007/05/08 21:52:56 tg Exp $
d41 1
a41 3
# make position-independent executables to gain improved
# address space randomisation on re-execution
LDFLAGS+=	-pie
@


1.6
log
@ZCONST
@
text
@d1 1
a1 1
# $MirOS: src/usr.bin/ssh/Makefile.inc,v 1.5 2006/02/22 02:16:43 tg Exp $
d41 4
@


1.5
log
@fix a lot of and kludge a few more __CRAZY problems, sync rcs id
@
text
@d1 1
a1 1
# $MirOS: src/usr.bin/ssh/Makefile.inc,v 1.4 2005/06/22 16:11:38 tg Exp $
d8 1
@


1.4
log
@merge
@
text
@d1 2
a2 2
# $MirOS: src/usr.bin/ssh/Makefile.inc,v 1.3 2005/04/15 16:28:27 tg Exp $
#	$OpenBSD: Makefile.inc,v 1.30 2005/06/17 02:45:19 djm Exp $
d19 2
@


1.3
log
@protect against multiple inclusion
this unbreaks ssh build
@
text
@d1 2
a2 2
# $MirOS: src/usr.bin/ssh/Makefile.inc,v 1.2 2005/03/13 18:33:29 tg Exp $
# $OpenBSD: Makefile.inc,v 1.29 2004/06/21 18:34:51 avsm Exp $
d12 1
a12 1
#CFLAGS+=	-Wstrict-prototypes
d15 1
a15 1
#CFLAGS+=	-Wsign-compare
d17 1
a17 1
#CFLAGS+=	-Wshadow
@


1.2
log
@merge src/usr.bin
@
text
@d1 1
a1 1
# $MirOS$
d4 3
d37 2
@


1.1
log
@Initial revision
@
text
@d1 2
a2 1
#	$OpenBSD: Makefile.inc,v 1.29 2004/06/21 18:34:51 avsm Exp $
d4 1
a4 1
CFLAGS+=	-I${.CURDIR}/..
d6 9
a14 10
CDIAGFLAGS=	-Wall
#CDIAGFLAGS+=	-Werror
CDIAGFLAGS+=	-Wpointer-arith
CDIAGFLAGS+=	-Wno-uninitialized
#CDIAGFLAGS+=	-Wstrict-prototypes
CDIAGFLAGS+=	-Wmissing-prototypes
CDIAGFLAGS+=	-Wunused
#CDIAGFLAGS+=	-Wsign-compare
CDIAGFLAGS+=	-Wbounded
#CDIAGFLAGS+=	-Wshadow
d18 1
a18 1
#CFLAGS+=	-DSMARTCARD
d30 4
@


1.1.1.1
log
@Import the OpenBSD foundation of MirOS BSD
@
text
@@


1.1.1.2
log
@most current OpenSSH.com
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.30 2005/06/17 02:45:19 djm Exp $
d9 1
a9 1
CDIAGFLAGS+=	-Wstrict-prototypes
d12 1
a12 1
CDIAGFLAGS+=	-Wsign-compare
d14 1
a14 1
CDIAGFLAGS+=	-Wshadow
@


1.1.1.3
log
@OpenSSH-current
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.33 2008/11/04 08:22:12 djm Exp $
a17 2
#CFLAGS+=	-DJPAKE

@


