head	1.12;
access;
symbols
	MIRBSD_10:1.6.0.2
	MIRBSD_10_BASE:1.6
	cvs-200702071700:1.1.1.2
	MIRBSD_9_BASE:1.3
	MIRBSD_8:1.2.0.2
	MIRBSD_8_BASE:1.2
	cvs-200507211800:1.1.1.1
	openbsd:1.1.1;
locks; strict;
comment	@# @;


1.12
date	2017.04.06.21.19.05;	author tg;	state Exp;
branches;
next	1.11;
commitid	10058E6B07B2F3DF9F4;

1.11
date	2014.09.01.21.41.53;	author tg;	state Exp;
branches;
next	1.10;
commitid	1005404E800592F748B;

1.10
date	2014.03.24.08.14.18;	author tg;	state Exp;
branches;
next	1.9;
commitid	100532FE97254D87FC7;

1.9
date	2014.03.23.20.04.24;	author tg;	state Exp;
branches;
next	1.8;
commitid	100532F3E601CC83CE2;

1.8
date	2013.12.31.14.16.05;	author bsiegert;	state Exp;
branches;
next	1.7;
commitid	10052C2D1A722F1A3A9;

1.7
date	2013.09.11.17.01.16;	author tg;	state Exp;
branches;
next	1.6;
commitid	1005230A1EC204C15F0;

1.6
date	2007.03.09.13.10.11;	author tg;	state Exp;
branches;
next	1.5;
commitid	10045F15CC71610A83E;

1.5
date	2007.02.07.17.10.03;	author tg;	state Exp;
branches;
next	1.4;
commitid	10045CA08025272E50E;

1.4
date	2006.10.28.20.28.15;	author tg;	state Exp;
branches;
next	1.3;
commitid	1004543BD6917334A56;

1.3
date	2006.06.16.22.55.11;	author tg;	state Exp;
branches;
next	1.2;
commitid	100449336D54F3F56E1;

1.2
date	2005.03.06.19.38.54;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.02.05.17.27.18;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.02.05.17.27.18;	author tg;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2007.02.07.17.05.46;	author tg;	state Exp;
branches;
next	;
commitid	10045CA0672701BAD89;


desc
@@


1.12
log
@rsync-related (but no bad idea for CVS, too) timezone/chroot changes:

• install /usr/share/zoneinfo/UTC into the chroot, always
• make /etc/localtime again a symlink to it (user-changeable, iff they also
  install the link target into /var/anoncvs/usr/share/zoneinfo/ manually⚠)
• install /var/anoncvs/usr/share/zoneinfo/posixrules as hardlink to UTC

⚠ these two new files are non-negotiable and must be regularily updated
@
text
@# $MirOS: src/share/zoneinfo/Makefile,v 1.11 2014/09/01 21:41:53 tg Exp $

TZDIR?=		${DESTDIR}/usr/share/zoneinfo
DATDIR=		${.CURDIR}/datfiles
YIT=		'${SHELL} -c ${DATDIR}/yearistype.sh'
ZIC?=		zic

TDATA=		africa antarctica asia australasia backward etcetera europe \
		factory northamerica pacificnew southamerica systemv
ALLDATA=	${TDATA} leapseconds
# Adjust the optarg to -p to fit your posixrules need.
ZICFLAGS=	-y ${YIT} -d ${TZDIR} -p Europe/Berlin

obj prereq depend includes all clean cleandir:

install:
	chmod -R u+w ${TZDIR}
	cd ${TZDIR} && \
	    mkdir -p Arctic Brazil Canada Chile Europe Mexico US
	ln -sf Berlin ${TZDIR}/Europe/Bonn
	cd ${DATDIR} && ${ZIC} ${ZICFLAGS} -L leapseconds ${TDATA}
	chown -R ${BINOWN}:${BINGRP} ${TZDIR}
	find ${TZDIR} -type f -print0 | xargs -0r chmod ${NONBINMODE}
	chmod -R a-w ${TZDIR}
	install -c -o root -g wheel -m 444 ${TZDIR}/UTC \
	    ${DESTDIR}/var/anoncvs/usr/share/zoneinfo/UTC
	cd ${DESTDIR}/var/anoncvs/usr/share/zoneinfo && ln -f UTC posixrules

.include <bsd.own.mk>
@


1.11
log
@stop installing
• /usr/share/misc/iso3166.tab (to be merged into acronyms)
• /usr/share/zoneinfo/zone.tab (new zone1970.tab, besides nothing uses it)
@
text
@d1 1
a1 1
# $MirOS: src/share/zoneinfo/Makefile,v 1.10 2014/03/24 08:14:18 tg Exp $
d25 3
@


1.10
log
@drop now-empty dir
@
text
@d1 1
a1 1
# $MirOS: src/share/zoneinfo/Makefile,v 1.9 2014/03/23 20:04:24 tg Exp $
d10 1
a10 1
ALLDATA=	${TDATA} iso3166.tab leapseconds zone.tab
a21 1
	${INSTALL} -c ${DATDIR}/zone.tab ${TZDIR}/
a24 2
	${INSTALL} -c -o ${BINOWN} -g ${BINGRP} -m ${NONBINMODE} \
	    ${DATDIR}/iso3166.tab ${DESTDIR}/usr/share/misc/
@


1.9
log
@fastmerge
@
text
@d1 1
a1 1
# $MirOS: src/share/zoneinfo/Makefile,v 1.8 2013/12/31 14:16:05 bsiegert Exp $
d19 1
a19 1
	    mkdir -p Arctic Brazil Canada Chile Europe Mexico Mideast US
@


1.8
log
@Add an empty "includes" target, so that the recursive 'make includes' does
not fail.
@
text
@d1 1
a1 1
# $MirOS: src/share/zoneinfo/Makefile,v 1.7 2013/09/11 17:01:16 tg Exp $
d8 2
a9 3
TDATA=		africa antarctica asia australasia etcetera europe \
		factory northamerica pacificnew solar87 solar88 \
		solar89 southamerica systemv backward
@


1.7
log
@new timezones
@
text
@d1 1
a1 1
# $MirOS: src/share/zoneinfo/Makefile,v 1.6 2007/03/09 13:10:11 tg Exp $
d15 1
a15 1
obj prereq depend all clean cleandir:
@


1.6
log
@sync with tzdata2007a
@
text
@d1 1
a1 1
# $MirOS: src/share/zoneinfo/Makefile,v 1.5 2007/02/07 17:10:03 tg Exp $
d20 2
a21 1
	    mkdir -p Arctic Brazil Canada Chile Mexico Mideast US
@


1.5
log
@merge
@
text
@d1 1
a1 1
# $MirOS: src/share/zoneinfo/Makefile,v 1.4 2006/10/28 20:28:15 tg Exp $
d20 1
a20 1
	    mkdir -p Arctic Brazil Canada Chile Mexico Mideast SystemV US
@


1.4
log
@shut up systrace (missing link-target's parent dir)
@
text
@d1 1
a1 1
# $MirOS: src/share/zoneinfo/Makefile,v 1.3 2006/06/16 22:55:11 tg Exp $
d22 1
d24 1
a24 1
	find ${TZDIR} -type f | xargs chmod ${NONBINMODE}
d26 2
@


1.3
log
@make 'share' cross-buildable and installable as non-root;
don't build I18N modules if NOPIC
@
text
@d1 1
a1 1
# $MirOS: src/share/zoneinfo/Makefile,v 1.2 2005/03/06 19:38:54 tg Exp $
d19 2
@


1.2
log
@merge src/share
@
text
@d1 1
a1 1
# $MirOS$
d18 1
@


1.1
log
@Initial revision
@
text
@d1 1
a1 2
#	$OpenBSD: Makefile,v 1.5 2002/02/18 22:08:32 millert Exp $
#	$NetBSD: Makefile,v 1.14 1995/04/22 12:10:17 cgd Exp $
d3 11
a13 4
# Change the line below for your time zone (after finding the zone you want in
# the time zone files, or adding it to a time zone file).
# Alternately, if you discover you've got the wrong time zone, you can just
#	zic -l rightzone
d15 1
a15 2
# This line has been moved to /usr/src/etc/Makefile
LOCALTIME=	US/Pacific
d17 2
a18 72
# If you want something other than Eastern United States time as a template
# for handling POSIX-style time zone environment variables,
# change the line below (after finding the zone you want in the
# time zone files, or adding it to a time zone file).
# Alternately, if you discover you've got the wrong time zone, you can just
#	zic -p rightzone

POSIXRULES=	US/Pacific

# Use an absolute path name for TZDIR unless you're just testing the software.

TZDIR=	${DESTDIR}/usr/share/zoneinfo

# If you always want time values interpreted as "seconds since the epoch
# (not counting leap seconds)", use
# 	REDO=		posix_only
# below.  If you always want right time values interpreted as "seconds since
# the epoch" (counting leap seconds)", use
#	REDO=		right_only
# below.  If you want both sets of data available, with leap seconds not
# counted normally, use
#	REDO=		posix_right
# below.  If you want both sets of data available, with leap seconds counted
# normally, use
#	REDO=		right_posix
# below.

REDO=		posix_right

# Since "." may not be in PATH...
YEARISTYPE=	${.CURDIR}/datfiles/yearistype.sh
YEARISTYPECOPY=	${.OBJDIR}/yearistypecopy

YDATA=		africa antarctica asia australasia \
		europe northamerica southamerica pacificnew etcetera factory \
		backward
NDATA=		systemv
SDATA=		solar87 solar88 solar89
TDATA=		$(YDATA) $(NDATA) $(SDATA)
TABDATA=	iso3166.tab zone.tab
DATA=		$(YDATA) $(NDATA) $(SDATA) $(TABDATA) leapseconds # yearistype.sh
USNO=		usno1988 usno1989 usno1989a usno1995 usno1997

ZIC=zic

all:	${YEARISTYPECOPY}

${YEARISTYPECOPY}:
	cp ${YEARISTYPE} yearistypecopy
	chmod u+x yearistypecopy

posix_only: ${TDATA} ${YEARISTYPECOPY}
	(cd ${.CURDIR}/datfiles; \
	    ${ZIC} -y ${YEARISTYPECOPY} -d ${TZDIR} -L /dev/null ${TDATA})

right_only: leapseconds ${TDATA} ${YEARISTYPECOPY}
	(cd ${.CURDIR}/datfiles; \
	    ${ZIC} -y ${YEARISTYPECOPY} -d ${TZDIR} -L leapseconds ${TDATA})

other_two: leapseconds ${TDATA} ${YEARISTYPECOPY}
	(cd ${.CURDIR}/datfiles; \
	    ${ZIC} -y ${YEARISTYPECOPY} -d ${TZDIR}/posix -L /dev/null ${TDATA})
	(cd ${.CURDIR}/datfiles; \
	    ${ZIC} -y ${YEARISTYPECOPY} -d ${TZDIR}/right -L leapseconds ${TDATA})

posix_right: posix_only other_two

right_posix: right_only other_two

realinstall: ${DATA} ${REDO} ${YEARISTYPECOPY}
	(cd ${.CURDIR}/datfiles; \
	    ${ZIC} -y ${YEARISTYPECOPY} -d ${TZDIR} -p ${POSIXRULES})
d20 2
a21 3
	find ${TZDIR} -type f | xargs chmod a=r

CLEANFILES+= yearistypecopy
d23 1
a23 2
.PATH:	${.CURDIR}/datfiles
.include <bsd.prog.mk>
@


1.1.1.1
log
@Import the OpenBSD foundation of MirOS BSD
@
text
@@


1.1.1.2
log
@Import tzdata2007a via OpenBSD
NB: I'm not importing tzcode because there are some major changes,
    a new TZif format/version (not yet enabled, but 64-bit safe) -
    which is the minor problem - and some changes to the code with
    yet not analysed implications
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.8 2006/02/11 16:16:34 espie Exp $
d85 1
a85 6
	find ${TZDIR} -type f -print0 | xargs -0r chmod a=r
	${INSTALL} -c -o root -g bin -m 644 ${.CURDIR}/datfiles/iso3166.tab \
	    ${DESTDIR}/usr/share/misc
	${INSTALL} -c -o root -g bin -m 644 ${.CURDIR}/datfiles/zone.tab \
	    ${DESTDIR}/usr/share/zoneinfo

@

