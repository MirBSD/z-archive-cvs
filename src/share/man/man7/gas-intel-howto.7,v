head	1.6;
access;
symbols
	MIRBSD_10:1.3.0.4
	MIRBSD_10_BASE:1.3
	MIRBSD_9_BASE:1.3
	MIRBSD_8:1.3.0.2
	MIRBSD_8_BASE:1.3
	mirbsd:1.1.7;
locks; strict;
comment	@.\" @;


1.6
date	2018.10.07.01.10.25;	author tg;	state Exp;
branches;
next	1.5;
commitid	1005BB95CA10BF418E8;

1.5
date	2018.07.15.13.41.26;	author tg;	state Exp;
branches;
next	1.4;
commitid	1005B4B4F0B4ECDB6D4;

1.4
date	2008.11.08.22.24.15;	author tg;	state Exp;
branches;
next	1.3;
commitid	1004916117E0B020D70;

1.3
date	2005.12.17.05.46.23;	author tg;	state Exp;
branches;
next	1.2;
commitid	10043A3A3E65E20A413;

1.2
date	2005.08.19.22.06.12;	author tg;	state Exp;
branches;
next	1.1;
commitid	2d66430657d7d2ae;

1.1
date	2005.03.06.16.33.41;	author tg;	state Exp;
branches
	1.1.7.1;
next	;

1.1.7.1
date	2005.03.06.16.33.41;	author tg;	state Exp;
branches;
next	;


desc
@@


1.6
log
@spelling cleanup: “programme” is distinct from “program”; even in
British English, the latter is used for computer programs, while
the former serves for things like the TV programme, or a programme
to plant trees
@
text
@.\" $MirOS: src/share/man/man7/gas-intel-howto.7,v 1.5 2018/07/15 13:41:26 tg Exp $
.\"-
.\" Copyright (c) 2004, 2005
.\"	Thorsten "mirabilos" Glaser <tg@@mirbsd.org>
.\"
.\" Licensee is hereby permitted to deal in this work without restric-
.\" tion, including unlimited rights to use, publicly perform, modify,
.\" merge, distribute, sell, give away or sublicence, provided all co-
.\" pyright notices above, these terms and the disclaimer are retained
.\" in all redistributions or reproduced in accompanying documentation
.\" or other materials provided with binary redistributions.
.\"
.\" All advertising materials mentioning features or use of this soft-
.\" ware must display the following acknowledgement:
.\"	This product includes material provided by Thorsten Glaser.
.\"
.\" Licensor offers the work "AS IS" and WITHOUT WARRANTY of any kind,
.\" express, or implied, to the maximum extent permitted by applicable
.\" law, without malicious intent or gross negligence; in no event may
.\" licensor, an author or contributor be held liable for any indirect
.\" or other damage, or direct damage except proven a consequence of a
.\" direct error of said person and intended use of this work, loss or
.\" other issues arising in any way out of its use, even if advised of
.\" the possibility of such damage or existence of a nontrivial bug.
.\"-
.\" Hopefully, this small tutorial takes away the fear from both UNIX(R)
.\" programmers coming from GAS AT&T move, and PC programmers from NASM.
.\"
.TH gas-intel-howto 7 "January 26th, 2004" "" "MirOS Tutorial"
.SH NAME
gas-intel-howto \- How to write Intel syntax \
assembly code with the GNU assembler
.SH TUTORIAL
Did you always wonder how this new Intel mode of \fBas(1)\fR could
be used?
Did you wonder why the GNU Texinfo documentation is wrong?
.br
This is the answer.
.PP
First off, how would you start an assembly language program?
This is a real-life example:
.PP
.DT
.nf
/* copyright ...
 */

#include <machine/asm.h>

	\&.intel_syntax noprefix
	\&.text
.fi
.PP
Now, you can use all the well-known ops and pseudo-ops
from the gas and intel world.
You just need to keep track, which one to use.
.br
Did you know you can concatenate assembly lines with
a semicolon ('\;')?
Now, how do you issue comments?
.br
It's easy.
Using \fBgcc \-c \-o fnord.o fnord.S\fR automatically
uses the C Preprocessor, \fBcpp(1)\fR, on the file first.
That's why the C-style comment in the above example could
be used.
.SH PSEUDO-OPS
All these pseudo-ops, and more, are supported on ELF:
.br
.TP 3
\&.text
Denotes a code segment.
.TP 3
\&.data
Denotes the data segment.
.TP 3
\&.bss
Denotes reserved space.
.TP 3
\&.code32
Generate code for a 32-bit segment (default).
.TP 3
\&.code16
Generate code for a 16-bit segment.
.TP 3
\&.globl \fBsymbol\fR
This defines a global symbol.
For ELF you apparently also need:
.PP
\&.type \fBsymbol\fR, @@function
.RS 3
This denotes the ELF symbol type.
You'd better use the \fBENTRY(symbol)\fR macro though.
.RE
.TP 3
\&.byte \&.word \&.long
Define bytes (etc.), akin the \fBdb\fR command in TASM.
.TP 3
\&.ascii "foo"
Define a string, also the same as the \fBdb\fR command.
.TP 3
\&.asciz "foo"
Define a zero-terminated string.
There needs not be extra \fB\&.byte 0x0A\fR commands for
control characters; rather use C escapes like this:
.DT
.nf
\&.data
foo:	\&.asciz  "Hello, World!\en"
\&.text
bar:	mov     eax,offset foo
	push    eax
	call    printf
	pop     eax
	ret
.fi
.SH OPERATIONS
This example also shows the basic command usage.
Some commands are different from both Intel common
and the gas intel_mode texinfo documentation.
.TP 3
lret
Used exactly as the \fBretf\fR command.
.TP 3
mov byte ptr [bx],0x80
The \fBbyte ptr\fR is a must.
.TP 3
jmp 0xF000,0xFFF0
This is the way long jumps (\fBjmp far\fR) are defined.
The manual states wrongly that one has to use \fBjmpl\fR or \fBljmp\fR.
.TP 3
\&. = 0x40 + _start
The \fBorg\fR directive refined.
Better than in NASM.
It also is a good way to check code size boundaries.
.TP 3
rep movsd
Just write them one after the other.
.TP 3
fs mov eax,[0]
This is a segment prefix usage.
Note, here is no dword ptr needed.
.SH CONCLUSION
It's not difficult to write intel code in GNU as,
once you have learned about the differences.
In fact, it is even more consistent than for example
NASM, which insists on calling pushf pushfw, and
issues a pushfd when writing pushf in 32-bit mode.
.SH ACKNOWLEDGEMENTS
Copyright (c) 2004 Thorsten Glaser. All rights reserved.
.br
Credits go to Intel, AMD, Microsoft, Borland, the NASM
and YASM projects and the Free Software Foundation.
.SH BUGS
Probably some typos and omissions.
Also, my nroff isn't the best.
Should convert to mdoc.
.br
The discuss list at
.B http://www.mirbsd.org/rss.htm#lists
takes suggestions, please.
@


1.5
log
@further limit the amount of mailto links we’re giving out
@
text
@d1 1
a1 1
.\" $MirOS: src/share/man/man7/gas-intel-howto.7,v 1.4 2008/11/08 22:24:15 tg Exp $
d40 1
a40 1
First off, how would you start an assembly language programme?
@


1.4
log
@mass conversion 66h.42h.de → mirbsd.org
@
text
@d1 1
a1 1
.\" $MirOS: src/share/man/man7/gas-intel-howto.7,v 1.3 2005/12/17 05:46:23 tg Exp $
d159 3
a161 1
Suggestions to <miros-discuss@@mirbsd.org> please.
@


1.3
log
@big fat licence update (I left some which are bsiegert@@'s alone though)
also, remove licence boilerplate from some .h files who don't deserve it
and remove and add some advertising clauses because I say so
@
text
@d1 1
a1 1
.\" $MirOS: src/share/man/man7/gas-intel-howto.7,v 1.2 2005/08/19 22:06:12 tg Exp $
d4 1
a4 1
.\"	Thorsten "mirabile" Glaser <tg@@66h.42h.de>
d159 1
a159 1
Suggestions to <miros-discuss@@66h.42h.de> please.
@


1.2
log
@* found some omission while browsing and advocating
* note I should convert to mdoc some time
@
text
@d1 1
a1 1
.\" $MirOS: src/share/man/man7/gas-intel-howto.7,v 1.1.7.1 2005/03/06 16:33:41 tg Exp $
d13 12
a24 7
.\" Licensor hereby provides this work "AS IS" and WITHOUT WARRANTY of
.\" any kind, expressed or implied, to the maximum extent permitted by
.\" applicable law, but with the warranty of being written without ma-
.\" licious intent or gross negligence; in no event shall licensor, an
.\" author or contributor be held liable for any damage, direct, indi-
.\" rect or other, however caused, arising in any way out of the usage
.\" of this work, even if advised of the possibility of such damage.
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
.\" $MirOS$
d3 1
a3 1
.\" Copyright (c) 2004
d125 1
a125 1
The manual states one has to use \fBjmpl\fR or \fBljmp\fR.
d152 1
@


1.1.7.1
log
@Add some missing files, such as some ISDN4BSD stuff,
documentation, tmac and tab files, TAI64 etc.
@
text
@@
