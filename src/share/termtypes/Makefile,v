head	1.5;
access;
symbols
	MIRBSD_10:1.5.0.2
	MIRBSD_10_BASE:1.5
	MIRBSD_9_BASE:1.3
	MIRBSD_8:1.2.0.2
	MIRBSD_8_BASE:1.2
	cvs-200507211800:1.1.1.1
	openbsd:1.1.1;
locks; strict;
comment	@# @;


1.5
date	2007.06.17.14.38.24;	author tg;	state Exp;
branches;
next	1.4;
commitid	100467547676A291DE9;

1.4
date	2006.10.28.19.32.38;	author tg;	state Exp;
branches;
next	1.3;
commitid	1004543B03326B18792;

1.3
date	2006.06.16.22.55.10;	author tg;	state Exp;
branches;
next	1.2;
commitid	100449336D54F3F56E1;

1.2
date	2005.03.06.19.38.49;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.02.05.17.27.17;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.02.05.17.27.17;	author tg;	state Exp;
branches;
next	;


desc
@@


1.5
log
@work around that bug by having ncurses to the :tc=*: resolution
@
text
@# $MirOS: src/share/termtypes/Makefile,v 1.4 2006/10/28 19:32:38 tg Exp $
# $OpenBSD: Makefile,v 1.15 2000/02/17 19:58:34 millert Exp $
#
# Take termcap/terminfo master file and generate termcap/terminfo .db files
# master: http://catb.org/~esr/terminfo/termtypes.master.gz
#
# millert@@openbsd says we don't use the master but the version from ncurses
# since it's more actively maintained.

MAN=		termcap.5
CLEANFILES+=	terminfo.src termcap.src terminfo.db termcap.db

all: terminfo.db termcap.db

terminfo.src: termtypes.master
	${TIC} -r -I -x ${.ALLSRC} | sed \
	    -e 's,/usr/share/lib/tabset,/usr/share/tabset,g' \
	    -e 's,/usr/lib/tabset,/usr/share/tabset,g' \
	    >$@@
	@@if [ ! -s ${.TARGET} ]; then \
	    echo ${.TARGET} is zero length!  You need to update ${TIC} ;\
	    rm -f ${.TARGET} ;\
	    exit 1 ;\
	else case $$(sed 1q ${.TARGET}) in \
	    Usage*) echo ${.TARGET} is corrupt!  You need to update ${TIC} ;\
		    rm -f ${.TARGET} ;\
		    exit 1 ;;\
	    esac ;\
	fi

terminfo.db: terminfo.src
	cap_mkdb -cif terminfo terminfo.src

termcap.src: termtypes.master
	${TIC} -r -C -x ${.ALLSRC} | sed \
	    -e 's,/usr/share/lib/tabset,/usr/share/tabset,g' \
	    -e 's,/usr/lib/tabset,/usr/share/tabset,g' \
	    > ${.TARGET}
	@@if [ ! -s ${.TARGET} ]; then \
	    echo ${.TARGET} is zero length!  You need to update ${TIC} ;\
	    rm -f ${.TARGET} ;\
	    exit 1 ;\
	else case $$(sed 1q ${.TARGET}) in \
	    Usage*) echo ${.TARGET} is corrupt!  You need to update ${TIC} ;\
		    rm -f ${.TARGET} ;\
		    exit 1 ;;\
	    esac ;\
	fi

termcap.db: termcap.src
	cap_mkdb -cf termcap termcap.src

realinstall:
	${INSTALL} ${INSTALL_COPY} -o ${BINOWN} -g ${BINGRP} -m 444 terminfo.db \
	     ${DESTDIR}${BINDIR}/misc/terminfo.db
	${INSTALL} ${INSTALL_COPY} -o ${BINOWN} -g ${BINGRP} -m 444 termcap.db \
	     ${DESTDIR}${BINDIR}/misc/termcap.db
	${INSTALL} ${INSTALL_COPY} -o ${BINOWN} -g ${BINGRP} -m 444 termcap.src \
	     ${DESTDIR}${BINDIR}/misc/termcap
	ln -fs ${BINDIR}/misc/termcap ${DESTDIR}/etc/termcap

.include <bsd.prog.mk>

# Use the tic we just built if possible
.if ${CROSS_MODE:L} == "yes"
TIC=	/usr/bin/tic
.elif exists(${.CURDIR}/../../usr.bin/tic/${__objdir}/tic)
TIC=	${.CURDIR}/../../usr.bin/tic/${__objdir}/tic
.elif exists(../../usr.bin/tic/tic)
TIC=	../../usr.bin/tic/tic
.else
TIC=	/usr/bin/tic
.endif
@


1.4
log
@instead of always (as per termcap(5) and terminfo(5) spec) skipping the
comment field in the first capability of each record, only do so when a
new -c option is given, to retain compatibility with databases that are
no termcap/terminfo databases (conservative approach)
@
text
@d1 1
a1 1
# $MirOS: src/share/termtypes/Makefile,v 1.3 2006/06/16 22:55:10 tg Exp $
d16 1
a16 1
	${TIC} -I -x ${.ALLSRC} | sed \
d35 1
a35 1
	${TIC} -C -x ${.ALLSRC} | sed \
@


1.3
log
@make 'share' cross-buildable and installable as non-root;
don't build I18N modules if NOPIC
@
text
@d1 1
a1 1
# $MirOS: src/share/termtypes/Makefile,v 1.2 2005/03/06 19:38:49 tg Exp $
d32 1
a32 1
	cap_mkdb -i -f terminfo terminfo.src
d51 1
a51 1
	cap_mkdb -f termcap termcap.src
@


1.2
log
@merge src/share
@
text
@d1 1
a1 1
# $MirOS$
d65 3
a67 1
.if exists(${.CURDIR}/../../usr.bin/tic/${__objdir}/tic)
@


1.1
log
@Initial revision
@
text
@d1 2
a2 1
#	$OpenBSD: Makefile,v 1.15 2000/02/17 19:58:34 millert Exp $
d5 4
a8 1
# master: http://www.tuxedo.org/~esr/terminfo/termtypes.master.gz
d10 2
a11 2
MAN=	termcap.5
CLEANFILES+= terminfo.src termcap.src terminfo.db termcap.db
d19 1
a19 1
	    > ${.TARGET}
d24 1
a24 1
	else case `sed 1q ${.TARGET}` in \
d43 1
a43 1
	else case `sed 1q ${.TARGET}` in \
a59 2
	${INSTALL} ${INSTALL_COPY} -o ${BINOWN} -g ${BINGRP} -m 444 ${.CURDIR}/map3270 \
	     ${DESTDIR}${BINDIR}/misc/map3270
@


1.1.1.1
log
@Import the OpenBSD foundation of MirOS BSD
@
text
@@
