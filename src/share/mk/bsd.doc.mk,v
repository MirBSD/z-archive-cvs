head	1.4;
access;
symbols
	MIRBSD_10:1.3.0.4
	MIRBSD_10_BASE:1.3
	MIRBSD_9_BASE:1.3
	MIRBSD_8:1.3.0.2
	MIRBSD_8_BASE:1.3
	cvs-200507211800:1.1.1.1
	cvs-200507040220:1.1.1.1
	openbsd:1.1.1;
locks; strict;
comment	@# @;


1.4
date	2008.04.10.14.07.45;	author tg;	state Exp;
branches;
next	1.3;
commitid	10047FE1F455D192B1C;

1.3
date	2005.02.14.19.21.20;	author tg;	state Exp;
branches;
next	1.2;

1.2
date	2005.02.14.18.57.46;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.02.05.17.27.17;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.02.05.17.27.17;	author tg;	state Exp;
branches;
next	;


desc
@@


1.4
log
@optimise
@
text
@# $MirOS: src/share/mk/bsd.doc.mk,v 1.3 2005/02/14 19:21:20 tg Exp $
# $OpenBSD: bsd.doc.mk,v 1.8 2001/04/03 23:00:09 espie Exp $
# $NetBSD: bsd.doc.mk,v 1.20 1994/07/26 19:42:37 mycroft Exp $
# @@(#)bsd.doc.mk	8.1 (Berkeley) 8/14/93

.if !defined(BSD_DOC_MK)
BSD_DOC_MK=1

.if !defined(BSD_OWN_MK)
.  include <bsd.own.mk>
.endif

FILES?=	${SRCS}
.PATH: ${.CURDIR}

.if !target(all)
.MAIN: all
.  if target(paper.)
all:
	@@print -ru2 Fix Makefile and replace paper.\$${PRINTER} target \
	    by paper.ps; exit 1
.  else
all: paper.txt
.  endif
.endif

.if !target(paper.ps)
paper.ps: ${SRCS}
	${TBL} ${SRCS} | ${ROFF} >${.TARGET}
.endif

.if !target(paper.txt)
paper.txt: ${SRCS}
	@@(test -e paper.ps && mv paper.ps paper.tmp) 2>/dev/null || true
	@@${MAKE} paper.ps 'ROFF=${NROFF}' 2>&1 | sed 's/paper\.ps/$@@/'
	@@mv paper.ps $@@ || { mv paper.tmp paper.ps 2>/dev/null; false; }
	@@mv paper.tmp paper.ps 2>/dev/null || true
.endif

.if !target(print)
print: paper.ps
	lpr -P${PRINTER} paper.ps
.endif

.if !target(manpages)
manpages:
.endif

.if !target(obj)
obj:
.endif

clean cleandir:
	rm -f paper.{txt,tmp,ps} [eE]rrs mklog ${CLEANFILES}

install:
	${INSTALL} ${INSTALL_COPY} -o ${DOCOWN} -g ${DOCGRP} -m ${DOCMODE} \
	    Makefile ${FILES} ${EXTRA} ${DESTDIR}${DOCDIR}/${DIR}/

spell: paper.spell

paper.spell: ${SRCS}
	spell ${SRCS} | sort | comm -23 - spell.ok >paper.spell

.endif
@


1.3
log
@all:		optimise a bit
obj/subdir:	rewrite using mksh features
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/bsd.doc.mk,v 1.2 2005/02/14 18:57:46 tg Exp $
d20 2
a21 2
	@@echo 'Fix Makefile and replace paper.$${PRINTER} target by paper.ps'
	@@false
@


1.2
log
@merge these from ncvs 1
@
text
@d1 1
a1 1
# $MirOS$
d34 1
a34 1
	@@([ -e paper.ps ] && mv paper.ps paper.tmp) 2>/dev/null || true
@


1.1
log
@Initial revision
@
text
@d1 4
a4 14
#	$OpenBSD: bsd.doc.mk,v 1.8 2001/04/03 23:00:09 espie Exp $
#	$NetBSD: bsd.doc.mk,v 1.20 1994/07/26 19:42:37 mycroft Exp $
#	@@(#)bsd.doc.mk	8.1 (Berkeley) 8/14/93

BIB?=		bib
EQN?=		eqn
GREMLIN?=	grn
GRIND?=		vgrind -f
INDXBIB?=	indxbib
PIC?=		pic
REFER?=		refer
ROFF?=		groff -M/usr/share/tmac ${MACROS} ${PAGES}
SOELIM?=	soelim
TBL?=		tbl
d6 8
d18 7
a24 1
all: paper.ps
d29 9
a37 1
	${ROFF} ${SRCS} > ${.TARGET}
d54 1
a54 1
	rm -f paper.* [eE]rrs mklog ${CLEANFILES}
a55 1
FILES?=	${SRCS}
d58 1
a58 1
	    Makefile ${FILES} ${EXTRA} ${DESTDIR}${DOCDIR}/${DIR}
a61 1

d63 1
a63 1
	spell ${SRCS} | sort | comm -23 - spell.ok > paper.spell
d65 1
a65 1
.include <bsd.own.mk>
@


1.1.1.1
log
@Import the OpenBSD foundation of MirOS BSD
@
text
@@
