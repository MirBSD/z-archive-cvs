head	1.176;
access;
symbols
	MIRBSD_10:1.121.0.2
	MIRBSD_10_BASE:1.121
	tg-release_reconsider:1.108
	MIRBSD_9_BASE:1.69
	MIRBSD_8:1.46.0.2
	MIRBSD_8_BASE:1.46
	cvs-200507211800:1.1.1.2
	cvs-200507040220:1.1.1.2
	openbsd:1.1.1;
locks; strict;
comment	@# @;


1.176
date	2018.04.28.06.40.06;	author tg;	state Exp;
branches;
next	1.175;
commitid	1005AE4174433053689;

1.175
date	2017.04.08.16.05.43;	author tg;	state Exp;
branches;
next	1.174;
commitid	10058E90A645BB20D20;

1.174
date	2017.04.02.22.33.29;	author tg;	state Exp;
branches;
next	1.173;
commitid	10058E17C4B6583E8B5;

1.173
date	2015.10.24.19.48.18;	author tg;	state Exp;
branches;
next	1.172;
commitid	100562BE0930D590F1D;

1.172
date	2015.07.19.01.04.20;	author tg;	state Exp;
branches;
next	1.171;
commitid	10055AAF66673FA175E;

1.171
date	2014.02.20.01.01.01;	author tg;	state Exp;
branches;
next	1.170;
commitid	100530553E421091CD1;

1.170
date	2014.02.09.22.49.30;	author tg;	state Exp;
branches;
next	1.169;
commitid	10052F806114B993C09;

1.169
date	2014.02.09.21.29.29;	author tg;	state Exp;
branches;
next	1.168;
commitid	10052F7F348166BF103;

1.168
date	2014.01.11.15.15.37;	author tg;	state Exp;
branches;
next	1.167;
commitid	10052D16032467B9DCA;

1.167
date	2013.08.06.20.34.03;	author tg;	state Exp;
branches;
next	1.166;
commitid	10052015DD07D9B7A5C;

1.166
date	2013.05.31.23.27.51;	author tg;	state Exp;
branches;
next	1.165;
commitid	10051A931CB73794C1D;

1.165
date	2012.12.31.21.08.12;	author tg;	state Exp;
branches;
next	1.164;
commitid	10050E1FED458946E2C;

1.164
date	2012.09.02.11.02.19;	author tg;	state Exp;
branches;
next	1.163;
commitid	10050433CBA6822A3F3;

1.163
date	2012.01.14.22.28.43;	author tg;	state Exp;
branches;
next	1.162;
commitid	1004F1201B2586590CB;

1.162
date	2011.07.17.22.34.27;	author tg;	state Exp;
branches;
next	1.161;
commitid	1004E23638A312ABEDA;

1.161
date	2011.01.15.21.52.46;	author tg;	state Exp;
branches;
next	1.160;
commitid	1004D32173B08BB4E36;

1.160
date	2010.09.20.00.07.25;	author tg;	state Exp;
branches;
next	1.159;
commitid	1004C96A5A724DDF8E1;

1.159
date	2010.08.14.19.49.05;	author tg;	state Exp;
branches;
next	1.158;
commitid	1004C66F34849DCDB80;

1.158
date	2010.01.06.19.07.38;	author tg;	state Exp;
branches;
next	1.157;
commitid	1004B44DF660B3051D8;

1.157
date	2009.12.20.12.35.19;	author tg;	state Exp;
branches;
next	1.156;
commitid	1004B2E19EE11E297EC;

1.156
date	2009.12.13.00.32.21;	author tg;	state Exp;
branches;
next	1.155;
commitid	1004B2436206D706B48;

1.155
date	2009.11.22.21.05.35;	author tg;	state Exp;
branches;
next	1.154;
commitid	1004B09A7B66FB3BA92;

1.154
date	2009.09.12.09.47.34;	author tg;	state Exp;
branches;
next	1.153;
commitid	1004AAB6E3D4BCF3154;

1.153
date	2009.08.30.18.04.09;	author tg;	state Exp;
branches;
next	1.152;
commitid	1004A9ABF0C29F10D97;

1.152
date	2009.08.10.05.16.55;	author tg;	state Exp;
branches;
next	1.151;
commitid	1004A7FAD5D0AD545CD;

1.151
date	2009.06.29.19.19.06;	author tg;	state Exp;
branches;
next	1.150;
commitid	1004A4913C16EB27F4B;

1.150
date	2009.06.07.13.20.19;	author tg;	state Exp;
branches;
next	1.149;
commitid	1004A2BBEAA4F76F1E3;

1.149
date	2009.04.17.17.29.23;	author tg;	state Exp;
branches;
next	1.148;
commitid	10049E8BC8A4C5C35FA;

1.148
date	2009.04.05.13.38.45;	author tg;	state Exp;
branches;
next	1.147;
commitid	10049D8B47C087F1BC8;

1.147
date	2009.03.29.13.04.21;	author tg;	state Exp;
branches;
next	1.146;
commitid	10049CF71B654F9EF54;

1.146
date	2009.03.04.16.16.33;	author tg;	state Exp;
branches;
next	1.145;
commitid	10049AEA96706BA974D;

1.145
date	2009.01.29.18.11.04;	author tg;	state Exp;
branches;
next	1.144;
commitid	1004981F14E69A8DA6E;

1.144
date	2009.01.02.05.16.31;	author tg;	state Exp;
branches;
next	1.143;
commitid	100495DA33F62ABDC14;

1.143
date	2008.12.13.23.29.29;	author tg;	state Exp;
branches;
next	1.142;
commitid	1004944455B2BE258CF;

1.142
date	2008.12.10.21.46.27;	author tg;	state Exp;
branches;
next	1.141;
commitid	100494038A97D264953;

1.141
date	2008.12.10.21.38.57;	author tg;	state Exp;
branches;
next	1.140;
commitid	100494036F0136F90DC;

1.140
date	2008.11.30.17.30.03;	author tg;	state Exp;
branches;
next	1.139;
commitid	1004932CD9D169A603F;

1.139
date	2008.11.30.11.22.40;	author tg;	state Exp;
branches;
next	1.138;
commitid	1004932777B60FD9CFC;

1.138
date	2008.11.22.12.25.40;	author tg;	state Exp;
branches;
next	1.137;
commitid	1004927FA5420552432;

1.137
date	2008.11.22.12.21.16;	author tg;	state Exp;
branches;
next	1.136;
commitid	1004927F94B7B8D5B9B;

1.136
date	2008.11.10.21.10.21;	author tg;	state Exp;
branches;
next	1.135;
commitid	1004918A32F7C57CF28;

1.135
date	2008.11.09.23.45.50;	author tg;	state Exp;
branches;
next	1.134;
commitid	1004917763D1B9E2880;

1.134
date	2008.11.01.21.45.38;	author tg;	state Exp;
branches;
next	1.133;
commitid	100490CCE1101EEEF3B;

1.133
date	2008.10.27.21.12.19;	author tg;	state Exp;
branches;
next	1.132;
commitid	10049062E955474273A;

1.132
date	2008.10.12.17.40.40;	author tg;	state Exp;
branches;
next	1.131;
commitid	10048F236AE38EC76E7;

1.131
date	2008.10.05.20.21.10;	author tg;	state Exp;
branches;
next	1.130;
commitid	10048E921BA4DD50640;

1.130
date	2008.10.05.20.14.31;	author tg;	state Exp;
branches;
next	1.129;
commitid	10048E9203C1320A0A1;

1.129
date	2008.08.25.19.01.04;	author tg;	state Exp;
branches;
next	1.128;
commitid	10048B30187152CECEC;

1.128
date	2008.08.08.12.40.45;	author tg;	state Exp;
branches;
next	1.127;
commitid	100489C3E7E2B7D00B4;

1.127
date	2008.08.02.00.46.09;	author tg;	state Exp;
branches;
next	1.126;
commitid	1004893AE670C97A071;

1.126
date	2008.08.02.00.45.41;	author tg;	state Exp;
branches;
next	1.125;
commitid	1004893AE1364EF8187;

1.125
date	2008.07.11.11.34.55;	author tg;	state Exp;
branches;
next	1.124;
commitid	1004877456B47323B33;

1.124
date	2008.04.10.13.55.56;	author tg;	state Exp;
branches;
next	1.123;
commitid	10047FE1C7755F47616;

1.123
date	2008.04.07.05.18.17;	author tg;	state Exp;
branches;
next	1.122;
commitid	10047F9AEB071883E46;

1.122
date	2008.03.10.15.40.56;	author tg;	state Exp;
branches;
next	1.121;
commitid	10047D556921423B9B5;

1.121
date	2008.03.09.16.20.06;	author tg;	state Exp;
branches
	1.121.2.1;
next	1.120;
commitid	10047D40E4D3C4738B9;

1.120
date	2007.10.08.21.10.05;	author tg;	state Exp;
branches;
next	1.119;
commitid	100470A9C9458D204BF;

1.119
date	2007.08.01.22.50.11;	author tg;	state Exp;
branches;
next	1.118;
commitid	10046B10E2C2D15F9CC;

1.118
date	2007.07.07.22.53.23;	author tg;	state Exp;
branches;
next	1.117;

1.117
date	2007.07.02.14.43.53;	author tg;	state Exp;
branches;
next	1.116;
commitid	10046890EF96DC54F01;

1.116
date	2007.06.30.03.03.44;	author tg;	state Exp;
branches;
next	1.115;
commitid	1004685C82627EC801C;

1.115
date	2007.06.28.16.07.28;	author tg;	state Exp;
branches;
next	1.114;
commitid	1004683DCD20D626F9F;

1.114
date	2007.06.26.18.33.05;	author tg;	state Exp;
branches;
next	1.113;
commitid	10046815BF70898D434;

1.113
date	2007.06.21.14.40.18;	author tg;	state Exp;
branches;
next	1.112;
commitid	100467A8D2C4D7EEFFE;

1.112
date	2007.06.16.15.41.48;	author tg;	state Exp;
branches;
next	1.111;
commitid	100467404D10F2EE204;

1.111
date	2007.06.12.11.52.12;	author tg;	state Exp;
branches;
next	1.110;
commitid	100466E88F530DF0688;

1.110
date	2007.06.07.17.08.16;	author tg;	state Exp;
branches;
next	1.109;
commitid	10046683B7D40BBFA77;

1.109
date	2007.06.04.09.05.39;	author tg;	state Exp;
branches;
next	1.108;
commitid	1004663D5F31FA91204;

1.108
date	2007.05.26.23.09.51;	author tg;	state Exp;
branches;
next	1.107;
commitid	1004658BE4A1272605F;

1.107
date	2007.05.21.18.29.19;	author tg;	state Exp;
branches;
next	1.106;
commitid	1004651E5060EDFC9EC;

1.106
date	2007.05.17.17.21.45;	author tg;	state Exp;
branches;
next	1.105;
commitid	100464C8F0D00B2CCA7;

1.105
date	2007.05.16.22.03.53;	author tg;	state Exp;
branches;
next	1.104;
commitid	100464B7E545A2B0094;

1.104
date	2007.05.07.14.07.40;	author tg;	state Exp;
branches;
next	1.103;
commitid	100463F329F71EBE9B2;

1.103
date	2007.04.28.00.12.46;	author tg;	state Exp;
branches;
next	1.102;
commitid	1004632918E6CE6474D;

1.102
date	2007.04.27.20.05.09;	author tg;	state Exp;
branches;
next	1.101;
commitid	100463257457AC21D75;

1.101
date	2007.04.18.19.56.24;	author tg;	state Exp;
branches;
next	1.100;
commitid	100462677FE698747C6;

1.100
date	2007.04.17.22.13.54;	author tg;	state Exp;
branches;
next	1.99;
commitid	100462546B84113BC9D;

1.99
date	2007.04.04.21.48.15;	author tg;	state Exp;
branches;
next	1.98;
commitid	10046141C903A248AA9;

1.98
date	2007.03.19.22.57.43;	author tg;	state Exp;
branches;
next	1.97;
commitid	10045FF157D0A6AB3BF;

1.97
date	2007.03.18.02.19.51;	author tg;	state Exp;
branches;
next	1.96;
commitid	10045FCA1C84D39F03D;

1.96
date	2007.03.10.22.18.29;	author tg;	state Exp;
branches;
next	1.95;
commitid	10045F32EAA5AD91B4E;

1.95
date	2007.03.09.10.40.53;	author tg;	state Exp;
branches;
next	1.94;
commitid	10045F138DD463284F5;

1.94
date	2007.03.09.10.07.32;	author tg;	state Exp;
branches;
next	1.93;
commitid	10045F131B26B0A8A15;

1.93
date	2007.03.08.10.07.02;	author tg;	state Exp;
branches;
next	1.92;
commitid	10045EFE05510C5611E;

1.92
date	2007.03.08.09.01.58;	author tg;	state Exp;
branches;
next	1.91;
commitid	10045EFD11B3F2287E1;

1.91
date	2007.02.26.02.37.50;	author tg;	state Exp;
branches;
next	1.90;
commitid	10045E2480645CA4095;

1.90
date	2007.02.17.03.07.15;	author tg;	state Exp;
branches;
next	1.89;
commitid	10045D671797452A315;

1.89
date	2007.02.07.01.37.52;	author tg;	state Exp;
branches;
next	1.88;
commitid	10045C92D5521A28D65;

1.88
date	2007.01.25.15.52.25;	author tg;	state Exp;
branches;
next	1.87;
commitid	10045B8D24749EA7142;

1.87
date	2006.12.28.00.27.42;	author tg;	state Exp;
branches;
next	1.86;
commitid	10045930F876825E0BD;

1.86
date	2006.12.11.20.48.34;	author tg;	state Exp;
branches;
next	1.85;
commitid	100457DC42E7BEFE7A2;

1.85
date	2006.11.17.03.20.29;	author tg;	state Exp;
branches;
next	1.84;
commitid	100455D2A9325B8F77C;

1.84
date	2006.11.09.02.43.45;	author tg;	state Exp;
branches;
next	1.83;
commitid	100455295F8672F03E0;

1.83
date	2006.11.03.18.11.58;	author tg;	state Exp;
branches;
next	1.82;
commitid	100454B868055826018;

1.82
date	2006.11.02.00.50.29;	author tg;	state Exp;
branches;
next	1.81;
commitid	100454940D51A8F9D37;

1.81
date	2006.10.28.19.52.51;	author tg;	state Exp;
branches;
next	1.80;
commitid	1004543B4F81120B887;

1.80
date	2006.10.27.15.52.58;	author tg;	state Exp;
branches;
next	1.79;
commitid	10045422B51340FA673;

1.79
date	2006.10.17.23.16.57;	author tg;	state Exp;
branches;
next	1.78;
commitid	1004535647F31E3C9E5;

1.78
date	2006.10.07.03.30.58;	author tg;	state Exp;
branches;
next	1.77;
commitid	10045271F5E7E1A8D13;

1.77
date	2006.10.02.23.24.14;	author tg;	state Exp;
branches;
next	1.76;
commitid	10045219FB4683B88EC;

1.76
date	2006.09.29.22.01.23;	author tg;	state Exp;
branches;
next	1.75;
commitid	100451D97C43276261F;

1.75
date	2006.09.29.21.57.08;	author tg;	state Exp;
branches;
next	1.74;
commitid	100451D96C32DE231BC;

1.74
date	2006.09.24.17.48.33;	author tg;	state Exp;
branches;
next	1.73;
commitid	1004516C4FA585E8AEF;

1.73
date	2006.09.22.00.09.18;	author tg;	state Exp;
branches;
next	1.72;
commitid	100451329B522B433AB;

1.72
date	2006.07.30.23.37.12;	author tg;	state Exp;
branches;
next	1.71;
commitid	10044CD42BC1D7050EC;

1.71
date	2006.07.02.23.31.50;	author tg;	state Exp;
branches;
next	1.70;
commitid	10044A8575760F61F97;

1.70
date	2006.06.27.14.15.30;	author tg;	state Exp;
branches;
next	1.69;
commitid	10044A13D8E1CD39631;

1.69
date	2006.06.23.15.22.01;	author tg;	state Exp;
branches;
next	1.68;
commitid	100449C072F1618CB8F;

1.68
date	2006.06.21.21.23.58;	author tg;	state Exp;
branches;
next	1.67;
commitid	1004499B8FF57A08170;

1.67
date	2006.06.17.20.08.08;	author tg;	state Exp;
branches;
next	1.66;
commitid	1004494613562439DA0;

1.66
date	2006.06.17.20.03.31;	author tg;	state Exp;
branches;
next	1.65;
commitid	1004494601D4FB92190;

1.65
date	2006.06.17.17.12.33;	author tg;	state Exp;
branches;
next	1.64;
commitid	100449437FA37D49D71;

1.64
date	2006.06.16.23.58.59;	author tg;	state Exp;
branches;
next	1.63;
commitid	100449345D3357A2344;

1.63
date	2006.06.15.18.11.36;	author tg;	state Exp;
branches;
next	1.62;
commitid	1004491A2D56D07D882;

1.62
date	2006.06.11.02.34.01;	author tg;	state Exp;
branches;
next	1.61;
commitid	100448B811E25A010FD;

1.61
date	2006.06.09.17.23.17;	author tg;	state Exp;
branches;
next	1.60;
commitid	1004489AE9175162708;

1.60
date	2006.06.09.00.31.36;	author tg;	state Exp;
branches;
next	1.59;
commitid	1004488C173518BB89D;

1.59
date	2006.06.02.12.08.14;	author tg;	state Exp;
branches;
next	1.58;
commitid	100447F717560592A14;

1.58
date	2006.05.27.19.21.35;	author tg;	state Exp;
branches;
next	1.57;
commitid	1004478A6D53CDFBE81;

1.57
date	2006.05.25.13.00.29;	author tg;	state Exp;
branches;
next	1.56;
commitid	1004475AA6108F8B7AC;

1.56
date	2006.04.06.11.10.50;	author tg;	state Exp;
branches;
next	1.55;
commitid	1004434F7486C593217;

1.55
date	2006.03.27.20.09.53;	author tg;	state Exp;
branches;
next	1.54;
commitid	100442846991B52FD40;

1.54
date	2006.03.27.19.33.45;	author tg;	state Exp;
branches;
next	1.53;
commitid	10044283E2F398B099E;

1.53
date	2006.03.19.21.04.27;	author tg;	state Exp;
branches;
next	1.52;
commitid	100441DC76F6F79727A;

1.52
date	2006.02.22.00.49.07;	author tg;	state Exp;
branches;
next	1.51;
commitid	10043FBB51A1C316D30;

1.51
date	2006.02.01.14.44.59;	author tg;	state Exp;
branches;
next	1.50;
commitid	10043E0C97C535FB4EB;

1.50
date	2006.01.18.10.21.37;	author tg;	state Exp;
branches;
next	1.49;
commitid	10043CE16C030E424E4;

1.49
date	2006.01.13.03.50.45;	author tg;	state Exp;
branches;
next	1.48;
commitid	10043C723A458BC9FB5;

1.48
date	2005.12.29.23.17.04;	author tg;	state Exp;
branches;
next	1.47;
commitid	10043B46E7169DC7DD6;

1.47
date	2005.12.23.19.59.48;	author tg;	state Exp;
branches;
next	1.46;
commitid	10043AC573F41AFA44F;

1.46
date	2005.12.20.01.06.29;	author tg;	state Exp;
branches
	1.46.2.1;
next	1.45;
commitid	10043A7590A11651175;

1.45
date	2005.12.20.00.47.54;	author tg;	state Exp;
branches;
next	1.44;
commitid	10043A754C158686664;

1.44
date	2005.12.19.23.14.48;	author tg;	state Exp;
branches;
next	1.43;
commitid	10043A73EF32AC23069;

1.43
date	2005.12.17.05.57.55;	author tg;	state Exp;
branches;
next	1.42;
commitid	10043A3A8D2077BDEA8;

1.42
date	2005.12.15.01.31.24;	author tg;	state Exp;
branches;
next	1.41;
commitid	10043A0C76470961B4A;

1.41
date	2005.12.15.01.24.45;	author tg;	state Exp;
branches;
next	1.40;
commitid	10043A0C5D7068BC1DF;

1.40
date	2005.12.04.13.22.55;	author tg;	state Exp;
branches;
next	1.39;
commitid	5c504392edbcad6a;

1.39
date	2005.11.19.12.34.57;	author tg;	state Exp;
branches;
next	1.38;
commitid	604d437f1bef96f7;

1.38
date	2005.11.17.18.30.03;	author tg;	state Exp;
branches;
next	1.37;
commitid	67c437ccc236b52;

1.37
date	2005.11.10.12.59.34;	author tg;	state Exp;
branches;
next	1.36;
commitid	5f62437344413860;

1.36
date	2005.10.21.20.08.14;	author tg;	state Exp;
branches;
next	1.35;
commitid	660443594ac06494;

1.35
date	2005.10.21.10.51.16;	author tg;	state Exp;
branches;
next	1.34;
commitid	58344358c8011f43;

1.34
date	2005.09.01.23.48.50;	author tg;	state Exp;
branches;
next	1.33;
commitid	6b394317936b3334;

1.33
date	2005.09.01.23.44.28;	author tg;	state Exp;
branches;
next	1.32;
commitid	47654317926557f4;

1.32
date	2005.08.26.20.56.00;	author tg;	state Exp;
branches;
next	1.31;
commitid	65f3430f81e61ad8;

1.31
date	2005.08.21.11.45.50;	author tg;	state Exp;
branches;
next	1.30;
commitid	1c13430869647d4b;

1.30
date	2005.08.21.11.35.42;	author tg;	state Exp;
branches;
next	1.29;
commitid	13e94308671df1eb;

1.29
date	2005.08.21.11.26.19;	author tg;	state Exp;
branches;
next	1.28;
commitid	4c7b430864e00c71;

1.28
date	2005.07.21.22.52.11;	author tg;	state Exp;
branches;
next	1.27;
commitid	236342e02714f4f2;

1.27
date	2005.07.07.18.42.00;	author tg;	state Exp;
branches;
next	1.26;
commitid	53c042cd778da2cb;

1.26
date	2005.07.04.02.37.18;	author tg;	state Exp;
branches;
next	1.25;
commitid	5a3342c8a0eed80e;

1.25
date	2005.07.03.20.13.52;	author tg;	state Exp;
branches;
next	1.24;
commitid	47c142c8470bb45a;

1.24
date	2005.06.14.13.47.39;	author tg;	state Exp;
branches;
next	1.23;
commitid	7c9942aedfb6942d;

1.23
date	2005.06.07.15.58.07;	author tg;	state Exp;
branches;
next	1.22;
commitid	524a42a5c4051647;

1.22
date	2005.05.26.20.27.38;	author tg;	state Exp;
branches;
next	1.21;
commitid	155f429631266953;

1.21
date	2005.05.23.22.07.42;	author tg;	state Exp;
branches;
next	1.20;
commitid	6b942925443b739;

1.20
date	2005.05.23.10.26.23;	author tg;	state Exp;
branches;
next	1.19;
commitid	31434291afe5d5d7;

1.19
date	2005.05.21.01.02.36;	author tg;	state Exp;
branches;
next	1.18;
commitid	7700428e88b212f8;

1.18
date	2005.05.14.18.02.12;	author tg;	state Exp;
branches;
next	1.17;
commitid	53c842863d35cb9b;

1.17
date	2005.05.06.00.17.43;	author tg;	state Exp;
branches;
next	1.16;
commitid	11d3427ab777584c;

1.16
date	2005.05.04.18.32.45;	author tg;	state Exp;
branches;
next	1.15;
commitid	3acd42791563318d;

1.15
date	2005.05.01.21.54.17;	author tg;	state Exp;
branches;
next	1.14;

1.14
date	2005.04.29.15.14.16;	author tg;	state Exp;
branches;
next	1.13;

1.13
date	2005.04.29.00.22.36;	author tg;	state Exp;
branches;
next	1.12;

1.12
date	2005.04.26.04.23.12;	author tg;	state Exp;
branches;
next	1.11;

1.11
date	2005.04.19.20.13.46;	author tg;	state Exp;
branches;
next	1.10;

1.10
date	2005.04.16.21.22.33;	author tg;	state Exp;
branches;
next	1.9;

1.9
date	2005.04.16.02.20.18;	author tg;	state Exp;
branches;
next	1.8;

1.8
date	2005.04.14.19.33.05;	author tg;	state Exp;
branches;
next	1.7;

1.7
date	2005.04.07.19.12.10;	author tg;	state Exp;
branches;
next	1.6;

1.6
date	2005.03.25.22.43.34;	author tg;	state Exp;
branches;
next	1.5;

1.5
date	2005.03.15.18.26.12;	author tg;	state Exp;
branches;
next	1.4;

1.4
date	2005.03.05.12.02.29;	author tg;	state Exp;
branches;
next	1.3;

1.3
date	2005.02.14.19.21.54;	author tg;	state Exp;
branches;
next	1.2;

1.2
date	2005.02.14.18.57.46;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.02.05.17.27.17;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.121.2.1
date	2008.03.12.19.11.19;	author tg;	state Exp;
branches;
next	;
commitid	10047D82AEC01A2B6BA;

1.46.2.1
date	2005.12.23.22.50.33;	author tg;	state Exp;
branches;
next	;
commitid	10043AC7F366BCB58B1;

1.1.1.1
date	2005.02.05.17.27.17;	author tg;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2005.07.04.02.25.10;	author tg;	state Exp;
branches;
next	;
commitid	5c2f42c89e13d7c7;


desc
@@


1.176
log
@bump version after the recent changes, except do it early
(a few are yet to come) because propagating on sparc takes ages
@
text
@# $MirOS: src/share/mk/sys.mk,v 1.172 2015/07/19 01:04:20 tg Exp $
# $OpenBSD: sys.mk,v 1.45 2005/03/07 00:06:00 deraadt Exp $
# $NetBSD: sys.mk,v 1.27 1996/04/10 05:47:19 mycroft Exp $
# @@(#)sys.mk	5.11 (Berkeley) 3/13/91

.if !defined(_SYS_MK)
_SYS_MK=1

.if ${MACHINE_OS} == "BSD"
OStype=		MirBSD
.else
.  error MACHINE_OS (${MACHINE_OS}) unknown!
.endif

.if defined(EXTRA_SYS_MK_INCLUDES)
.  for _i in ${EXTRA_SYS_MK_INCLUDES}
.    include ${_i}
.  endfor
.endif

# Sync these with <sys/param.h>
unix=		We run ${OStype}.
OSrev=		10		# MirOS version (major)
OSrpl=		185		# MirOS patchlevel
OScompat=	3.5		# OpenBSD compatibility revision
.if !defined(OSNAME) || empty(OSNAME)
OSNAME!=	uname -s
.endif
OSname=		${OSNAME:L}
OStriplet?=	${MACHINE_ARCH}-ecce-${OSname}${OSrev}
OSgccver?=	3.4.6
_MIRMAKE_EXE=	/usr/bin/make
_MIRMAKE_VER=	20100106

.SUFFIXES:	.out .a .ln .o .lo .s .S .c .m .cc .C .cxx .cpp .F .f .y .l .i .h .sh .m4
.LIBS:		.a

AR?=		ar
ARFLAGS?=	rl
RANLIB?=	ranlib
LORDER?=	lorder

AS?=		as
CC?=		mgcc
CPP?=		${CC} -E
_DEFcTOsOPTS?=	-S
HOSTCC?=	mgcc

CPPFLAGS?=
PIPE?=		-pipe

AFLAGS?=	${DEBUG}
COMPILE.s?=	${CC} -D_ASM_SOURCE ${AFLAGS} -c
LINK.s?=	${CC} -D_ASM_SOURCE ${AFLAGS} ${LDFLAGS}
COMPILE.S?=	${CC} -D_ASM_SOURCE ${AFLAGS} ${CPPFLAGS} -c
LINK.S?=	${CC} -D_ASM_SOURCE ${AFLAGS} ${CPPFLAGS} ${LDFLAGS}

CFLAGS?=	-O2 ${PIPE} -Wno-long-long ${DEBUG}
COMPILE.c?=	${CC} ${CFLAGS:M*} ${CPPFLAGS} -c
LINK.c?=	${CC} ${CFLAGS:M*} ${CPPFLAGS} ${LDFLAGS}

CXX?=		false
CXXFLAGS?=	${CFLAGS:N-std=c99:N-std=gnu99:N-Wno-long-long}
COMPILE.cc?=	${CXX} ${CXXFLAGS:M*} ${CPPFLAGS} -c
LINK.cc?=	${CXX} ${CXXFLAGS:M*} ${CPPFLAGS} ${LDFLAGS}

FC?=		false
FFLAGS?=	-O2
COMPILE.f?=	${FC} ${FFLAGS:M*} -c
LINK.f?=	${FC} ${FFLAGS:M*} ${LDFLAGS}
COMPILE.F?=	${FC} ${FFLAGS:M*} -D_ASM_SOURCE ${CPPFLAGS} -c
LINK.F?=	${FC} ${FFLAGS:M*} -D_ASM_SOURCE ${CPPFLAGS} ${LDFLAGS}

LEX?=		lex
LFLAGS?=
LEX.l?=		${LEX} ${LFLAGS}

LD?=		ld
LDFLAGS+=	${DEBUG}

LINT?=		lint
LINTFLAGS?=	-chapbx

# MirOS make can use MirBSD ksh extensions per definitionem
SHELL=		/bin/mksh
MAKE?=		make

YACC?=		yacc
YFLAGS?=	-d
YACC.y?=	${YACC} ${YFLAGS}

INSTALL?=	install

CTAGS?=		ctags

# C
.c:
	${LINK.c} -o $@@ ${.IMPSRC} ${LDLIBS}
.c.o:
	${COMPILE.c} ${CFLAGS_${.TARGET}:M*} ${.IMPSRC}
.c.i:
	${COMPILE.c} ${CFLAGS_${.TARGET:.i=.o}:M*} -o $@@ -E ${.IMPSRC}
.c.s:
	${COMPILE.c} ${CFLAGS_${.TARGET:.s=.o}:M*} -o $@@ ${_DEFcTOsOPTS} ${.IMPSRC}
.c.a:
	${COMPILE.c} ${CFLAGS_${.TARGET:.a=.o}:M*} ${.IMPSRC}
	${AR} ${ARFLAGS} $@@ $*.o
	rm -f $*.o
.c.ln:
	env CC=${_ORIG_CC:Q} ${LINT} ${LINTFLAGS} ${CFLAGS:M-[IDU]*} \
	    ${CPPFLAGS:M-[IDU]*} -i ${.IMPSRC}

# Objective-C
.m:
	${LINK.c} -o $@@ ${.IMPSRC} ${LDLIBS}
.m.o:
	${COMPILE.c} ${CFLAGS_${.TARGET}:M*} ${.IMPSRC}
.m.i:
	${COMPILE.c} ${CFLAGS_${.TARGET:.i=.o}:M*} -o $@@ -E ${.IMPSRC}
.m.s:
	${COMPILE.c} ${CFLAGS_${.TARGET:.s=.o}:M*} -o $@@ ${_DEFcTOsOPTS} ${.IMPSRC}
.m.a:
	${COMPILE.c} ${CFLAGS_${.TARGET:.a=.o}:M*} ${.IMPSRC}
	${AR} ${ARFLAGS} $@@ $*.o
	rm -f $*.o
.m.ln:
	env CC=${_ORIG_CC:Q} ${LINT} ${LINTFLAGS} ${CFLAGS:M-[IDU]*} \
	    ${CPPFLAGS:M-[IDU]*} -i ${.IMPSRC}

# C++
.cc:
	${LINK.cc} -o $@@ ${.IMPSRC} ${LDLIBS}
.cc.o:
	${COMPILE.cc} ${CXXFLAGS_${.TARGET}:M*} ${.IMPSRC}
.cc.i:
	${COMPILE.cc} ${CXXFLAGS_${.TARGET:.i=.o}:M*} -o $@@ -E ${.IMPSRC}
.cc.s:
	${COMPILE.cc} ${CXXFLAGS_${.TARGET:.s=.o}:M*} -o $@@ ${_DEFcTOsOPTS} ${.IMPSRC}
.cc.a:
	${COMPILE.cc} ${CXXFLAGS_${.TARGET:.a=.o}:M*} ${.IMPSRC}
	${AR} ${ARFLAGS} $@@ $*.o
	rm -f $*.o

.C:
	${LINK.cc} -o $@@ ${.IMPSRC} ${LDLIBS}
.C.o:
	${COMPILE.cc} ${CXXFLAGS_${.TARGET}:M*} ${.IMPSRC}
.C.i:
	${COMPILE.cc} ${CXXFLAGS_${.TARGET:.i=.o}:M*} -o $@@ -E ${.IMPSRC}
.C.s:
	${COMPILE.cc} ${CXXFLAGS_${.TARGET:.s=.o}:M*} -o $@@ ${_DEFcTOsOPTS} ${.IMPSRC}
.C.a:
	${COMPILE.cc} ${CXXFLAGS_${.TARGET:.a=.o}:M*} ${.IMPSRC}
	${AR} ${ARFLAGS} $@@ $*.o
	rm -f $*.o

.cxx:
	${LINK.cc} -o $@@ ${.IMPSRC} ${LDLIBS}
.cxx.o:
	${COMPILE.cc} ${CXXFLAGS_${.TARGET}:M*} ${.IMPSRC}
.cxx.i:
	${COMPILE.cc} ${CXXFLAGS_${.TARGET:.i=.o}:M*} -o $@@ -E ${.IMPSRC}
.cxx.s:
	${COMPILE.cc} ${CXXFLAGS_${.TARGET:.s=.o}:M*} -o $@@ ${_DEFcTOsOPTS} ${.IMPSRC}
.cxx.a:
	${COMPILE.cc} ${CXXFLAGS_${.TARGET:.a=.o}:M*} ${.IMPSRC}
	${AR} ${ARFLAGS} $@@ $*.o
	rm -f $*.o

.cpp:
	${LINK.cc} -o $@@ ${.IMPSRC} ${LDLIBS}
.cpp.o:
	${COMPILE.cc} ${CXXFLAGS_${.TARGET}:M*} ${.IMPSRC}
.cpp.i:
	${COMPILE.cc} ${CXXFLAGS_${.TARGET:.i=.o}:M*} -o $@@ -E ${.IMPSRC}
.cpp.s:
	${COMPILE.cc} ${CXXFLAGS_${.TARGET:.s=.o}:M*} -o $@@ ${_DEFcTOsOPTS} ${.IMPSRC}
.cpp.a:
	${COMPILE.cc} ${CXXFLAGS_${.TARGET:.a=.o}:M*} ${.IMPSRC}
	${AR} ${ARFLAGS} $@@ $*.o
	rm -f $*.o

# Fortran
.f:
	${LINK.f} -o $@@ ${.IMPSRC} ${LDLIBS}
.f.o:
	${COMPILE.f} ${FFLAGS_${.TARGET}:M*} ${.IMPSRC}
.f.a:
	${COMPILE.f} ${FFLAGS_${.TARGET:.a=.o}:M*} ${.IMPSRC}
	${AR} ${ARFLAGS} $@@ $*.o
	rm -f $*.o

.F:
	${LINK.F} -o $@@ ${.IMPSRC} ${LDLIBS}
.F.o:
	${COMPILE.F} ${FFLAGS_${.TARGET}:M*} ${.IMPSRC}
.F.i:
	${COMPILE.F} ${FFLAGS_${.TARGET:.i=.o}:M*} -o $@@ -E ${.IMPSRC}
.F.a:
	${COMPILE.F} ${FFLAGS_${.TARGET:.a=.o}:M*} ${.IMPSRC}
	${AR} ${ARFLAGS} $@@ $*.o
	rm -f $*.o

# Assembly
.s:
	${LINK.s} -o $@@ ${.IMPSRC} ${LDLIBS}
.s.o:
	${COMPILE.s} ${AFLAGS_${.TARGET}:M*} ${.IMPSRC}
.s.a:
	${COMPILE.s} ${AFLAGS_${.TARGET:.a=.o}:M*} ${.IMPSRC}
	${AR} ${ARFLAGS} $@@ $*.o
	rm -f $*.o

.S:
	${LINK.S} -o $@@ ${.IMPSRC} ${LDLIBS}
.S.o:
	${COMPILE.S} ${AFLAGS_${.TARGET}:M*} ${.IMPSRC}
.S.s:
	${COMPILE.S} ${AFLAGS_${.TARGET:.s=.o}:M*} -o $@@ -E ${.IMPSRC}
.S.a:
	${COMPILE.S} ${AFLAGS_${.TARGET:.a=.o}:M*} ${.IMPSRC}
	${AR} ${ARFLAGS} $@@ $*.o
	rm -f $*.o

# Lex
.l:
	${LEX.l} -o${.TARGET:R}.yy.c ${.IMPSRC}
	${LINK.c} -o $@@ ${.TARGET:R}.yy.c ${LDLIBS} -ll
	rm -f ${.TARGET:R}.yy.c
.l.c:
	${LEX.l} -o$@@ ${.IMPSRC}
.l.o:
	${LEX.l} -o${.TARGET:R}.yy.c ${.IMPSRC}
	${COMPILE.c} ${CFLAGS_${.TARGET}:M*} -o $@@ ${.TARGET:R}.yy.c
	rm -f ${.TARGET:R}.yy.c

# Yacc
.y:
	${YACC.y} -o ${.TARGET:R}.tab.c ${.IMPSRC}
	${LINK.c} -o $@@ ${.TARGET:R}.tab.c ${LDLIBS}
	rm -f ${.TARGET:R}.tab.c
.y.c:
	${YACC.y} -o $@@ ${.IMPSRC}
.y.o:
	${YACC.y} -o ${.TARGET:R}.tab.c ${.IMPSRC}
	${COMPILE.c} ${CFLAGS_${.TARGET}:M*} -o $@@ ${.TARGET:R}.tab.c
	rm -f ${.TARGET:R}.tab.c

# Shell
.sh:
	rm -f $@@
	cp ${.IMPSRC} $@@
	chmod +x $@@

# Debugging output
.if defined(___DISPLAY_MAKEVARS)
${.TARGETS}: .MADE
	@@:
.  if empty(.TARGETS)
.MAIN: ___display_makevars
___display_makevars::
.  else
.BEGIN:
.  endif
.  for _i in ${___DISPLAY_MAKEVARS}
	@@print -r -- ${${_i}:Q}
.  endfor
.elif defined(___DUMP_MAKEVARS)
${.TARGETS}: .MADE
	@@:
.  if empty(.TARGETS)
.MAIN: ___dump_makevars
___dump_makevars::
.  else
.BEGIN:
.  endif
.  for _i in ${___DUMP_MAKEVARS}
	@@print -r -- ${_i:Q:Q}=${${_i}:Q:Q}
.  endfor
.endif

.endif
@


1.175
log
@add -fverbose-asm and MD options to compile-to-.s by default
@
text
@d24 1
a24 1
OSrpl=		184		# MirOS patchlevel
@


1.174
log
@the next snapshot shall bear a bumped minor
@
text
@d46 1
d104 1
a104 1
	${COMPILE.c} ${CFLAGS_${.TARGET:.s=.o}:M*} -o $@@ -S ${.IMPSRC}
d121 1
a121 1
	${COMPILE.c} ${CFLAGS_${.TARGET:.s=.o}:M*} -o $@@ -S ${.IMPSRC}
d138 1
a138 1
	${COMPILE.cc} ${CXXFLAGS_${.TARGET:.s=.o}:M*} -o $@@ -S ${.IMPSRC}
d151 1
a151 1
	${COMPILE.cc} ${CXXFLAGS_${.TARGET:.s=.o}:M*} -o $@@ -S ${.IMPSRC}
d164 1
a164 1
	${COMPILE.cc} ${CXXFLAGS_${.TARGET:.s=.o}:M*} -o $@@ -S ${.IMPSRC}
d177 1
a177 1
	${COMPILE.cc} ${CXXFLAGS_${.TARGET:.s=.o}:M*} -o $@@ -S ${.IMPSRC}
@


1.173
log
@bump after recent <*.mk> changes and before upcoming imports
@
text
@d24 1
a24 1
OSrpl=		183		# MirOS patchlevel
@


1.172
log
@bump; post-SSL-SHA; pre SSL-RNG, sendmail update, Unicode 8, mksh fixes, DH params, honour cipher order
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.171 2014/02/20 01:01:01 tg Exp $
d24 1
a24 1
OSrpl=		182		# MirOS patchlevel
@


1.171
log
@bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.170 2014/02/09 22:49:30 tg Exp $
d24 1
a24 1
OSrpl=		181		# MirOS patchlevel
@


1.170
log
@tentatively drop C99
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.168 2014/01/11 15:15:37 tg Exp $
d24 1
a24 1
OSrpl=		180		# MirOS patchlevel
@


1.169
log
@define to false all commands we do not ship (CXX, FC)
@
text
@d57 1
a57 1
CFLAGS?=	-O2 ${PIPE} -std=gnu99 ${DEBUG}
d62 1
a62 1
CXXFLAGS?=	${CFLAGS:N-std=c99:N-std=gnu99}
@


1.168
log
@add some → .s suffix rules
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.167 2013/08/06 20:34:03 tg Exp $
d61 1
a61 1
CXX?=		c++
d66 1
a66 1
FC?=		llvm-gfortran
d93 1
a93 1
CTAGS?=		/usr/bin/ctags
@


1.167
log
@bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.166 2013/05/31 23:27:51 tg Exp $
d102 2
d119 2
d136 2
d149 2
d162 2
d172 1
a172 1
	${COMPILE.cc} ${CXXFLAGS_${.TARGET:.i=.o}:M*} ${.IMPSRC}
d174 3
a176 1
	${COMPILE.cc} ${CXXFLAGS_${.TARGET:.a=.o}:M*} -o $@@ -E ${.IMPSRC}
d178 1
a178 1
	${COMPILE.cc} ${CXXFLAGS_${.TARGET:S/.a$/.o/}:M*} ${.IMPSRC}
d199 1
a199 1
	${COMPILE.S} ${FFLAGS_${.TARGET:.a=.o}:M*} ${.IMPSRC}
d217 2
a218 2
.S.i:
	${COMPILE.S} ${AFLAGS_${.TARGET:.i=.o}:M*} -o $@@ -E ${.IMPSRC}
@


1.166
log
@Replace wcwidth code by mine based on Unicode 6.2.0
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.165 2012/12/31 21:08:12 tg Exp $
d24 1
a24 1
OSrpl=		179		# MirOS patchlevel
@


1.165
log
@bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.164 2012/09/02 11:02:19 tg Exp $
d24 1
a24 1
OSrpl=		178		# MirOS patchlevel
@


1.164
log
@* for the "foo.sh -> foo" implicit rule, chmod +x $@@ in the object dir
* bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.163 2012/01/14 22:28:43 tg Exp $
d24 1
a24 1
OSrpl=		177		# MirOS patchlevel
@


1.163
log
@bump; the current state warrants one (libm, bootloader fix), and when we have fixed everything “needed” we can just bump again (pd, bump ssh/lynx/cvs, …)
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.162 2011/07/17 22:34:27 tg Exp $
d24 1
a24 1
OSrpl=		176		# MirOS patchlevel
d240 1
@


1.162
log
@bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.161 2011/01/15 21:52:46 tg Exp $
d24 1
a24 1
OSrpl=		175		# MirOS patchlevel
@


1.161
log
@Introduce /etc/ssh/root:config and /etc/ssh/root:known_hosts
and /etc/ssh/root:authorised_keys for the superuser if his
HOME directory is unset, empty or, not normalised, "/" (root).
十̲CVS: ----------------------------------------------------------------------
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.160 2010/09/20 00:07:25 tg Exp $
d24 1
a24 1
OSrpl=		174		# MirOS patchlevel
@


1.160
log
@fallout from the build, and bump patchlevel

todo: check locking twice (user+kernel) and convert all userspace to
the new pushb_fast call; more reliability checks
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.159 2010/08/14 19:49:05 tg Exp $
d24 1
a24 1
OSrpl=		173		# MirOS patchlevel
@


1.159
log
@bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.158 2010/01/06 19:07:38 tg Exp $
d24 1
a24 1
OSrpl=		172		# MirOS patchlevel
@


1.158
log
@since install(1) has no --stripflags=-x even on OSX, we must not
strip by default on Mach-O targets; we however can default STRIP
to "strip -x" I'd say (bsiegert@@ please test); see ML discussion
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.157 2009/12/20 12:35:19 tg Exp $
d24 1
a24 1
OSrpl=		171		# MirOS patchlevel
@


1.157
log
@new 「___DUMP_MAKEVARS='foo bar'」 target, like ___DISPLAY_MAKEVARS, but
can be eval’d in shell
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.156 2009/12/13 00:32:21 tg Exp $
d33 1
a33 1
_MIRMAKE_VER=	20091220
@


1.156
log
@i386 sync
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.155 2009/11/22 21:05:35 tg Exp $
d33 1
a33 1
_MIRMAKE_VER=	20091212
d253 12
@


1.155
log
@bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.154 2009/09/12 09:47:34 tg Exp $
d24 1
a24 1
OSrpl=		170		# MirOS patchlevel
d31 1
d33 1
a33 1
_MIRMAKE_VER=	20091122
@


1.154
log
@no -Wl,--no-undefined for LTMIRMAKE – unbreaks ports/devel/lrmi
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.153 2009/08/30 18:04:09 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20090912
@


1.153
log
@add experimental support for distinguishing between DLLs and plugins
to <bsd.lib.mk> – both versioned and unversioned

needs to be tested on GNU (Interix) and DyLD (Darwin, Mac OSX)

agreed bsiegert@@
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.152 2009/08/10 05:16:55 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20090830
@


1.152
log
@sync
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.151 2009/06/29 19:19:06 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20090622
@


1.151
log
@bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.150 2009/06/07 13:20:19 tg Exp $
d24 1
a24 1
OSrpl=		169		# MirOS patchlevel
@


1.150
log
@bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.149 2009/04/17 17:29:23 tg Exp $
d24 1
a24 1
OSrpl=		168		# MirOS patchlevel
d32 1
a32 1
_MIRMAKE_VER=	20090417
@


1.149
log
@bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.148 2009/04/05 13:38:45 tg Exp $
d24 1
a24 1
OSrpl=		167		# MirOS patchlevel
@


1.148
log
@bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.147 2009/03/29 13:04:21 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20090304
@


1.147
log
@• take care of dbins
• #!/bin/mksh shebang, in most places
• rcsid while here
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.146 2009/03/04 16:16:33 tg Exp $
d24 1
a24 1
OSrpl=		166		# MirOS patchlevel
@


1.146
log
@pasto
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.145 2009/01/29 18:11:04 tg Exp $
d83 1
a83 1
SHELL=		/usr/dbin/mksh
@


1.145
log
@bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.144 2009/01/02 05:16:31 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20090101
d161 1
a161 1
	${COMPILE.cc} ${CXXFLAGS_${.TARGET:.i=.o}:M*} -o $@@ -E ${.IMPSRC}
d163 1
a163 1
	${COMPILE.cc} ${CXXFLAGS_${.TARGET:.a=.o}:M*} ${.IMPSRC}
@


1.144
log
@bump, regenerate, etc.
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.143 2008/12/13 23:29:29 tg Exp $
d24 1
a24 1
OSrpl=		165		# MirOS patchlevel
@


1.143
log
@standard path to mksh is /usr/dbin/mksh on MirOS-current
(sometimes I curse myself for giving in to that idea…)
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.142 2008/12/10 21:46:27 tg Exp $
d24 1
a24 1
OSrpl=		164		# MirOS patchlevel
d32 1
a32 1
_MIRMAKE_VER=	20081212
@


1.142
log
@same to “make lint” target
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.141 2008/12/10 21:38:57 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20081012
d83 1
a83 1
SHELL=		/bin/mksh
@


1.141
log
@fix build problems: use ${CC} -E, because our system headers assume
ANSI C and thus cannot be linted with Reiser CCCP
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.140 2008/11/30 17:30:03 tg Exp $
d106 2
a107 2
	${LINT} ${LINTFLAGS} ${CFLAGS:M-[IDU]*} ${CPPFLAGS:M-[IDU]*} \
	    -i ${.IMPSRC}
d121 2
a122 2
	${LINT} ${LINTFLAGS} ${CFLAGS:M-[IDU]*} ${CPPFLAGS:M-[IDU]*} \
	    -i ${.IMPSRC}
@


1.140
log
@work with CPP=CC -E (ohne "-")
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.139 2008/11/30 11:22:40 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20081130
@


1.139
log
@bump patchlevel; allow cpp change
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.138 2008/11/22 12:25:40 tg Exp $
d44 1
a44 1
CPP?=		${CC} -E -
@


1.138
log
@CPP?=${CC} -E - #, actually…
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.137 2008/11/22 12:21:16 tg Exp $
d24 1
a24 1
OSrpl=		163		# MirOS patchlevel
d32 1
a32 1
_MIRMAKE_VER=	20081122
@


1.137
log
@CPP should default to CC -E
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.136 2008/11/10 21:10:21 tg Exp $
d44 1
a44 1
CPP?=		${CC} -E
@


1.136
log
@• add minimal Fortran support to <sys.mk>, <bsd.prog.mk>, <bsd.lib.mk>
  ‣ untested except for 99 bottles of beer example
• bump OS to MirBSD #10uA3, so that people can actually compile LLVM
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.135 2008/11/09 23:45:50 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20081110
d44 1
a44 1
CPP?=		cpp
@


1.135
log
@-std=c99 / -std=gnu99 are no valid CXXFLAGS
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.134 2008/11/01 21:45:38 tg Exp $
d24 1
a24 1
OSrpl=		162		# MirOS patchlevel
d32 1
a32 1
_MIRMAKE_VER=	20081109
d34 1
a34 1
.SUFFIXES:	.out .a .ln .o .lo .s .S .c .m .cc .C .cxx .cpp .y .l .i .h .sh .m4
d65 7
d169 21
@


1.134
log
@honour BSD_PREFIX for includes target
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.133 2008/10/27 21:12:19 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20081101
d61 1
a61 1
CXXFLAGS?=	${CFLAGS}
@


1.133
log
@fix dependency information for the LTMIRMAKE case (shlibs)

XXX bsd.prog.mk does not have similar issues as we do not
XXX use libfool to build .lo files for executables (now)
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.132 2008/10/12 17:40:40 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20081027
@


1.132
log
@bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.131 2008/10/05 20:21:10 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20081012
@


1.131
log
@• fix CFLAGS_foo.o honoration in more cases
• shorten while here
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.130 2008/10/05 20:14:31 tg Exp $
d24 1
a24 1
OSrpl=		161		# MirOS patchlevel
d32 1
a32 1
_MIRMAKE_VER=	20080825
@


1.130
log
@add experimental, discouraged LTMIRMAKE variable and modus operandi
sort of works for dylibs and programmes; does not consider bundles yet

shouldn’t affect normal operation at all

agreed to commit bsiegert@@
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.129 2008/08/25 19:01:04 tg Exp $
d89 1
a89 1
	${LINK.c} -o ${.TARGET} ${.IMPSRC} ${LDLIBS}
d93 1
a93 1
	${COMPILE.c} ${CFLAGS_${.TARGET}:M*} -o ${.TARGET} -E ${.IMPSRC}
d95 1
a95 1
	${COMPILE.c} ${CFLAGS_${.TARGET:S/.a$/.o/}:M*} ${.IMPSRC}
d104 1
a104 1
	${LINK.c} -o ${.TARGET} ${.IMPSRC} ${LDLIBS}
d108 1
a108 1
	${COMPILE.c} ${CFLAGS_${.TARGET}:M*} -o ${.TARGET} -E ${.IMPSRC}
d110 1
a110 1
	${COMPILE.c} ${CFLAGS_${.TARGET:S/.a$/.o/}:M*} ${.IMPSRC}
d119 1
a119 1
	${LINK.cc} -o ${.TARGET} ${.IMPSRC} ${LDLIBS}
d123 1
a123 1
	${COMPILE.cc} ${CXXFLAGS_${.TARGET}:M*} -o ${.TARGET} -E ${.IMPSRC}
d125 1
a125 1
	${COMPILE.cc} ${CXXFLAGS_${.TARGET:S/.a$/.o/}:M*} ${.IMPSRC}
d130 1
a130 1
	${LINK.cc} -o ${.TARGET} ${.IMPSRC} ${LDLIBS}
d134 1
a134 1
	${COMPILE.cc} ${CXXFLAGS_${.TARGET}:M*} -o ${.TARGET} -E ${.IMPSRC}
d136 1
a136 1
	${COMPILE.cc} ${CXXFLAGS_${.TARGET:S/.a$/.o/}:M*} ${.IMPSRC}
d141 1
a141 1
	${LINK.cc} -o ${.TARGET} ${.IMPSRC} ${LDLIBS}
d145 1
a145 1
	${COMPILE.cc} ${CXXFLAGS_${.TARGET}:M*} -o ${.TARGET} -E ${.IMPSRC}
d147 1
a147 1
	${COMPILE.cc} ${CXXFLAGS_${.TARGET:S/.a$/.o/}:M*} ${.IMPSRC}
d152 1
a152 1
	${LINK.cc} -o ${.TARGET} ${.IMPSRC} ${LDLIBS}
d154 1
a154 1
	${COMPILE.cc} ${CXXFLAGS_${.TARGET}:M*} ${.IMPSRC}
d156 1
a156 1
	${COMPILE.cc} ${CXXFLAGS_${.TARGET}:M*} -o ${.TARGET} -E ${.IMPSRC}
d164 1
a164 1
	${LINK.s} -o ${.TARGET} ${.IMPSRC} ${LDLIBS}
d168 1
a168 1
	${COMPILE.s} ${AFLAGS_${.TARGET:S/.a$/.o/}:M*} ${.IMPSRC}
d173 1
a173 1
	${LINK.S} -o ${.TARGET} ${.IMPSRC} ${LDLIBS}
d177 1
a177 1
	${COMPILE.S} ${AFLAGS_${.TARGET}:M*} -o ${.TARGET} -E ${.IMPSRC}
d179 1
a179 1
	${COMPILE.S} ${AFLAGS_${.TARGET:S/.a$/.o/}:M*} ${.IMPSRC}
d186 1
a186 1
	${LINK.c} -o ${.TARGET} ${.TARGET:R}.yy.c ${LDLIBS} -ll
d189 1
a189 1
	${LEX.l} -o${.TARGET} ${.IMPSRC}
d192 1
a192 1
	${COMPILE.c} ${CFLAGS_${.TARGET}:M*} -o ${.TARGET} ${.TARGET:R}.yy.c
d198 1
a198 1
	${LINK.c} -o ${.TARGET} ${.TARGET:R}.tab.c ${LDLIBS}
d201 1
a201 1
	${YACC.y} -o ${.TARGET} ${.IMPSRC}
d204 1
a204 1
	${COMPILE.c} ${CFLAGS_${.TARGET}:M*} -o ${.TARGET} ${.TARGET:R}.tab.c
d209 2
a210 2
	rm -f ${.TARGET}
	cp ${.IMPSRC} ${.TARGET}
@


1.129
log
@bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.128 2008/08/08 12:40:45 tg Exp $
d34 1
a34 1
.SUFFIXES:	.out .a .ln .o .s .S .c .m .cc .C .cxx .cpp .y .l .i .h .sh .m4
@


1.128
log
@• if SHLIB_VERSION is not set but building shared library, error out
  ⁍ use SHLIB_VERSION=- for bundles/plugins
• fix for RTLD_TYPE==GNU and SHLIB_VERSION=-

This work partially sponsored by SyGroup GmbH and GoTo navisend AG

• bump mirmake vsn
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.127 2008/08/02 00:46:09 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20080808
@


1.127
log
@time to bump, still in progress
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.126 2008/08/02 00:45:41 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20080711
@


1.126
log
@yay, optu*.c do not build, because, tadaa, with debugging cflags I had
-std=c99 enabled, with normal cflags not…

time to break ancient code which is not -std=c99 (well, -std=gnu99, with
extensions) clean (ISTR oldroff already sets -std=gnu89)
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.125 2008/07/11 11:34:55 tg Exp $
d24 1
a24 1
OSrpl=		160		# MirOS patchlevel
@


1.125
log
@bump mirmake vsn, even if we don't do a portable mirmake release (yet)
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.124 2008/04/10 13:55:56 tg Exp $
d56 1
a56 1
CFLAGS?=	-O2 ${PIPE} ${DEBUG}
@


1.124
log
@fix C++ support: I’ve seen distfiles with *.cpp and *.C files now
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.123 2008/04/07 05:18:17 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20080410
@


1.123
log
@bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.122 2008/03/10 15:40:56 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20080407
d34 1
a34 1
.SUFFIXES:	.out .a .ln .o .s .S .c .m .cc .cxx .cpp .y .l .i .h .sh .m4
d129 11
@


1.122
log
@unlock, MirOS #10-current 0AuA0, 2008
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.121 2008/03/09 16:20:06 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20080310
@


1.121
log
@bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.120 2007/10/08 21:10:05 tg Exp $
d24 1
a24 1
OSrpl=		128		# MirOS patchlevel
d32 1
a32 1
_MIRMAKE_VER=	20080309
@


1.121.2.1
log
@bump to #10-stable 0As81
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.121 2008/03/09 16:20:06 tg Exp $
d24 1
a24 1
OSrpl=		129		# MirOS patchlevel
@


1.120
log
@even though it’s non-standard, add .cpp as an alias for .cc/.cxx suffix;
didn’t add .C though since mirmake should operate on MacOS X which isn’t
installable on case-sensitive filesystems as well (yuck)
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.119 2007/08/01 22:50:11 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20071008
@


1.119
log
@for all it's worth, from here on it's #10-RELEASE.
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.118 2007/07/07 22:53:23 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20070702
d34 1
a34 1
.SUFFIXES:	.out .a .ln .o .s .S .c .m .cc .cxx .y .l .i .h .sh .m4
d140 11
@


1.118
log
@bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.116 2007/06/30 03:03:44 tg Exp $
d24 1
a24 1
OSrpl=		28		# MirOS patchlevel
@


1.117
log
@• On Darwin / Mac OSX, ld fails if -x is used with
  | /usr/bin/ld: /Volumes/FreeWRT/freewrt/tools_build/w-mirmake-20070626-3/mirmake/build/libmirmake/libmirmake.a(getopt_long.o) malformed object (section (__TEXT,__textcoal_nt) no symbol at start of coalesced section)
  or something similar. Drop the -x, use -X which seems to work.
  (Note: on Solaris, -x also seems to make problems. Thanks joerg@@dragonfly)
• The Darwin ld(1) doesn't support -g either.
@
text
@d24 1
a24 1
OSrpl=		27		# MirOS patchlevel
@


1.116
log
@bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.115 2007/06/28 16:07:28 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20070628
@


1.115
log
@clean SHLIB_LINKS too
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.114 2007/06/26 18:33:05 tg Exp $
d24 1
a24 1
OSrpl=		26		# MirOS patchlevel
@


1.114
log
@bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.113 2007/06/21 14:40:18 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20070626
@


1.113
log
@• libedit, libm, libocurses, libsectok, libskey, libssl, libusbhid, libutil:
  do something I should've long done and bump their majors – ABI changes are
  not only removals (or changes) of T/D symbols but also additions(!) of U
  symbols (i.e. imports); these changed during the <ctype.h> changes from a
  while ago and depend on newer libc; I did an nm(1) comparision against #9
  (release) to allow upgrading by source
• libc, uname: since I'm bumping a lot of other shlibs, it's a good time to
  bump the libc major as well and finally get rid of that struct utsname bug
  I introduced when I had no idea what I was doing, in MirOS #1 or so…
• libpthread: requires a major bump if libc major is bumped, or so they say
• bump os patchlevel

agreed bsiegert@@
XXX any more changes to do before release?
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.112 2007/06/16 15:41:48 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20070612
@


1.112
log
@sync’n’bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.111 2007/06/12 11:52:12 tg Exp $
d24 1
a24 1
OSrpl=		25		# MirOS patchlevel
@


1.111
log
@having libc.so 0600 for some time would be bad
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.110 2007/06/07 17:08:16 tg Exp $
d24 1
a24 1
OSrpl=		24		# MirOS patchlevel
@


1.110
log
@• never strip the symbol table from shared libraries
• we can optimise .so object build now
• remove a useless if clause
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.109 2007/06/04 09:05:39 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20070607
@


1.109
log
@for all practical reasons, this is MirOS #10; bump everything except the ospatchlevel to -RELEASE already
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.108 2007/05/26 23:09:51 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20070527
@


1.108
log
@fixing the bootloader issue rectifies a bump here
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.107 2007/05/21 18:29:19 tg Exp $
d24 1
a24 1
OSrpl=		23		# MirOS patchlevel
@


1.107
log
@experimental: use -Wl,-O2 for linking, bump mirmake vsn
ok bsiegert@@ if nothing breaks
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.106 2007/05/17 17:21:45 tg Exp $
d24 1
a24 1
OSrpl=		22		# MirOS patchlevel
d32 1
a32 1
_MIRMAKE_VER=	20070521
@


1.106
log
@• provide a generic “includes” target if HDRS given and none exists

  “wurscht” bsiegert@@, “käse” waldi@@, “brot” ssimon@@ ☻
• bump mirmake vsn
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.105 2007/05/16 22:03:53 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20070517
@


1.105
log
@okay, time to clear up one of the earliest messes in MirBSD's history…
(yes I was young and stup^Wunknowingly did this)

• lib/libc/gen/uname.c: do not fill in the struct utsname.patchlevel
  field any more.
• X11/xc/config/imake/imake.c: use sysctl kern.ospatchlevel, instead
  of relying on non-standard/unsafe struct utsname.patchlevel.
• lib/libc/gen/uname.c: in order to avoid a libc version bump, bzero
  the struct utsname * argument, so that the former patchlevel field
  becomes a NUL string.
• sys/sys/utsname.h: revert, i.e. delete the “patchlevel” field from
  struct utsname. Do NOT bump the os patchlevel, because this change
  does not affect the kernel/userland interface – that field has ne-
  ver been used in kernel land. This change, back then, was not safe
  as per ABI policy.
• lib/libc/gen/uname.c, share/mk/sys.mk, sys/sys/param.h: patchlevel
  bump for size change of struct utsname, used in gen/uname.c to add
  1 to the number of octets to bzero(), ifdef'd (so that new source,
  old includes, is safe).
• lib/libc/Makefile: mention gen/uname.c change for next major bump.

All other users of struct utsname in the base system have been taken
care of already (most notably uname(1); the others didn't use the os
patchlevel anyway).
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.104 2007/05/07 14:07:40 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20070428
@


1.104
log
@bump
• sdiff
• *.h, *.mk fixes
• whirlpool
• pkgsrc® known to work
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.103 2007/04/28 00:12:46 tg Exp $
d24 1
a24 1
OSrpl=		21		# MirOS patchlevel
@


1.103
log
@more lex/yacc overhaul, tentatively
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.102 2007/04/27 20:05:09 tg Exp $
d24 1
a24 1
OSrpl=		20		# MirOS patchlevel
@


1.102
log
@• bsd.sys.mk: for defined(FOO) add && !empty(FOO), e.g. DESTDIR, because
  a “make dist” was falsely using DESTDIR rules for standard builds
• bsd.sys.mk, sys.mk: make standard lex/yacc rules parallel-build safe,
  because it also eases debugging
• sys.mk: bump mirmake vsn
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.101 2007/04/18 19:56:24 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20070427
d175 1
a175 1
	${YACC.y} -b ${.TARGET:R} ${.IMPSRC}
d179 1
a179 2
	${YACC.y} -b ${.TARGET:R} ${.IMPSRC}
	mv ${.TARGET:R}.tab.c ${.TARGET}
d181 1
a181 1
	${YACC.y} -b ${.TARGET:R} ${.IMPSRC}
@


1.101
log
@add comment; bump mirmake vsn
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.100 2007/04/17 22:13:54 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20070418
d163 3
a165 3
	${LEX.l} ${.IMPSRC}
	${LINK.c} -o ${.TARGET} lex.yy.c ${LDLIBS} -ll
	rm -f lex.yy.c
d167 1
a167 2
	${LEX.l} ${.IMPSRC}
	mv lex.yy.c ${.TARGET}
d169 3
a171 3
	${LEX.l} ${.IMPSRC}
	${COMPILE.c} ${CFLAGS_${.TARGET}:M*} -o ${.TARGET} lex.yy.c
	rm -f lex.yy.c
d175 3
a177 3
	${YACC.y} ${.IMPSRC}
	${LINK.c} -o ${.TARGET} y.tab.c ${LDLIBS}
	rm -f y.tab.c
d179 2
a180 2
	${YACC.y} ${.IMPSRC}
	mv y.tab.c ${.TARGET}
d182 3
a184 3
	${YACC.y} ${.IMPSRC}
	${COMPILE.c} ${CFLAGS_${.TARGET}:M*} -o ${.TARGET} y.tab.c
	rm -f y.tab.c
@


1.100
log
@bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.99 2007/04/04 21:48:15 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20070404
@


1.99
log
@• sys.mk: the occasional bump
• bsd.sys.mk: don't -isystem ${.CURDIR} because then <ctype.h> includes
  ${.CURDIR}/ctype.h (if exists) instead; mark it -idirafter instead (a
  ${.CURDIR}/foo.h is then still matched by <foo.h> but only if there's
  no foo.h in /usr/include et al.); people who wanted ${.CURDIR} as the
  preference path used CPPFLAGS+=-I${.CURDIR} anyway (src/lib/csu etc.)
  -> fixes heirloom sh build
• bsd.sys.mk: bump mirmake version
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.98 2007/03/19 22:57:43 tg Exp $
d24 1
a24 1
OSrpl=		18		# MirOS patchlevel
@


1.98
log
@| cd '/usr/src/bin/mksh' && exec GCC_HONOUR_COPTS=2 mgcc -O2 -pipe -Os -fweb -Wformat -Wstrict-aliasing -Wbounded -fno-align-functions -fno-align-labels -falign-loops=4 -falign-jumps=4 -march=i486 -mpush-args -mpreferred-stack-boundary=2 -fhonour-copts -Werror -fno-strict-aliasing -fstack-protector-all -fwrapv -std=gnu99 -Wall -isystem /usr/src/bin/mksh -I'/usr/src/bin/mksh/obj/build-dir' -DHAVE_ATTRIBUTE=1 -DHAVE_ATTRIBUTE_BOUNDED=1 -DHAVE_ATTRIBUTE_USED=1 -DHAVE_SYS_PARAM_H=1 -DHAVE_SYS_MKDEV_H=0 -DHAVE_SYS_MMAN_H=1 -DHAVE_SYS_SYSMACROS_H=0 -DHAVE_LIBGEN_H=1 -DHAVE_PATHS_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_STDINT_H=1 -DHAVE_GRP_H=1 -DHAVE_ULIMIT_H=0 -DHAVE_VALUES_H=0 -DHAVE_RLIM_T=1 -DHAVE_SIG_T=1 -DHAVE_MKSH_SIGNAME=0 -DHAVE_SYS_SIGNAME=1 -DHAVE__SYS_SIGNAME=0 -DHAVE_SYS_SIGLIST=1 -DHAVE_STRSIGNAL=0 -DHAVE_ARC4RANDOM=1 -DHAVE_ARC4RANDOM_PUSH=1 -DHAVE_FLOCK_EX=1 -DHAVE_SETLOCALE_CTYPE=1 -DHAVE_LANGINFO_CODESET=1 -DHAVE_REVOKE=1 -DHAVE_SETMODE=1 -DHAVE_SETRESUGID=1 -DHAVE_SETGROUPS=1 -DHAVE_STRCASESTR=1 -DHAVE_STRLCPY=1 -DHAVE_PERSISTENT_HISTORY=1 -DHAVE_MULTI_IDSTRING=1 -DHAVE_CONFIG_H -DCONFIG_H_FILENAME=\"sh.h\"  -o '/usr/src/bin/mksh/obj/build-dir/mksh' alloc.c edit.c eval.c exec.c expr.c funcs.c histrap.c jobs.c lex.c main.c misc.c shf.c syn.c tree.c var.c
| /usr/src/bin/mksh/Build.sh: GCC_HONOUR_COPTS=2: not found
| *** Error code 1

• use /usr/bin/env if we want to add environment variables
• <sys.mk>: bump mirmake vsn
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.97 2007/03/18 02:19:51 tg Exp $
d24 1
a24 1
OSrpl=		17		# MirOS patchlevel
d32 1
a32 1
_MIRMAKE_VER=	20070320
@


1.97
log
@bump patchlevel ― bootloader fix (intel macs), security fix (mbufs patch#2)
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.96 2007/03/10 22:18:29 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20070310
@


1.96
log
@• uh oh, unassociated shell commands in <bsd.lib.mk> from the recent
  as-vs-cc dispute; how could've this worked at all?
• fix ctags stuff while here
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.95 2007/03/09 10:40:53 tg Exp $
d24 1
a24 1
OSrpl=		16		# MirOS patchlevel
@


1.95
log
@experimental change:

Until now, <bsd.sys.mk> contained
| COMPILE.c:= GCC_HONOUR_COPTS=2 ${COMPILE.c}
which worked well, except that changes to e.g. CPPFLAGS past that
line wouldn't be honoured. Incidentally, I noticed this because the
very same <bsd.sys.mk> does its “destdir build” magic in the lines
after that…

Now, it does
| CC:= GCC_HONOUR_COPTS=2 ${CC}
because I didn't find a way to do it without expansion; this thusly
affects all uses of ${CC}, i.e.
• COMPILE.c (as until now)
• COMPILE.S, COMPILE.s - not dangerous because doesn't call cc1
• LINK.c, LINK.S, LINK.s - not dangerous because doesn't call cc1
• LINKER (bsd.prog.mk, bsd.lib.mk) - not dangerous because doesn't call cc1
• <bsd.cfwrap.mk> - filtered out by .ifndef BSD_CFWRAP_MK and, in case
  the parent Makefile includes <bsd.sys.mk> before, a :NGCC_HONOUR_COPTS=*
  clause appended to the internal use of ${CC} - won't help other uses then
• CC in “make depend” - filtered out by .ifnmake depend¹

This unbreaks “destdir build” and maybe² some other CPPFLAGS+= lines,
hardenes the rule for honouring CFLAGS a little, but should² work.

¹) safe because “make obj” and “make depend” are never used
   in combination with other targets because they change
   make(1)s cwd and the Makefile itself
²) not tried yet… neither scanned for
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.94 2007/03/09 10:07:32 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20070309
@


1.94
log
@• bsd.own.mk: simplify, don't over-use := operator
• sys.mk: make ___DISPLAY_MAKEVARS usable with targets specified on
  the command line as well (just produces a line of superfluous output
  per target: “`foo' is up to date.” but that can be filtered out easily.
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.93 2007/03/08 10:07:02 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20070308
d43 7
a55 5
CC?=		mgcc
HOSTCC?=	mgcc

PIPE?=		-pipe

a64 3
CPP?=		cpp
CPPFLAGS?=

@


1.93
log
@use about the same compile commands in all places
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.92 2007/03/08 09:01:58 tg Exp $
d195 3
d199 7
a206 4
___display_makevars: .PHONY .NOTMAIN
.for _i in ${___DISPLAY_MAKEVARS}
	@@print -r -- ${${_i}:Q}
.endfor
@


1.92
log
@MirOS #10-beta
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.91 2007/02/26 02:37:50 tg Exp $
d94 1
a94 1
	${COMPILE.c} -o ${.TARGET} -E ${.IMPSRC}
d96 1
a96 1
	${COMPILE.c} ${.IMPSRC}
d109 1
a109 1
	${COMPILE.c} -o ${.TARGET} -E ${.IMPSRC}
d111 1
a111 1
	${COMPILE.c} ${.IMPSRC}
d124 1
a124 1
	${COMPILE.cc} -o ${.TARGET} -E ${.IMPSRC}
d126 1
a126 1
	${COMPILE.cc} ${.IMPSRC}
d135 1
a135 1
	${COMPILE.cc} -o ${.TARGET} -E ${.IMPSRC}
d137 1
a137 1
	${COMPILE.cc} ${.IMPSRC}
d147 1
a147 1
	${COMPILE.s} ${.IMPSRC}
d156 1
a156 1
	${COMPILE.S} -o ${.TARGET} -E ${.IMPSRC}
d158 1
a158 1
	${COMPILE.S} ${.IMPSRC}
@


1.91
log
@bump time, major changes in the bootloader are being tested
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.90 2007/02/17 03:07:15 tg Exp $
d23 2
a24 2
OSrev=		9		# MirOS version (major)
OSrpl=		173		# MirOS patchlevel
d32 1
a32 1
_MIRMAKE_VER=	20061228
@


1.90
log
@bump (for FOSDEM; bug fixes)
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.89 2007/02/07 01:37:52 tg Exp $
d24 1
a24 1
OSrpl=		172		# MirOS patchlevel
@


1.89
log
@* bump after gcc changes and during kernel and kernbase changes
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.88 2007/01/25 15:52:25 tg Exp $
d24 1
a24 1
OSrpl=		171		# MirOS patchlevel
@


1.88
log
@fixing the integer overflow problem is worth me a bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.87 2006/12/28 00:27:42 tg Exp $
d24 1
a24 1
OSrpl=		170		# MirOS patchlevel
@


1.87
log
@I should've bumped _MIRMAKE_VER earlier...
after the last CPPFLAGS change, to be exact
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.86 2006/12/11 20:48:34 tg Exp $
d24 1
a24 1
OSrpl=		169		# MirOS patchlevel
@


1.86
log
@bump for 23C3 edition; it's been a lot of changes recently anyway
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.85 2006/11/17 03:20:29 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20061101
@


1.85
log
@bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.84 2006/11/09 02:43:45 tg Exp $
d24 1
a24 1
OSrpl=		168		# MirOS patchlevel
@


1.84
log
@finally, bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.83 2006/11/03 18:11:58 tg Exp $
d24 1
a24 1
OSrpl=		167		# MirOS patchlevel
@


1.83
log
@time to bump these I suppose
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.82 2006/11/02 00:50:29 tg Exp $
d24 1
a24 1
OSrpl=		166		# MirOS patchlevel
@


1.82
log
@CPPFLAGS could be overridden from command line, restore previous
behaviour but be less invasive and use bsd.sys.mk
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.81 2006/10/28 19:52:51 tg Exp $
d24 1
a24 1
OSrpl=		165		# MirOS patchlevel
@


1.81
log
@* add new CONFGRP?=wheel (mirmake: same as BINGRP, unless BINGRP is the
  default of 'bin', in which case, it defaults to '0')
* sort logically, not alphabetically
* INSTALL_STRIP libs (while here)
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.80 2006/10/27 15:52:58 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20061028
d64 1
a64 1
CPPFLAGS?=	-isystem ${.CURDIR}
@


1.80
log
@* sys.mk, param.h: bump OS patchlevel
* sys.mk, sys.mk.ed: simplify CPPFLAGS generation
* limits.h, stdlib.h: crank MB_LEN_MAX to (2*real-MB_LEN_MAX - 1)
  to account for functions such as wcrtomb(3) to process an mbstate_t
* machine/limits.h: do *not* define MB_LEN_MAX=1 unconditionally,
  broke libncursesw(!); protect against multiple inclusion
* bsd.port.mk: default 'mmake uninstall' to pkg_delete -c
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.79 2006/10/17 23:16:57 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20061026
@


1.79
log
@bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.78 2006/10/07 03:30:58 tg Exp $
d24 1
a24 1
OSrpl=		164		# MirOS patchlevel
d32 1
a32 1
_MIRMAKE_VER=	20061006
d64 1
a64 5
CPPFLAGS?=

# CPPOPTS are for the user to override/add, e.g. in make.cfg
CPPOPTS=	-isystem ${.CURDIR}
CPPFLAGS+=	${CPPOPTS}
@


1.78
log
@bump <sys.mk> patchlevel because the makefile includes changed
recently (C++ reliability fixes); <sys/param.h> is tied to it,
so bump it too.
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.77 2006/10/02 23:24:14 tg Exp $
d24 1
a24 1
OSrpl=		163		# MirOS patchlevel
@


1.77
log
@bump for changed components
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.76 2006/09/29 22:01:23 tg Exp $
d24 1
a24 1
OSrpl=		162		# MirOS patchlevel
d32 1
a32 1
_MIRMAKE_VER=	20060929
@


1.76
log
@it's AFLAGS not ASFLAGS
bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.75 2006/09/29 21:57:08 tg Exp $
d24 1
a24 1
OSrpl=		161		# MirOS patchlevel
@


1.75
log
@:M* the CFLAGS and friends
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.74 2006/09/24 17:48:33 tg Exp $
d24 1
a24 1
OSrpl=		160		# MirOS patchlevel
d32 1
a32 1
_MIRMAKE_VER=	20060924
d149 1
a149 1
	${COMPILE.s} ${ASFLAGS_${.TARGET}:M*} ${.IMPSRC}
d158 1
a158 1
	${COMPILE.S} ${ASFLAGS_${.TARGET}:M*} ${.IMPSRC}
@


1.74
log
@bsiegert@@ and I decided this is #9-current, going on #10
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.73 2006/09/22 00:09:18 tg Exp $
d55 2
a56 2
COMPILE.c?=	${CC} ${CFLAGS} ${CPPFLAGS} -c
LINK.c?=	${CC} ${CFLAGS} ${CPPFLAGS} ${LDFLAGS}
d60 2
a61 2
COMPILE.cc?=	${CXX} ${CXXFLAGS} ${CPPFLAGS} -c
LINK.cc?=	${CXX} ${CXXFLAGS} ${CPPFLAGS} ${LDFLAGS}
d96 1
a96 1
	${COMPILE.c} ${CFLAGS_${.TARGET}} ${.IMPSRC}
d111 1
a111 1
	${COMPILE.c} ${CFLAGS_${.TARGET}} ${.IMPSRC}
d126 1
a126 1
	${COMPILE.cc} ${CXXFLAGS_${.TARGET}} ${.IMPSRC}
d137 1
a137 1
	${COMPILE.cc} ${CXXFLAGS_${.TARGET}} ${.IMPSRC}
d149 1
a149 1
	${COMPILE.s} ${ASFLAGS_${.TARGET}} ${.IMPSRC}
d158 1
a158 1
	${COMPILE.S} ${ASFLAGS_${.TARGET}} ${.IMPSRC}
d176 1
a176 1
	${COMPILE.c} ${CFLAGS_${.TARGET}} -o ${.TARGET} lex.yy.c
d189 1
a189 1
	${COMPILE.c} ${CFLAGS_${.TARGET}} -o ${.TARGET} y.tab.c
@


1.73
log
@formalise the check whether we have a 'new' cksum
XXX think better about this
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.72 2006/07/30 23:37:12 tg Exp $
d24 1
a24 1
OSrpl=		129		# MirOS patchlevel
d32 1
a32 1
_MIRMAKE_VER=	20060921
@


1.72
log
@mirmake vsn
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.71 2006/07/02 23:31:50 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20060730
@


1.71
log
@* depend all shared libraries on libc
* remove refs to a few obsolete libs
* we don't depend on libgcc since it's machdep and compiler-dependent
* bump mirmake vsn
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.70 2006/06/27 14:15:30 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20060702
@


1.70
log
@MirOS #9-stable (yes, in -rHEAD, that's right, for now)
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.69 2006/06/23 15:22:01 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20060623
@


1.69
log
@for mirmake
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.68 2006/06/21 21:23:58 tg Exp $
d24 1
a24 1
OSrpl=		128		# MirOS patchlevel
@


1.68
log
@bump to #9-RELEASE
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.67 2006/06/17 20:08:08 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20060617
@


1.67
log
@can't do it the same in <bsd.cfwrap.mk>
so distinguish, again
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.66 2006/06/17 20:03:31 tg Exp $
d24 1
a24 1
OSrpl=		18		# MirOS patchlevel
@


1.66
log
@make HOSTCFLAGS?=${CFLAGS} system-wide
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.65 2006/06/17 17:12:33 tg Exp $
d50 1
a57 3
HOSTCC?=	mgcc
HOSTCFLAGS?=	${CFLAGS}

@


1.65
log
@* <bsd.cfwrap.mk> provide CC_FOR_BUILD, CFLAGS_FOR_BUILD (host stuff),
  unbreaks cross-built native gcc configure
* others: bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.64 2006/06/16 23:58:59 tg Exp $
d58 1
@


1.64
log
@bump mirmake vsn (not yet ospatchlevel)
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.63 2006/06/15 18:11:36 tg Exp $
d24 1
a24 1
OSrpl=		17		# MirOS patchlevel
d32 1
a32 1
_MIRMAKE_VER=	20060616
@


1.63
log
@switch to DEBUGLIBS?=No, MALLOC_TYPE?=brk for release
bump os patchlevel

agreed bsiegert@@
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.62 2006/06/11 02:34:01 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20060615
@


1.62
log
@surprise, surprise
this is almost MirOS #9-beta ;)
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.61 2006/06/09 17:23:17 tg Exp $
d24 1
a24 1
OSrpl=		16		# MirOS patchlevel
d32 1
a32 1
_MIRMAKE_VER=	20060611
@


1.61
log
@fix <bsd.cfwrap.mk> + DEBUGPROGS + MKC_DEBG
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.60 2006/06/09 00:31:36 tg Exp $
d23 2
a24 2
OSrev=		8		# MirOS version (major)
OSrpl=		169		# MirOS patchlevel
d32 1
a32 1
_MIRMAKE_VER=	20060609
@


1.60
log
@just to be safe, bump (indicate new fxp(4) code, among others)
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.59 2006/06/02 12:08:14 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20060527
@


1.59
log
@oops, an M in my tree, belongs to commitid 100447F717560592A14
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.58 2006/05/27 19:21:35 tg Exp $
d24 1
a24 1
OSrpl=		168		# MirOS patchlevel
@


1.58
log
@bump mirmake vsn
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.57 2006/05/25 13:00:29 tg Exp $
d24 1
a24 1
OSrpl=		167		# MirOS patchlevel
@


1.57
log
@bump os patchlevel
todo: release new mksh, mircksum; fix errors; release snapshot
then: start obsd3.9 merge (maybe)
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.56 2006/04/06 11:10:50 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20060327
@


1.56
log
@these changes justify another version number bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.55 2006/03/27 20:09:53 tg Exp $
d24 1
a24 1
OSrpl=		166		# MirOS patchlevel
@


1.55
log
@also bump mirmake version
(wtf, already 27th of march? time surely passes by...)
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.54 2006/03/27 19:33:45 tg Exp $
d24 1
a24 1
OSrpl=		165		# MirOS patchlevel
@


1.54
log
@bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.53 2006/03/19 21:04:27 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20060319
@


1.53
log
@bump mirmake version
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.52 2006/02/22 00:49:07 tg Exp $
d24 1
a24 1
OSrpl=		164		# MirOS patchlevel
@


1.52
log
@bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.51 2006/02/01 14:44:59 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20060112
@


1.51
log
@bump version number (libiconv)
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.50 2006/01/18 10:21:37 tg Exp $
d24 1
a24 1
OSrpl=		163		# MirOS patchlevel
@


1.50
log
@bump kernel version (ET_DYN exec capab)
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.49 2006/01/13 03:50:45 tg Exp $
d24 1
a24 1
OSrpl=		162		# MirOS patchlevel
@


1.49
log
@bump patchlevels, let's do a snapshot
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.48 2005/12/29 23:17:04 tg Exp $
d24 1
a24 1
OSrpl=		161		# MirOS patchlevel
@


1.48
log
@* bsd.own.mk: this is #8-current, switch DEBUGLIBS on
* sys.mk: bump _MIRMAKE_VER to tomorrow (will have to regen anyway)
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.47 2005/12/23 19:59:48 tg Exp $
d24 1
a24 1
OSrpl=		160		# MirOS patchlevel
d32 1
a32 1
_MIRMAKE_VER=	20051230
@


1.47
log
@bump to MirOS #8-current
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.46 2005/12/20 01:06:29 tg Exp $
d32 1
a32 1
_MIRMAKE_VER=	20051220
@


1.46
log
@for all practical reasons, this code _is_ MirOS #8 (BSD, GCC, X11)
set the version number; last fixes and tagging will be done later.
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.45 2005/12/20 00:47:54 tg Exp $
d24 1
a24 1
OSrpl=		128		# MirOS patchlevel
@


1.46.2.1
log
@I hereby declare the MirOS #8-stable branch *snip* open
and its maintainer Benny Siegert (bsiegert@@)
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.46 2005/12/20 01:06:29 tg Exp $
d24 1
a24 1
OSrpl=		129		# MirOS patchlevel
@


1.45
log
@while I see it... ${_MIRMAKE_EXE} will be the pathname of the compiled exe.
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.44 2005/12/19 23:14:48 tg Exp $
d24 1
a24 1
OSrpl=		61		# MirOS patchlevel
@


1.44
log
@* make kernel build
* bump OS patchlevel
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.43 2005/12/17 05:57:55 tg Exp $
d31 2
a32 1
_MIRMAKE_VER=	20051217
@


1.43
log
@bsiegert@@ decided it wouldn't be that good an idea to include debugging
symbols in all libraries for the release (but we'll do for snapshots).

bump mirmake and miros patchlevels
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.42 2005/12/15 01:31:24 tg Exp $
d24 1
a24 1
OSrpl=		60		# MirOS patchlevel
@


1.42
log
@${.SYSMK:Q} no "${.SYSMK}"

this fix is required for building firesomething-1.5 (a port bsiegert@@ has
already prepared), thus bump MIRMAKE_VERSION in <sys.mk> as well
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.41 2005/12/15 01:24:45 tg Exp $
d24 1
a24 1
OSrpl=		59		# MirOS patchlevel
d31 1
a31 1
_MIRMAKE_VER=	20051215
@


1.41
log
@* use ${FOO:Q} i.p.v. '${FOO}' or "${FOO}"
* replace v='' and v="" with v= while here
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.40 2005/12/04 13:22:55 tg Exp $
d31 1
a31 1
_MIRMAKE_VER=	20051119
@


1.40
log
@this will be MirOS 08u3B
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.39 2005/11/19 12:34:57 tg Exp $
d203 1
a203 1
	@@print -r -- '${${_i}}'
@


1.39
log
@add (and, exceptionally, document) LDADD_CYCLIC
bump mirmake version
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.38 2005/11/17 18:30:03 tg Exp $
d24 1
a24 1
OSrpl=		58		# MirOS patchlevel
@


1.38
log
@* lkm: remove ld(1) generated output file for us;
  modload(8) doesn't seem to do it any more
* sys: bump patchlevel, LKM works
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.37 2005/11/10 12:59:34 tg Exp $
d31 1
a31 1
_MIRMAKE_VER=	20051110
@


1.37
log
@bump to 20051110 (mostly, portability changes)
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.36 2005/10/21 20:08:14 tg Exp $
d24 1
a24 1
OSrpl=		57		# MirOS patchlevel
@


1.36
log
@20051021 it is
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.35 2005/10/21 10:51:16 tg Exp $
d31 1
a31 1
_MIRMAKE_VER=	20051021
@


1.35
log
@* sys.mk, param.h: bump (sys.mk += 2 even)
  -> library changes, timekeeping fixes
* bsd.prog.mk: do not attempt to objcopy on DEBUGPROGS install if
  INSTALL_SCRIPT is empty (it doesn't like scripts, and besides,
  if we don't strip out debug information anyway...)
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.34 2005/09/01 23:48:50 tg Exp $
d31 1
a31 1
_MIRMAKE_VER=	20050821
@


1.34
log
@no reason to MACHINE_OS?= with recent enough (2 years or so) make(1)
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.33 2005/09/01 23:44:28 tg Exp $
d24 1
a24 1
OSrpl=		55		# MirOS patchlevel
@


1.33
log
@* use .error here
* forget about MirLinux for now
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.32 2005/08/26 20:56:00 tg Exp $
a8 1
MACHINE_OS?=	unknown
@


1.32
log
@bump to 0837 (changes: gcc)
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.31 2005/08/21 11:45:50 tg Exp $
a11 2
.elif ${MACHINE_OS} == "Linux"
OStype=		MirLinux
d13 1
a13 3
ERRORS+=	Something fishy: $$MACHINE_OS unknown!
___DISPLAY_MAKEVARS+=ERRORS
OStype=		unknown
@


1.31
log
@mk.conf -> make.cfg (uses basename of $MAKE, for portable mirmake's sake)
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.30 2005/08/21 11:35:42 tg Exp $
d29 1
a29 1
OSrpl=		54		# MirOS patchlevel
@


1.30
log
@provide _MIRMAKE_VER in base-mirmake, too
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.29 2005/08/21 11:26:19 tg Exp $
d71 1
a71 1
# CPPOPTS are for the user to override/add, e.g. in mk.conf
@


1.29
log
@* PREFIXify BINDIR, SHAREDIR, MANDIR etc.
* use print not printf for ___DISPLAY_MAKEVARS
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.28 2005/07/21 22:52:11 tg Exp $
d36 1
@


1.28
log
@* merge
* bump patchlevel (userland)
* invent _subdircheck target
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.27 2005/07/07 18:42:00 tg Exp $
d207 1
a207 1
	@@printf '%s\n' '${${_i}}'
@


1.27
log
@fix build; bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.26 2005/07/04 02:37:18 tg Exp $
d29 1
a29 1
OSrpl=		53		# MirOS patchlevel
@


1.26
log
@merge OpenBSD
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.25 2005/07/03 20:13:52 tg Exp $
d29 1
a29 1
OSrpl=		52		# MirOS patchlevel
@


1.25
log
@0833 for a long time... forgot to ci
@
text
@d1 2
a2 2
# $MirOS: src/share/mk/sys.mk,v 1.24 2005/06/14 13:47:39 tg Exp $
# $OpenBSD: sys.mk,v 1.37 2004/04/05 19:17:25 miod Exp $
d29 1
a29 1
OSrpl=		51		# MirOS patchlevel
d54 2
@


1.24
log
@* use ${LINKER} not ${CC} in <bsd.lib.mk>, like <bsd.prog.mk>
* set LINKER to ${CXX} if ${SRCS} contains a C++ file
  (unused within MirOS source tree though)
  XXX could we add -lobjc to LDADD if SRCS contain an ObjC/ObjC++ file?
* enable DEBUGLIBS to show off that it isn't broken ;)
* bump patchlevel
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.23 2005/06/07 15:58:07 tg Exp $
d29 1
a29 1
OSrpl=		50		# MirOS patchlevel
@


1.23
log
@double default message buffer size on i386 and macppc
(not doable "without great pain" on sparc)

it's quite small already with K7 PowerNow(tm)! in effect.
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.22 2005/05/26 20:27:38 tg Exp $
d29 1
a29 1
OSrpl=		49		# MirOS patchlevel
@


1.22
log
@bump to 0830:
* gcc 3.4.5 (yay!)
* binutils, gdb 20050514
* idle loop
* mksh R22
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.21 2005/05/23 22:07:42 tg Exp $
d29 1
a29 1
OSrpl=		48		# MirOS patchlevel
@


1.21
log
@mksh
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.20 2005/05/23 10:26:23 tg Exp $
d29 1
a29 1
OSrpl=		47		# MirOS patchlevel
@


1.20
log
@bump MirOS patchlevel
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.19 2005/05/21 01:02:36 tg Exp $
d82 2
a83 2
# MirOS can use mirbsdksh extensions per definitionem
SHELL=		/bin/ksh
@


1.19
log
@prefix _ASM_SOURCE definition to CPPFLAGS if assembling
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.18 2005/05/14 18:02:12 tg Exp $
d29 1
a29 1
OSrpl=		46		# MirOS patchlevel
@


1.18
log
@bump a bit
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.17 2005/05/06 00:17:43 tg Exp $
d47 4
a50 4
COMPILE.s?=	${CC} ${AFLAGS} -c
LINK.s?=	${CC} ${AFLAGS} ${LDFLAGS}
COMPILE.S?=	${CC} ${AFLAGS} ${CPPFLAGS} -c
LINK.S?=	${CC} ${AFLAGS} ${CPPFLAGS} ${LDFLAGS}
@


1.17
log
@* bump OS patchlevel again
* start pretending we're the #8 release in some parts
  of the documentation already
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.16 2005/05/04 18:32:45 tg Exp $
d29 1
a29 1
OSrpl=		45		# MirOS patchlevel
@


1.16
log
@bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.15 2005/05/01 21:54:17 tg Exp $
d29 1
a29 1
OSrpl=		44		# MirOS patchlevel
@


1.15
log
@disable boehm-gc for gcj and Objective C
cf. http://www.monkey.org/openbsd/archive/ports/0304/msg00263.html
and today's IRC log
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.14 2005/04/29 15:14:16 tg Exp $
d29 1
a29 1
OSrpl=		43		# MirOS patchlevel
@


1.14
log
@bump (early - some changes still comming, don't build now)
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.13 2005/04/29 00:22:36 tg Exp $
d29 1
a29 1
OSrpl=		42		# MirOS patchlevel
@


1.13
log
@post-RC1 grave changes: gcc EH, <.mk>
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.12 2005/04/26 04:23:12 tg Exp $
d29 1
a29 1
OSrpl=		41		# MirOS patchlevel
@


1.12
log
@these changes justify a version bump (*winks* hi MirPorts)
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.11 2005/04/19 20:13:46 tg Exp $
d29 1
a29 1
OSrpl=		40		# MirOS patchlevel
@


1.11
log
@hack on gdb
make it somehow work (i386, sparc, powerpc)
add readline docs from rl 5.0
nuke generated files
make make build work again
bump OS version
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.10 2005/04/16 21:22:33 tg Exp $
d29 1
a29 1
OSrpl=		39		# MirOS patchlevel
@


1.10
log
@change order of .SUFFIXES - don't sort!
partially inspired by NetBSD(R), most by OpenBSD, final decision by me
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.9 2005/04/16 02:20:18 tg Exp $
d29 1
a29 1
OSrpl=		38		# MirOS patchlevel
@


1.9
log
@sync
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.8 2005/04/14 19:33:05 tg Exp $
d37 1
a37 1
.SUFFIXES:	.a .c .cc .cxx .h .i .l .ln .m .m4 .o .out .S .s .sh .y
@


1.8
log
@bump
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.7 2005/04/07 19:12:10 tg Exp $
d67 4
a70 1
CPPFLAGS+=	-isystem ${.CURDIR}
@


1.7
log
@provide ${OStype} to <bsd.own.mk>

mainly for bsiegert@@ and his MirPorts/Darwin issues,
but will be good in no time for MirInterix as well.
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.6 2005/03/25 22:43:34 tg Exp $
d29 1
a29 1
OSrpl=		37		# MirOS patchlevel
@


1.6
log
@adding EH and shared libgcc justifies bumping,
as do all the other small improvements
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.5 2005/03/15 18:26:12 tg Exp $
a8 6
.if defined(EXTRA_SYS_MK_INCLUDES)
.  for _i in ${EXTRA_SYS_MK_INCLUDES}
.    include ${_i}
.  endfor
.endif

d20 6
@


1.5
log
@* move <sys.mk> readme to bsd.README
* -idirafter ${.CURDIR} => -isystem ${.CURDIR}
  unbreaks much of base
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.4 2005/03/05 12:02:29 tg Exp $
d29 1
a29 1
OSrpl=		36		# MirOS patchlevel
@


1.4
log
@++Objective-C;
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.3 2005/02/14 19:21:54 tg Exp $
a5 12
# We want at least the following defines: (samples)
# MACHINE		i386			amiga
# MACHINE_ARCH		i386			m68k
# MACHINE_OS		BSD			Linux
# OStype		MirBSD			Debian (...)
# OSrev			7			version
# OSrpl			128			patchlevel
# OSNAME		MirBSD			uname -s
# OSname		mirbsd			uname -s in lowercase
# OScompat		3.5			equivalent OpenBSD version
# OStriplet		i386-ecce-mirbsd8	... for GNU software

d67 1
a67 1
CPPFLAGS+=	-idirafter ${.CURDIR}
@


1.3
log
@make ${.CURDIR} an -idirafter as well
@
text
@d1 1
a1 1
# $MirOS: src/share/mk/sys.mk,v 1.2 2005/02/14 18:57:46 tg Exp $
d49 1
a49 1
.SUFFIXES:	.a .c .cc .cxx .h .i .l .ln .m4 .o .out .S .s .sh .y
d118 15
@


1.2
log
@merge these from ncvs 1
@
text
@d1 1
a1 1
# $MirOS$
d41 1
a41 1
OSrpl=		35		# MirOS patchlevel
d79 1
a79 1
CPPFLAGS+=	-I${.CURDIR}
@


1.1
log
@Initial revision
@
text
@d1 19
a19 3
#	$OpenBSD: sys.mk,v 1.37 2004/04/05 19:17:25 miod Exp $
#	$NetBSD: sys.mk,v 1.27 1996/04/10 05:47:19 mycroft Exp $
#	@@(#)sys.mk	5.11 (Berkeley) 3/13/91
d22 3
a24 3
.for __SYS_MK_INCLUDE in ${EXTRA_SYS_MK_INCLUDES}
.include ${__SYS_MK_INCLUDE}
.endfor
d27 10
a36 5
unix=		We run OpenBSD.
OSMAJOR=	3
OSMINOR=	5
OSREV=		$(OSMAJOR).$(OSMINOR)
OSrev=		$(OSMAJOR)$(OSMINOR)
d38 10
a47 1
.SUFFIXES: .out .a .ln .o .c .cc .C .cxx .F .f .r .y .l .s .S .cl .p .h .sh .m4
d49 1
d64 1
a64 1
CC?=		cc
d70 1
a70 1
HOSTCC?=	cc
d78 2
a79 11
CPPFLAGS?=	

FC?=		f77
FFLAGS?=		-O2
RFLAGS?=
COMPILE.f?=	${FC} ${FFLAGS} -c
LINK.f?=	${FC} ${FFLAGS} ${LDFLAGS}
COMPILE.F?=	${FC} ${FFLAGS} ${CPPFLAGS} -c
LINK.F?=	${FC} ${FFLAGS} ${CPPFLAGS} ${LDFLAGS}
COMPILE.r?=	${FC} ${FFLAGS} ${RFLAGS} -c
LINK.r?=	${FC} ${FFLAGS} ${RFLAGS} ${LDFLAGS}
d91 2
a94 7
PC?=		pc
PFLAGS?=
COMPILE.p?=	${PC} ${PFLAGS} ${CPPFLAGS} -c
LINK.p?=	${PC} ${PFLAGS} ${CPPFLAGS} ${LDFLAGS}

SHELL?=		sh

d107 3
a109 2
	${COMPILE.c} ${.IMPSRC}
.if (${MACHINE_ARCH} != "alpha")
a113 1
.endif
d115 2
a116 1
	${LINT} ${LINTFLAGS} ${CFLAGS:M-[IDU]*} -i ${.IMPSRC}
d122 3
a124 1
	${COMPILE.cc} ${.IMPSRC}
a129 9
.C:
	${LINK.cc} -o ${.TARGET} ${.IMPSRC} ${LDLIBS}
.C.o:
	${COMPILE.cc} ${.IMPSRC}
.C.a:
	${COMPILE.cc} ${.IMPSRC}
	${AR} ${ARFLAGS} $@@ $*.o
	rm -f $*.o

d133 3
a135 1
	${COMPILE.cc} ${.IMPSRC}
a140 38
# Fortran/Ratfor
.f:
	${LINK.f} -o ${.TARGET} ${.IMPSRC} ${LDLIBS}
.f.o:
	${COMPILE.f} ${.IMPSRC}
.f.a:
	${COMPILE.f} ${.IMPSRC}
	${AR} ${ARFLAGS} $@@ $*.o
	rm -f $*.o

.F:
	${LINK.F} -o ${.TARGET} ${.IMPSRC} ${LDLIBS}
.F.o:
	${COMPILE.F} ${.IMPSRC}
.F.a:
	${COMPILE.F} ${.IMPSRC}
	${AR} ${ARFLAGS} $@@ $*.o
	rm -f $*.o

.r:
	${LINK.r} -o ${.TARGET} ${.IMPSRC} ${LDLIBS}
.r.o:
	${COMPILE.r} ${.IMPSRC}
.r.a:
	${COMPILE.r} ${.IMPSRC}
	${AR} ${ARFLAGS} $@@ $*.o
	rm -f $*.o

# Pascal
.p:
	${LINK.p} -o ${.TARGET} ${.IMPSRC} ${LDLIBS}
.p.o:
	${COMPILE.p} ${.IMPSRC}
.p.a:
	${COMPILE.p} ${.IMPSRC}
	${AR} ${ARFLAGS} $@@ $*.o
	rm -f $*.o

d145 1
a145 1
	${COMPILE.s} ${.IMPSRC}
d150 1
d154 3
a156 1
	${COMPILE.S} ${.IMPSRC}
d172 1
a172 1
	${COMPILE.c} -o ${.TARGET} lex.yy.c 
d185 1
a185 1
	${COMPILE.c} -o ${.TARGET} y.tab.c
d192 11
@


1.1.1.1
log
@Import the OpenBSD foundation of MirOS BSD
@
text
@@


1.1.1.2
log
@the dreaded importer strikes again
@
text
@d1 1
a1 1
#	$OpenBSD: sys.mk,v 1.45 2005/03/07 00:06:00 deraadt Exp $
d13 1
a13 1
OSMINOR=	7
a34 2
PIPE?=		-pipe

d91 1
d96 1
d98 1
a98 1
	${LINT} ${LINTFLAGS} ${CFLAGS:M-[IDU]*} ${CPPFLAGS:M-[IDU]*} -i ${.IMPSRC}
@

