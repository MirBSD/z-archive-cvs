head	1.7;
access;
symbols
	MIRBSD_10:1.7.0.2
	MIRBSD_10_BASE:1.7
	cvs-200610131945:1.1.1.3
	MIRBSD_9_BASE:1.4
	MIRBSD_8:1.4.0.2
	MIRBSD_8_BASE:1.4
	cvs-200507211800:1.1.1.2
	cvs-200504261445:1.1.1.2
	openbsd:1.1.1;
locks; strict;
comment	@# @;


1.7
date	2007.04.28.00.12.44;	author tg;	state Exp;
branches;
next	1.6;
commitid	1004632918E6CE6474D;

1.6
date	2007.04.27.22.21.04;	author tg;	state Exp;
branches;
next	1.5;
commitid	1004632774B71EB3ACC;

1.5
date	2006.10.13.18.21.53;	author tg;	state Exp;
branches;
next	1.4;
commitid	100452FD95539285DEF;

1.4
date	2005.10.21.11.02.38;	author tg;	state Exp;
branches;
next	1.3;
commitid	6c0b4358cac0ef88;

1.3
date	2005.04.26.15.12.25;	author tg;	state Exp;
branches;
next	1.2;

1.2
date	2005.03.15.18.58.32;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.02.05.17.22.06;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.02.05.17.22.06;	author tg;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2005.04.26.14.55.29;	author tg;	state Exp;
branches;
next	1.1.1.3;

1.1.1.3
date	2006.10.13.18.05.02;	author tg;	state Exp;
branches;
next	;
commitid	100452FD5647CB46846;


desc
@@


1.7
log
@more lex/yacc overhaul, tentatively
@
text
@# $MirOS: src/bin/systrace/Makefile,v 1.6 2007/04/27 22:21:04 tg Exp $
# $OpenBSD: Makefile,v 1.15 2006/07/02 12:34:15 sturm Exp $

PROG=		systrace
CPPFLAGS+=	-I. -DYY_NO_UNPUT -I${.CURDIR}/../../sys
DPADD+=		${LIBEVENT}
LDADD+=		-levent

.include <bsd.own.mk>
COPTS+=		-Wall -Wstrict-prototypes -Wmissing-prototypes \
		-Wpointer-arith -Wno-uninitialized

SRCS=	cradle.c filter.c intercept-translate.c intercept.c \
	linux-translate.c openbsd-syscalls.c util.c \
	policy.c systrace-errno.h systrace-error.c \
	systrace-translate.c systrace.c alias.c register.c \
	parse.y lex.l

.include <bsd.prog.mk>
@


1.6
log
@• it's no longer "y.tab.h" it's ${.IMPSRC:R}.tab.h now
• sync CLEANFILES
@
text
@d1 1
a1 1
# $MirOS: src/bin/systrace/Makefile,v 1.5 2006/10/13 18:21:53 tg Exp $
a7 1
CLEANFILES+=	parse.tab.h
@


1.5
log
@possibly upgrade systrace; also covers security issues
@
text
@d1 1
a1 1
# $MirOS: src/bin/systrace/Makefile,v 1.4 2005/10/21 11:02:38 tg Exp $
d8 1
a8 1
CLEANFILES+=	parse.c lex.c y.tab.h
@


1.4
log
@* merge bin and lib completely
* convert some ancient RCSID styles etc. to more modern stuff
* fix use of CDIAGFLAGS+=, CFLAGS+= and COPTS+= to the correct
  variant (include bsd.own.mk _then_ COPTS+=) so they're added
  after any user-specified flags
  (this is probably lurking in more places than I can imagine)
* fix some indenting, comments, etc.
* make stuff compile (fix warnings/errors)
* add script to review _all_ shlib_version after an openbsd import
* remove two more obsolete /usr/lib/debug/ references
* bin/ps: comment out some SMP code
@
text
@d1 2
a2 2
# $MirOS: src/bin/systrace/Makefile,v 1.3 2005/04/26 15:12:25 tg Exp $
# $OpenBSD: Makefile,v 1.13 2004/07/09 21:53:55 mickey Exp $
d15 1
a15 1
	openbsd-syscalls.c util.c \
a19 2
beforedepend: parse.c lex.c

@


1.3
log
@* merge
* still prolong string interception buffer
@
text
@d1 1
a1 1
# $MirOS: src/bin/systrace/Makefile,v 1.2 2005/03/15 18:58:32 tg Exp $
a5 2
CFLAGS+=	-Wall -Wstrict-prototypes -Wmissing-prototypes \
		-Wpointer-arith -Wno-uninitialized
d10 4
@


1.2
log
@CFLAGS vs COPTS vs CPPFLAGS cleanup
@
text
@d1 2
a2 2
# $MirOS$
# $OpenBSD: Makefile,v 1.12 2004/01/23 20:51:18 sturm Exp $
d5 1
a5 1
CPPFLAGS+=	-I. -DYY_NO_UNPUT
@


1.1
log
@Initial revision
@
text
@d1 2
a2 1
#	$OpenBSD: Makefile,v 1.12 2004/01/23 20:51:18 sturm Exp $
d4 7
a10 7
PROG=	systrace
CFLAGS+=-I. -I${.CURDIR}
CFLAGS+=-Wall -Wstrict-prototypes -Wmissing-prototypes -Wpointer-arith \
	-Wno-uninitialized
CFLAGS+=-DYY_NO_UNPUT
DPADD+=	${LIBEVENT}
LDADD+=	-levent
d17 2
a18 1
CLEANFILES+= parse.c lex.c y.tab.h
a20 3

.depend: parse.c lex.c

@


1.1.1.1
log
@Import the OpenBSD foundation of MirOS BSD
@
text
@@


1.1.1.2
log
@latest fixes from OpenBSD, last update for #8 if nothing weird happens
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.13 2004/07/09 21:53:55 mickey Exp $
d4 1
a4 1
CFLAGS+=-I. -I${.CURDIR} -I${.CURDIR}/../../sys
@


1.1.1.3
log
@import current systrace from obsd
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.15 2006/07/02 12:34:15 sturm Exp $
d12 1
a12 1
	linux-translate.c openbsd-syscalls.c util.c \
d16 1
d19 3
@


