head	1.23;
access;
symbols
	MIRBSD_10:1.12.0.2
	MIRBSD_10_BASE:1.12
	MIRBSD_9_BASE:1.6
	MIRBSD_8:1.5.0.2
	MIRBSD_8_BASE:1.5
	cvs-200507211800:1.1.1.2
	openbsd:1.1.1;
locks; strict;
comment	@# @;


1.23
date	2014.02.19.17.15.10;	author tg;	state Exp;
branches;
next	1.22;
commitid	1005304E6B4683AAB85;

1.22
date	2013.10.10.23.09.47;	author tg;	state Exp;
branches;
next	1.21;
commitid	100525733D370513C42;

1.21
date	2011.08.18.21.45.18;	author tg;	state Exp;
branches;
next	1.20;
commitid	1004E4D87FF628E9DD0;

1.20
date	2011.07.06.22.21.53;	author tg;	state Exp;
branches;
next	1.19;
commitid	1004E14E010182825E7;

1.19
date	2011.07.06.21.08.21;	author tg;	state Exp;
branches;
next	1.18;
commitid	1004E14CEDC79991801;

1.18
date	2009.11.22.21.11.28;	author tg;	state Exp;
branches;
next	1.17;
commitid	1004B09A91838010E32;

1.17
date	2009.08.27.18.04.54;	author tg;	state Exp;
branches;
next	1.16;
commitid	1004A96CACF7D07E95E;

1.16
date	2009.06.29.19.31.15;	author tg;	state Exp;
branches;
next	1.15;
commitid	1004A49168E70552251;

1.15
date	2009.06.29.19.29.50;	author tg;	state Exp;
branches;
next	1.14;
commitid	1004A491644068EDFFF;

1.14
date	2009.05.17.14.09.25;	author tg;	state Exp;
branches;
next	1.13;
commitid	1004A101A5960DAB717;

1.13
date	2009.03.15.15.40.44;	author tg;	state Exp;
branches;
next	1.12;
commitid	10049BD21691D58561F;

1.12
date	2008.03.09.14.18.58;	author tg;	state Exp;
branches;
next	1.11;
commitid	10047D3F1E95EA60ADC;

1.11
date	2007.05.07.15.46.23;	author tg;	state Exp;
branches;
next	1.10;
commitid	100463F49DA1187D74F;

1.10
date	2007.05.07.15.21.14;	author tg;	state Exp;
branches;
next	1.9;
commitid	100463F43D3067E6553;

1.9
date	2007.04.29.22.17.45;	author tg;	state Exp;
branches;
next	1.8;
commitid	100463519761D6D8E11;

1.8
date	2006.09.17.19.28.57;	author tg;	state Exp;
branches;
next	1.7;
commitid	100450DA20303EFF79D;

1.7
date	2006.07.30.23.39.47;	author tg;	state Exp;
branches;
next	1.6;
commitid	10044CD434D0C0595CA;

1.6
date	2006.05.26.11.55.15;	author tg;	state Exp;
branches;
next	1.5;
commitid	1004476ECB0544641F5;

1.5
date	2005.10.21.11.02.34;	author tg;	state Exp;
branches;
next	1.4;
commitid	6c0b4358cac0ef88;

1.4
date	2005.04.12.19.50.21;	author tg;	state Exp;
branches;
next	1.3;

1.3
date	2005.03.16.17.19.06;	author tg;	state Exp;
branches;
next	1.2;

1.2
date	2005.03.06.18.55.22;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.02.05.17.22.05;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.02.05.17.22.05;	author tg;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2005.07.21.20.45.23;	author tg;	state Exp;
branches;
next	;
commitid	560042e0092f571e;


desc
@@


1.23
log
@add BAFH; consider deprecating OAAT1S
@
text
@# $MirOS: src/bin/md5/Makefile,v 1.22 2013/10/10 23:09:47 tg Exp $
# $OpenBSD: Makefile,v 1.10 2005/05/24 21:57:47 millert Exp $

PROG=	cksum
MAN=	cksum.1 md5.1 sha1.1 rmd160.1
LINKS=	${BINDIR}/cksum ${BINDIR}/sha1 \
	${BINDIR}/cksum ${BINDIR}/rmd160 \
	${BINDIR}/cksum ${BINDIR}/md5 \
	${BINDIR}/cksum ${BINDIR}/sum
MLINKS= cksum.1 sum.1

.if exists(${.SYSMK}/libmirmake.a)
CPPFLAGS+=	-D_GNU_SOURCE -D_MIRMAKE_DEFNS
.  if make(depend)
# shortcoming in mirmake_20080411-1wtf2 that it can’t do
# -isystem and -include and -idirafter or summat lik’em…
CPPFLAGS+=	-I${.SYSMK}
.  endif
LDADD+=		-L${.SYSMK} -lmirmake
.endif

ALGOS=	adler32 bafh cdb md4 md5 nzat nzaat oaat oaat1 oaat1s rmd160 sfv \
	sha1 sha256 sha384 sha512 size sum suma sysvsum tiger whirlpool

CLEANFILES+=	${ALGOS} ${ALGOS:=sum}

algos:
.for _lnk in ${ALGOS}
	ln -sf ${PROG} ${_lnk}
	ln -sf ${PROG} ${_lnk}sum
.endfor
	# these don't make any sense
	-rm -f sumsum sysvsumsum

regress: ${PROG}
	./${PROG} -a adler32 -a bafh -a cdb -a cksum -a md4 -a md5 \
	    -a nzat -a nzaat \
	    -a oaat -a oaat1 -a oaat1s -a rmd160 -a sfv \
	    -a sha1 -a sha256 -a sha384 -a sha512 -a size \
	    -a sum -a suma -a sysvsum -a tiger -a whirlpool \
	    -x | diff -u ${.CURDIR}/testres -

.include <bsd.prog.mk>
@


1.22
log
@fix build on GNU/Linux
@
text
@d1 1
a1 1
# $MirOS: src/bin/md5/Makefile,v 1.21 2011/08/18 21:45:18 tg Exp $
d22 1
a22 1
ALGOS=	adler32 cdb md4 md5 nzat nzaat oaat oaat1 oaat1s rmd160 sfv \
d36 1
a36 1
	./${PROG} -a adler32 -a cdb -a cksum -a md4 -a md5 \
@


1.21
log
@sync list of foosum GNUlinks
@
text
@d1 1
a1 1
# $MirOS: src/bin/md5/Makefile,v 1.20 2011/07/06 22:21:53 tg Exp $
d14 5
@


1.20
log
@replace uses of OAAT hash in all its variants by NZAT (mksh internal) or NZAAT (all others)
@
text
@d1 1
a1 1
# $MirOS: src/bin/md5/Makefile,v 1.19 2011/07/06 21:08:21 tg Exp $
d17 2
a18 2
ALGOS=	adler32 cdb md4 md5 oaat oaat1 oaat1s rmd160 sfv sha1 \
	sha256 sha384 sha512 size sum suma sysvsum tiger whirlpool
@


1.19
log
@some code sharing and a regression test
@
text
@d1 1
a1 1
# $MirOS: src/bin/md5/Makefile,v 1.18 2009/11/22 21:11:28 tg Exp $
d32 1
@


1.18
log
@sync
@
text
@d1 1
a1 1
# $MirOS: src/bin/md5/Makefile,v 1.17 2009/08/27 18:04:54 tg Exp $
d30 7
@


1.17
log
@implementing Jenkins' one-at-a-time hash, one at a time :)
this time, in cksum(1)
@
text
@d1 1
a1 1
# $MirOS: src/bin/md5/Makefile,v 1.16 2009/06/29 19:31:15 tg Exp $
d17 2
a18 2
ALGOS=	adler32 cdb md4 md5 oaat rmd160 sfv sha1 sha256 sha384 sha512 \
	size sum suma sysvsum tiger whirlpool
@


1.16
log
@remove *sum symlinks that do not make any sense (cksum, sum, sysvsum)
@
text
@d1 1
a1 1
# $MirOS: src/bin/md5/Makefile,v 1.15 2009/06/29 19:29:50 tg Exp $
d17 1
a17 1
ALGOS=	adler32 cdb md4 md5 rmd160 sfv sha1 sha256 sha384 sha512 \
@


1.15
log
@sync algo list
@
text
@d1 1
a1 1
# $MirOS: src/bin/md5/Makefile,v 1.14 2009/05/17 14:09:25 tg Exp $
d27 2
@


1.14
log
@implement GNU md5sum compatible mode, two-way
• argv[0] = ${algo}sum
• .Fl G

The former accepts (and ignores) either -b or -t (but not both,
due to the rest of the code¹) but rejects -c (not implemented¹)
and -w (unknown) as well as --gnu-long-options.
The latter is more picky but can be called more easily.

① pending rewrite?
@
text
@d1 1
a1 1
# $MirOS: src/bin/md5/Makefile,v 1.13 2009/03/15 15:40:44 tg Exp $
d17 1
a17 1
ALGOS=	adler32 md4 md5 rmd160 sfv sha1 sha256 sha384 sha512 \
@


1.13
log
@make mirmake/debian'able
XXX wonder if the _GNU_SOURCE should be defined unconditionally¹
XXX in mirmake.h since we use e.g. asprintf extensively
XXX ¹) must define it before __GLIBC__ is available...
@
text
@d1 1
a1 1
# $MirOS: src/bin/md5/Makefile,v 1.12 2008/03/09 14:18:58 tg Exp $
d17 11
@


1.12
log
@portability
@
text
@d1 1
a1 1
# $MirOS: src/bin/md5/Makefile,v 1.11 2007/05/07 15:46:23 tg Exp $
d13 2
a14 1
LDADD+=	-L${.SYSMK} -lmirmake
@


1.11
log
@consolidate crc.c, crc.h, md5.c, libz/adler32 into cksum.c
@
text
@d1 1
a1 1
# $MirOS: src/bin/md5/Makefile,v 1.10 2007/05/07 15:21:14 tg Exp $
d12 4
@


1.10
log
@add suma and sfv hashes in the standard format, too
(can't do adler32 that easily for now, later; sum/cksum/sysvsum differ, never)
@
text
@d1 1
a1 1
# $MirOS: src/bin/md5/Makefile,v 1.9 2007/04/29 22:17:45 tg Exp $
d4 1
a4 3
PROG=		cksum
SRCS=		crc.c md5.c

a11 15
.include <bsd.own.mk>

COPTS+=		-Wall -Wconversion -Wmissing-prototypes

.if ${OStype} != "MirBSD"
CPPFLAGS+=	-D_MIRMAKE_DEFNS
LDADD+=		-L${.SYSMK} -lmirmake
DPADD+=		${LIBZ}
LDADD+=		-lz
.else
SMALL=		#defined
KERNBASE?=	${BSDSRCDIR}/kern
.  include "${KERNBASE}/z/Makefile.adler32"
.endif

@


1.9
log
@• use adler stuff from kern lib
• fold rest into crc.[ch]

note:	crc32 here doesn't match the one from zlib, although both
	say they use the same polynomial… weird
@
text
@d1 1
a1 1
# $MirOS: src/bin/md5/Makefile,v 1.8 2006/09/17 19:28:57 tg Exp $
d5 1
a5 6
SRCS=		crc.c md5.c sfv.c suma.c
.if ${MACHINE_ARCH} == "i386"
SRCS+=		suma-x86.S
.else
SRCS+=		suma-mi.c
.endif
@


1.8
log
@add the SFV (from cksfv) and TIGER hashes
@
text
@d1 1
a1 1
# $MirOS: src/bin/md5/Makefile,v 1.7 2006/07/30 23:39:47 tg Exp $
d5 1
a5 1
SRCS=		adler32.c crc.c md5.c sfv.c suma.c
d7 1
a7 2
SRCS+=		ad32-x86.S suma-x86.S
CPPFLAGS+=	-DUSE_ASM
a9 2
DPADD+=		${LIBZ}
LDADD+=		-lz
d21 1
a21 1
COPTS+=	-Wall -Wconversion -Wmissing-prototypes
d26 6
@


1.7
log
@* install as 'cksum' first
* provide mirmake user hints
@
text
@d1 1
a1 1
# $MirOS: src/bin/md5/Makefile,v 1.6 2006/05/26 11:55:15 tg Exp $
d5 1
a5 1
SRCS=		adler32.c crc.c md5.c suma.c
@


1.6
log
@add adler32 (libz-based and my own asm code)
@
text
@d1 1
a1 1
# $MirOS: src/bin/md5/Makefile,v 1.5 2005/10/21 11:02:34 tg Exp $
d4 1
a4 1
PROG=		md5
d16 4
a19 4
LINKS=	${BINDIR}/md5 ${BINDIR}/sha1 \
	${BINDIR}/md5 ${BINDIR}/rmd160 \
	${BINDIR}/md5 ${BINDIR}/cksum \
	${BINDIR}/md5 ${BINDIR}/sum
d26 5
@


1.5
log
@* merge bin and lib completely
* convert some ancient RCSID styles etc. to more modern stuff
* fix use of CDIAGFLAGS+=, CFLAGS+= and COPTS+= to the correct
  variant (include bsd.own.mk _then_ COPTS+=) so they're added
  after any user-specified flags
  (this is probably lurking in more places than I can imagine)
* fix some indenting, comments, etc.
* make stuff compile (fix warnings/errors)
* add script to review _all_ shlib_version after an openbsd import
* remove two more obsolete /usr/lib/debug/ references
* bin/ps: comment out some SMP code
@
text
@d1 1
a1 1
# $MirOS: src/bin/md5/Makefile,v 1.4 2005/04/12 19:50:21 tg Exp $
d4 2
a5 2
PROG=	md5
SRCS=	crc.c md5.c suma.c
d7 2
a8 1
SRCS+=	suma-x86.S
d10 3
a12 1
SRCS+=	suma-mi.c
@


1.4
log
@stub out the SUMA algorithm so this at least
builds on non-x86

XXX which MACHINE and MACHINE_ARCH has Darwin/x86?
XXX MACHINE_ARCH is currently i686, going to change!?
@
text
@d1 2
a2 2
# $MirOS: src/bin/md5/Makefile,v 1.3 2005/03/16 17:19:06 tg Exp $
# $OpenBSD: Makefile,v 1.9 2004/05/04 14:50:45 millert Exp $
d19 3
a21 1
COPTS+=	-ansi -Wall -Wconversion -Wmissing-prototypes
@


1.3
log
@add a traditional CRC algorithm of mine to the pool
looks like message digests in output, very cool ;-)

at the moment, x86-only. Wish C had a carry flag!
@
text
@d1 1
a1 1
# $MirOS: src/bin/md5/Makefile,v 1.2 2005/03/06 18:55:22 tg Exp $
d5 7
a11 1
SRCS=	crc.c md5.c suma.c suma-x86.S
@


1.2
log
@merge src/bin
@
text
@d1 1
a1 1
# $MirOS$
d5 1
a5 1
SRCS=	crc.c md5.c
@


1.1
log
@Initial revision
@
text
@d1 2
a2 1
#	$OpenBSD: Makefile,v 1.9 2004/05/04 14:50:45 millert Exp $
a12 1
CPPFLAGS+= -I${.CURDIR}
@


1.1.1.1
log
@Import the OpenBSD foundation of MirOS BSD
@
text
@@


1.1.1.2
log
@Import almost everything (no ancontrol, ifconfig, pfctl, wicontrol)
of (the undeleted parts of) OpenBSD-current's userland of about 3 hours ago.
Warning: this introduces major breakage!
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.10 2005/05/24 21:57:47 millert Exp $
d13 1
a13 1
COPTS+=	-Wall -Wconversion -Wmissing-prototypes
@

