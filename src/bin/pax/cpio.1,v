head	1.41;
access;
symbols
	paxmirabilis-20190825:1.41
	paxmirabilis-20190224:1.41
	paxmirabilis-20190210:1.41
	npax:1.1.1.7.0.2
	cvs-20181212:1.1.1.7
	paxmirabilis-20171021:1.39
	paxmirabilis-20161104:1.38
	paxmirabilis-20161031:1.38
	paxmirabilis-20161025:1.38
	paxmirabilis-20160306:1.38
	cvs-201603041945:1.1.1.5
	paxmirabilis-20151013:1.36
	paxmirabilis-20140703:1.35
	paxmirabilis-20120606:1.33
	paxmirabilis-20120605:1.33
	cvs-201206051745:1.1.1.4
	paxmirabilis-20120520:1.31
	paxmirabilis-20120216:1.31
	paxmirabilis-20120212:1.30
	cvs-201202112230:1.1.1.4
	paxmirabilis-20110817:1.26
	MIRBSD_10:1.16.0.2
	MIRBSD_10_BASE:1.16
	cvs-200710231945:1.1.1.3
	cvs-200606232242:1.1.1.2
	MIRBSD_9_BASE:1.14
	MIRBSD_8:1.6.0.2
	MIRBSD_8_BASE:1.6
	cvs-200507211800:1.1.1.1
	cvs-200504291700:1.1.1.1
	openbsd:1.1.1;
locks; strict;
comment	@.\" @;


1.41
date	2018.12.25.19.38.10;	author tg;	state Exp;
branches;
next	1.40;
commitid	1005C22871909EC7FE2;

1.40
date	2018.12.12.18.08.42;	author tg;	state Exp;
branches;
next	1.39;
commitid	1005C114EA81986F5EC;

1.39
date	2017.03.29.01.52.30;	author tg;	state Exp;
branches;
next	1.38;
commitid	10058DB13781FFCE83A;

1.38
date	2016.03.06.13.47.11;	author tg;	state Exp;
branches;
next	1.37;
commitid	10056DC34E25F0AA0A6;

1.37
date	2016.02.11.20.12.10;	author tg;	state Exp;
branches;
next	1.36;
commitid	10056BCEAFF41919B5B;

1.36
date	2015.04.12.21.49.37;	author tg;	state Exp;
branches;
next	1.35;
commitid	100552AE886399630F6;

1.35
date	2014.07.03.19.36.25;	author tg;	state Exp;
branches;
next	1.34;
commitid	10053B5B0CA5BBF302E;

1.34
date	2014.07.03.18.57.17;	author tg;	state Exp;
branches;
next	1.33;
commitid	10053B5A7967833D26E;

1.33
date	2012.06.05.19.29.33;	author tg;	state Exp;
branches;
next	1.32;
commitid	1004FCE5E341EA37634;

1.32
date	2012.05.20.20.04.30;	author tg;	state Exp;
branches;
next	1.31;
commitid	1004FB94E665B6D9B12;

1.31
date	2012.02.16.16.01.08;	author tg;	state Exp;
branches;
next	1.30;
commitid	1004F3D28152C6F33B8;

1.30
date	2012.02.12.01.48.20;	author tg;	state Exp;
branches;
next	1.29;
commitid	1004F371A63217504BD;

1.29
date	2012.02.12.00.04.32;	author tg;	state Exp;
branches;
next	1.28;
commitid	1004F37020D48949196;

1.28
date	2012.02.11.23.44.04;	author tg;	state Exp;
branches;
next	1.27;
commitid	1004F36FD511FCFD6D5;

1.27
date	2012.02.11.23.37.52;	author tg;	state Exp;
branches;
next	1.26;
commitid	1004F36FBE0634FBDC9;

1.26
date	2011.08.17.09.03.58;	author tg;	state Exp;
branches;
next	1.25;
commitid	1004E4B8392073278B7;

1.25
date	2011.08.16.21.32.46;	author tg;	state Exp;
branches;
next	1.24;
commitid	1004E4AE1EF00AF3003;

1.24
date	2011.08.16.14.17.23;	author tg;	state Exp;
branches;
next	1.23;
commitid	1004E4A7C0359BB0B3A;

1.23
date	2011.08.16.13.45.00;	author tg;	state Exp;
branches;
next	1.22;
commitid	1004E4A74015B88F988;

1.22
date	2011.08.16.13.27.01;	author tg;	state Exp;
branches;
next	1.21;
commitid	1004E4A702C39E0597C;

1.21
date	2009.11.22.18.23.40;	author tg;	state Exp;
branches;
next	1.20;
commitid	1004B0981B210A68B89;

1.20
date	2009.11.22.15.55.24;	author tg;	state Exp;
branches;
next	1.19;
commitid	1004B095EF92797429F;

1.19
date	2009.10.27.18.47.25;	author tg;	state Exp;
branches;
next	1.18;
commitid	1004AE74055714A6EEB;

1.18
date	2008.11.08.23.03.35;	author tg;	state Exp;
branches;
next	1.17;
commitid	10049161AB22DF5DFC5;

1.17
date	2008.03.14.17.05.06;	author tg;	state Exp;
branches;
next	1.16;
commitid	10047DAB05868FB6D0C;

1.16
date	2007.10.23.20.07.42;	author tg;	state Exp;
branches;
next	1.15;
commitid	100471E5499154FE86E;

1.15
date	2006.07.21.17.34.59;	author tg;	state Exp;
branches;
next	1.14;
commitid	10044C1103610EA28BB;

1.14
date	2006.06.23.23.16.55;	author tg;	state Exp;
branches;
next	1.13;
commitid	100449C767A7700D8A7;

1.13
date	2006.06.23.23.16.42;	author tg;	state Exp;
branches;
next	1.12;
commitid	100449C766B035A1300;

1.12
date	2006.06.23.23.03.56;	author tg;	state Exp;
branches;
next	1.11;
commitid	100449C736877C98FFB;

1.11
date	2006.06.19.20.31.05;	author tg;	state Exp;
branches;
next	1.10;
commitid	100449709733F6F9BF6;

1.10
date	2006.06.19.19.40.55;	author tg;	state Exp;
branches;
next	1.9;
commitid	1004496FDD922F52248;

1.9
date	2006.06.19.19.27.53;	author tg;	state Exp;
branches;
next	1.8;
commitid	1004496FAC317DB21F2;

1.8
date	2006.05.27.20.21.50;	author tg;	state Exp;
branches;
next	1.7;
commitid	1004478B4E97A7BA302;

1.7
date	2006.05.27.20.17.35;	author tg;	state Exp;
branches;
next	1.6;
commitid	1004478B3F06A943674;

1.6
date	2005.12.17.07.12.06;	author tg;	state Exp;
branches;
next	1.5;
commitid	10043A3B7997FC3F459;

1.5
date	2005.11.23.23.27.09;	author tg;	state Exp;
branches;
next	1.4;
commitid	61c84384fa91bd26;

1.4
date	2005.11.18.13.58.47;	author tg;	state Exp;
branches;
next	1.3;
commitid	888437ddd2ba951;

1.3
date	2005.11.16.13.58.38;	author tg;	state Exp;
branches;
next	1.2;
commitid	63cf437b3768eac1;

1.2
date	2005.02.28.20.04.58;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.02.05.17.22.06;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.02.05.17.22.06;	author tg;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2006.06.23.23.00.12;	author tg;	state Exp;
branches;
next	1.1.1.3;
commitid	100449C727D31170AA3;

1.1.1.3
date	2007.10.23.19.50.48;	author tg;	state Exp;
branches;
next	1.1.1.4;
commitid	100471E50A5256C77AE;

1.1.1.4
date	2012.02.11.22.47.21;	author tg;	state Exp;
branches;
next	1.1.1.5;
commitid	1004F36F008225F3522;

1.1.1.5
date	2016.03.04.19.46.09;	author tg;	state Exp;
branches;
next	1.1.1.6;
commitid	10056D9E61429EE6550;

1.1.1.6
date	2016.03.04.20.54.59;	author tg;	state Exp;
branches;
next	1.1.1.7;
commitid	10056D9F62E152ECBA5;

1.1.1.7
date	2018.12.12.00.24.22;	author tg;	state Exp;
branches
	1.1.1.7.2.1;
next	;
commitid	1005C1055452C78F9E4;

1.1.1.7.2.1
date	2018.12.12.06.03.10;	author tg;	state Exp;
branches;
next	1.1.1.7.2.2;
commitid	1005C10A4B12E5998CE;

1.1.1.7.2.2
date	2018.12.12.12.43.12;	author tg;	state Exp;
branches;
next	;
commitid	1005C1102747A3732E3;


desc
@@


1.41
log
@update from contrib/samples/portmdoc,v 1.11
@
text
@.\"	$MirOS: src/bin/pax/cpio.1,v 1.40 2018/12/12 18:08:42 tg Exp $
.\"	$OpenBSD: cpio.1,v 1.35 2014/09/08 01:27:54 schwarze Exp $
.\"
.\" Copyright (c) 2005, 2009, 2011, 2012, 2014, 2015, 2016,
.\"		  2017, 2018
.\"	mirabilos <m@@mirbsd.org>
.\" Copyright (c) 1997 SigmaSoft, Th. Lockert
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
.\" IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
.\" OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
.\" IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
.\" INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
.\" NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
.\" DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
.\" THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
.\" (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
.\" THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
.\"-
.\" Try to make GNU groff and AT&T nroff more compatible
.\" * ` generates ‘ in gnroff, so use \`
.\" * ' generates ’ in gnroff, \' generates ´, so use \*(aq
.\" * - generates ‐ in gnroff, \- generates −, so .tr it to -
.\"   thus use - for hyphens and \- for minus signs and option dashes
.\" * ~ is size-reduced and placed atop in groff, so use \*(TI
.\" * ^ is size-reduced and placed atop in groff, so use \*(ha
.\" * \(en does not work in nroff, so use \*(en
.\" * <>| are problematic, so redefine and use \*(Lt\*(Gt\*(Ba
.\" Also make sure to use \& *before* a punctuation char that is to not
.\" be interpreted as punctuation, and especially with two-letter words
.\" but also (after) a period that does not end a sentence (“e.g.\&”).
.\" The section after the "doc" macropackage has been loaded contains
.\" additional code to convene between the UCB mdoc macropackage (and
.\" its variant as BSD mdoc in groff) and the GNU mdoc macropackage.
.\"
.ie \n(.g \{\
.	if \*[.T]ascii .tr \-\N'45'
.	if \*[.T]latin1 .tr \-\N'45'
.	if \*[.T]utf8 .tr \-\N'45'
.	ds <= \[<=]
.	ds >= \[>=]
.	ds Rq \[rq]
.	ds Lq \[lq]
.	ds sL \(aq
.	ds sR \(aq
.	if \*[.T]utf8 .ds sL `
.	if \*[.T]ps .ds sL `
.	if \*[.T]utf8 .ds sR '
.	if \*[.T]ps .ds sR '
.	ds aq \(aq
.	ds TI \(ti
.	ds ha \(ha
.	ds en \(en
.\}
.el \{\
.	ds aq '
.	ds TI ~
.	ds ha ^
.	ds en \(em
.\}
.\"
.\" Implement .Dd with the Mdocdate RCS keyword
.\"
.rn Dd xD
.de Dd
.ie \\$1$Mdocdate: \{\
.	xD \\$2 \\$3, \\$4
.\}
.el .xD \\$1 \\$2 \\$3 \\$4 \\$5 \\$6 \\$7 \\$8
..
.\"
.\" .Dd must come before definition of .Mx, because when called
.\" with -mandoc, it might implement .Mx itself, but we want to
.\" use our own definition. And .Dd must come *first*, always.
.\"
.Dd $Mdocdate: December 25 2018 $
.\"
.\" Check which macro package we use, and do other -mdoc setup.
.\"
.ie \n(.g \{\
.	if \*[.T]utf8 .tr \[la]\*(Lt
.	if \*[.T]utf8 .tr \[ra]\*(Gt
.	ie d volume-ds-1 .ds tT gnu
.	el .ie d doc-volume-ds-1 .ds tT gnp
.	el .ds tT bsd
.\}
.el .ds tT ucb
.\"
.\" Implement .Mx (MirBSD)
.\"
.ie "\*(tT"gnu" \{\
.	eo
.	de Mx
.	nr curr-font \n[.f]
.	nr curr-size \n[.ps]
.	ds str-Mx \f[\n[curr-font]]\s[\n[curr-size]u]
.	ds str-Mx1 \*[Tn-font-size]\%MirBSD\*[str-Mx]
.	if !\n[arg-limit] \
.	if \n[.$] \{\
.	ds macro-name Mx
.	parse-args \$@@
.	\}
.	if (\n[arg-limit] > \n[arg-ptr]) \{\
.	nr arg-ptr +1
.	ie (\n[type\n[arg-ptr]] == 2) \
.	as str-Mx1 \~\*[arg\n[arg-ptr]]
.	el \
.	nr arg-ptr -1
.	\}
.	ds arg\n[arg-ptr] "\*[str-Mx1]
.	nr type\n[arg-ptr] 2
.	ds space\n[arg-ptr] "\*[space]
.	nr num-args (\n[arg-limit] - \n[arg-ptr])
.	nr arg-limit \n[arg-ptr]
.	if \n[num-args] \
.	parse-space-vector
.	print-recursive
..
.	ec
.	ds sP \s0
.	ds tN \*[Tn-font-size]
.\}
.el .ie "\*(tT"gnp" \{\
.	eo
.	de Mx
.	nr doc-curr-font \n[.f]
.	nr doc-curr-size \n[.ps]
.	ds doc-str-Mx \f[\n[doc-curr-font]]\s[\n[doc-curr-size]u]
.	ds doc-str-Mx1 \*[doc-Tn-font-size]\%MirBSD\*[doc-str-Mx]
.	if !\n[doc-arg-limit] \
.	if \n[.$] \{\
.	ds doc-macro-name Mx
.	doc-parse-args \$@@
.	\}
.	if (\n[doc-arg-limit] > \n[doc-arg-ptr]) \{\
.	nr doc-arg-ptr +1
.	ie (\n[doc-type\n[doc-arg-ptr]] == 2) \
.	as doc-str-Mx1 \~\*[doc-arg\n[doc-arg-ptr]]
.	el \
.	nr doc-arg-ptr -1
.	\}
.	ds doc-arg\n[doc-arg-ptr] "\*[doc-str-Mx1]
.	nr doc-type\n[doc-arg-ptr] 2
.	ds doc-space\n[doc-arg-ptr] "\*[doc-space]
.	nr doc-num-args (\n[doc-arg-limit] - \n[doc-arg-ptr])
.	nr doc-arg-limit \n[doc-arg-ptr]
.	if \n[doc-num-args] \
.	doc-parse-space-vector
.	doc-print-recursive
..
.	ec
.	ds sP \s0
.	ds tN \*[doc-Tn-font-size]
.\}
.el \{\
.	de Mx
.	nr cF \\n(.f
.	nr cZ \\n(.s
.	ds aa \&\f\\n(cF\s\\n(cZ
.	if \\n(aC==0 \{\
.		ie \\n(.$==0 \&MirBSD\\*(aa
.		el .aV \\$1 \\$2 \\$3 \\$4 \\$5 \\$6 \\$7 \\$8 \\$9
.	\}
.	if \\n(aC>\\n(aP \{\
.		nr aP \\n(aP+1
.		ie \\n(C\\n(aP==2 \{\
.			as b1 \&MirBSD\ #\&\\*(A\\n(aP\\*(aa
.			ie \\n(aC>\\n(aP \{\
.				nr aP \\n(aP+1
.				nR
.			\}
.			el .aZ
.		\}
.		el \{\
.			as b1 \&MirBSD\\*(aa
.			nR
.		\}
.	\}
..
.\}
.\"-
.ie \ng==1 \{\
.	ds nc mircpio
.	ds np mirpax
.	ds nt mirtar
.	ds nm mircpio
.	Dt MIRCPIO 1
.\}
.el .ie \ng==2 \{\
.	ds nc paxcpio
.	ds np pax
.	ds nt paxtar
.	ds nm paxcpio
.	Dt PAXCPIO 1
.\}
.el \{\
.	ds nc cpio
.	ds np pax
.	ds nt tar
.	ds nm cpio
.	Dt CPIO 1
.\}
.\"-
.Os MirBSD
.Sh NAME
.ie \ng==1 \{\
.Nm mircpio
.Nd copy file archives in and out
.\}
.el .ie \ng==2 \{\
.Nm paxcpio
.Nd copy file archives in and out
.\}
.el \{\
.Nm cpio
.Nd copy file archives in and out
.\}
.Sh SYNOPSIS
.Bk -words
.Nm \*(nm
.Fl o
.Op Fl 0AaBcJjLVvZz
.Op Fl C Ar bytes
.Op Fl F Ar archive
.Op Fl H Ar format
.Op Fl M Ar flag
.Op Fl O Ar archive
.No \*(Lt Ar name-list
.Op \*(Gt Ar archive
.Nm \*(nm
.Fl i
.Op Fl 06BbcdfJjmrSstuVvZz
.Op Fl C Ar bytes
.Op Fl E Ar file
.Op Fl F Ar archive
.Op Fl H Ar format
.Op Fl I Ar archive
.Op Fl M Ar flag
.Op Ar pattern ...
.Op \*(Lt Ar archive
.Nm \*(nm
.Fl p
.Op Fl 0adLlmuVv
.Ar destination-directory
.No \*(Lt Ar name-list
.Ek
.Sh DESCRIPTION
The
.Nm
command copies files to and from a
.Nm cpio
archive.
.Pp
The options are as follows:
.Bl -tag -width Ds
.It Fl 0
Use the NUL
.Pq Ql \e0
character as a pathname terminator, instead of newline
.Pq Ql \en .
This applies only to the pathnames read from standard input in
the write and copy modes,
and to the pathnames written to standard output in list mode.
This option is expected to be used in concert with the
.Fl print0
function in
.Xr find 1 ,
the
.Fl d Ar \*(aq\*(aq
option to the
.Ic read
built-in utility of
.Xr mksh 1
or the
.Fl 0
flag in
.Xr xargs 1 .
.It Fl o
Create an archive.
Reads the list of files to store in the
archive from standard input, and writes the archive on standard
output.
.Bl -tag -width Ds
.It Fl A
Append to the specified archive.
.It Fl a
Reset the access times on files that have been copied to the
archive.
.It Fl B
Set block size of output to 5120 bytes.
.It Fl C Ar bytes
Set the block size of output to
.Ar bytes .
.It Fl c
Use ASCII format for
.Nm cpio
header for portability.
.It Fl F Ar archive
Use the specified file as the input for the archive.
.It Fl H Ar format
Write the archive in the specified format.
Recognised formats are:
.Pp
.Bl -tag -width sv4cpio -compact
.It Ar ar
Unix Archiver.
.It Ar bcpio
Old binary
.Nm cpio
format.
Selected by
.Fl 6 .
.It Ar cpio
Old octal character
.Nm cpio
format.
Selected by
.Fl c .
.It Ar sv4cpio
SVR4 hex
.Nm cpio
format.
.It Ar sv4crc
SVR4 hex
.Nm cpio
format with checksums.
This is the default format for creating new archives.
.It Ar tar
Old tar format.
.It Ar ustar
POSIX ustar format.
.It "\ "
.It Ar bin
These four formats...\&
.It Ar crc
\&...are supported...\&
.It Ar newc
\&...for backwards...\&
.It Ar odc
\&...compatibility only.
.El
.It Fl J
Use the xz utility to compress the archive.
.It Fl j
Use the bzip2 utility to compress the archive.
.It Fl L
Follow symbolic links.
.It Fl M Ar flag
Configure the archive normaliser.
.Ar flag
is either a numeric value compatible to
.Xr strtonum 3
which is directly stored in the flags word, or
one of the following values, optionally prefixed with
.Dq no\-
to turn them off:
.Pp
.Bl -tag -width xxxxxx -compact
.It Ar inodes
0x0001: Serialise inodes, zero device info.
.br
(cpio, sv4cpio, sv4crc)
.It Ar links
0x0002: Store content of hard links only once.
.br
(cpio, sv4cpio, sv4crc)
.It Ar mtime
0x0004: Zero out the file modification time.
.br
(ar, cpio, sv4cpio, sv4crc, ustar)
.It Ar uidgid
0x0008: Set owner to 0:0
.Pq Li root Ns : Ns Li wheel .
.br
(ar, cpio, sv4cpio, sv4crc, ustar)
.It Ar verb
0x0010: Debug this option.
.It Ar debug
0x0020: Debug file header storage.
.It Ar lncp
0x0040: Extract hard links by copy if link fails.
.It Ar numid
0x0080: Use only numeric uid and gid values.
.br
(ustar)
.It Ar gslash
0x0100: Append a slash after directory names.
.br
(ustar)
.It Ar set
0x0003: Keep ownership and mtime intact.
.It Ar dist
0x008B: Clean everything except mtime.
.It Ar norm
0x008F: Clean everything.
.It Ar root
0x0089: Clean owner and device information.
.El
.Pp
When creating an archive and verbosely listing output, these
normalisation operations are not reflected in the output,
because they are made only after the output has been shown.
.Pp
This option is only implemented for the ar, cpio, sv4cpio,
sv4crc, and ustar file format writing routines.
.It Fl O Ar archive
Use the specified file name as the archive to write to.
.It Fl V
Print a dot
.Pq Sq \&.
for each file written to the archive.
.It Fl v
Be verbose about operations.
List filenames as they are written to the archive.
.It Fl Z
Use the
.Xr compress 1
utility to compress the archive.
.It Fl z
Use the
.Xr gzip 1
utility to compress the archive.
.El
.It Fl i
Restore files from an archive.
Reads the archive file from
standard input and extracts files matching the
.Ar patterns
that were specified on the command line.
.Bl -tag -width Ds
.It Fl 6
Process old-style
.Nm cpio
format archives.
.It Fl B
Set the block size of the archive being read to 5120 bytes.
.It Fl b
Do byte and word swapping after reading in data from the
archive, for restoring archives created on systems with
a different byte order.
.It Fl C Ar bytes
Read archive written with a block size of
.Ar bytes .
.It Fl c
Expect the archive headers to be in ASCII format.
.It Fl d
Create any intermediate directories as needed during
restore.
.It Fl E Ar file
Read list of file name patterns to extract or list from
.Ar file .
.It Fl F Ar archive , Fl I Ar archive
Use the specified file as the input for the archive.
.It Fl f
Restore all files except those matching the
.Ar patterns
given on the command line.
.It Fl H Ar format
Read an archive of the specified format.
Recognised formats are:
.Pp
.Bl -tag -width sv4cpio -compact
.It Ar ar
Unix Archiver.
.It Ar bcpio
Old binary
.Nm cpio
format.
.It Ar cpio
Old octal character
.Nm cpio
format.
.It Ar sv4cpio
SVR4 hex
.Nm cpio
format.
.It Ar sv4crc
SVR4 hex
.Nm cpio
format with checksums.
.It Ar tar
Old tar format.
.It Ar ustar
POSIX ustar format.
.It "\ "
.It Ar bin
These four formats...\&
.It Ar crc
\&...are supported...\&
.It Ar newc
\&...for backwards...\&
.It Ar odc
\&...compatibility only.
.El
.It Fl J
Use the xz utility to decompress the archive.
.It Fl j
Use the bzip2 utility to decompress the archive.
.It Fl m
Restore modification times on files.
.It Fl r
Rename restored files interactively.
.It Fl S
Swap words after reading data from the archive.
.It Fl s
Swap bytes after reading data from the archive.
.It Fl t
Only list the contents of the archive, no files or
directories will be created.
.It Fl u
Overwrite files even when the file in the archive is
older than the one that will be overwritten.
.It Fl V
Print a dot
.Pq Sq \&.
for each file read from the archive.
.It Fl v
Be verbose about operations.
List filenames as they are copied in from the archive.
.It Fl Z
Use the
.Xr compress 1
utility to decompress the archive.
.It Fl z
Use the
.Xr gzip 1
utility to decompress the archive.
.El
.It Fl p
Copy files from one location to another in a single pass.
The list of files to copy are read from standard input and
written out to a directory relative to the specified
.Ar directory
argument.
.Bl -tag -width Ds
.It Fl a
Reset the access times on files that have been copied.
.It Fl d
Create any intermediate directories as needed to write
the files at the new location.
.It Fl L
Follow symbolic links.
.It Fl l
When possible, link files rather than creating an
extra copy.
.It Fl m
Restore modification times on files.
.It Fl u
Overwrite files even when the original file being copied is
older than the one that will be overwritten.
.It Fl V
Print a dot
.Pq Sq \&.
for each file copied.
.It Fl v
Be verbose about operations.
List filenames as they are copied.
.El
.El
.Sh ENVIRONMENT
.Bl -tag -width Fl
.It Ev TMPDIR
Path in which to store temporary files.
.El
.Sh EXIT STATUS
The
.Nm
utility exits with one of the following values:
.Pp
.Bl -tag -width Ds -offset indent -compact
.It 0
All files were processed successfully.
.It 1
An error occurred.
.El
.Sh DIAGNOSTICS
Whenever
.Nm
cannot create a file or a link when extracting an archive or cannot
find a file while writing an archive, or cannot preserve the user
ID, group ID, file mode, or access and modification times when the
.Fl p
option is specified, a diagnostic message is written to standard
error and a non-zero exit value will be returned, but processing
will continue.
In the case where
.Nm
cannot create a link to a file,
unless
.Fl M Ar lncp
is given,
.Nm
will not create a second copy of the file.
.Pp
If the extraction of a file from an archive is prematurely terminated
by a signal or error,
.Nm
may have only partially extracted the file the user wanted.
Additionally, the file modes of extracted files and directories may
have incorrect file bits, and the modification and access times may
be wrong.
.Pp
If the creation of an archive is prematurely terminated by a signal
or error,
.Nm
may have only partially created the archive, which may violate the
specific archive format specification.
.Sh SEE ALSO
.Xr ar 1 ,
.if \ng==1 \{\
.Xr cpio 1 ,
.Xr deb 5 ,
.Xr mirpax 1 ,
.Xr mirtar 1 ,
.\}
.ie \ng==2 \{\
.Xr cpio 1 ,
.Xr deb 5 ,
.Xr pax 1 ,
.Xr paxtar 1 ,
.\}
.el \{\
.Xr pax 1 ,
.\}
.Xr tar 1
.Sh AUTHORS
.An -nosplit
.An Keith Muller
at the University of California, San Diego.
.Mx
extensions by
.An mirabilos Aq m@@mirbsd.org .
.Sh CAVEATS
Different file formats have different maximum file sizes.
It is recommended that a format such as cpio or ustar
be used for larger files.
.Bl -column "File format" "Maximum file size" -offset indent
.It Sy "File format" Ta Sy "Maximum file size"
.It ar Ta "10 Gigabytes \- 1 Byte"
.It bcpio Ta "4 Gibibytes"
.It sv4cpio Ta "4 Gibibytes"
.It sv4crc Ta "4 Gibibytes"
.It cpio Ta "8 Gibibytes"
.It tar Ta "8 Gibibytes"
.It ustar Ta "8 Gibibytes"
.El
.Pp
The backwards-compatible format options are not available in the
.Xr \*(np 1
front-end.
.Pp
The
.Fl M
option is a MirBSD extension, available starting with
.Mx 8 .
Archives written using these options are, however, compatible to
the standard and should be readable on any other system.
The only option whose behaviour is not explicitly allowed by the
standard is hard link unification (write file contens only once)
selected by
.Fl M Ar 0x0002 .
.Pp
The
.Fl V
option is a GNU extension, available starting with
.Mx 11 .
.Pp
The
.Ar ar
file format matches APT repositories and the BSD
.Xr ar 1
specification, not GNU binutils (which can however read them) or SYSV systems.
.Sh BUGS
The
.Fl s
and
.Fl S
options are currently not implemented.
.Pp
The
.Ar pax
file format is not yet supported.
@


1.40
log
@merge the npax branch into MAIN

asides from a missing dprintf and portability, this ought to be
good enough for people (well me) to play with for now
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.35 2014/07/03 19:36:25 tg Exp $
d86 1
a86 1
.Dd $Mdocdate: July 3 2014 $
d94 1
d107 1
a107 1
.	ds str-Mx1 \*[Tn-font-size]\%MirOS\*[str-Mx]
d133 32
d171 1
a171 1
.		ie \\n(.$==0 \&MirOS\\*(aa
d177 1
a177 1
.			as b1 \&MirOS\ #\&\\*(A\\n(aP\\*(aa
d185 1
a185 1
.			as b1 \&MirOS\\*(aa
@


1.39
log
@layout fix
@
text
@d2 1
a2 1
.\"	$OpenBSD: cpio.1,v 1.34 2011/09/03 22:59:08 jmc Exp $
d4 2
a5 1
.\" Copyright (c) 2005, 2009, 2011, 2012, 2014, 2015, 2016, 2017
d196 1
d223 1
d244 7
a250 1
.Xr find 1
d311 1
a311 1
These four formats...
d313 1
a313 1
\&...are supported...
d315 1
a315 1
\&...for backwards...
d349 2
a350 1
0x0008: Set owner to 0:0 (root:wheel).
d464 1
a464 1
These four formats...
d466 1
a466 1
\&...are supported...
d468 1
a468 1
\&...for backwards...
d619 1
@


1.38
log
@apply changes from mpax-erstmalnurderbackport branch not related to the CVEs
@
text
@d4 1
a4 1
.\" Copyright (c) 2005, 2009, 2011, 2012, 2014, 2015, 2016
d594 1
@


1.37
log
@merge most recent portmdoc into a̲l̲l̲ of its users; fixup .\& into \&. like
in mksh(1), for Schillix ditroff
@
text
@d594 2
a595 2
Keith Muller at the University of California, San Diego.
.Pp
d598 1
a598 1
.An Thorsten Glaser Aq tg@@mirbsd.org .
@


1.36
log
@-0 is a global option
@
text
@d4 2
a5 2
.\" Copyright (c) 2005, 2009, 2011, 2012, 2014, 2015
.\"	Thorsten Glaser <tg@@mirbsd.org>
d38 3
a40 1
.\" Also make sure to use \& especially with two-letter words.
d377 1
a377 1
.Pq Sq .\&
d482 1
a482 1
.Pq Sq .\&
d520 1
a520 1
.Pq Sq .\&
@


1.35
log
@add -0 option to cpio to mirror pax
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.33 2012/06/05 19:29:33 tg Exp $
d4 1
a4 1
.\" Copyright (c) 2005, 2009, 2011, 2012, 2014
d83 1
a83 1
.Dd $Mdocdate: June 5 2012 $
d228 16
a395 16
.It Fl 0
Use the NUL
.Pq Ql \e0
character as a pathname terminator, instead of newline
.Pq Ql \en .
This applies only to the pathnames read from standard input in
the write and copy modes,
and to the pathnames written to standard output in list mode.
This option is expected to be used in concert with the
.Fl print0
function in
.Xr find 1
or the
.Fl 0
flag in
.Xr xargs 1 .
@


1.34
log
@document why 'tar -M dist -cvvf - foo' does not show 0:0 owner etc.
@
text
@d195 1
a195 1
.Op Fl AaBcJjLVvZz
d205 1
a205 1
.Op Fl 6BbcdfJjmrSstuVvZz
d216 1
a216 1
.Op Fl adLlmuVv
d380 16
@


1.33
log
@mention nōn-support (TOOD) of pax file format
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.32 2012/05/20 20:04:30 tg Exp $
d4 1
a4 1
.\" Copyright (c) 2005, 2009, 2011, 2012
d83 1
a83 1
.Dd $Mdocdate: May 20 2012 $
d349 4
@


1.32
log
@update portmdoc; re-check its rules
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.31 2012/02/16 16:01:08 tg Exp $
d83 1
a83 1
.Dd $Mdocdate: March 15 2010 $
d622 4
@


1.31
log
@implement the GNU cpio option -V (print a dot per file processed)
sponsored by tarent solutions GmbH for work on evolvis (FusionForge)
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.30 2012/02/12 01:48:20 tg Exp $
d37 2
d83 1
a83 1
.Dd $Mdocdate: February 12 2012 $
d85 1
a85 1
.\" Check which macro package we use
d88 2
@


1.30
log
@-rg2: paxcpio / pax / paxtar (new)
-rg1: mircpio / mirpax / mirtar (old)
-rg0: cpio / pax / tar (default)
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.29 2012/02/12 00:04:32 tg Exp $
d191 1
a191 1
.Op Fl AaBcJjLvZz
d201 1
a201 1
.Op Fl 6BbcdfJjmrSstuvZz
d212 1
a212 1
.Op Fl adLlmuv
d349 4
d454 4
d492 4
d593 1
a593 1
option is a MirBSD extensions, available starting with
d603 5
@


1.29
log
@slowmerge options.c; sort getopt/getoldopt arguments AGAIN, finally
merge usage changes from obsd; add xz support
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.28 2012/02/11 23:44:04 tg Exp $
d81 1
a81 1
.Dd $Mdocdate: February 11 2012 $
d159 7
d180 4
d545 7
d553 1
@


1.28
log
@the -M flag can be used during extraction, too (think lncp)
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.27 2012/02/11 23:37:52 tg Exp $
d180 1
a180 1
.Op Fl AaBcjLvZz
d190 1
a190 1
.Op Fl 6BbcdfjmrSstuvZz
d277 2
d421 2
@


1.27
log
@slowmerge, fix and extend the manual pages
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.26 2011/08/17 09:03:58 tg Exp $
d81 1
a81 1
.Dd $Mdocdate: August 17 2011 $
d196 1
@


1.26
log
@Debian idiotically uses something called lexgrog(1) to parse manpages
for whatis information which fails even worse than mdocml(1)…
@
text
@d1 2
a2 2
.\"	$MirOS: src/bin/pax/cpio.1,v 1.25 2011/08/16 21:32:46 tg Exp $
.\"	$OpenBSD: cpio.1,v 1.26 2007/05/31 19:19:15 jmc Exp $
d4 1
a4 1
.\" Copyright (c) 2005, 2009, 2011
d81 1
a81 1
.Dd $Mdocdate: August 16 2011 $
d180 1
a180 1
.Op Fl AaBcLvZz
d186 2
a187 2
.Ar \*(Lt name-list
.Op Ar \*(Gt archive
d190 1
a190 1
.Op Fl 6BbcdfmrSstuvZz
d197 1
a197 1
.Op Ar \*(Lt archive
d202 1
a202 1
.Ar \*(Lt name-list
d230 1
a230 1
.Nm
d243 1
a243 1
.Nm
d249 1
a249 1
.Nm
d255 1
a255 1
.Nm
d259 1
a259 1
.Nm
d268 1
a268 1
These
d270 1
a270 1
four
d272 1
a272 1
formats
d274 1
a274 1
are supported for backwards compatibility only.
d276 2
d339 1
a339 1
Compress archive using
d341 1
a341 1
format.
d343 1
a343 1
Compress archive using
d345 1
a345 1
format.
d356 1
a356 1
.Nm
d390 1
a390 1
.Nm
d394 1
a394 1
.Nm
d398 1
a398 1
.Nm
d402 1
a402 1
.Nm
d410 1
a410 1
These
d412 1
a412 1
four
d414 1
a414 1
formats
d416 1
a416 1
are supported for backwards compatibility only.
d418 2
d438 1
a438 1
Uncompress archive using
d440 1
a440 1
format.
d442 1
a442 1
Uncompress archive using
d444 1
a444 1
format.
d478 2
a479 1
.Sh ERRORS
d481 3
a483 2
will exit with one of the following values:
.Bl -tag -width 2n
d489 1
a489 1
.Pp
d533 4
d541 1
a541 2
.Pp
.Bl -column "File format" "Maximum file size" -offset indent -compact
d543 6
a548 6
.It ar Ta 10 Gigabytes \- 1 Byte
.It bcpio Ta 4 Gibibytes
.It sv4cpio Ta 4 Gibibytes
.It cpio Ta 8 Gibibytes
.It tar Ta 8 Gibibytes
.It ustar Ta 8 Gibibytes
d570 1
a570 1
specification, not GNU binutils or SYSV systems.
@


1.25
log
@backend for Unix Archiver libraries – ar(5) and deb(5) format files
(since GNU binutils on ELF systems thinks SYSV style ar is used…)
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.24 2011/08/16 14:17:23 tg Exp $
d169 6
a174 1
.Nm \*(nm
d176 1
@


1.24
log
@with -rg1 the manpages are now mir’d
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.23 2011/08/16 13:45:00 tg Exp $
d4 2
a5 1
.\" Copyright (c) 2005, 2009 Thorsten Glaser <tg@@mirbsd.org>
d233 2
d278 1
a278 1
one of the following values, prefixed with
d280 1
a280 1
to turn them off, or not, to turn them on:
d285 2
d289 2
d293 2
d297 2
a298 8
.It Ar dist
0x008B: Clean everything except mtime.
.It Ar set
0x0003: Keep ownership and mtime intact.
.It Ar norm
0x008F: Clean everything.
.It Ar root
0x0089: Clean owner and device information.
d304 1
a304 1
0x0040: Extract hard links by copying if linking fails.
d307 2
d311 10
d323 1
a323 1
This option is only implemented for the cpio, sv4cpio,
a324 10
For the ustar format, the
.Ar inodes
and
.Ar links
specifiers are ignored.
For all formats except ustar, the
.Ar numid
and
.Ar gslash
specifiers are ignored.
d378 2
d510 1
d513 1
d528 1
d535 1
a535 7
.Sh BUGS
The
.Fl s
and
.Fl S
options are currently not implemented.
.Sh CAVEATS
d550 12
@


1.23
log
@… aaaand the even longer awaited functionality to append a slash to a
directory’s name upon ustar creation (like gtar)
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.22 2011/08/16 13:27:01 tg Exp $
d151 15
a165 1
.Dt CPIO 1
d168 1
a168 1
.Nm cpio
d171 1
a171 1
.Nm cpio
d181 1
a181 1
.Nm cpio
d191 1
a191 1
.Nm cpio
d200 1
a200 1
.Nm
d503 5
d533 1
a533 1
.Xr pax 1
@


1.22
log
@implement the long-awaited option to skip writing the ASCII uid/gid
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.21 2009/11/22 18:23:40 tg Exp $
d80 1
a80 1
.Dd $Mdocdate: November 22 2009 $
d290 2
d303 3
a305 1
specifier is ignored.
@


1.21
log
@fix more manpages
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.20 2009/11/22 15:55:24 tg Exp $
d275 1
a275 1
0x000B: Clean everything except mtime.
d279 1
a279 1
0x000F: Clean everything.
d281 1
a281 1
0x0009: Clean owner and device information.
d288 2
d299 3
@


1.20
log
@update to contrib/samples/portmdoc,v 1.6
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.19 2009/10/27 18:47:25 tg Exp $
d80 1
a80 1
.Dd $Mdocdate: November 17 2009 $
d262 1
a262 1
.Dq no-
@


1.19
log
@new option “-M lncp”, see TFM for details
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.18 2008/11/08 23:03:35 tg Exp $
d4 1
a4 1
.\" Copyright (c) 2005 Thorsten Glaser <tg@@mirbsd.org>
a26 3
.\"
.\"	$OpenBSD: cpio.1,v 1.26 2007/05/31 19:19:15 jmc Exp $
.\"
d29 3
a31 3
.\" * ` generates ‘ in groff, so use \`
.\" * ' generates ’ in groff, \' generates ´, so use \*(aq
.\" * - generates ‐ in groff, \- generates −, fixed in tmac/mdoc/doc-groff
d36 4
d41 13
d67 1
d79 10
a88 1
.Dd $Mdocdate: November 8 2008 $
d91 32
a122 7
.de Mx
.nr cF \\n(.f
.nr cZ \\n(.s
.ds aa \&\f\\n(cF\s\\n(cZ
.if \\n(aC==0 \{\
.	ie \\n(.$==0 \&MirOS\\*(aa
.	el .aV \\$1 \\$2 \\$3 \\$4 \\$5 \\$6 \\$7 \\$8 \\$9
d124 21
a144 6
.if \\n(aC>\\n(aP \{\
.	nr aP \\n(aP+1
.	ie \\n(C\\n(aP==2 \{\
.		as b1 \&MirOS\ #\&\\*(A\\n(aP\\*(aa
.		ie \\n(aC>\\n(aP \{\
.			nr aP \\n(aP+1
a146 5
.		el .aZ
.	\}
.	el \{\
.		as b1 \&MirOS\\*(aa
.		nR
d148 1
d150 1
a150 1
..
@


1.18
log
@more mass conversions, including ancient eMail addresses
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.17 2008/03/14 17:05:06 tg Exp $
d64 1
a64 1
.Dd $Mdocdate: March 14 2008 $
d226 2
d400 3
@


1.17
log
@switch to portmdoc
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.16 2007/10/23 20:07:42 tg Exp $
d4 1
a4 1
.\" Copyright (c) 2005 Thorsten Glaser <tg@@66h.42h.de>
@


1.16
log
@merge openbsd changes and fix tar -R, -S flag misdocumentation
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.15 2006/07/21 17:34:59 tg Exp $
d30 37
a66 4
.Dd October 23, 2007
.Dt CPIO 1
.Os MirBSD
.\" for portability
d91 2
@


1.15
log
@* add -M option to pax
* sync manpages
* don't document deprecated format names in pax(1) any more
* add .de Mx for portability
* improve -M verb to show archive fmt
@
text
@d1 2
a2 2
.\"	$MirOS: src/bin/pax/cpio.1,v 1.14 2006/06/23 23:16:55 tg Exp $
.\"	$OpenBSD: cpio.1,v 1.23 2006/01/03 17:22:47 jmc Exp $
d28 3
a30 1
.Dd July 21, 2006
d64 1
a64 1
.Op Fl aABcLvzZ
d70 2
a71 2
.Ar "< name-list"
.Op Ar "> archive"
d74 1
a74 1
.Op Fl bBcdfmrsStuvzZ6
d80 2
a81 2
.Op Ar "pattern ..."
.Op Ar "< archive"
d84 1
a84 1
.Op Fl adlLmuv
d86 1
a86 1
.Ar "< name-list"
d102 2
a106 2
.It Fl A
Append to the specified archive.
d109 3
a115 3
.It Fl C Ar bytes
Set the block size of output to
.Ar bytes .
d117 1
a117 2
.It Fl O Ar archive
Use the specified file name as the archive to write to.
d200 2
d205 4
a212 4
.It Fl Z
Compress archive using
.Xr compress 1
format.
d221 6
a230 4
.It Fl B
Set the block size of the archive being read to 5120 bytes.
.It Fl c
Expect the archive headers to be in ASCII format.
d234 2
d242 2
a247 3
.It Fl F Ar archive
.It Fl I Ar archive
Use the specified file as the input for the archive.
d287 2
a290 2
.It Fl S
Swap words after reading data from the archive.
d300 4
a307 8
.It Fl Z
Uncompress archive using
.Xr compress 1
format.
.It Fl 6
Process old-style
.Nm
format archives.
d321 2
a325 2
.It Fl L
Follow symbolic links.
@


1.14
log
@oops, bump date
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.13 2006/06/23 23:16:42 tg Exp $
d28 1
a28 1
.Dd June 24, 2006
d30 26
a55 1
.Os
d193 1
a193 1
ustar, and sv4crc file format writing routines.
d408 1
a408 1
option is a MirOS extensions, available starting with
@


1.13
log
@use SI binary units, damnit!
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.12 2006/06/23 23:03:56 tg Exp $
d28 1
a28 1
.Dd June 19, 2006
@


1.12
log
@merge the OpenBSD import (bugfix)
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.11 2006/06/19 20:31:05 tg Exp $
d364 5
a368 5
.It bcpio Ta 4 Gigabytes
.It sv4cpio Ta 4 Gigabytes
.It cpio Ta 8 Gigabytes
.It tar Ta 8 Gigabytes
.It ustar Ta 8 Gigabytes
@


1.11
log
@* fix -M option processing in tar(1)
* support ustar (in cpio(1) and tar(1)) with -M uidgid and -M mtime,
  as well as the -M debug and -M verb options
@
text
@d1 2
a2 2
.\"	$MirOS: src/bin/pax/cpio.1,v 1.10 2006/06/19 19:40:55 tg Exp $
.\"	$OpenBSD: cpio.1,v 1.20 2003/11/21 20:54:02 jmc Exp $
d357 13
@


1.10
log
@bring the -M option to tar(1)
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.9 2006/06/19 19:27:53 tg Exp $
d168 6
a173 1
and sv4crc file format writing routines.
@


1.9
log
@don't advertise the non-standard formats any more,
people better use -M flag.
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.8 2006/05/27 20:21:50 tg Exp $
d167 2
a168 4
This option currently is only useful in connection with
the cpio, sv4cpio and sv4crc file formats.
The bcpio, tar and ustar format write routines do not yet implement
normalisation, and probably never will to the full extent.
@


1.8
log
@* keep track of 80c to have nicer looking output
* american -> english  while here
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.7 2006/05/27 20:17:35 tg Exp $
d28 1
a28 1
.Dd February 16, 1997
a108 6
.It Ar dist
Same as
.Ar cpio ,
except that UID/GID are set to zero and
inodes and device major/minor are anonymised.
Hardlinks are stored only once.
a121 8
.It Ar v4norm
Same as
.Ar sv4crc ;
UID/GID and mtime set to zero; inodes and device major/minor anonymised.
.It Ar v4root
Same as
.Ar sv4crc ;
UID/GID set to zero; inodes anonymised.
d146 1
a146 1
0x0001: Serialide inodes, zero device info.
d154 3
a156 1
0x000B: Mirror the dist format.
d158 1
a158 1
0x000F: Mirror the v4norm format.
d160 1
a160 3
0x0009: Mirror the v4root format.
.It Ar set
0x0003: Use inode and hard link manipulation.
d365 1
a365 1
The dist, v4norm and v4root formats, as well as the
d367 1
a367 1
option, are MirOS extensions, available starting with
d372 3
a374 1
standard is hard link unification (write file contens only once).
@


1.7
log
@clarify default output format
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.6 2005/12/17 07:12:06 tg Exp $
d94 1
a94 1
Recognized formats are:
d101 2
a102 3
Selected by the
.Fl 6
option.
d107 2
a108 3
Selected by the
.Fl c
option.
d123 1
a123 1
This is the default format.
d230 1
a230 1
Recognized formats are:
@


1.6
log
@Once upon a time, we had two new formats.
Then, a third one.

Now, we've got the -M option with which you can set all these
anonymisation, normalisation etc. options bitwise.
We also have two new bits:
 - verbose, which tells you what anon options are used
 - debug, which traces files as their headers are stored

That all of course documented in the manual page.
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.5 2005/11/23 23:27:09 tg Exp $
d101 3
d108 3
d125 1
@


1.5
log
@* cpio.1, pax.1: document new format "dist"
* cpio.c: implement new format "dist"
* cpio.c: trailer doesn't need an inode in any case
* cpio.h: sync comments between CPIO and VCPIO structs
* extern.h, options.c: add glue for new format "dist"
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.4 2005/11/18 13:58:47 tg Exp $
d41 1
d143 37
d373 9
@


1.4
log
@For v4norm (but not v4root), also anonymise the device major:minor of
the device the file to archive resides/resided on (set to zero)

* does not affect the device major:minor of the file to archive itself
  (only nonzero if the file to archive is a character/block special)
* this works because of my inode serialisation algorithm, which
  uses the original device major:minor and the original inode as
  index into its database, but assigns continuous new-inode numbers
  to them no matter which device they are on

Proof:

e/x/161824 M/interix.diff C/me/x/161824l? | /cpio -oHv4norm >x                <
debug: inode    27820 ->   3, dev       41:      43, file <C/me/x/161824>
debug: inode    27820 ->   4, dev       41:      4D, file <M/interix.diff>
debug: inode    27820 ->   3, dev       41:      43, file <C/me/x/161824l2>
debug: inode    27820 ->   3, dev       41:      43, file <C/me/x/161824l3>
debug: inode        0 ->   5, dev        0:       0, file <TRAILER!!!>
/161824l? | xargs ls -li                                                      <
161824 -rw-r--r--  3 sysop      None          0 Nov 18 13:38 C/me/x/161824
161824 -rw-r--r--  3 sysop      None          0 Nov 18 13:38 C/me/x/161824l2
161824 -rw-r--r--  3 sysop      None          0 Nov 18 13:38 C/me/x/161824l3
161824 -rwxrwxrwx  1 +Everyone  +Everyone  6039 Nov 16 14:46 M/interix.diff

If a file exists twice in the source tree, it's archived twice unless
it's a hard link - in the new v4norm format, it should not matter if
they are on separate or same filesystems for the emission of a new
inode number. If they have been hardlinks before, it does of course
matter, but as far as I am concerned, mpczar does not need to deal
with these, as CVS checkouts aren't hardlinked anyway (and we don't
archive the CVS/ subdirectories).
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.3 2005/11/16 13:58:38 tg Exp $
d104 6
@


1.3
log
@* cpio.1: Document sv4crc format for creation and extraction
* cpio.1, pax.1: Document new v4norm and v4root formats for creation only
  (to extract these, the sv4crc driver is being used)
* cpio.c: Add initialisation routines for v4norm and v4root formats
* cpio.c (vcpio_wr): Write c_ino, c_uid, c_gid and c_mtime through a
  layer of indirection, depending on the state of (v4norm) setting them
  to the stat buf value, zero (uid, gid, mtime) or the result of a table
  lookup (inode)
* extern.h: expose new v4norm_stwr, v4root_stwr (cpio.c) and
  flnk_start, chk_flnk (table.c) functions
* options.c: add entries for new formats v4norm, v4root
* tables.c: mirror lnk_start, chk_lnk functions to build up a hard link
  table on archive creation as well, anonymising _all_ inodes stored

(inodes start at 3)
@
text
@d1 1
a1 1
.\"	$MirOS: src/bin/pax/cpio.1,v 1.2 2005/02/28 20:04:58 tg Exp $
d119 1
a119 1
UID/GID and mtime set to zero.
d123 1
a123 1
UID/GID set to zero.
@


1.2
log
@merge
@
text
@d1 1
a1 1
.\"	$MirOS$
d4 1
a27 2
.\"	$OpenBSD: cpio.1,v 1.20 2003/11/21 20:54:02 jmc Exp $
.\"
d108 4
d116 8
d196 4
@


1.1
log
@Initial revision
@
text
@d1 1
d113 9
d189 9
d310 4
@


1.1.1.1
log
@Import the OpenBSD foundation of MirOS BSD
@
text
@@


1.1.1.2
log
@One "miserable" byte in filenames is worth an import

agreed bsiegert@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: cpio.1,v 1.23 2006/01/03 17:22:47 jmc Exp $
d26 1
a26 1
.\"	$OpenBSD: cpio.1,v 1.23 2006/01/03 17:22:47 jmc Exp $
a284 13
.Sh CAVEATS
Different file formats have different maximum file sizes.
It is recommended that a format such as cpio or ustar
be used for larger files.
.Pp
.Bl -column "File format" "Maximum file size" -offset indent -compact
.It Sy "File format" Ta Sy "Maximum file size"
.It bcpio Ta 4 Gigabytes
.It sv4cpio Ta 4 Gigabytes
.It cpio Ta 8 Gigabytes
.It tar Ta 8 Gigabytes
.It ustar Ta 8 Gigabytes
.El
@


1.1.1.3
log
@import latest OpenCPIO ☺
@
text
@d1 1
a1 1
.\"	$OpenBSD: cpio.1,v 1.26 2007/05/31 19:19:15 jmc Exp $
d26 1
a26 1
.\"	$OpenBSD: cpio.1,v 1.26 2007/05/31 19:19:15 jmc Exp $
d28 1
a28 1
.Dd $Mdocdate$
d37 1
a37 1
.Op Fl AaBcLvZz
d42 2
a43 2
.Ar \*(Lt name-list
.Op Ar \*(Gt archive
d46 1
a46 1
.Op Fl 6BbcdfmrSstuvZz
d52 2
a53 2
.Op Ar pattern ...
.Op Ar \*(Lt archive
d56 1
a56 1
.Op Fl adLlmuv
d58 1
a58 1
.Ar \*(Lt name-list
a73 2
.It Fl A
Append to the specified archive.
d77 2
a80 3
.It Fl C Ar bytes
Set the block size of output to
.Ar bytes .
d85 3
d89 2
a90 1
Use the specified file as the input for the archive.
a114 2
.It Fl O Ar archive
Use the specified file name as the archive to write to.
d118 4
a125 4
.It Fl z
Compress archive using
.Xr gzip 1
format.
a133 6
.It Fl 6
Process old-style
.Nm
format archives.
.It Fl B
Set the block size of the archive being read to 5120 bytes.
d138 4
a144 2
.It Fl c
Expect the archive headers to be in ASCII format.
a150 2
.It Fl F Ar archive , Fl I Ar archive
Use the specified file as the input for the archive.
d155 3
d184 2
a187 2
.It Fl s
Swap bytes after reading data from the archive.
d197 4
d205 4
a208 4
.It Fl z
Uncompress archive using
.Xr gzip 1
format.
a221 2
.It Fl L
Follow symbolic links.
d225 2
@


1.1.1.4
log
@import up-to-date pax from OpenBSD 5.1-current
@
text
@d1 1
a1 1
.\"	$OpenBSD: cpio.1,v 1.34 2011/09/03 22:59:08 jmc Exp $
d26 3
a28 1
.Dd $Mdocdate: September 3 2011 $
d37 1
a37 1
.Op Fl AaBcjLvZz
d42 2
a43 2
.No \*(Lt Ar name-list
.Op \*(Gt Ar archive
d46 1
a46 1
.Op Fl 6BbcdfjmrSstuvZz
d53 1
a53 1
.Op \*(Lt Ar archive
d58 1
a58 1
.No \*(Lt Ar name-list
a111 3
.It Fl j
Compress archive using the bzip2 format.
The bzip2 utility must be installed separately.
a183 3
.It Fl j
Uncompress archive using the bzip2 format.
The bzip2 utility must be installed separately.
d242 1
a242 2
.Sh EXIT STATUS
The
d244 2
a245 3
utility exits with one of the following values:
.Pp
.Bl -tag -width Ds -offset indent -compact
d251 1
a251 1
.Sh DIAGNOSTICS
d289 2
a290 1
.Bl -column "File format" "Maximum file size" -offset indent
d292 5
a296 5
.It bcpio Ta "4 Gigabytes"
.It sv4cpio Ta "4 Gigabytes"
.It cpio Ta "8 Gigabytes"
.It tar Ta "8 Gigabytes"
.It ustar Ta "8 Gigabytes"
@


1.1.1.5
log
@pull newer paxtar from OpenBSD
@
text
@d1 1
a1 1
.\"	$OpenBSD: cpio.1,v 1.35 2014/09/08 01:27:54 schwarze Exp $
d26 1
a26 1
.Dd $Mdocdate: September 8 2014 $
d290 1
a290 2
.An Keith Muller
at the University of California, San Diego.
@


1.1.1.6
log
@revert the import; we’ll just backport the CVE fixes, for now ☹
@
text
@d1 1
a1 1
.\"	$OpenBSD: cpio.1,v 1.34 2011/09/03 22:59:08 jmc Exp $
d26 1
a26 1
.Dd $Mdocdate: February 11 2012 $
d290 2
a291 1
Keith Muller at the University of California, San Diego.
@


1.1.1.7
log
@Import latest OpenBSD paxtar, unmodified, into vendor branch
@
text
@d1 1
a1 1
.\"	$OpenBSD: cpio.1,v 1.35 2014/09/08 01:27:54 schwarze Exp $
d26 1
a26 1
.Dd $Mdocdate: September 8 2014 $
d290 1
a290 2
.An Keith Muller
at the University of California, San Diego.
@


1.1.1.7.2.1
log
@do the ‘c’s
@
text
@a2 3
.\" Copyright (c) 2005, 2009, 2011, 2012, 2014, 2015, 2016,
.\"		  2017, 2018
.\"	mirabilos <m@@mirbsd.org>
a24 16
.\"-
.\" Try to make GNU groff and AT&T nroff more compatible
.\" * ` generates ‘ in gnroff, so use \`
.\" * ' generates ’ in gnroff, \' generates ´, so use \*(aq
.\" * - generates ‐ in gnroff, \- generates −, so .tr it to -
.\"   thus use - for hyphens and \- for minus signs and option dashes
.\" * ~ is size-reduced and placed atop in groff, so use \*(TI
.\" * ^ is size-reduced and placed atop in groff, so use \*(ha
.\" * \(en does not work in nroff, so use \*(en
.\" * <>| are problematic, so redefine and use \*(Lt\*(Gt\*(Ba
.\" Also make sure to use \& *before* a punctuation char that is to not
.\" be interpreted as punctuation, and especially with two-letter words
.\" but also (after) a period that does not end a sentence (“e.g.\&”).
.\" The section after the "doc" macropackage has been loaded contains
.\" additional code to convene between the UCB mdoc macropackage (and
.\" its variant as BSD mdoc in groff) and the GNU mdoc macropackage.
d26 3
a28 136
.ie \n(.g \{\
.	if \*[.T]ascii .tr \-\N'45'
.	if \*[.T]latin1 .tr \-\N'45'
.	if \*[.T]utf8 .tr \-\N'45'
.	ds <= \[<=]
.	ds >= \[>=]
.	ds Rq \[rq]
.	ds Lq \[lq]
.	ds sL \(aq
.	ds sR \(aq
.	if \*[.T]utf8 .ds sL `
.	if \*[.T]ps .ds sL `
.	if \*[.T]utf8 .ds sR '
.	if \*[.T]ps .ds sR '
.	ds aq \(aq
.	ds TI \(ti
.	ds ha \(ha
.	ds en \(en
.\}
.el \{\
.	ds aq '
.	ds TI ~
.	ds ha ^
.	ds en \(em
.\}
.\"
.\" Implement .Dd with the Mdocdate RCS keyword
.\"
.rn Dd xD
.de Dd
.ie \\$1$Mdocdate: \{\
.	xD \\$2 \\$3, \\$4
.\}
.el .xD \\$1 \\$2 \\$3 \\$4 \\$5 \\$6 \\$7 \\$8
..
.\"
.\" .Dd must come before definition of .Mx, because when called
.\" with -mandoc, it might implement .Mx itself, but we want to
.\" use our own definition. And .Dd must come *first*, always.
.\"
.Dd $Mdocdate: February 11 2016 $
.\"
.\" Check which macro package we use, and do other -mdoc setup.
.\"
.ie \n(.g \{\
.	if \*[.T]utf8 .tr \[la]\*(Lt
.	if \*[.T]utf8 .tr \[ra]\*(Gt
.	ie d volume-ds-1 .ds tT gnu
.	el .ds tT bsd
.\}
.el .ds tT ucb
.\"
.\" Implement .Mx (MirBSD)
.\"
.ie "\*(tT"gnu" \{\
.	eo
.	de Mx
.	nr curr-font \n[.f]
.	nr curr-size \n[.ps]
.	ds str-Mx \f[\n[curr-font]]\s[\n[curr-size]u]
.	ds str-Mx1 \*[Tn-font-size]\%MirOS\*[str-Mx]
.	if !\n[arg-limit] \
.	if \n[.$] \{\
.	ds macro-name Mx
.	parse-args \$@@
.	\}
.	if (\n[arg-limit] > \n[arg-ptr]) \{\
.	nr arg-ptr +1
.	ie (\n[type\n[arg-ptr]] == 2) \
.	as str-Mx1 \~\*[arg\n[arg-ptr]]
.	el \
.	nr arg-ptr -1
.	\}
.	ds arg\n[arg-ptr] "\*[str-Mx1]
.	nr type\n[arg-ptr] 2
.	ds space\n[arg-ptr] "\*[space]
.	nr num-args (\n[arg-limit] - \n[arg-ptr])
.	nr arg-limit \n[arg-ptr]
.	if \n[num-args] \
.	parse-space-vector
.	print-recursive
..
.	ec
.	ds sP \s0
.	ds tN \*[Tn-font-size]
.\}
.el \{\
.	de Mx
.	nr cF \\n(.f
.	nr cZ \\n(.s
.	ds aa \&\f\\n(cF\s\\n(cZ
.	if \\n(aC==0 \{\
.		ie \\n(.$==0 \&MirOS\\*(aa
.		el .aV \\$1 \\$2 \\$3 \\$4 \\$5 \\$6 \\$7 \\$8 \\$9
.	\}
.	if \\n(aC>\\n(aP \{\
.		nr aP \\n(aP+1
.		ie \\n(C\\n(aP==2 \{\
.			as b1 \&MirOS\ #\&\\*(A\\n(aP\\*(aa
.			ie \\n(aC>\\n(aP \{\
.				nr aP \\n(aP+1
.				nR
.			\}
.			el .aZ
.		\}
.		el \{\
.			as b1 \&MirOS\\*(aa
.			nR
.		\}
.	\}
..
.\}
.\"-
.ie \ng==1 \{\
.	ds nc mircpio
.	ds np mirpax
.	ds nt mirtar
.	ds nm mircpio
.	Dt MIRCPIO 1
.\}
.el .ie \ng==2 \{\
.	ds nc paxcpio
.	ds np pax
.	ds nt paxtar
.	ds nm paxcpio
.	Dt PAXCPIO 1
.\}
.el \{\
.	ds nc cpio
.	ds np pax
.	ds nt tar
.	ds nm cpio
.	Dt CPIO 1
.\}
.\"-
.Os MirBSD
a29 9
.ie \ng==1 \{\
.Nm mircpio
.Nd copy file archives in and out
.\}
.el .ie \ng==2 \{\
.Nm paxcpio
.Nd copy file archives in and out
.\}
.el \{\
a31 1
.\}
d33 1
a33 1
.Nm \*(nm
d35 1
a35 1
.Op Fl 0AaBcJjLVvZz
a38 1
.Op Fl M Ar flag
d42 1
a42 1
.Nm \*(nm
d44 1
a44 1
.Op Fl 06BbcdfJjmrSstuVvZz
a49 1
.Op Fl M Ar flag
d52 1
a52 1
.Nm \*(nm
d54 1
a54 1
.Op Fl 0adLlmuVv
d61 1
a61 1
.Nm cpio
a65 22
.It Fl 0
Use the NUL
.Pq Ql \e0
character as a pathname terminator, instead of newline
.Pq Ql \en .
This applies only to the pathnames read from standard input in
the write and copy modes,
and to the pathnames written to standard output in list mode.
This option is expected to be used in concert with the
.Fl print0
function in
.Xr find 1 ,
the
.Fl d Ar \*(aq\*(aq
option to the
.Ic read
built-in utility of
.Xr mksh 1
or the
.Fl 0
flag in
.Xr xargs 1 .
d84 1
a84 1
.Nm cpio
d90 1
a90 1
Recognised formats are:
a92 2
.It Ar ar
Unix Archiver.
d95 1
a95 1
.Nm cpio
a96 2
Selected by
.Fl 6 .
d99 1
a99 1
.Nm cpio
a100 2
Selected by
.Fl c .
d103 1
a103 1
.Nm cpio
a104 5
.It Ar sv4crc
SVR4 hex
.Nm cpio
format with checksums.
This is the default format for creating new archives.
a108 9
.It "\ "
.It Ar bin
These four formats...\&
.It Ar crc
\&...are supported...\&
.It Ar newc
\&...for backwards...\&
.It Ar odc
\&...compatibility only.
a109 2
.It Fl J
Use the xz utility to compress the archive.
d111 2
a112 1
Use the bzip2 utility to compress the archive.
a114 58
.It Fl M Ar flag
Configure the archive normaliser.
.Ar flag
is either a numeric value compatible to
.Xr strtonum 3
which is directly stored in the flags word, or
one of the following values, optionally prefixed with
.Dq no\-
to turn them off:
.Pp
.Bl -tag -width xxxxxx -compact
.It Ar inodes
0x0001: Serialise inodes, zero device info.
.br
(cpio, sv4cpio, sv4crc)
.It Ar links
0x0002: Store content of hard links only once.
.br
(cpio, sv4cpio, sv4crc)
.It Ar mtime
0x0004: Zero out the file modification time.
.br
(ar, cpio, sv4cpio, sv4crc, ustar)
.It Ar uidgid
0x0008: Set owner to 0:0
.Pq Li root Ns : Ns Li wheel .
.br
(ar, cpio, sv4cpio, sv4crc, ustar)
.It Ar verb
0x0010: Debug this option.
.It Ar debug
0x0020: Debug file header storage.
.It Ar lncp
0x0040: Extract hard links by copy if link fails.
.It Ar numid
0x0080: Use only numeric uid and gid values.
.br
(ustar)
.It Ar gslash
0x0100: Append a slash after directory names.
.br
(ustar)
.It Ar set
0x0003: Keep ownership and mtime intact.
.It Ar dist
0x008B: Clean everything except mtime.
.It Ar norm
0x008F: Clean everything.
.It Ar root
0x0089: Clean owner and device information.
.El
.Pp
When creating an archive and verbosely listing output, these
normalisation operations are not reflected in the output,
because they are made only after the output has been shown.
.Pp
This option is only implemented for the ar, cpio, sv4cpio,
sv4crc, and ustar file format writing routines.
a116 4
.It Fl V
Print a dot
.Pq Sq \&.
for each file written to the archive.
d121 1
a121 1
Use the
d123 1
a123 1
utility to compress the archive.
d125 1
a125 1
Use the
d127 1
a127 1
utility to compress the archive.
d138 1
a138 1
.Nm cpio
d165 1
a165 1
Recognised formats are:
a167 2
.It Ar ar
Unix Archiver.
d170 1
a170 1
.Nm cpio
d174 1
a174 1
.Nm cpio
d178 1
a178 1
.Nm cpio
a179 4
.It Ar sv4crc
SVR4 hex
.Nm cpio
format with checksums.
a183 9
.It "\ "
.It Ar bin
These four formats...\&
.It Ar crc
\&...are supported...\&
.It Ar newc
\&...for backwards...\&
.It Ar odc
\&...compatibility only.
a184 2
.It Fl J
Use the xz utility to decompress the archive.
d186 2
a187 1
Use the bzip2 utility to decompress the archive.
a201 4
.It Fl V
Print a dot
.Pq Sq \&.
for each file read from the archive.
d206 1
a206 1
Use the
d208 1
a208 1
utility to decompress the archive.
d210 1
a210 1
Use the
d212 1
a212 1
utility to decompress the archive.
a235 4
.It Fl V
Print a dot
.Pq Sq \&.
for each file copied.
a269 3
unless
.Fl M Ar lncp
is given,
a286 14
.Xr ar 1 ,
.if \ng==1 \{\
.Xr cpio 1 ,
.Xr deb 5 ,
.Xr mirpax 1 ,
.Xr mirtar 1 ,
.\}
.ie \ng==2 \{\
.Xr cpio 1 ,
.Xr deb 5 ,
.Xr pax 1 ,
.Xr paxtar 1 ,
.\}
.el \{\
a287 1
.\}
a289 1
.An -nosplit
a291 3
.Mx
extensions by
.An mirabilos Aq m@@mirbsd.org .
d298 5
a302 7
.It ar Ta "10 Gigabytes \- 1 Byte"
.It bcpio Ta "4 Gibibytes"
.It sv4cpio Ta "4 Gibibytes"
.It sv4crc Ta "4 Gibibytes"
.It cpio Ta "8 Gibibytes"
.It tar Ta "8 Gibibytes"
.It ustar Ta "8 Gibibytes"
a303 26
.Pp
The backwards-compatible format options are not available in the
.Xr \*(np 1
front-end.
.Pp
The
.Fl M
option is a MirBSD extension, available starting with
.Mx 8 .
Archives written using these options are, however, compatible to
the standard and should be readable on any other system.
The only option whose behaviour is not explicitly allowed by the
standard is hard link unification (write file contens only once)
selected by
.Fl M Ar 0x0002 .
.Pp
The
.Fl V
option is a GNU extension, available starting with
.Mx 11 .
.Pp
The
.Ar ar
file format matches APT repositories and the BSD
.Xr ar 1
specification, not GNU binutils (which can however read them) or SYSV systems.
a309 4
.Pp
The
.Ar pax
file format is not yet supported.
@


1.1.1.7.2.2
log
@pax without .h, modulo setpgent and O_CLOEXEC
@
text
@d85 1
a85 1
.Dd $Mdocdate: December 12 2018 $
a194 1
.Bk -words
a220 1
.Ek
@


