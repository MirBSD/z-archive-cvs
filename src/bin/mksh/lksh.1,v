head	1.25;
access;
symbols
	mksh-R57:1.25
	mksh-R56c:1.23
	mksh-R56b:1.23
	mksh-R56:1.23
	mksh-R55:1.23
	mksh-R54:1.20
	mksh-R53a:1.18
	mksh-R53:1.18
	mksh-R52c:1.17
	mksh-R52b:1.16
	mksh-R52:1.16
	mksh-R51:1.10
	mksh-R50f:1.5.2.1
	mksh-R50e:1.5
	mksh-R50stable:1.5.0.2
	mksh-R50d:1.5
	mksh-R50c:1.5
	mksh-R50b:1.5
	mksh-R50:1.5
	mksh-R49:1.5
	mksh-R48b:1.5
	mksh-R48:1.5
	mksh-R47:1.5
	mksh-R46:1.4;
locks; strict;
comment	@.\" @;


1.25
date	2018.12.25.19.38.08;	author tg;	state Exp;
branches;
next	1.24;
commitid	1005C22871909EC7FE2;

1.24
date	2018.07.15.13.57.18;	author tg;	state Exp;
branches;
next	1.23;
commitid	1005B4B52CF2EB9391F;

1.23
date	2017.04.02.13.38.02;	author tg;	state Exp;
branches;
next	1.22;
commitid	10058E0FEB71C12075B;

1.22
date	2017.02.27.16.04.37;	author tg;	state Exp;
branches;
next	1.21;
commitid	10058B44E2935E9F2EB;

1.21
date	2017.02.18.02.33.13;	author tg;	state Exp;
branches;
next	1.20;
commitid	10058A7B271530B4CED;

1.20
date	2016.11.11.23.31.35;	author tg;	state Exp;
branches;
next	1.19;
commitid	100582654B972655F84;

1.19
date	2016.08.25.16.21.33;	author tg;	state Exp;
branches;
next	1.18;
commitid	10057BF1B1D101BE102;

1.18
date	2016.08.10.18.20.05;	author tg;	state Exp;
branches;
next	1.17;
commitid	10057AB706B2E3BA65B;

1.17
date	2016.02.11.20.12.09;	author tg;	state Exp;
branches;
next	1.16;
commitid	10056BCEAFF41919B5B;

1.16
date	2015.12.12.22.25.14;	author tg;	state Exp;
branches;
next	1.15;
commitid	100566C9EDD3DC6C239;

1.15
date	2015.10.09.21.36.56;	author tg;	state Exp;
branches;
next	1.14;
commitid	100561833456A230F8F;

1.14
date	2015.10.09.20.33.49;	author tg;	state Exp;
branches;
next	1.12;
commitid	100561824BB685E1CE5;

1.12
date	2015.10.09.19.28.20;	author tg;	state Exp;
branches;
next	1.11;
commitid	10056181542140199D2;

1.11
date	2015.09.05.19.19.06;	author tg;	state Exp;
branches;
next	1.10;
commitid	10055EB402C54C3076B;

1.10
date	2015.04.12.22.32.12;	author tg;	state Exp;
branches;
next	1.9;
commitid	100552AF26A429AA816;

1.9
date	2015.04.11.23.28.19;	author tg;	state Exp;
branches;
next	1.8;
commitid	1005529AD8D33CF99B9;

1.8
date	2015.03.21.00.12.46;	author tg;	state Exp;
branches;
next	1.7;
commitid	100550CB7886DC367A3;

1.7
date	2015.03.20.23.37.54;	author tg;	state Exp;
branches;
next	1.6;
commitid	100550CAF6732AE1EA7;

1.6
date	2015.03.20.23.37.29;	author tg;	state Exp;
branches;
next	1.5;
commitid	100550CAF4E01CA838D;

1.5
date	2013.05.22.18.18.06;	author tg;	state Exp;
branches
	1.5.2.1;
next	1.4;
commitid	100519D0BC73B2B6519;

1.4
date	2013.05.02.20.21.43;	author tg;	state Exp;
branches;
next	1.3;
commitid	1005182CAE814B1B129;

1.3
date	2013.04.27.19.16.25;	author tg;	state Exp;
branches;
next	1.2;
commitid	100517C240B5F21EA3E;

1.2
date	2013.04.27.18.50.24;	author tg;	state Exp;
branches;
next	1.1;
commitid	100517C1D840086DC8F;

1.1
date	2013.04.27.18.13.58;	author tg;	state Exp;
branches;
next	;
commitid	100517C156555EF1DBB;

1.5.2.1
date	2015.03.21.00.12.45;	author tg;	state Exp;
branches;
next	;
commitid	100550CB7886DC367A3;


desc
@@


1.25
log
@update from contrib/samples/portmdoc,v 1.11
@
text
@.\" $MirOS: src/bin/mksh/lksh.1,v 1.24 2018/07/15 13:57:18 tg Exp $
.\"-
.\" Copyright (c) 2008, 2009, 2010, 2012, 2013, 2015, 2016, 2017, 2018
.\"	mirabilos <m@@mirbsd.org>
.\"
.\" Provided that these terms and disclaimer and all copyright notices
.\" are retained or reproduced in an accompanying document, permission
.\" is granted to deal in this work without restriction, including un‐
.\" limited rights to use, publicly perform, distribute, sell, modify,
.\" merge, give away, or sublicence.
.\"
.\" This work is provided “AS IS” and WITHOUT WARRANTY of any kind, to
.\" the utmost extent permitted by applicable law, neither express nor
.\" implied; without malicious intent or gross negligence. In no event
.\" may a licensor, author or contributor be held liable for indirect,
.\" direct, other damage, loss, or other issues arising in any way out
.\" of dealing in the work, even if advised of the possibility of such
.\" damage or existence of a defect, except proven that it results out
.\" of said person’s immediate fault when using the work as intended.
.\"-
.\" Try to make GNU groff and AT&T nroff more compatible
.\" * ` generates ‘ in gnroff, so use \`
.\" * ' generates ’ in gnroff, \' generates ´, so use \*(aq
.\" * - generates ‐ in gnroff, \- generates −, so .tr it to -
.\"   thus use - for hyphens and \- for minus signs and option dashes
.\" * ~ is size-reduced and placed atop in groff, so use \*(TI
.\" * ^ is size-reduced and placed atop in groff, so use \*(ha
.\" * \(en does not work in nroff, so use \*(en
.\" * <>| are problematic, so redefine and use \*(Lt\*(Gt\*(Ba
.\" Also make sure to use \& *before* a punctuation char that is to not
.\" be interpreted as punctuation, and especially with two-letter words
.\" but also (after) a period that does not end a sentence (“e.g.\&”).
.\" The section after the "doc" macropackage has been loaded contains
.\" additional code to convene between the UCB mdoc macropackage (and
.\" its variant as BSD mdoc in groff) and the GNU mdoc macropackage.
.\"
.ie \n(.g \{\
.	if \*[.T]ascii .tr \-\N'45'
.	if \*[.T]latin1 .tr \-\N'45'
.	if \*[.T]utf8 .tr \-\N'45'
.	ds <= \[<=]
.	ds >= \[>=]
.	ds Rq \[rq]
.	ds Lq \[lq]
.	ds sL \(aq
.	ds sR \(aq
.	if \*[.T]utf8 .ds sL `
.	if \*[.T]ps .ds sL `
.	if \*[.T]utf8 .ds sR '
.	if \*[.T]ps .ds sR '
.	ds aq \(aq
.	ds TI \(ti
.	ds ha \(ha
.	ds en \(en
.\}
.el \{\
.	ds aq '
.	ds TI ~
.	ds ha ^
.	ds en \(em
.\}
.\"
.\" Implement .Dd with the Mdocdate RCS keyword
.\"
.rn Dd xD
.de Dd
.ie \\$1$Mdocdate: \{\
.	xD \\$2 \\$3, \\$4
.\}
.el .xD \\$1 \\$2 \\$3 \\$4 \\$5 \\$6 \\$7 \\$8
..
.\"
.\" .Dd must come before definition of .Mx, because when called
.\" with -mandoc, it might implement .Mx itself, but we want to
.\" use our own definition. And .Dd must come *first*, always.
.\"
.Dd $Mdocdate: December 25 2018 $
.\"
.\" Check which macro package we use, and do other -mdoc setup.
.\"
.ie \n(.g \{\
.	if \*[.T]utf8 .tr \[la]\*(Lt
.	if \*[.T]utf8 .tr \[ra]\*(Gt
.	ie d volume-ds-1 .ds tT gnu
.	el .ie d doc-volume-ds-1 .ds tT gnp
.	el .ds tT bsd
.\}
.el .ds tT ucb
.\"
.\" Implement .Mx (MirBSD)
.\"
.ie "\*(tT"gnu" \{\
.	eo
.	de Mx
.	nr curr-font \n[.f]
.	nr curr-size \n[.ps]
.	ds str-Mx \f[\n[curr-font]]\s[\n[curr-size]u]
.	ds str-Mx1 \*[Tn-font-size]\%MirBSD\*[str-Mx]
.	if !\n[arg-limit] \
.	if \n[.$] \{\
.	ds macro-name Mx
.	parse-args \$@@
.	\}
.	if (\n[arg-limit] > \n[arg-ptr]) \{\
.	nr arg-ptr +1
.	ie (\n[type\n[arg-ptr]] == 2) \
.	as str-Mx1 \~\*[arg\n[arg-ptr]]
.	el \
.	nr arg-ptr -1
.	\}
.	ds arg\n[arg-ptr] "\*[str-Mx1]
.	nr type\n[arg-ptr] 2
.	ds space\n[arg-ptr] "\*[space]
.	nr num-args (\n[arg-limit] - \n[arg-ptr])
.	nr arg-limit \n[arg-ptr]
.	if \n[num-args] \
.	parse-space-vector
.	print-recursive
..
.	ec
.	ds sP \s0
.	ds tN \*[Tn-font-size]
.\}
.el .ie "\*(tT"gnp" \{\
.	eo
.	de Mx
.	nr doc-curr-font \n[.f]
.	nr doc-curr-size \n[.ps]
.	ds doc-str-Mx \f[\n[doc-curr-font]]\s[\n[doc-curr-size]u]
.	ds doc-str-Mx1 \*[doc-Tn-font-size]\%MirBSD\*[doc-str-Mx]
.	if !\n[doc-arg-limit] \
.	if \n[.$] \{\
.	ds doc-macro-name Mx
.	doc-parse-args \$@@
.	\}
.	if (\n[doc-arg-limit] > \n[doc-arg-ptr]) \{\
.	nr doc-arg-ptr +1
.	ie (\n[doc-type\n[doc-arg-ptr]] == 2) \
.	as doc-str-Mx1 \~\*[doc-arg\n[doc-arg-ptr]]
.	el \
.	nr doc-arg-ptr -1
.	\}
.	ds doc-arg\n[doc-arg-ptr] "\*[doc-str-Mx1]
.	nr doc-type\n[doc-arg-ptr] 2
.	ds doc-space\n[doc-arg-ptr] "\*[doc-space]
.	nr doc-num-args (\n[doc-arg-limit] - \n[doc-arg-ptr])
.	nr doc-arg-limit \n[doc-arg-ptr]
.	if \n[doc-num-args] \
.	doc-parse-space-vector
.	doc-print-recursive
..
.	ec
.	ds sP \s0
.	ds tN \*[doc-Tn-font-size]
.\}
.el \{\
.	de Mx
.	nr cF \\n(.f
.	nr cZ \\n(.s
.	ds aa \&\f\\n(cF\s\\n(cZ
.	if \\n(aC==0 \{\
.		ie \\n(.$==0 \&MirBSD\\*(aa
.		el .aV \\$1 \\$2 \\$3 \\$4 \\$5 \\$6 \\$7 \\$8 \\$9
.	\}
.	if \\n(aC>\\n(aP \{\
.		nr aP \\n(aP+1
.		ie \\n(C\\n(aP==2 \{\
.			as b1 \&MirBSD\ #\&\\*(A\\n(aP\\*(aa
.			ie \\n(aC>\\n(aP \{\
.				nr aP \\n(aP+1
.				nR
.			\}
.			el .aZ
.		\}
.		el \{\
.			as b1 \&MirBSD\\*(aa
.			nR
.		\}
.	\}
..
.\}
.\"-
.Dt LKSH 1
.Os MirBSD
.Sh NAME
.Nm lksh
.Nd Legacy Korn shell built on mksh
.Sh SYNOPSIS
.Nm
.Bk -words
.Op Fl +abCefhiklmnprUuvXx
.Op Fl +o Ar opt
.Oo
.Fl c Ar string \*(Ba
.Fl s \*(Ba
.Ar file
.Op Ar args ...
.Oc
.Ek
.Sh DESCRIPTION
.Nm
is a command interpreter intended exclusively for running legacy
shell scripts.
It is built on
.Nm mksh ;
refer to its manual page for details on the scripting language.
It is recommended to port scripts to
.Nm mksh
instead of relying on legacy or objectionable POSIX-mandated behaviour,
since the MirBSD Korn Shell scripting language is much more consistent.
.Pp
Do not use
.Nm
as an interactive or login shell; use
.Nm mksh
instead.
.Pp
Note that it's strongly recommended to invoke
.Nm
with
.Fl o Ic posix
to fully enjoy better compatibility to the
.Tn POSIX
standard (which is probably why you use
.Nm
over
.Nm mksh
in the first place);
.Fl o Ic sh
(possibly additionally to the above) may be needed for some legacy scripts.
.Sh LEGACY MODE
.Nm
currently has the following differences from
.Nm mksh :
.Bl -bullet
.It
The
.Ev KSH_VERSION
string identifies
.Nm
as
.Dq Li LEGACY KSH
instead of
.Dq Li MIRBSD KSH .
Note that the rest of the version string is identical between
the two shell flavours, and the behaviour and differences can
change between versions; see the accompanying manual page
.Xr mksh 1
for the versions this document applies to.
.It
.Nm
uses
.Tn POSIX
arithmetic, which has quite a few implications:
The data type for arithmetic operations is the host
.Tn ISO
C
.Vt long
data type.
Signed integer wraparound is Undefined Behaviour; this means that...
.Bd -literal -offset indent
$ echo $((2147483647 + 1))
.Ed
.Pp
\&... is permitted to, e.g. delete all files on your system
(the figure differs for non-32-bit systems, the rule doesn't).
The sign of the result of a modulo operation with at least one
negative operand is unspecified.
Shift operations on negative numbers are unspecified.
Division of the largest negative number by \-1 is Undefined Behaviour.
The compiler is permitted to delete all data and crash the system
if Undefined Behaviour occurs (see above for an example).
.It
The rotation arithmetic operators are not available.
.It
The shift arithmetic operators take all bits of the second operand into
account; if they exceed permitted precision, the result is unspecified.
.It
Unless
.Ic set -o posix
is active,
.Nm
always uses traditional mode for constructs like:
.Bd -literal -offset indent
$ set -- $(getopt ab:c "$@@")
$ echo $?
.Ed
.Pp
POSIX mandates this to show 0, but traditional mode
passes through the errorlevel from the
.Xr getopt 1
command.
.It
Functions defined with the
.Ic function
reserved word share the shell options
.Pq Ic set -o
instead of locally scoping them.
.El
.Sh SEE ALSO
.Xr mksh 1
.Pp
.Pa http://www.mirbsd.org/mksh.htm
.Pp
.Pa http://www.mirbsd.org/ksh\-chan.htm
.Sh CAVEATS
To use
.Nm
as
.Pa /bin/sh ,
compilation to enable
.Ic set -o posix
by default if called as
.Nm sh
.Pq adding Dv \-DMKSH_BINSHPOSIX to Dv CPPFLAGS
is highly recommended for better standards compliance.
.Pp
For better compatibility with legacy scripts, such as many
.Tn Debian
maintainer scripts, Upstart and SYSV init scripts, and other
unfixed scripts, also adding the
.Dv \-DMKSH_BINSHREDUCED
compile-time option to enable
.Em both
.Ic set -o posix -o sh
when the shell is run as
.Nm sh ,
as well as integrating the optional disrecommended
.Xr printf 1
builtin, might be necessary.
.Pp
.Nm
tries to make a cross between a legacy bourne/posix compatibl-ish
shell and a legacy pdksh-alike but
.Dq legacy
is not exactly specified.
.Pp
Talk to the
.Mx
development team and users using the mailing list at
.Aq Mt miros\-mksh@@mirbsd.org
(please note the EU-DSGVO/GDPR notice on
.Pa http://www.mirbsd.org/rss.htm#lists
and in the SMTP banner!) or the
.Li \&#\&!/bin/mksh
.Pq or Li \&#ksh
IRC channel at
.Pa irc.freenode.net
.Pq Port 6697 SSL, 6667 unencrypted
if you need any further quirks or assistance,
and consider migrating your legacy scripts to work with
.Nm mksh
instead of requiring
.Nm .
@


1.24
log
@add EU-DSGVO (GDPR) notice for the mailing list
@
text
@d1 1
a1 1
.\" $MirOS: src/bin/mksh/lksh.1,v 1.21 2017/02/18 02:33:13 tg Exp $
d3 1
a3 1
.\" Copyright (c) 2008, 2009, 2010, 2012, 2013, 2015, 2016, 2017
d77 1
a77 1
.Dd $Mdocdate: February 18 2017 $
d85 1
d98 1
a98 1
.	ds str-Mx1 \*[Tn-font-size]\%MirOS\*[str-Mx]
d124 32
d162 1
a162 1
.		ie \\n(.$==0 \&MirOS\\*(aa
d168 1
a168 1
.			as b1 \&MirOS\ #\&\\*(A\\n(aP\\*(aa
d176 1
a176 1
.			as b1 \&MirOS\\*(aa
@


1.23
log
@POSuX demands persistent history support, so permit it in lksh

also, use http for links, it’s less demanding than https
@
text
@d307 5
a311 3
development team using the mailing list at
.Aq miros\-mksh@@mirbsd.org
or the
@


1.22
log
@improve wording avoiding bad linebreaks
@
text
@a265 2
.It
Support for persistent history is never compiled in.
d270 1
a270 1
.Pa https://www.mirbsd.org/mksh.htm
d272 1
a272 1
.Pa https://www.mirbsd.org/ksh\-chan.htm
@


1.21
log
@fixup relation between lksh and mksh (somewhat minimal delta)
@
text
@d1 1
a1 1
.\" $MirOS: src/bin/mksh/lksh.1,v 1.17 2016/02/11 20:12:09 tg Exp $
d77 1
a77 1
.Dd $Mdocdate: February 11 2016 $
d187 1
a187 1
with at least the
a188 2
option, if not both that
.Em and Fl o Ic sh ,
d195 3
a197 1
in the first place) or legacy scripts, respectively.
@


1.20
log
@collective R54 release preparation multi-merger:

install both lksh and mksh manpages from Build.sh (Martijn Dekker)
spelling fixes (Larry Hynes)
manpage improvements (Martijn Dekker)
initial port to Harvey-OS’ APEX (Ronald G. Minnich, Elbing Miss, Álvaro Jurado)
more from komh’s OS/2 port (KO Myung-Hun)
@
text
@d3 1
a3 1
.\" Copyright (c) 2008, 2009, 2010, 2012, 2013, 2015, 2016
d176 1
a176 1
instead of relying on legacy or idiotic POSIX-mandated behaviour,
d179 6
a203 9
.\"XXX TODO: remove (some systems may wish to have lksh as ksh)
There is no explicit support for interactive use,
nor any command line editing or history code.
Hence,
.Nm
is not suitable as a user's login shell, either; use
.Nm mksh
instead.
.It
a240 1
.\"XXX TODO: move this to FPOSIX
a245 13
.\"XXX TODO: move this to FPOSIX
The
.Tn GNU
.Nm bash
extension &\*(Gt to redirect stdout and stderr in one go is not parsed.
.It
.\"XXX TODO: drop along with allowing interactivity
The
.Nm mksh
command line option
.Fl T
is not available.
.It
a260 13
.\"XXX TODO: move to FPOSIX/FSH
Unlike
.At
.Nm ksh ,
.Nm mksh
in
.Fl o Ic posix
or
.Fl o Ic sh
mode and
.Nm lksh
do not keep file descriptors \*(Gt 2 private from sub-processes.
.It
d266 2
a275 6
The distinction between the shell variants
.Pq Nm lksh / Nm mksh
and shell flags
.Pq Fl o Ic posix / Ic sh
will be reworked for an upcoming release.
.Pp
d284 1
d286 1
d290 3
a292 1
unfixed scripts, using the compile-time options for enabling
d296 4
a299 2
.Nm sh
is recommended.
a306 8
The
.Ic set
built-in command does not currently have all options one would expect
from a full-blown
.Nm mksh
or
.Nm pdksh .
.Pp
@


1.19
log
@outstanding bumps
@
text
@d224 2
a225 2
arithmetics, which has quite a few implications:
The data type for arithmetics is the host
@


1.18
log
@fixes
@
text
@d212 1
a212 1
.Dq LEGACY KSH
d214 1
a214 1
.Dq MIRBSD KSH .
@


1.17
log
@merge most recent portmdoc into a̲l̲l̲ of its users; fixup .\& into \&. like
in mksh(1), for Schillix ditroff
@
text
@d1 1
a1 1
.\" $MirOS: src/bin/mksh/lksh.1,v 1.4 2013/05/02 20:21:43 tg Exp $
d77 1
a77 1
.Dd $Mdocdate: May 2 2013 $
a243 3
.Nm
only offers the traditional ten file descriptors to scripts.
.It
@


1.16
log
@update for recent changes
@
text
@d3 1
a3 1
.\" Copyright (c) 2008, 2009, 2010, 2012, 2013, 2015
d30 3
a32 1
.\" Also make sure to use \& especially with two-letter words.
@


1.15
log
@make “source” into a built-in command (keepasn, to match ksh93 and “dot”);
remove the “stop” alias and drop old Android and OS/2 hacks and auto-unalias
@
text
@d305 6
@


1.14
log
@move some information off mksh.1; harmonise
@
text
@a291 12
.\"XXX TODO: move to FSH? fix upstreams? both ugh.
.Nm lksh
undefines an alias when a
.Tn POSIX
function with the same name is defined,
to make that function immediately callable.
In
.Nm mksh ,
aliases have precedence; the name must be quoted or
.Ic unalias Ns ed
to access it.
.It
@


1.12
log
@comments for future directions (keep delta lower, make lksh-as-ksh doable)

oksh synching will be more work than I can continue while being ill still…
@
text
@d176 14
a219 3
only offers the traditional ten file descriptors to scripts.
.It
.Nm
d223 3
a225 1
The data type for arithmetics is the host ISO C
d228 7
a234 1
Signed integer wraparound is Undefined Behaviour.
d240 4
a243 1
if Undefined Behaviour occurs.
d323 12
a334 1
by default is highly recommended for better standards compliance.
d344 1
a344 1
built-in command does not have all options one would expect
@


1.11
log
@oksh sync, simplify *all* if(x)free(x); constructs, simplify x_push() and sync boilerplate while here
@
text
@d4 1
a4 1
.\"	mirabilos <tg@@mirbsd.org>
d182 1
d223 1
d229 1
d235 1
d257 1
d270 1
@


1.10
log
@MFC most things (see mksh.hts) to R50-stable; sync clog
@
text
@d4 1
a4 1
.\"	Thorsten “mirabilos” Glaser <tg@@mirbsd.org>
@


1.9
log
@Implement the “FKSH functions have local scope for shell options” feature
for mksh but not lksh; bump to R51-alpha.

While here, tweak build scripts a bit, fixup MirBSD-specific Makefile
things, remove part of a comment that’s uninteresting.
@
text
@d278 1
a278 1
reserved word share the shell flags
@


1.8
log
@sync clog
@
text
@d275 6
@


1.7
log
@only lksh now implies unalias for a POSIX function definition (used e.g. in Debian sysvinit scripts that use a “stop” function)
@
text
@d178 1
a178 1
has the following differences from
d198 5
@


1.6
log
@use a perl test for fd-cloexec to avoid testing the tester with the tester; improve fd-cloexec description
@
text
@d259 11
@


1.5
log
@remove the remark that lksh is not suitable for /bin/sh
(as, on some systems and for some pedants, it may be *better* suited
 due to its broken use of the host C “long” data type for arithmetics)
but warn that this can only work with -DMKSH_BINSHPOSIX really
@
text
@d3 1
a3 1
.\" Copyright (c) 2008, 2009, 2010, 2012, 2013
d248 1
a248 2
.Nm lksh ,
unlike
d251 8
a258 1
does not keep file descriptors \*(Gt 2 private.
@


1.5.2.1
log
@sync clog
@
text
@d1 1
a1 1
.\" $MirOS: src/bin/mksh/lksh.1,v 1.5 2013/05/22 18:18:06 tg Exp $
d3 1
a3 1
.\" Copyright (c) 2008, 2009, 2010, 2012, 2013, 2015
d75 1
a75 1
.Dd $Mdocdate: May 22 2013 $
d178 1
a178 1
currently has the following differences from
a197 5
Note that the rest of the version string is identical between
the two shell flavours, and the behaviour and differences can
change between versions; see the accompanying manual page
.Xr mksh 1
for the versions this document applies to.
d248 2
a249 1
Unlike
d252 1
a252 8
.Nm mksh
in
.Fl o Ic posix
or
.Fl o Ic sh
mode and
.Nm lksh
do not keep file descriptors \*(Gt 2 private from sub-processes.
@


1.4
log
@• Allow setting both -o posix and -o sh (although only in the same
  command; setting one still unsets the other at first)
• Change subst_exstat to be conformant unless -o sh is set and -o posix isn’t
• In lksh, make subst_exstat (newly) conformant if -o posix
• New MKSH_BINSHPOSIX to accompany MKSH_BINSHREDUCED
• Sync lksh manpage precisely
@
text
@d1 1
a1 1
.\" $MirOS: src/bin/mksh/lksh.1,v 1.3 2013/04/27 19:16:25 tg Exp $
d75 1
a75 1
.Dd $Mdocdate: April 27 2013 $
a181 4
.Nm
is not suitable for use as
.Pa /bin/sh .
.It
d261 8
@


1.3
log
@sync and be even more explicit

XXX some day, write the *precise* delta of MKSH_LEGACY_MODE into lksh.1
@
text
@d1 1
a1 1
.\" $MirOS: src/bin/mksh/lksh.1,v 1.2 2013/04/27 18:50:24 tg Exp $
d187 1
a187 1
nor any command line editing code.
d203 22
a224 5
Some
.Nm mksh
specific extensions are missing; specifically, the
.Fl T
command-line option.
d226 1
a226 1
Some extensions from other shells, such as
d228 4
a231 2
.Nm bash ,
which
d233 3
a235 1
provides, are missing, for increased compatibility with legacy scripts.
d237 3
a256 21
.It
Integers use the host C environment's
.Vt long
type, not
.Vt int32_t .
Unsigned arithmetic is done using
.Vt unsigned long ,
not
.Vt uint32_t .
Neither value limits nor wraparound is guaranteed.
Dividing the largest negative number by \-1 is Undefined Behaviour
.Po
but might work on 32-bit and 64-bit
.Vt long
types
.Pc .
POSIX, by virtue of including ISO C, makes it legal for code triggering
Undefined Behaviour to remove all your data and crash the system!
.It
.Nm
only offers the traditional ten file descriptors to scripts.
@


1.2
log
@after enough complaints by POSIX sh advocates,
• make parsing numbers with leading digit-zero as octal independent of
  mksh/lksh and dependent on set -o posix; adjust manpages to match
• warn about these changes and why mksh uses 32-bit consistent arithmetics
  and point people to lksh for host-long undefined-behaviour arithmetics
• point out, explicitly, that it is *legal* for the operating environment
  to make 'print $((2147483647 + 1))' (on a 32-bit system; adjust for a
  64-bit system) to run 'rm -rf ~ /' instead
@
text
@d1 1
a1 1
.\" $MirOS: src/bin/mksh/lksh.1,v 1.1 2013/04/27 18:13:58 tg Exp $
d249 2
@


1.1
log
@move mircvs://contrib/hosted/tg/deb/mksh/debian/lksh.1
\ to mircvs://src/bin/mksh/lksh.1
@
text
@d1 1
a1 1
.\" $MirOS: contrib/hosted/tg/deb/mksh/debian/lksh.1,v 1.8 2013/04/26 22:25:47 tg Exp $
d5 15
d75 1
a75 1
.Dd $Mdocdate: April 26 2013 $
d167 1
a167 1
is a command interpreter intended exclusive for running legacy
d172 4
a233 3
.Nm
parses leading-zero numbers as octal (base 8).
.It
a264 7
Parsing numbers with leading zero digits or
.Dq 0x
is relatively recent in all
.Nm pdksh
derivates, but supported here for completeness.
It might make sense to make this a run-time option, but
that might also be overkill.
@

