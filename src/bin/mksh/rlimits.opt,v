head	1.4;
access;
symbols
	mksh-R57:1.3
	mksh-R56c:1.3
	mksh-R56b:1.3
	mksh-R56:1.3
	mksh-R55:1.3
	mksh-R54:1.3
	mksh-R53a:1.3
	mksh-R53:1.3
	mksh-R52c:1.3
	mksh-R52b:1.3
	mksh-R52:1.3
	mksh-R51:1.2
	mksh-R50f:1.1
	mksh-R50e:1.1
	mksh-R50stable:1.1.0.2
	mksh-R50d:1.1
	mksh-R50c:1.1
	mksh-R50b:1.1
	mksh-R50:1.1
	mksh-R49:1.1;
locks; strict;
comment	@# @;


1.4
date	2019.04.24.20.56.31;	author tg;	state Exp;
branches;
next	1.3;
commitid	1005CC0CD7B2A3E9776;

1.3
date	2015.12.12.21.08.44;	author tg;	state Exp;
branches;
next	1.2;
commitid	100566C8CF54F3FF318;

1.2
date	2015.05.01.23.16.31;	author tg;	state Exp;
branches;
next	1.1;
commitid	100554409082C43CC56;

1.1
date	2013.11.17.22.21.18;	author tg;	state Exp;
branches;
next	;
commitid	100528941705C91094F;


desc
@@


1.4
log
@add two more ulimits; rlimits.opt patch and cursory descriptions are
From: Todd C. Miller <Todd.Miller@@sudo.ws>
@
text
@/*-
 * Copyright (c) 2013, 2015
 *	mirabilos <m@@mirbsd.org>
 *
 * Provided that these terms and disclaimer and all copyright notices
 * are retained or reproduced in an accompanying document, permission
 * is granted to deal in this work without restriction, including un-
 * limited rights to use, publicly perform, distribute, sell, modify,
 * merge, give away, or sublicence.
 *
 * This work is provided "AS IS" and WITHOUT WARRANTY of any kind, to
 * the utmost extent permitted by applicable law, neither express nor
 * implied; without malicious intent or gross negligence. In no event
 * may a licensor, author or contributor be held liable for indirect,
 * direct, other damage, loss, or other issues arising in any way out
 * of dealing in the work, even if advised of the possibility of such
 * damage or existence of a defect, except proven that it results out
 * of said person's immediate fault when using the work as intended.
 */

@@RLIMITS_DEFNS
__RCSID("$MirOS: src/bin/mksh/rlimits.opt,v 1.3 2015/12/12 21:08:44 tg Exp $");
@@RLIMITS_ITEMS
#define FN(lname,lid,lfac,lopt) (const struct limits *)(&rlimits_ ## lid),
@@@@

/* generic options for the ulimit builtin */

<a|
<H|
<S|

/* do not use options -H, -S or -a or change the order */

>t|RLIMIT_CPU
FN("time(cpu-seconds)", RLIMIT_CPU, 1

>f|RLIMIT_FSIZE
FN("file(blocks)", RLIMIT_FSIZE, 512

>c|RLIMIT_CORE
FN("coredump(blocks)", RLIMIT_CORE, 512

>d|RLIMIT_DATA
FN("data(KiB)", RLIMIT_DATA, 1024

>s|RLIMIT_STACK
FN("stack(KiB)", RLIMIT_STACK, 1024

>l|RLIMIT_MEMLOCK
FN("lockedmem(KiB)", RLIMIT_MEMLOCK, 1024

>n|RLIMIT_NOFILE
FN("nofiles(descriptors)", RLIMIT_NOFILE, 1

>p|RLIMIT_NPROC
FN("processes", RLIMIT_NPROC, 1

>w|RLIMIT_SWAP
FN("swap(KiB)", RLIMIT_SWAP, 1024

>T|RLIMIT_TIME
FN("humantime(seconds)", RLIMIT_TIME, 1

>V|RLIMIT_NOVMON
FN("vnodemonitors", RLIMIT_NOVMON, 1

>i|RLIMIT_SIGPENDING
FN("sigpending", RLIMIT_SIGPENDING, 1

>q|RLIMIT_MSGQUEUE
FN("msgqueue(bytes)", RLIMIT_MSGQUEUE, 1

>M|RLIMIT_AIO_MEM
FN("AIOlockedmem(KiB)", RLIMIT_AIO_MEM, 1024

>O|RLIMIT_AIO_OPS
FN("AIOoperations", RLIMIT_AIO_OPS, 1

>C|RLIMIT_TCACHE
FN("cachedthreads", RLIMIT_TCACHE, 1

>B|RLIMIT_SBSIZE
FN("sockbufsiz(KiB)", RLIMIT_SBSIZE, 1024

>P|RLIMIT_PTHREAD
FN("threadsperprocess", RLIMIT_PTHREAD, 1

>r|RLIMIT_THREADS
FN("threadsperprocess", RLIMIT_THREADS, 1

>e|RLIMIT_NICE
FN("maxnice", RLIMIT_NICE, 1

>r|RLIMIT_RTPRIO
FN("maxrtprio", RLIMIT_RTPRIO, 1

>m|ULIMIT_M_IS_RSS
FN("resident-set(KiB)", RLIMIT_RSS, 1024
>m|ULIMIT_M_IS_VMEM
FN("memory(KiB)", RLIMIT_VMEM, 1024

>v|ULIMIT_V_IS_VMEM
FN("virtual-memory(KiB)", RLIMIT_VMEM, 1024
>v|ULIMIT_V_IS_AS
FN("address-space(KiB)", RLIMIT_AS, 1024

>x|RLIMIT_LOCKS
FN("filelocks", RLIMIT_LOCKS, 1

|RLIMITS_OPTCS
@


1.3
log
@add explicit licence
@
text
@d22 1
a22 1
__RCSID("$MirOS: src/bin/mksh/rlimits.opt,v 1.2 2015/05/01 23:16:31 tg Exp $");
d89 3
d108 3
@


1.2
log
@sometimes, I feel pretty stupid

separate the backslash+newline things out of the *.opt files,
logically not 100% clean, but better as it is not generated
content anyway (keeping the one-liners in there for now, even
though more consistent would be shifting them out as well)
@
text
@d1 20
d22 1
a22 1
__RCSID("$MirOS: src/bin/mksh/rlimits.opt,v 1.1 2013/11/17 22:21:18 tg Exp $");
@


1.1
log
@more clueful (automatic) getopt string generation
@
text
@d2 1
a2 20
__RCSID("$MirOS: src/bin/mksh/sh_flags.h,v 1.15 2013/07/21 18:47:24 tg Exp $");
struct limits {
	/* limit resource */
	int resource;
	/* multiply by to get rlim_{cur,max} values */
	unsigned int factor;
	/* getopts char */
	char optchar;
	/* limit name */
	char name[1];
};
#define FN(lname,lid,lfac,lopt)				\
	static const struct {				\
		int resource;				\
		unsigned int factor;			\
		char optchar;				\
		char name[sizeof(lname)];		\
	} rlimits_ ## lid = {				\
		lid, lfac, lopt, lname			\
	};
d4 1
a4 2
#define FN(lname,lid,lfac,lopt)				\
	(const struct limits *)(&rlimits_ ## lid),
@

