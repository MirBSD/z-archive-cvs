head	1.8;
access;
symbols
	MIRBSD_10:1.2.0.4
	MIRBSD_10_BASE:1.2
	MIRBSD_9_BASE:1.2
	MIRBSD_8:1.2.0.2
	MIRBSD_8_BASE:1.2;
locks; strict;
comment	@# @;


1.8
date	2017.04.03.14.06.19;	author tg;	state Exp;
branches;
next	1.7;
commitid	10058E256E06C5F6D70;

1.7
date	2017.04.02.21.37.27;	author tg;	state Exp;
branches;
next	1.6;
commitid	10058E16F2E0BAC8521;

1.6
date	2016.10.22.21.57.30;	author tg;	state Exp;
branches;
next	1.5;
commitid	100580BE0D16B029470;

1.5
date	2016.10.22.15.46.02;	author tg;	state Exp;
branches;
next	1.4;
commitid	100580B89CC17F99E32;

1.4
date	2016.10.21.21.21.38;	author tg;	state Exp;
branches;
next	1.3;
commitid	100580A86FB2F9BCEC7;

1.3
date	2016.10.21.21.19.27;	author tg;	state Exp;
branches;
next	1.2;
commitid	100580A86730D1DE72E;

1.2
date	2005.12.05.22.33.23;	author tg;	state Exp;
branches;
next	1.1;
commitid	2de24394c043d01f;

1.1
date	2005.04.19.21.30.32;	author tg;	state Exp;
branches;
next	;


desc
@@


1.8
log
@since we hooked this up and ship it we can’t run check on the all target
(because the posixtz preload isn’t in base)
@
text
@# $MirOS: src/gnu/usr.bin/rcs/getdate/Makefile,v 1.5 2016/10/22 15:46:02 tg Exp $

PROG=		getdate
NOMAN=		yes
CPPFLAGS+=	-DTEST

all: ${PROG}

NEED_RCS_LIB=	No
.include "../Makefile.inc"

CPPFLAGS+=	-I${CVSLIB}

${CVSLIB}/getdate.c:
	@@: avoid running yacc on it

# see mircvs://contrib/code/Snippets/posixtz.c
.if exists(/usr/lib/libposixtz.so)
REGRESS_ENV+=	GETDATE_LD_PRELOAD=/usr/lib/libposixtz.so
.endif

CLEANFILES+=	getdate-expected getdate-got getdate.cmp getdate.log*

check:
	(set +e; env ${REGRESS_ENV} ${SHELL} ${CVSLIB}/test-getdate.sh; \
	    rv=$$?; cat getdate.log; exit $$rv)
	@@echo all OK

.include <bsd.prog.mk>
.PATH.c: ${CVSLIB}
@


1.7
log
@fix dependency/yacc issue…
@
text
@d7 1
a7 1
all: ${PROG} check
@


1.6
log
@with .y in MAIN now we need to copy .c or BSD make freaks out
also, run the testsuite during build, it’s cheap enough
@
text
@d14 2
a15 3
CLEANFILES+=	getdate.c
getdate.c: ${CVSLIB}/getdate.c
	cp ${.ALLSRC} $@@
d30 1
@


1.5
log
@add a target to run the testsuite
@
text
@d1 1
a1 1
# $MirOS: src/gnu/usr.bin/rcs/getdate/Makefile,v 1.4 2016/10/21 21:21:38 tg Exp $
d7 2
d13 4
a16 1
.PATH: ${CVSLIB}
@


1.4
log
@fix
@
text
@d1 1
a1 1
# $MirOS: src/gnu/usr.bin/rcs/getdate/Makefile,v 1.3 2016/10/21 21:19:27 tg Exp $
d13 12
@


1.3
log
@omit -lrcs from getdate(1)
@
text
@d1 1
a1 1
# $MirOS: src/gnu/usr.bin/rcs/getdate/Makefile,v 1.2 2005/12/05 22:33:23 tg Exp $
a3 2
SRCS=
OBJS=		getdate.o
d11 1
a11 2

getdate.o: ${CVSLIB}/getdate.c
@


1.2
log
@cvslib path
@
text
@d1 1
a1 1
# $MirOS: src/gnu/usr.bin/rcs/getdate/Makefile,v 1.1 2005/04/19 21:30:32 tg Exp $
d9 1
@


1.1
log
@sync
@
text
@d1 1
a1 1
# $MirOS: src/gnu/usr.bin/rcs/ci/Makefile,v 1.1.7.1 2005/03/06 17:00:10 tg Exp $
d4 2
d9 6
@

