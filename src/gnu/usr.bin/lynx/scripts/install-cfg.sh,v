head	1.1;
branch	1.1.109;
access;
symbols
	lynx-2_8_8dev_16:1.1.109.3
	lynx-2_8_8dev_15e:1.1.109.3
	lynx-2_8_8dev_15:1.1.109.3
	lynx-2_8_8dev_14:1.1.109.3
	lynx-2_8_8dev_12:1.1.109.3
	lynx-2_8_8dev_11:1.1.109.3
	lynx-2_8_8dev_10a:1.1.109.3
	lynx-2_8_8dev_7a:1.1.109.3
	lynx-2_8_8dev_7:1.1.109.3
	lynx-2_8_7rel_1:1.1.109.3
	lynx-2_8_7dev_12:1.1.109.3
	lynx-2_8_7dev_11a:1.1.109.3
	MIRBSD_10:1.1.109.2.0.2
	MIRBSD_10_BASE:1.1.109.2
	lynx-2_8_7dev_8:1.1.109.2
	lynx-2_8_7dev_7:1.1.109.2
	lynx-2_8_7dev_5:1.1.109.2
	lynx-2_8_7dev_2:1.1.109.2
	lynx-2_8_6pre_5:1.1.109.2
	lynx-2_8_6pre_4:1.1.109.1
	lynx-2_8_6pre_3:1.1.109.1
	MIRBSD_9_BASE:1.1.109.1
	lynx-2_8_6dev_18c:1.1.109.1
	lynx-2_8_6dev_18:1.1.109.1
	lynx:1.1.109;
locks; strict;
comment	@# @;


1.1
date	2006.06.02.23.57.22;	author tg;	state Exp;
branches
	1.1.109.1;
next	;
commitid	1004480D0704B288D75;

1.1.109.1
date	2006.06.02.23.57.22;	author tg;	state Exp;
branches;
next	1.1.109.2;
commitid	1004480D0704B288D75;

1.1.109.2
date	2006.10.02.22.56.24;	author tg;	state Exp;
branches;
next	1.1.109.3;
commitid	100452198D23E36C6DC;

1.1.109.3
date	2008.12.16.23.13.11;	author tg;	state Exp;
branches;
next	;
commitid	100494835F965A87026;


desc
@@


1.1
log
@Initial revision
@
text
@#!/bin/sh
# install lynx.cfg, ensuring the old config-file is saved to a unique file,
# and prepending customizations to the newly-installed file.
#
# $1 = install program
# $2 = file to install
# $3 = where to install it
PRG="$1"
SRC=$2
DST=$3

if test -f "$DST" ; then
	echo "** checking if you have customized $DST"
	OLD=lynx-cfg.old
	NEW=lynx-cfg.new
	TST=lynx-cfg.tst
	TMP=lynx-cfg.tmp
	trap "rm -f $OLD $NEW $TST $TMP; exit 9" 1 2 5 15
	rm -f $OLD $NEW $TST $TMP

	# Make a list of the settings which are in the original lynx.cfg
	# Do not keep the user's HELPFILE setting since we modify that in
	# a different makefile rule.
	egrep '^[ 	]*[A-Za-z]' $SRC |sed -e 's/^[ 	]*HELPFILE:.*/HELPFILE:/' >$TMP
	egrep '^[ 	]*[A-Za-z]' $SRC |fgrep -v -f $TMP >$OLD
	egrep '^[ 	]*[A-Za-z]' $DST |fgrep -v -f $TMP >$TST

	if test -s $TST ; then
		cat >$TMP <<EOF
## The following lines were saved from your previous configuration.

EOF
		cat $TST >>$TMP
		cat $SRC >$NEW
		cat $TMP >>$NEW

		# See if we have saved this information before (ignoring the
		# HELPFILE line).
		if cmp -s $NEW $OLD
		then
			echo "... installed $DST would not be changed"
		else
			NUM=1
			while test -f ${DST}-${NUM}
			do
				if cmp -s $NEW ${DST}-${NUM}
				then
					break
				fi
				NUM=`expr $NUM + 1`
			done
			if test ! -f ${DST}-${NUM}
			then
				echo "... saving old config as ${DST}-${NUM}"
				mv $DST ${DST}-${NUM} || exit 1
			fi
			echo "** installing $NEW as $DST"
			eval $PRG $NEW $DST || exit 1
		fi
	else
		echo "... no customizations found"
		echo "** installing $SRC as $DST"
		eval $PRG $SRC $DST || exit 1
	fi
	rm -f $SKIP $OLD $NEW $TST $TMP
elif cmp -s $SRC $DST
then
	echo "... installed $DST would not be changed"
else
	echo "** installing $SRC as $DST"
	eval $PRG $SRC $DST || exit 1
fi
@


1.1.109.1
log
@apparently, these are needed in current lynx :(
@
text
@@


1.1.109.2
log
@Update to lynx 2.8.6pre.5
This is a required update, because earlier versions contain some
non-free, non-redistributable files!
@
text
@a20 8
	# avoid propagating obsolete URLs into new installs
	echo lynx.browser.org >$TMP
	echo www.trill-home.com >>$TMP
	echo www.cc.ukans.edu >>$TMP
	echo www.ukans.edu >>$TMP
	echo www.slcc.edu >>$TMP
	echo sol.slcc.edu >>$TMP

d24 1
a24 1
	egrep '^[ 	]*[A-Za-z]' $SRC |sed -e 's/^[ 	]*HELPFILE:.*/HELPFILE:/' >>$TMP
@


1.1.109.3
log
@Import Lynx 2.8.7dev.11a via eMail from Tom Dickey:
Message-ID: <20081215010313.GA8373@@invisible-island.net>
Message-ID: <20081216012408.GA15364@@invisible-island.net>
@
text
@a1 1
# $LynxId: install-cfg.sh,v 1.3 2008/09/10 13:15:35 tom Exp $
a11 5
LANG=C;		export LANG
LC_ALL=C;	export LC_ALL
LC_CTYPE=C;	export LC_CTYPE
LANGUAGE=C;	export LANGUAGE

@


