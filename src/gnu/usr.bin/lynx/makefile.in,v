head	1.14;
access;
symbols
	lynx-2_8_8dev_16:1.1.109.15
	lynx-2_8_8dev_15e:1.1.109.14
	lynx-2_8_8dev_15:1.1.109.13
	lynx-2_8_8dev_14:1.1.109.12
	lynx-2_8_8dev_12:1.1.109.11
	lynx-2_8_8dev_11:1.1.109.10
	lynx-2_8_8dev_10a:1.1.109.9
	lynx-2_8_8dev_7a:1.1.109.7
	lynx-2_8_8dev_7:1.1.109.7
	lynx-2_8_7rel_1:1.1.109.6
	lynx-2_8_7dev_12:1.1.109.6
	lynx-2_8_7dev_11a:1.1.109.6
	MIRBSD_10:1.2.0.2
	MIRBSD_10_BASE:1.2
	lynx-2_8_7dev_8:1.1.109.5
	lynx-2_8_7dev_7:1.1.109.5
	lynx-2_8_7dev_5:1.1.109.5
	lynx-2_8_7dev_2:1.1.109.4
	lynx-2_8_6pre_5:1.1.109.3
	lynx-2_8_6pre_4:1.1.109.3
	lynx-2_8_6pre_3:1.1.109.3
	MIRBSD_9_BASE:1.1.109.2
	lynx-2_8_6dev_18c:1.1.109.2
	lynx-2_8_6dev_18:1.1.109.2
	MIRBSD_8:1.1.109.1.0.2
	MIRBSD_8_BASE:1.1.109.1
	lynx-2_8_6dev_16:1.1.109.1
	lynx:1.1.109;
locks; strict;
comment	@# @;


1.14
date	2015.09.29.21.56.54;	author tg;	state Exp;
branches;
next	1.13;
commitid	100560B093E5AF326EC;

1.13
date	2015.09.29.21.48.00;	author tg;	state Exp;
branches;
next	1.12;
commitid	100560B071331070784;

1.12
date	2013.08.06.20.42.54;	author tg;	state Exp;
branches;
next	1.11;
commitid	10052015FDA30F39400;

1.11
date	2013.05.18.14.59.31;	author tg;	state Exp;
branches;
next	1.10;
commitid	1005197975F6A2B23A5;

1.10
date	2012.12.31.21.19.42;	author tg;	state Exp;
branches;
next	1.9;
commitid	10050E2017B122CED3C;

1.9
date	2012.08.23.18.36.04;	author tg;	state Exp;
branches;
next	1.8;
commitid	1005036781D23C1E744;

1.8
date	2012.03.03.18.41.30;	author tg;	state Exp;
branches;
next	1.7;
commitid	1004F5265E717A6953D;

1.7
date	2012.02.20.02.54.32;	author tg;	state Exp;
branches;
next	1.6;
commitid	1004F41B5FA50E82A6E;

1.6
date	2012.02.19.19.37.51;	author tg;	state Exp;
branches;
next	1.5;
commitid	1004F414F917991F461;

1.5
date	2011.12.18.04.53.29;	author tg;	state Exp;
branches;
next	1.4;
commitid	1004EED71D23F6FA4F2;

1.4
date	2010.12.19.19.22.22;	author tg;	state Exp;
branches;
next	1.3;
commitid	1004D0E5B7B7150A62A;

1.3
date	2008.12.16.23.27.07;	author tg;	state Exp;
branches;
next	1.2;
commitid	1004948395D7D988D96;

1.2
date	2007.05.20.11.10.34;	author tg;	state Exp;
branches;
next	1.1;
commitid	10046502C7E7F8B3225;

1.1
date	2005.03.27.22.11.54;	author tg;	state Exp;
branches
	1.1.109.1;
next	;

1.1.109.1
date	2005.03.27.22.11.54;	author tg;	state Exp;
branches;
next	1.1.109.2;

1.1.109.2
date	2006.06.02.19.16.47;	author tg;	state Exp;
branches;
next	1.1.109.3;
commitid	10044808E727319C3F7;

1.1.109.3
date	2006.09.13.19.11.24;	author tg;	state Exp;
branches;
next	1.1.109.4;
commitid	100450857B406EB1869;

1.1.109.4
date	2006.11.10.20.04.53;	author tg;	state Exp;
branches;
next	1.1.109.5;
commitid	1004554DB4E3D3CA612;

1.1.109.5
date	2007.05.19.22.29.32;	author tg;	state Exp;
branches;
next	1.1.109.6;
commitid	100464F7A1519624932;

1.1.109.6
date	2008.12.16.23.13.03;	author tg;	state Exp;
branches;
next	1.1.109.7;
commitid	100494835F965A87026;

1.1.109.7
date	2010.12.19.18.12.39;	author tg;	state Exp;
branches;
next	1.1.109.8;
commitid	1004D0E4B24304015D1;

1.1.109.8
date	2011.12.18.04.50.13;	author tg;	state Exp;
branches;
next	1.1.109.9;
commitid	1004EED71133F1D38BA;

1.1.109.9
date	2012.02.19.18.28.12;	author tg;	state Exp;
branches;
next	1.1.109.10;
commitid	1004F413EF328BF0E26;

1.1.109.10
date	2012.02.20.02.48.50;	author tg;	state Exp;
branches;
next	1.1.109.11;
commitid	1004F41B47B3CD46F18;

1.1.109.11
date	2012.03.03.17.34.10;	author tg;	state Exp;
branches;
next	1.1.109.12;
commitid	1004F52560E10C1B66B;

1.1.109.12
date	2012.08.23.17.47.40;	author tg;	state Exp;
branches;
next	1.1.109.13;
commitid	10050366CBF479FD80F;

1.1.109.13
date	2012.12.31.21.09.38;	author tg;	state Exp;
branches;
next	1.1.109.14;
commitid	10050E1FF02228195F0;

1.1.109.14
date	2013.05.18.14.43.55;	author tg;	state Exp;
branches;
next	1.1.109.15;
commitid	100519793BB3FCC7E2F;

1.1.109.15
date	2013.08.06.20.31.28;	author tg;	state Exp;
branches;
next	;
commitid	10052015D37118B3894;


desc
@@


1.14
log
@fixup and some XXX
@
text
@# $LynxId: makefile.in,v 1.125 2012/08/12 23:54:35 tom Exp $
##makefile for lynx

SHELL		= @@CONFIG_SHELL@@
CDPATH		= .

.SUFFIXES:
@@SET_MAKE@@
prefix		= @@prefix@@
exec_prefix	= @@exec_prefix@@
top_srcdir	= @@top_srcdir@@
srcdir		= @@srcdir@@
builddir	= .
VPATH		= $(srcdir)

CC		= @@CC@@
CFLAGS		= @@CFLAGS@@
DEFS		= @@DEFS@@
CPPFLAGS	= @@CPPFLAGS@@
LINT		= @@LINT@@
ETAGS		= @@ETAGS@@

x		= @@EXEEXT@@
o		= .@@OBJEXT@@

LDFLAGS		= @@EXTRA_LDFLAGS@@ @@LDFLAGS@@
LIBS		= @@LIBS@@

INSTALL		= @@INSTALL@@
INSTALL_PROGRAM	= @@INSTALL_PROGRAM@@
INSTALL_DATA	= @@INSTALL_DATA@@
transform	= @@program_transform_name@@

LN_S		= @@LN_S@@

TAR		= @@TAR@@
TAR_UP		= $(TAR) @@TAR_UP_OPTIONS@@ @@TAR_PIPE_OPTIONS@@
TAR_DOWN	= $(TAR) @@TAR_DOWN_OPTIONS@@ @@TAR_PIPE_OPTIONS@@

# $Format: "LYNX_VERSION	= $ProjectVersion$"$
LYNX_VERSION	= 2.8.8dev.16

## This is the version which we are developing (or, upon release, make this
## the same).  Use no dots in the name, since it must work on VMS and MS-DOS.
VERSION		= 2-8-8

##this is the name of the directory the lynx source code is in.
##(e.g., lynx2-8-7, not the full path)
lynxdir= lynx$(VERSION)
lynxname= lynx$(VERSION)

## The 'DESTDIR' variable allows you to install the program into a different
## location, e.g., for packaging, without affecting the compiled-in pathnames.
DESTDIR= @@DESTDIR@@

## Where you want lynx installed
bindir= @@bindir@@
BINDIR= $(DESTDIR)$(bindir)

## Where you want the lynx man file installed
mandir= @@mandir@@/man1
MANDIR= $(DESTDIR)$(mandir)

## Where you want the lynx.cfg file installed
sysconfdir= @@sysconfdir@@
SYSCONFDIR= $(DESTDIR)$(sysconfdir)

## Where you want the doc-files installed
datarootdir= @@datarootdir@@
docdir    = @@datadir@@/lynx_doc
DOCDIR    = $(DESTDIR)$(docdir)

## Where you want the help-files installed
helpdir   = @@datadir@@/lynx_help
HELPDIR   = $(DESTDIR)$(helpdir)

##set the relative location of the WWW library Implementation directory,
##from this directory
##do not set this to be an absolute path!!!
WWW_DIR   = $(builddir)/WWW/Library/Implementation

##set the relative location of the message-file directory
##do not set this to be an absolute path!!!
PO_DIR    = $(builddir)/po
PO_SRCDIR = $(srcdir)/po

##set the relative location of the main source-directory
##do not set this to be an absolute path!!!
SRC_DIR   = $(builddir)/src

##set the relative location of the character-translation data directory
##do not set this to be an absolute path!!!
CHR_DIR   = $(SRC_DIR)/chrtrans

## Path to gzip that will compress the help files.
## It will be used when --enable-gzip-help is set by configure.
## Leave *both* empty if you don't want to gzip help files.
COMPRESS_PROG=@@COMPRESS_PROG@@
COMPRESS_EXT=@@COMPRESS_EXT@@

# Path of scripts directory
scripts_dir=$(srcdir)/scripts

MAKE_RECUR = $(MAKE) @@cf_cv_makeflags@@ DESTDIR="$(DESTDIR)" CC="$(CC)"

@@LYNXCFG_MAKE@@CFG2HTML = alphatoc.html body.html cattoc.html

# !!!!!!!!!!! SUN resolv LIBRARY !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
# To include resolv in the LIBS="" list for SUN 3, 4 or Solaris OS,
# point RESOLVLIB to that library.  You need this if you get the message
# "Alert!:  Unable to connect to remote host" whenever you try to
# access a host other than localhost and have made Lynx without it.
# See the PROBLEMS file for more information.
#RESOLVLIB= -lresolv

# !!!!!!!!!!!!!  DIRECT WAIS ACCESS !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
# If you are adding direct wais access you must fill in the
# location of wais.a, client.a and the standard math library, libm.a.
# You can pick up the most current freeWAIS sources from
#	ftp://ftp.cnidr.org/pub/NIDR.tools/freewais
# If you are using freeWAIS-0.202 or older, include -DDECLARE_WAIS_LOGFILES
# in your SITE_DEFS.
# Please put an ABSOLUTE address here if you want it to work!
#WAISLIB= ../../freeWAIS-0.202/bin/client.a ../../freeWAIS-0.202/bin/wais.a /usr/lib/libm.a

# !!!!!!!!!!!!! SLANG Support (For color version of Lynx). !!!!!!!!!!!!!!!!
# The slang library is an alternative to curses, developed by John E. Davis
# (davis@@space.mit.edu).  Version 0.99-27 or higher is available from
#	ftp://space.mit.edu/pub/davis
# It provides color support for Lynx.

# !!!!!!!!!!!!! NCURSES Support (For color version of Lynx). !!!!!!!!!!!!!!
# If you need ncurses, the latest version can always be found
# in ftp://invisible-island.net/ncurses/
# or ftp://ftp.gnu.org/pub/gnu/

# Also be sure to check out the compilation symbols in userdefs.h
# before building Lynx!

# If you apply patches which require linking to site-specific libraries, set
# SITE_LIBS to those libraries.
SITE_LIBS= # Your libraries here

# Set SITE_LYDEFS to one or more of the defines for the WWW Library:
SITE_LYDEFS = # Your defines here

# Set SITE_DEFS to one or more of the defines for lynx below:
SITE_DEFS = # Your defines here

# defines for which there are no configure options:
# -DHP_TERMINAL    For DIM workaround to REVERSE problems on HP terminals.
# -DIGNORE_CTRL_C  Define if Control-C shouldn't exit lynx.
# -DNO_RULES       Disables CERN-style access rules (see lynx.cfg).
# -DMISC_EXP       Enable some truly experimental stuff
# -DSHORTENED_RBIND  For a SOCKSified lynx with the short version of Rbind.
# -DSLANG_MBCS_HACK prevent cutoff lines when using UTF8 console (slang only)
# -DUSE_VASPRINT   Use vasprintf() function
#
# if you are linking to freeWAIS-0.202 or older, you should define this
# in SITE_DEFS
#
# -DDECLARE_WAIS_LOGFILES
#
# if you have the reverse clear screen problem of some SUN4 systems you
# should define this in SITE_DEFS
#
# -DREVERSE_CLEAR_SCREEN_PROBLEM
#
# if you have an SVR4 system with the "type any key" problem, try defining
# this in LYFLAGS (SITE_LYDEFS) and SITE_DEFS
#
# -DSVR4_BSDSELECT
#
# Old Data General systems may need this in their SITE_LYDEFS
# for their inet_addr(host) calls.
#
# -DDGUX_OLD

# Many other defines have configure options  (see INSTALLATION, Section II-1c.):
#
# for installation of local execution links, please see the file userdefs.h

WWW_CFLAGS = \
	LY_CFLAGS=${CFLAGS:Q} \
	CPPFLAGS=${CPPFLAGS:Q} \
	LYFLAGS="$(SITE_LYDEFS)"

SRC_CFLAGS = \
	CFLAGS=${CFLAGS:Q} \
	CPPFLAGS=${CPPFLAGS:Q} \
	LDFLAGS=${LDFLAGS:Q} \
	LIBS="$(LIBS) $(RESOLVLIB) $(WAISLIB) $(SITE_LIBS)" \
	SITE_DEFS="$(SITE_DEFS)" \
	WWWINC=$(WWW_DIR) \
	WWWLIB="../$(WWW_DIR)/libwww.a"

actual_PROG  = `echo lynx|    sed '$(transform)'`
binary_PROG  = $(actual_PROG)$x

all lynx$x: cfg_defs.h LYHelp.h
@@MSG_DIR_MAKE@@	$(SHELL) $(scripts_dir)/fixtext.sh $(srcdir)/LYMessages_en.h >LYMessages.c
@@MSG_DIR_MAKE@@	cd $(PO_DIR) && $(MAKE_RECUR)
	cd $(WWW_DIR) && $(MAKE_RECUR) $(WWW_CFLAGS)
	cd $(SRC_DIR) && $(MAKE_RECUR) all $(SRC_CFLAGS)

lint:
	cd $(WWW_DIR) && $(MAKE_RECUR) LINT="$(LINT)" $(WWW_CFLAGS) $@@
	cd $(SRC_DIR) && $(MAKE_RECUR) LINT="$(LINT)" $(SRC_CFLAGS) $@@
	cd $(CHR_DIR) && $(MAKE_RECUR) LINT="$(LINT)" $@@

tags:
	cd $(WWW_DIR) && $(MAKE_RECUR) $(WWW_CFLAGS) $@@
	cd $(SRC_DIR) && $(MAKE_RECUR) $(SRC_CFLAGS) $@@
	cd $(CHR_DIR) && $(MAKE_RECUR) $@@

etags:
	$(ETAGS) *.[ch] */*.[ch] */*/*.[ch] */*/*/*.[ch]

help:
	@@echo
	@@echo "Please run make with one of the following arguments"
	@@echo "all        -- to make the executable, put it in this directory"
	@@echo "clean      -- removes all '$o' and 'core' files"
	@@echo "depend     -- use makedepend to generate header-dependencies"
	@@echo "tar        -- runs clean, removes executable, and tars the whole directory"
	@@echo "compress   -- runs tar, then compresses the result"
	@@echo "zip        -- runs clean, removes executable, and zips the whole directory"
	@@echo

##Miscellaneous actions
clean:
	rm -f WWW/Library/*/*.[aoib]
	rm -f WWW/Library/*/.created
	cd $(WWW_DIR) && $(MAKE_RECUR) $@@
	cd $(SRC_DIR) && $(MAKE_RECUR) $@@
@@MSG_DIR_MAKE@@	rm -f LYMessages.c
@@MSG_DIR_MAKE@@	cd $(PO_DIR) && $(MAKE_RECUR) $@@
	rm -f *.b $(SRC_DIR)/lynx$x *.leaks cfg_defs.h LYHelp.h lint.*
@@LYNXCFG_MAKE@@	-rm -f $(CFG2HTML)
	rm -f help_files.sed
	rm -f core *.core

depend: cfg_defs.h LYHelp.h
	cd $(WWW_DIR) && $(MAKE_RECUR) $@@
	cd $(SRC_DIR) && $(MAKE_RECUR) $@@

distclean: clean
	-rm -f WWW/Library/*/*~
	-rm -f WWW/Library/*/*.bak
	-rm -rf $(SRC_DIR)/obsolete
	-cd $(WWW_DIR) && $(MAKE_RECUR) $@@
	-cd $(SRC_DIR) && $(MAKE_RECUR) $@@
	-cd $(CHR_DIR) && $(MAKE_RECUR) $@@
@@MSG_DIR_MAKE@@	cd $(PO_DIR) && $(MAKE_RECUR) $@@
@@MSG_DIR_MAKE@@	-rmdir $(PO_DIR)
	-rm -f *~ *.bak *.sav tags TAGS
	-rm -f $(WWW_DIR)/makefile $(SRC_DIR)/makefile $(CHR_DIR)/makefile
@@SRCDIR_CLEAN@@	-rmdir $(WWW_DIR) && rmdir WWW/Library && rmdir WWW
@@SRCDIR_CLEAN@@	-rmdir $(CHR_DIR) && rmdir $(SRC_DIR)
	-rm -f makefile lynx_cfg.h config.status config.log config.cache
	-rm -f lynx$x

maintainer-clean: distclean
	-find . -type f -name '*.rej' -exec rm -f {} \;
	-find . -type f -name '*.orig' -exec rm -f {} \;
	-rm -rf WWW/Library/*/obsolete
	-rm -f Lynx.prj .*_aux

tar:  clean
	rm -f lynx$x
	$(MAKE) save

turnover:	clean
	$(MAKE) save

zipcompress: compress zip
	echo "done!"

zip:  clean
	rm -f $(SRC_DIR)/lynx$x
	rm -f lynx$x
	rm -f $(SRC_DIR)/a.out
	rm -f ../$(lynxname).zip
	cd ..; rm -f $(lynxname).zip; zip -r $(lynxname).zip $(lynxdir)

save:
	cd ..; rm -f $(lynxname).tar; $(TAR_UP) $(lynxdir) > $(lynxname).tar

compress: tar
	cd ..; rm -f $(lynxname).tar.Z; compress -f -v $(lynxname).tar

# Directory containing reference source for patch generation,
#     either absolute or relative to $(top_srcdir)/..
REFDIR=orig/$(lynxdir)

lynx.patch: $(top_srcdir) $(top_srcdir)/CHANGES
	- cd $(top_srcdir)/.. && cd $(REFDIR) && { rm -f \
		config.log \
		config.status \
		lynx_cfg.h \
			; \
		for I in . $(SRC_DIR) $(WWW_DIR); do ( set +e; \
			( set -x; cd $$I && rm -f *.orig *.rej makefile ); : ); \
		done; }
	( cd $(top_srcdir)/..; echo "%%% Created `date` by target $@@. %%%"; \
	   if diff -bru /dev/null /dev/null;		     \
		   then diff -bru $(REFDIR) $(lynxdir);	     \
		   else diff -brc $(REFDIR) $(lynxdir); fi ) \
		| grep -v '^Common' \
		| grep -v '^Binary files ' \
		| grep -v '^Only ' | tee $@@ | egrep '^\-\-\- .*$(lynxdir)'

install: install-bin install-man install-cfg @@INSTALL_LSS@@
	@@echo
	@@echo "Use $(MAKE) install-help to install the help-files"
	@@echo "Use $(MAKE) install-doc to install extra documentation files"
	@@echo

install-full: install install-help install-doc
	@@echo Full installation complete.

install-bin: $(BINDIR) lynx$x
@@MSG_DIR_MAKE@@	cd $(PO_DIR) && $(MAKE_RECUR) install
	@@ECHO_CC@@$(SHELL) -c \
	'if test -f $(BINDIR)/$(binary_PROG) ; then \
	      mv -f $(BINDIR)/$(binary_PROG) $(BINDIR)/lynx.old; fi'
	$(INSTALL_PROGRAM) lynx$x $(BINDIR)/$(binary_PROG)

install-man : $(MANDIR)
	$(INSTALL_DATA) $(srcdir)/lynx.man $(MANDIR)/$(actual_PROG).1

install-doc : $(DOCDIR) $(HELPDIR)
	@@echo Copying sample files
	(cd $(srcdir) && $(TAR_UP) C[HO]* PROBLEMS README docs samples test ) | \
			       ( cd $(DOCDIR) && chmod -R u+w . && $(TAR_DOWN) )
	$(SHELL) -c 'if test "$(COMPRESS_PROG)" != "" ; then \
		(cd $(DOCDIR) && $(COMPRESS_PROG) -f docs/CHANGES*.[0-9] docs/*.announce ) \
	fi'
	$(SHELL) -c 'for name in COPYING COPYHEADER; do \
		cd $(HELPDIR) && rm -f $$name ;\
		cd $(HELPDIR) && ( $(LN_S) $(docdir)/$$name . || cp $(DOCDIR)/$$name . );\
		done'
	-$(SHELL) -c 'case `id|sed -e "s/(.*//"` in uid=0) chown -R root $(DOCDIR);; esac'

# HPUX 'sed' does not seem to like '=' as pattern delimiter.
# We cannot use '%' because it may appear in a URL.
# Andrew filesystem uses '@@'.
# So we limit sed delimiters to '!' and '%', depending on the expected text.
FIX_SED = tr '=' '"'

LYNX_URL='http://lynx.invisible-island.net/lynx2.8.7'
LYNXDOCS_URL='http://lynx.isc.org/release/lynx2-8-7/docs/'	#XXX
LYNXHELP_URL='http://lynx.invisible-island.net/lynx_help/'

@@LYNXCFG_MAKE@@$(CFG2HTML) :
@@LYNXCFG_MAKE@@	@@echo 'Making htmlized lynx.cfg'
@@LYNXCFG_MAKE@@	cd $(SRC_DIR) && $(MAKE_RECUR) LYReadCFG.i
@@LYNXCFG_MAKE@@	@@-rm -f $(CFG2HTML)
@@LYNXCFG_MAKE@@	sed -n -e '/Config_Type  *Config_Table/,/{0, *0, *0}/ p' $(SRC_DIR)/LYReadCFG.i | \
@@LYNXCFG_MAKE@@	sed  -e 's/ *{ *"\([^"]*\)".*/\1/' | \
@@LYNXCFG_MAKE@@	perl $(scripts_dir)/cfg2html.pl -ams $(srcdir)/lynx.cfg
@@LYNXCFG_MAKE@@	-rm -f $(SRC_DIR)/LYReadCFG.i

help_files.sed : makefile $(srcdir)/lynx_help/help_files.txt
	@@echo Constructing sed-script $@@
	@@-rm -f $@@ help_files.tmp
	@@cat $(srcdir)/lynx_help/help_files.txt > help_files.tmp
@@LYNXDOC_MAKE@@	@@ECHO_CC@@echo 's!$(LYNXDOCS_URL)!file://$(docdir)!g' >> help_files.tmp
@@LYNXCFG_MAKE@@	@@ECHO_CC@@echo 's!$(LYNXHELP_URL)alphatoc.html!alphatoc.html!g' >> help_files.tmp
@@LYNXCFG_MAKE@@	@@ECHO_CC@@echo 's!$(LYNXHELP_URL)cattoc.html!cattoc.html!g' >> help_files.tmp
@@LYNXCFG_MAKE@@	@@ECHO_CC@@echo 's!alphatoc\.html!alphatoc.html$(COMPRESS_EXT)!g' >> help_files.tmp
@@LYNXCFG_MAKE@@	@@ECHO_CC@@echo 's!cattoc\.html!cattoc.html$(COMPRESS_EXT)!g' >> help_files.tmp
@@LYNXCFG_MAKE@@	@@ECHO_CC@@echo 's!body\.html!body.html$(COMPRESS_EXT)!g' >> help_files.tmp
	@@ECHO_CC@@sed	-e '/^#/d' -e '/^$$/d' \
		-e 's%\(.*\)=\(.*\@@.*\)$$%s=@@\1@@=\2=g%' \
		-e 's%\(.*\)=\(http:.*\)$$%s=@@\1@@=\2=g%' \
		-e 's%\(.*\)=\(ftp:.*\)$$%s=@@\1@@=\2=g%' \
		-e 's%\(.*\)=\(.*\.html\)$$%s=@@\1@@=\2$(COMPRESS_EXT)=g%' \
		help_files.tmp | $(FIX_SED) > $@@
	@@echo Appending interim-fix for existing html files to $@@
	@@ECHO_CC@@sed	-e '/^#/d' -e '/[:@@]/d' -e '/^$$/d' \
		-e 's%\(.*\)=\(.*\.html\)$$%s=\2=\2$(COMPRESS_EXT)=g%' \
		-e 's%\.html=%\\.html=%' \
		help_files.tmp | $(FIX_SED) >> $@@
	@@ECHO_CC@@if test -n "$(COMPRESS_EXT)"; then echo 's%\$(COMPRESS_EXT)\$(COMPRESS_EXT)%$(COMPRESS_EXT)%g' >> $@@; fi
	@@-rm -f help_files.tmp

install-help : $(CFG2HTML) help_files.sed $(HELPDIR)
	-$(SHELL) -c 'if cd "$(HELPDIR)" ; then \
		WD=`pwd` ; \
		TAIL=`basename "$(helpdir)"` ; \
		HEAD=`echo "$$WD"|sed -e "s,/$${TAIL}$$,,"` ; \
		test "x$$WD" != "x$$HEAD" && rm -fr * ; \
		fi'
	test -d $(HELPDIR)/keystrokes || mkdir $(HELPDIR)/keystrokes
	@@echo Translating/copying html files
@@LYNXCFG_MAKE@@	@@$(SHELL) -c 'for f in $(CFG2HTML) ; do \
@@LYNXCFG_MAKE@@		sed -f help_files.sed $$f > $(HELPDIR)/$$f ; \
@@LYNXCFG_MAKE@@		done'
	@@ECHO_CC@@$(SHELL) -c 'sed_prog=`pwd`/help_files.sed && \
		cd $(srcdir)/lynx_help && \
		dirs=keystrokes && \
		files="*.html */*.html" && \
		for f in $$files ; do \
			sed -f $$sed_prog $$f > $(HELPDIR)/$$f ; \
		done && \
		if test "$(COMPRESS_PROG)" != "" ; then \
			(cd $(HELPDIR) && $(COMPRESS_PROG) $$files ) \
		fi'
	@@echo Updating $(sysconfdir)/lynx.cfg
	@@ECHO_CC@@$(SHELL) -c \
	'if test -f $(SYSCONFDIR)/lynx.cfg ; then \
		mv $(SYSCONFDIR)/lynx.cfg $(SYSCONFDIR)/lynx.tmp ; \
	else \
		cp $(srcdir)/lynx.cfg $(SYSCONFDIR)/lynx.tmp ; \
	fi'
	@@echo Updating $(sysconfdir)/lynx.cfg to point to installed help-files
	@@ECHO_CC@@sed	-e '/^HELPFILE:http/s!^!#!' \
		-e '/^#HELPFILE:file/s!#!!' \
		$(SYSCONFDIR)/lynx.tmp | \
	$(SHELL) $(scripts_dir)/cfg_path.sh lynx_help $(helpdir) | \
	$(SHELL) $(scripts_dir)/cfg_path.sh lynx_doc  $(helpdir) | \
	sed	-e '/^HELPFILE:file/s!$$!$(COMPRESS_EXT)!' \
		-e '/^HELPFILE:file/s!$(COMPRESS_EXT)$(COMPRESS_EXT)$$!$(COMPRESS_EXT)!' \
		>$(SYSCONFDIR)/lynx.cfg
	chmod 644 $(SYSCONFDIR)/lynx.cfg
	-rm -f $(SYSCONFDIR)/lynx.tmp

LYHelp.h : help_files.sed $(srcdir)/LYHelp.hin
	@@echo Creating $@@
	@@sed -f help_files.sed $(srcdir)/LYHelp.hin > $@@
	@@echo '**********************************************'
	@@echo
	@@$(SHELL) -c 'if test "$(COMPRESS_PROG)" = "" ; then \
		echo "       Help files will NOT be gzipped."; \
	else \
		echo "       Help links point to compressed files"; \
		echo "       To access them properly you have to type"; \
		echo "                 make install-help"; \
	fi'
	@@echo
	@@echo '**********************************************'

cfg_defs.h : $(scripts_dir)/cfg_defs.sh $(scripts_dir)/cfg_edit.sh config.cache lynx_cfg.h
	@@rm -f $@@
	$(SHELL) -c 'SHELL=$(SHELL) $(SHELL) $(scripts_dir)/cfg_defs.sh $(srcdir)'

install-cfg : $(SYSCONFDIR)
	@@$(SHELL) $(scripts_dir)/install-cfg.sh "$(INSTALL_DATA)" $(srcdir)/lynx.cfg $(SYSCONFDIR)/lynx.cfg

install-lss : $(SYSCONFDIR)
	@@$(SHELL) $(scripts_dir)/install-lss.sh "$(INSTALL_DATA)" $(srcdir)/samples/lynx.lss $(SYSCONFDIR)/lynx.lss

uninstall ::
@@MSG_DIR_MAKE@@	cd $(PO_DIR) && $(MAKE_RECUR) uninstall
	-rm -f $(BINDIR)/$(binary_PROG)
	-rm -f $(MANDIR)/$(actual_PROG).1
	-rm -f $(SYSCONFDIR)/lynx.cfg
	-rm -f $(SYSCONFDIR)/lynx.lss

uninstall \
uninstall-help ::
	-$(SHELL) -c 'if test -d "$(HELPDIR)" ; then \
		WD=`cd "$(HELPDIR)" && pwd` ; \
		TAIL=`basename "$(helpdir)"` ; \
		HEAD=`echo "$$WD"|sed -e "s,/$${TAIL}$$,,"` ; \
		test "x$$WD" != "x$$HEAD" && rm -rf "$(HELPDIR)"; \
		fi'

uninstall \
uninstall-doc ::
	-$(SHELL) -c 'if test -d "$(DOCDIR)" ; then \
		WD=`cd "$(DOCDIR)" && pwd` ; \
		TAIL=`basename "$(docdir)"` ; \
		HEAD=`echo "$$WD"|sed -e "s,/$${TAIL}$$,,"` ; \
		test "x$$WD" != "x$$HEAD" && rm -rf "$(DOCDIR)"; \
		fi'
	-$(SHELL) -c 'if test -d "$(HELPDIR)" ; then \
		WD=`cd "$(HELPDIR)" && pwd` ; \
		TAIL=`basename "$(helpdir)"` ; \
		HEAD=`echo "$$WD"|sed -e "s,/'$${TAIL}'$$,,"` ; \
		test "x$$WD" != "x$$HEAD" ; \
		cd "$(HELPDIR)" && rm -f COPYING COPYHEADER ; \
		fi'

update-po:
	rsync -Lrtvz  translationproject.org::tp/latest/lynx/  $(PO_SRCDIR)
	test -f $(PO_SRCDIR)/makefile && cd $(PO_SRCDIR) && $(MAKE_RECUR) $@@

preinstall :
	@@ echo ''
	@@ echo '** Configuration summary for LYNX $(LYNX_VERSION):'
	@@ echo ''
	@@ echo '       program name: '$(actual_PROG)
	@@ echo ''
	@@ echo '      bin directory: '$(BINDIR)
	@@ echo '   config directory: '$(SYSCONFDIR)
	@@ echo '      man directory: '$(MANDIR)
	@@ echo '     help directory: '$(HELPDIR)
	@@ echo '      doc directory: '$(DOCDIR)

$(BINDIR) \
$(MANDIR) \
$(SYSCONFDIR) \
$(HELPDIR) \
$(DOCDIR) :
	mkdir -p $@@
@


1.13
log
@ISC.org is making themselves even more irrelevant: new Lynx homepage
@
text
@d352 2
a353 2
LYNXDOCS_URL='$(LYNX_URL)/docs/'
LYNXHELP_URL='$(LYNX_URL)/lynx_help/'
@


1.12
log
@fastmerge
@
text
@d351 1
a351 1
LYNX_URL='http://lynx.isc.org/release/lynx2-8-7'
@


1.11
log
@fastmerge
@
text
@d41 1
a41 1
LYNX_VERSION	= 2.8.8dev.15e
@


1.10
log
@fastmerge
@
text
@d41 1
a41 1
LYNX_VERSION	= 2.8.8dev.15
@


1.9
log
@fastmerge
@
text
@d41 1
a41 1
LYNX_VERSION	= 2.8.8dev.14
@


1.8
log
@update port and base to Lynx 2.8.8dev.12
@
text
@d1 1
a1 1
# $LynxId: makefile.in,v 1.118 2011/06/12 18:36:28 tom Exp $
d26 1
d41 1
a41 1
LYNX_VERSION	= 2.8.8dev.12
d69 1
d104 1
a104 1
MAKE_RECUR = $(MAKE) DESTDIR="$(DESTDIR)" CC="$(CC)"
d191 1
@


1.7
log
@fastmerge
@
text
@d40 1
a40 1
LYNX_VERSION	= 2.8.8dev.11
@


1.6
log
@merge lynx2.8.8dev.10a and fix some spelling
@
text
@d40 1
a40 1
LYNX_VERSION	= 2.8.8dev.10
@


1.5
log
@emergency merge of lynx 2.8.8dev.8
@
text
@d1 1
a1 1
# $LynxId: makefile.in,v 1.114 2010/09/21 08:17:25 tom Exp $
d40 1
a40 1
LYNX_VERSION	= 2.8.8dev.8
d358 1
a358 1
@@LYNXCFG_MAKE@@	perl $(scripts_dir)/cfg2html.pl -ms $(srcdir)/lynx.cfg
@


1.4
log
@fastmerge; break since I can’t get autoconf-2.13 to work and it’s late
@
text
@d40 1
a40 1
LYNX_VERSION	= 2.8.8dev.7
@


1.3
log
@fastmerge
@
text
@d1 1
a1 1
# $LynxId: makefile.in,v 1.101 2008/09/10 17:22:01 tom Exp $
d21 1
d31 1
a34 2
MKINSTALLDIRS	= @@MKINSTALLDIRS@@

d39 3
d44 1
a44 1
VERSION		= 2-8-7
d104 2
a148 1
# -DEXP_ASCII_CTYPES use POSIX locale for toupper/tolower/isupper
d194 3
d206 9
d236 1
a236 1
@@LYNXCFG_MAKE@@	-rm -f alphatoc.html body.html cattoc.html tmp007
d322 3
a324 3
	'if test -f $(BINDIR)/lynx$x ; then \
	      mv -f $(BINDIR)/lynx$x $(BINDIR)/lynx.old; fi'
	$(INSTALL_PROGRAM) lynx$x $(BINDIR)/lynx$x
d327 1
a327 1
	$(INSTALL_DATA) $(srcdir)/lynx.man $(MANDIR)/lynx.1
d338 1
a338 1
		cd $(HELPDIR) && ( $(LN_S) $(DOCDIR)/$$name . || cp $(DOCDIR)/$$name . );\
d348 1
a348 1
LYNX_URL='http://lynx.isc.org/release/lynx2-8-6'
d352 9
d365 6
a370 6
@@LYNXDOC_MAKE@@	@@echo 's!$(LYNXDOCS_URL)!file://$(docdir)!g' >> help_files.tmp
@@LYNXCFG_MAKE@@	@@echo 's!$(LYNXHELP_URL)alphatoc.html!alphatoc.html!g' >> help_files.tmp
@@LYNXCFG_MAKE@@	@@echo 's!$(LYNXHELP_URL)cattoc.html!cattoc.html!g' >> help_files.tmp
@@LYNXCFG_MAKE@@	@@echo 's!alphatoc\.html!alphatoc.html$(COMPRESS_EXT)!g' >> help_files.tmp
@@LYNXCFG_MAKE@@	@@echo 's!cattoc\.html!cattoc.html$(COMPRESS_EXT)!g' >> help_files.tmp
@@LYNXCFG_MAKE@@	@@echo 's!body\.html!body.html$(COMPRESS_EXT)!g' >> help_files.tmp
d385 7
a391 2
install-help : help_files.sed $(HELPDIR)
	- (cd $(HELPDIR) && WD=`pwd` && HEAD=`echo $$WD|sed -e 's!/lynx_help$$!!'` && test $$WD != $$HEAD && rm -fr *)
a392 6
@@LYNXCFG_MAKE@@	@@echo 'Making htmlized lynx.cfg'
@@LYNXCFG_MAKE@@	cd $(SRC_DIR) && $(MAKE_RECUR) LYReadCFG.i
@@LYNXCFG_MAKE@@	@@-rm -f alphatoc.html body.html cattoc.html
@@LYNXCFG_MAKE@@	sed -n -e '/Config_Type  *Config_Table/,/{0, *0, *0}/ p' $(SRC_DIR)/LYReadCFG.i | \
@@LYNXCFG_MAKE@@	sed  -e 's/ *{ *"\([^"]*\)".*/\1/' | \
@@LYNXCFG_MAKE@@	perl $(scripts_dir)/cfg2html.pl -ms $(srcdir)/lynx.cfg
d394 1
a394 1
@@LYNXCFG_MAKE@@	@@$(SHELL) -c 'for f in alphatoc.html body.html cattoc.html ; do \
a396 1
@@LYNXCFG_MAKE@@	-rm -f $(SRC_DIR)/LYReadCFG.i
d453 2
a454 2
	-rm -f $(BINDIR)/lynx$x
	-rm -f $(MANDIR)/lynx.1
d460 6
a465 1
	-test -d $(HELPDIR) && WD=`cd $(HELPDIR) && pwd` && HEAD=`echo $$WD|sed -e 's!/lynx_help$$!!'` && test $$WD != $$HEAD && rm -rf $(HELPDIR)
d469 13
a481 2
	-test -d $(DOCDIR) && WD=`cd $(DOCDIR) && pwd` && HEAD=`echo $$WD|sed -e 's!/lynx_doc$$!!'` && test $$WD != $$HEAD && rm -rf $(DOCDIR)
	-test -d $(HELPDIR) && WD=`cd $(HELPDIR) && pwd` && HEAD=`echo $$WD|sed -e 's!/lynx_help$$!!'` && test $$WD != $$HEAD && cd $(HELPDIR) && rm -f COPYING COPYHEADER
d487 12
d504 1
a504 3
	$(SHELL) $(MKINSTALLDIRS) $@@
etags:
	etags -r "/\(PRIVATE\|PUBLIC\)[ \t]+\([a-zA-Z_][a-zA-Z_0-1]*[ \t*]+\)*\([a-zA-Z_][a-zA-Z_0-1]*\)[ \t]+\(ARGS[0-9]\|NOARGS\)/\3/" *.[ch] */*.[ch] */*/*.[ch] */*/*/*.[ch]
@


1.2
log
@• bring in patches from the MirPort
• oldlynx script: use #!/usr/bin/env mksh
• fix file://localhost/~/ not found bug
• regenerate configure script
@
text
@d1 1
a1 1
# $LynxId: makefile.in,v 1.97 2007/05/13 22:29:46 tom Exp $
d13 1
d65 2
a66 2
docdir= @@datadir@@/lynx_doc
DOCDIR= $(DESTDIR)$(docdir)
d69 2
a70 2
helpdir= @@datadir@@/lynx_help
HELPDIR= $(DESTDIR)$(helpdir)
d75 14
a88 1
WWWINC= WWW/Library/Implementation
d187 2
a188 2
	WWWINC=$(WWWINC) \
	WWWLIB="../$(WWWINC)/libwww.a"
d192 3
a194 3
@@MSG_DIR_MAKE@@	cd po && $(MAKE_RECUR)
	cd $(WWWINC) && $(MAKE_RECUR) $(WWW_CFLAGS)
	cd src && $(MAKE_RECUR) all $(SRC_CFLAGS)
d197 2
a198 2
	cd $(WWWINC) && $(MAKE_RECUR) LINT="$(LINT)" $(WWW_CFLAGS) $@@
	cd src && $(MAKE_RECUR) LINT="$(LINT)" $(SRC_CFLAGS) $@@
d215 2
a216 1
	cd src && $(MAKE_RECUR) clean
d218 2
a219 2
@@MSG_DIR_MAKE@@	cd po && $(MAKE_RECUR) $@@
	rm -f *.b src/lynx$x *.leaks cfg_defs.h LYHelp.h lint.*
d225 2
a226 2
	cd $(WWWINC) && $(MAKE_RECUR) $@@
	cd src && $(MAKE_RECUR) $@@
d231 6
a236 5
	-rm -rf src/obsolete
	-cd src && $(MAKE_RECUR) $@@
	-cd src/chrtrans && $(MAKE_RECUR) $@@
@@MSG_DIR_MAKE@@	cd po && $(MAKE_RECUR) $@@
@@MSG_DIR_MAKE@@	-rmdir po
d238 3
a240 3
	-rm -f $(WWWINC)/makefile src/makefile src/chrtrans/makefile
@@SRCDIR_CLEAN@@	-rmdir $(WWWINC) && rmdir WWW/Library && rmdir WWW
@@SRCDIR_CLEAN@@	-rmdir src/chrtrans && rmdir src
d261 1
a261 1
	rm -f src/lynx$x
d263 1
a263 1
	rm -f src/a.out
d283 1
a283 1
		for I in . src $(WWWINC); do ( set +e; \
d304 1
a304 1
@@MSG_DIR_MAKE@@	cd po && $(MAKE_RECUR) install
d364 1
a364 1
@@LYNXCFG_MAKE@@	cd src && make LYReadCFG.i
d366 1
a366 1
@@LYNXCFG_MAKE@@	sed -n -e '/Config_Type  *Config_Table/,/{0, *0, *0}/ p' src/LYReadCFG.i | \
d373 1
a373 1
@@LYNXCFG_MAKE@@	-rm -f src/LYReadCFG.i
d403 1
a403 1
LYHelp.h : help_files.sed LYHelp.hin
d429 1
a429 1
@@MSG_DIR_MAKE@@	cd po && $(MAKE_RECUR) uninstall
d444 4
@


1.1
log
@Initial revision
@
text
@d1 1
d40 1
a40 1
VERSION		= 2-8-6
d43 1
a43 1
##(e.g., lynx2-8-6, not the full path)
d60 2
a61 2
libdir= @@libdir@@
LIBDIR= $(DESTDIR)$(libdir)
d64 1
a64 1
docdir= @@libdir@@/lynx_doc
d68 1
a68 1
helpdir= @@libdir@@/lynx_help
d82 5
d163 13
d177 4
a180 13
@@MSG_DIR_MAKE@@	$(SHELL) $(srcdir)/fixtext.sh $(srcdir)/LYMessages_en.h >LYMessages.c
@@MSG_DIR_MAKE@@	cd po && $(MAKE) CC="$(CC)"
	cd $(WWWINC) && $(MAKE) CC="$(CC)" \
		LY_CFLAGS="$(CFLAGS)" \
		CPPFLAGS="$(CPPFLAGS)" \
		LYFLAGS="$(SITE_LYDEFS)"
	cd src && $(MAKE) all CC="$(CC)" \
		CFLAGS="$(CFLAGS)" \
		CPPFLAGS="$(CPPFLAGS)" \
		LIBS="$(LIBS) $(RESOLVLIB) $(WAISLIB) $(SITE_LIBS)" \
		SITE_DEFS="$(SITE_DEFS)" \
		WWWINC=$(WWWINC) \
		WWWLIB="../$(WWWINC)/libwww.a"
d183 2
a184 11
	cd $(WWWINC) && $(MAKE) LINT="$(LINT)" CC="$(CC)" \
		LY_CFLAGS="$(CFLAGS)" \
		CPPFLAGS="$(CPPFLAGS)" \
		LYFLAGS="$(SITE_LYDEFS)" lint
	cd src && $(MAKE) all LINT="$(LINT)" CC="$(CC)" \
		CFLAGS="$(CFLAGS)" \
		CPPFLAGS="$(CPPFLAGS)" \
		LIBS="$(LIBS) $(RESOLVLIB) $(WAISLIB) $(SITE_LIBS)" \
		SITE_DEFS="$(SITE_DEFS)" \
		WWWINC=$(WWWINC) \
		WWWLIB="../$(WWWINC)/libwww.a" lint
d201 1
a201 1
	cd src && $(MAKE) clean
d203 1
a203 1
@@MSG_DIR_MAKE@@	cd po && $(MAKE) $@@
d210 2
a211 2
	cd $(WWWINC) && $(MAKE) $@@
	cd src && $(MAKE) $@@
d217 3
a219 3
	-cd src && $(MAKE) $@@
	-cd src/chrtrans && $(MAKE) $@@
@@MSG_DIR_MAKE@@	cd po && $(MAKE) $@@
d226 1
a226 1
	-rm -f lynx$x install-*
d288 4
a291 2
@@MSG_DIR_MAKE@@	cd po && $(MAKE) CC="$(CC)" install
	-mv -f $(BINDIR)/lynx$x $(BINDIR)/lynx.old
d316 4
d324 3
a326 2
@@LYNXCFG_MAKE@@	@@echo 's!http://www.hippo.ru/%7Ehvv/lynxcfg_toc.html#alphatoc!alphatoc.html!g' >> help_files.tmp
@@LYNXCFG_MAKE@@	@@echo 's!http://www.hippo.ru/%7Ehvv/lynxcfg_toc.html!cattoc.html!g' >> help_files.tmp
d352 1
a352 1
@@LYNXCFG_MAKE@@	perl $(srcdir)/scripts/cfg2html.pl -ms $(srcdir)/lynx.cfg
d368 4
a371 3
	@@echo Updating $(libdir)/lynx.cfg
	@@ECHO_CC@@$(SHELL) -c 'if test -f $(LIBDIR)/lynx.cfg ; then \
		mv $(LIBDIR)/lynx.cfg $(LIBDIR)/lynx.tmp ; \
d373 1
a373 1
		cp $(srcdir)/lynx.cfg $(LIBDIR)/lynx.tmp ; \
d375 1
a375 1
	@@echo Updating $(libdir)/lynx.cfg to point to installed help-files
d378 4
a381 3
		-e '/^HELPFILE:file/s!/PATH_TO/lynx_help!$(helpdir)!' \
		-e '/^[A-Z_]*:/s!/PATH_TO/lynx_doc!$(docdir)!' \
		-e '/^HELPFILE:file/s!$$!$(COMPRESS_EXT)!' \
d383 3
a385 3
		$(LIBDIR)/lynx.tmp >$(LIBDIR)/lynx.cfg
	chmod 644 $(LIBDIR)/lynx.cfg
	-rm -f $(LIBDIR)/lynx.tmp
d402 1
a402 1
cfg_defs.h : $(srcdir)/cfg_defs.sh $(srcdir)/cfg_edit.sh config.cache lynx_cfg.h
d404 1
a404 1
	$(SHELL) -c 'SHELL=$(SHELL) $(SHELL) $(srcdir)/cfg_defs.sh $(srcdir)'
d406 2
a407 2
install-cfg : $(LIBDIR)
	@@$(SHELL) -c '$(srcdir)/scripts/install-cfg.sh "$(INSTALL_DATA)" $(srcdir)/lynx.cfg $(LIBDIR)/lynx.cfg'
d409 2
a410 3
install-lss : $(LIBDIR)
	-mv -f $(LIBDIR)/lynx.lss $(LIBDIR)/lynx.oldlss
	$(INSTALL_DATA) $(srcdir)/samples/lynx.lss $(LIBDIR)/lynx.lss
d413 1
a413 1
@@MSG_DIR_MAKE@@	cd po && $(MAKE) CC="$(CC)" uninstall
d416 2
a417 2
	-rm -f $(LIBDIR)/lynx.cfg
	-rm -f $(LIBDIR)/lynx.lss
d430 1
a430 1
$(LIBDIR) \
@


1.1.109.1
log
@Lynx 2.8.6dev.11h (pre-patch) minus
* lib
* po
* scripts
@
text
@@


1.1.109.2
log
@import Lynx/2.8.6dev.18 (hopefully with our SSL fixes)
@
text
@a80 3
# Path of scripts directory
scripts_dir=$(srcdir)/scripts

d158 1
a158 1
@@MSG_DIR_MAKE@@	$(SHELL) $(scripts_dir)/fixtext.sh $(srcdir)/LYMessages_en.h >LYMessages.c
d344 1
a344 1
@@LYNXCFG_MAKE@@	perl $(scripts_dir)/cfg2html.pl -ms $(srcdir)/lynx.cfg
d369 3
a371 4
		$(LIBDIR)/lynx.tmp | \
	$(SHELL) $(scripts_dir)/cfg_path.sh lynx_help $(helpdir) | \
	$(SHELL) $(scripts_dir)/cfg_path.sh lynx_doc  $(helpdir) | \
	sed	-e '/^HELPFILE:file/s!$$!$(COMPRESS_EXT)!' \
d373 1
a373 1
		>$(LIBDIR)/lynx.cfg
d392 1
a392 1
cfg_defs.h : $(scripts_dir)/cfg_defs.sh $(scripts_dir)/cfg_edit.sh config.cache lynx_cfg.h
d394 1
a394 1
	$(SHELL) -c 'SHELL=$(SHELL) $(SHELL) $(scripts_dir)/cfg_defs.sh $(srcdir)'
d397 1
a397 1
	@@$(SHELL) $(scripts_dir)/install-cfg.sh "$(INSTALL_DATA)" $(srcdir)/lynx.cfg $(LIBDIR)/lynx.cfg
@


1.1.109.3
log
@Import Lynx 2.8.6pre.3
@
text
@d59 2
a60 2
sysconfdir= @@sysconfdir@@
SYSCONFDIR= $(DESTDIR)$(sysconfdir)
d63 1
a63 1
docdir= @@datadir@@/lynx_doc
d67 1
a67 1
helpdir= @@datadir@@/lynx_help
d363 3
a365 3
	@@echo Updating $(sysconfdir)/lynx.cfg
	@@ECHO_CC@@$(SHELL) -c 'if test -f $(SYSCONFDIR)/lynx.cfg ; then \
		mv $(SYSCONFDIR)/lynx.cfg $(SYSCONFDIR)/lynx.tmp ; \
d367 1
a367 1
		cp $(srcdir)/lynx.cfg $(SYSCONFDIR)/lynx.tmp ; \
d369 1
a369 1
	@@echo Updating $(sysconfdir)/lynx.cfg to point to installed help-files
d372 1
a372 1
		$(SYSCONFDIR)/lynx.tmp | \
d377 3
a379 3
		>$(SYSCONFDIR)/lynx.cfg
	chmod 644 $(SYSCONFDIR)/lynx.cfg
	-rm -f $(SYSCONFDIR)/lynx.tmp
d400 2
a401 2
install-cfg : $(SYSCONFDIR)
	@@$(SHELL) $(scripts_dir)/install-cfg.sh "$(INSTALL_DATA)" $(srcdir)/lynx.cfg $(SYSCONFDIR)/lynx.cfg
d403 3
a405 3
install-lss : $(SYSCONFDIR)
	-mv -f $(SYSCONFDIR)/lynx.lss $(SYSCONFDIR)/lynx.oldlss
	$(INSTALL_DATA) $(srcdir)/samples/lynx.lss $(SYSCONFDIR)/lynx.lss
d411 2
a412 2
	-rm -f $(SYSCONFDIR)/lynx.cfg
	-rm -f $(SYSCONFDIR)/lynx.lss
d425 1
a425 1
$(SYSCONFDIR) \
@


1.1.109.4
log
@Update to Lynx 2.8.7dev.2 in src, too (possibly security relevant)
@
text
@d39 1
a39 1
VERSION		= 2-8-7
d42 1
a42 1
##(e.g., lynx2-8-7, not the full path)
@


1.1.109.5
log
@Finally, a new Lynx snapshot!
@
text
@a0 1
# $LynxId: makefile.in,v 1.97 2007/05/13 22:29:46 tom Exp $
a83 2
MAKE_RECUR = $(MAKE) DESTDIR="$(DESTDIR)" CC="$(CC)"

a159 13
WWW_CFLAGS = \
	LY_CFLAGS="$(CFLAGS)" \
	CPPFLAGS="$(CPPFLAGS)" \
	LYFLAGS="$(SITE_LYDEFS)"

SRC_CFLAGS = \
	CFLAGS="$(CFLAGS)" \
	CPPFLAGS="$(CPPFLAGS)" \
	LIBS="$(LIBS) $(RESOLVLIB) $(WAISLIB) $(SITE_LIBS)" \
	SITE_DEFS="$(SITE_DEFS)" \
	WWWINC=$(WWWINC) \
	WWWLIB="../$(WWWINC)/libwww.a"

d162 12
a173 3
@@MSG_DIR_MAKE@@	cd po && $(MAKE_RECUR)
	cd $(WWWINC) && $(MAKE_RECUR) $(WWW_CFLAGS)
	cd src && $(MAKE_RECUR) all $(SRC_CFLAGS)
d176 11
a186 2
	cd $(WWWINC) && $(MAKE_RECUR) LINT="$(LINT)" $(WWW_CFLAGS) $@@
	cd src && $(MAKE_RECUR) LINT="$(LINT)" $(SRC_CFLAGS) $@@
d203 1
a203 1
	cd src && $(MAKE_RECUR) clean
d205 1
a205 1
@@MSG_DIR_MAKE@@	cd po && $(MAKE_RECUR) $@@
d212 2
a213 2
	cd $(WWWINC) && $(MAKE_RECUR) $@@
	cd src && $(MAKE_RECUR) $@@
d219 3
a221 3
	-cd src && $(MAKE_RECUR) $@@
	-cd src/chrtrans && $(MAKE_RECUR) $@@
@@MSG_DIR_MAKE@@	cd po && $(MAKE_RECUR) $@@
d228 1
a228 1
	-rm -f lynx$x
d290 2
a291 4
@@MSG_DIR_MAKE@@	cd po && $(MAKE_RECUR) install
	@@ECHO_CC@@$(SHELL) -c \
	'if test -f $(BINDIR)/lynx$x ; then \
	      mv -f $(BINDIR)/lynx$x $(BINDIR)/lynx.old; fi'
a315 4
LYNX_URL='http://lynx.isc.org/release/lynx2-8-6'
LYNXDOCS_URL='$(LYNX_URL)/docs/'
LYNXHELP_URL='$(LYNX_URL)/lynx_help/'

d320 2
a321 3
@@LYNXDOC_MAKE@@	@@echo 's!$(LYNXDOCS_URL)!file://$(docdir)!g' >> help_files.tmp
@@LYNXCFG_MAKE@@	@@echo 's!$(LYNXHELP_URL)alphatoc.html!alphatoc.html!g' >> help_files.tmp
@@LYNXCFG_MAKE@@	@@echo 's!$(LYNXHELP_URL)cattoc.html!cattoc.html!g' >> help_files.tmp
d364 1
a364 2
	@@ECHO_CC@@$(SHELL) -c \
	'if test -f $(SYSCONFDIR)/lynx.cfg ; then \
d404 2
a405 1
	@@$(SHELL) $(scripts_dir)/install-lss.sh "$(INSTALL_DATA)" $(srcdir)/samples/lynx.lss $(SYSCONFDIR)/lynx.lss
d408 1
a408 1
@@MSG_DIR_MAKE@@	cd po && $(MAKE_RECUR) uninstall
@


1.1.109.6
log
@Import Lynx 2.8.7dev.11a via eMail from Tom Dickey:
Message-ID: <20081215010313.GA8373@@invisible-island.net>
Message-ID: <20081216012408.GA15364@@invisible-island.net>
@
text
@d1 1
a1 1
# $LynxId: makefile.in,v 1.101 2008/09/10 17:22:01 tom Exp $
a12 1
builddir	= .
d64 2
a65 2
docdir    = @@datadir@@/lynx_doc
DOCDIR    = $(DESTDIR)$(docdir)
d68 2
a69 2
helpdir   = @@datadir@@/lynx_help
HELPDIR   = $(DESTDIR)$(helpdir)
d74 1
a74 14
WWW_DIR   = $(builddir)/WWW/Library/Implementation

##set the relative location of the message-file directory
##do not set this to be an absolute path!!!
PO_DIR    = $(builddir)/po
PO_SRCDIR = $(srcdir)/po

##set the relative location of the main source-directory
##do not set this to be an absolute path!!!
SRC_DIR   = $(builddir)/src

##set the relative location of the character-translation data directory
##do not set this to be an absolute path!!!
CHR_DIR   = $(SRC_DIR)/chrtrans
d173 2
a174 2
	WWWINC=$(WWW_DIR) \
	WWWLIB="../$(WWW_DIR)/libwww.a"
d178 3
a180 3
@@MSG_DIR_MAKE@@	cd $(PO_DIR) && $(MAKE_RECUR)
	cd $(WWW_DIR) && $(MAKE_RECUR) $(WWW_CFLAGS)
	cd $(SRC_DIR) && $(MAKE_RECUR) all $(SRC_CFLAGS)
d183 2
a184 2
	cd $(WWW_DIR) && $(MAKE_RECUR) LINT="$(LINT)" $(WWW_CFLAGS) $@@
	cd $(SRC_DIR) && $(MAKE_RECUR) LINT="$(LINT)" $(SRC_CFLAGS) $@@
d201 1
a201 2
	cd $(WWW_DIR) && $(MAKE_RECUR) $@@
	cd $(SRC_DIR) && $(MAKE_RECUR) $@@
d203 2
a204 2
@@MSG_DIR_MAKE@@	cd $(PO_DIR) && $(MAKE_RECUR) $@@
	rm -f *.b $(SRC_DIR)/lynx$x *.leaks cfg_defs.h LYHelp.h lint.*
d210 2
a211 2
	cd $(WWW_DIR) && $(MAKE_RECUR) $@@
	cd $(SRC_DIR) && $(MAKE_RECUR) $@@
d216 5
a220 6
	-rm -rf $(SRC_DIR)/obsolete
	-cd $(WWW_DIR) && $(MAKE_RECUR) $@@
	-cd $(SRC_DIR) && $(MAKE_RECUR) $@@
	-cd $(CHR_DIR) && $(MAKE_RECUR) $@@
@@MSG_DIR_MAKE@@	cd $(PO_DIR) && $(MAKE_RECUR) $@@
@@MSG_DIR_MAKE@@	-rmdir $(PO_DIR)
d222 3
a224 3
	-rm -f $(WWW_DIR)/makefile $(SRC_DIR)/makefile $(CHR_DIR)/makefile
@@SRCDIR_CLEAN@@	-rmdir $(WWW_DIR) && rmdir WWW/Library && rmdir WWW
@@SRCDIR_CLEAN@@	-rmdir $(CHR_DIR) && rmdir $(SRC_DIR)
d245 1
a245 1
	rm -f $(SRC_DIR)/lynx$x
d247 1
a247 1
	rm -f $(SRC_DIR)/a.out
d267 1
a267 1
		for I in . $(SRC_DIR) $(WWW_DIR); do ( set +e; \
d288 1
a288 1
@@MSG_DIR_MAKE@@	cd $(PO_DIR) && $(MAKE_RECUR) install
d348 1
a348 1
@@LYNXCFG_MAKE@@	cd $(SRC_DIR) && $(MAKE_RECUR) LYReadCFG.i
d350 1
a350 1
@@LYNXCFG_MAKE@@	sed -n -e '/Config_Type  *Config_Table/,/{0, *0, *0}/ p' $(SRC_DIR)/LYReadCFG.i | \
d357 1
a357 1
@@LYNXCFG_MAKE@@	-rm -f $(SRC_DIR)/LYReadCFG.i
d387 1
a387 1
LYHelp.h : help_files.sed $(srcdir)/LYHelp.hin
d413 1
a413 1
@@MSG_DIR_MAKE@@	cd $(PO_DIR) && $(MAKE_RECUR) uninstall
a427 4
update-po:
	rsync -Lrtvz  translationproject.org::tp/latest/lynx/  $(PO_SRCDIR)
	test -f $(PO_SRCDIR)/makefile && cd $(PO_SRCDIR) && $(MAKE_RECUR) $@@

@


1.1.109.7
log
@Import lynx-current
@
text
@d1 1
a1 1
# $LynxId: makefile.in,v 1.114 2010/09/21 08:17:25 tom Exp $
a20 1
ETAGS		= @@ETAGS@@
a29 1
transform	= @@program_transform_name@@
d33 2
a38 3
# $Format: "LYNX_VERSION	= $ProjectVersion$"$
LYNX_VERSION	= 2.8.8dev.7

d41 1
a41 1
VERSION		= 2-8-8
a100 2
@@LYNXCFG_MAKE@@CFG2HTML = alphatoc.html body.html cattoc.html

d144 1
a189 3
actual_PROG  = `echo lynx|    sed '$(transform)'`
binary_PROG  = $(actual_PROG)$x

a198 9
	cd $(CHR_DIR) && $(MAKE_RECUR) LINT="$(LINT)" $@@

tags:
	cd $(WWW_DIR) && $(MAKE_RECUR) $(WWW_CFLAGS) $@@
	cd $(SRC_DIR) && $(MAKE_RECUR) $(SRC_CFLAGS) $@@
	cd $(CHR_DIR) && $(MAKE_RECUR) $@@

etags:
	$(ETAGS) *.[ch] */*.[ch] */*/*.[ch] */*/*/*.[ch]
d220 1
a220 1
@@LYNXCFG_MAKE@@	-rm -f $(CFG2HTML)
d306 3
a308 3
	'if test -f $(BINDIR)/$(binary_PROG) ; then \
	      mv -f $(BINDIR)/$(binary_PROG) $(BINDIR)/lynx.old; fi'
	$(INSTALL_PROGRAM) lynx$x $(BINDIR)/$(binary_PROG)
d311 1
a311 1
	$(INSTALL_DATA) $(srcdir)/lynx.man $(MANDIR)/$(actual_PROG).1
d322 1
a322 1
		cd $(HELPDIR) && ( $(LN_S) $(docdir)/$$name . || cp $(DOCDIR)/$$name . );\
d332 1
a332 1
LYNX_URL='http://lynx.isc.org/release/lynx2-8-7'
a335 9
@@LYNXCFG_MAKE@@$(CFG2HTML) :
@@LYNXCFG_MAKE@@	@@echo 'Making htmlized lynx.cfg'
@@LYNXCFG_MAKE@@	cd $(SRC_DIR) && $(MAKE_RECUR) LYReadCFG.i
@@LYNXCFG_MAKE@@	@@-rm -f $(CFG2HTML)
@@LYNXCFG_MAKE@@	sed -n -e '/Config_Type  *Config_Table/,/{0, *0, *0}/ p' $(SRC_DIR)/LYReadCFG.i | \
@@LYNXCFG_MAKE@@	sed  -e 's/ *{ *"\([^"]*\)".*/\1/' | \
@@LYNXCFG_MAKE@@	perl $(scripts_dir)/cfg2html.pl -ms $(srcdir)/lynx.cfg
@@LYNXCFG_MAKE@@	-rm -f $(SRC_DIR)/LYReadCFG.i

d340 6
a345 6
@@LYNXDOC_MAKE@@	@@ECHO_CC@@echo 's!$(LYNXDOCS_URL)!file://$(docdir)!g' >> help_files.tmp
@@LYNXCFG_MAKE@@	@@ECHO_CC@@echo 's!$(LYNXHELP_URL)alphatoc.html!alphatoc.html!g' >> help_files.tmp
@@LYNXCFG_MAKE@@	@@ECHO_CC@@echo 's!$(LYNXHELP_URL)cattoc.html!cattoc.html!g' >> help_files.tmp
@@LYNXCFG_MAKE@@	@@ECHO_CC@@echo 's!alphatoc\.html!alphatoc.html$(COMPRESS_EXT)!g' >> help_files.tmp
@@LYNXCFG_MAKE@@	@@ECHO_CC@@echo 's!cattoc\.html!cattoc.html$(COMPRESS_EXT)!g' >> help_files.tmp
@@LYNXCFG_MAKE@@	@@ECHO_CC@@echo 's!body\.html!body.html$(COMPRESS_EXT)!g' >> help_files.tmp
d360 2
a361 7
install-help : $(CFG2HTML) help_files.sed $(HELPDIR)
	-$(SHELL) -c 'if cd "$(HELPDIR)" ; then \
		WD=`pwd` ; \
		TAIL=`basename "$(helpdir)"` ; \
		HEAD=`echo "$$WD"|sed -e "s,/$${TAIL}$$,,"` ; \
		test "x$$WD" != "x$$HEAD" && rm -fr * ; \
		fi'
d363 6
d370 1
a370 1
@@LYNXCFG_MAKE@@	@@$(SHELL) -c 'for f in $(CFG2HTML) ; do \
d373 1
d430 2
a431 2
	-rm -f $(BINDIR)/$(binary_PROG)
	-rm -f $(MANDIR)/$(actual_PROG).1
d437 1
a437 6
	-$(SHELL) -c 'if test -d "$(HELPDIR)" ; then \
		WD=`cd "$(HELPDIR)" && pwd` ; \
		TAIL=`basename "$(helpdir)"` ; \
		HEAD=`echo "$$WD"|sed -e "s,/$${TAIL}$$,,"` ; \
		test "x$$WD" != "x$$HEAD" && rm -rf "$(HELPDIR)"; \
		fi'
d441 2
a442 13
	-$(SHELL) -c 'if test -d "$(DOCDIR)" ; then \
		WD=`cd "$(DOCDIR)" && pwd` ; \
		TAIL=`basename "$(docdir)"` ; \
		HEAD=`echo "$$WD"|sed -e "s,/$${TAIL}$$,,"` ; \
		test "x$$WD" != "x$$HEAD" && rm -rf "$(DOCDIR)"; \
		fi'
	-$(SHELL) -c 'if test -d "$(HELPDIR)" ; then \
		WD=`cd "$(HELPDIR)" && pwd` ; \
		TAIL=`basename "$(helpdir)"` ; \
		HEAD=`echo "$$WD"|sed -e "s,/'$${TAIL}'$$,,"` ; \
		test "x$$WD" != "x$$HEAD" ; \
		cd "$(HELPDIR)" && rm -f COPYING COPYHEADER ; \
		fi'
a447 12
preinstall :
	@@ echo ''
	@@ echo '** Configuration summary for LYNX $(LYNX_VERSION):'
	@@ echo ''
	@@ echo '       program name: '$(actual_PROG)
	@@ echo ''
	@@ echo '      bin directory: '$(BINDIR)
	@@ echo '   config directory: '$(SYSCONFDIR)
	@@ echo '      man directory: '$(MANDIR)
	@@ echo '     help directory: '$(HELPDIR)
	@@ echo '      doc directory: '$(DOCDIR)

d453 3
a455 1
	mkdir -p $@@
@


1.1.109.8
log
@emergency update to lynx2.8.8dev.8.tar.gz (only tested changes in it)
@
text
@d40 1
a40 1
LYNX_VERSION	= 2.8.8dev.8
@


1.1.109.9
log
@Import Lynx 2.8.8dev.10 plus dev.10a patch from invisible-island plus
fix for “lynx -help” output by KIHARA Hideto, by import-3rdpty,v 1.43
@
text
@d1 1
a1 1
# $LynxId: makefile.in,v 1.118 2011/06/12 18:36:28 tom Exp $
d40 1
a40 1
LYNX_VERSION	= 2.8.8dev.10
d358 1
a358 1
@@LYNXCFG_MAKE@@	perl $(scripts_dir)/cfg2html.pl -ams $(srcdir)/lynx.cfg
@


1.1.109.10
log
@May as well properly merge dev.11 now; dev.12 will probably take a while,
and it’s good to have a baseline for an updated MirPort.
@
text
@d40 1
a40 1
LYNX_VERSION	= 2.8.8dev.11
@


1.1.109.11
log
@Another development release of Lynx fixing minor bugs
@
text
@d40 1
a40 1
LYNX_VERSION	= 2.8.8dev.12
@


1.1.109.12
log
@lynx2.8.8dev.14
@
text
@d1 1
a1 1
# $LynxId: makefile.in,v 1.125 2012/08/12 23:54:35 tom Exp $
a25 1
LDFLAGS		= @@EXTRA_LDFLAGS@@ @@LDFLAGS@@
d40 1
a40 1
LYNX_VERSION	= 2.8.8dev.14
a67 1
datarootdir= @@datarootdir@@
d102 1
a102 1
MAKE_RECUR = $(MAKE) @@cf_cv_makeflags@@ DESTDIR="$(DESTDIR)" CC="$(CC)"
a188 1
	LDFLAGS="$(LDFLAGS)" \
@


1.1.109.13
log
@Import Lynx 2.8.8dev.15 as suggested by lewellyn on IRC
@
text
@d41 1
a41 1
LYNX_VERSION	= 2.8.8dev.15
@


1.1.109.14
log
@Update to the latest Lynx patchkit
@
text
@d41 1
a41 1
LYNX_VERSION	= 2.8.8dev.15e
@


1.1.109.15
log
@Update
@
text
@d41 1
a41 1
LYNX_VERSION	= 2.8.8dev.16
@


