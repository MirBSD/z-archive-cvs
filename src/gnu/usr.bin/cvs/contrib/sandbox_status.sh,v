head	1.1;
branch	1.1.101;
access;
symbols
	MIRBSD_10:1.1.101.2.0.4
	MIRBSD_10_BASE:1.1.101.2
	MIRBSD_9_BASE:1.1.101.2
	MIRBSD_8:1.1.101.2.0.2
	MIRBSD_8_BASE:1.1.101.2
	cvs-1_12_13:1.1.101.2
	cvs-1_12_12:1.1.101.1
	FSF:1.1.101;
locks; strict;
comment	@# @;


1.1
date	2005.03.06.15.17.47;	author tg;	state Exp;
branches
	1.1.101.1;
next	;

1.1.101.1
date	2005.03.06.15.17.47;	author tg;	state Exp;
branches;
next	1.1.101.2;

1.1.101.2
date	2005.12.05.21.43.41;	author tg;	state Exp;
branches;
next	;
commitid	2cec4394b499b817;


desc
@@


1.1
log
@Initial revision
@
text
@#! /bin/sh
#
# sandbox_status - identify files added, changed, or removed 
#                  in CVS working directory
#
# Contributed by Lowell Skoog <fluke!lowell@@uunet.uu.net>
# 
# This program should be run in a working directory that has been
# checked out using CVS.  It identifies files that have been added,
# changed, or removed in the working directory, but not "cvs
# committed".  It also determines whether the files have been "cvs
# added" or "cvs removed".  For directories, it is only practical to
# determine whether they have been added.

name=sandbox_status
changes=0

# If we can't run CVS commands in this directory
cvs status . > /dev/null 2>&1
if [ $? != 0 ] ; then

    # Bail out
    echo "$name: there is no version here; bailing out" 1>&2
    exit 1
fi

# Identify files added to working directory
for file in .* * ; do

    # Skip '.' and '..'
    if [ $file = '.' -o $file = '..' ] ; then
	continue
    fi

    # If a regular file
    if [ -f $file ] ; then
	if cvs status $file | grep -s '^From:[ 	]*New file' ; then
	    echo "file added:      $file - not CVS committed"
	    changes=`expr $changes + 1`
	elif cvs status $file | grep -s '^From:[ 	]*no entry for' ; then
	    echo "file added:      $file - not CVS added, not CVS committed"
	    changes=`expr $changes + 1`
	fi

    # Else if a directory
    elif [ -d $file -a $file != CVS.adm ] ; then

	# Move into it
	cd $file

	# If CVS commands don't work inside
	cvs status . > /dev/null 2>&1
	if [ $? != 0 ] ; then
	    echo "directory added: $file - not CVS added"
	    changes=`expr $changes + 1`
	fi

	# Move back up
	cd ..
    fi
done

# Identify changed files
changedfiles=`cvs diff | egrep '^diff' | awk '{print $3}'`
for file in $changedfiles ; do
    echo "file changed:    $file - not CVS committed"
    changes=`expr $changes + 1`
done

# Identify files removed from working directory
removedfiles=`cvs status | egrep '^File:[ 	]*no file' | awk '{print $4}'`

# Determine whether each file has been cvs removed
for file in $removedfiles ; do
    if cvs status $file | grep -s '^From:[ 	]*-' ; then
	echo "file removed:    $file - not CVS committed"
    else
	echo "file removed:    $file - not CVS removed, not CVS committed"
    fi
    changes=`expr $changes + 1`
done

exit $changes
@


1.1.101.1
log
@GNU CVS 1.12.11 with the following directories removed:
- contrib/pam
- emx
- os2
- tools
- vms
- windows-NT
- zlib
@
text
@@


1.1.101.2
log
@Import current version of GNU CVS, in the hope to actually fix bugs...
@
text
@a2 12
#  Copyright (C) 1995-2005 The Free Software Foundation, Inc.
#
#  This program is free software; you can redistribute it and/or modify
#  it under the terms of the GNU General Public License as published by
#  the Free Software Foundation; either version 2, or (at your option)
#  any later version.
#
#  This program is distributed in the hope that it will be useful,
#  but WITHOUT ANY WARRANTY; without even the implied warranty of
#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#  GNU General Public License for more details.
#
@

