head	1.9;
access;
symbols
	mbsd-20101220_mergebase:1.8
	cvs-201107021500:1.1.1.2
	cvs-20101220:1.1.1.2
	mbsd-20101220:1.8.0.2
	cvs-201012191730:1.1.1.2
	cvs-200812170000:1.1.1.2
	cvs-200805071200:1.1.1.2
	MIRBSD_10:1.6.0.2
	MIRBSD_10_BASE:1.6
	cvs-200803022030:1.1.1.2
	cvs-200707152000:1.1.1.2
	cvs-200704292000:1.1.1.2
	cvs-200702051700:1.1.1.2
	cvs-200609121900:1.1.1.2
	MIRBSD_9_BASE:1.6
	cvs-200606151800:1.1.1.2
	cvs-200603231300:1.1.1.2
	MIRBSD_8:1.4.0.2
	MIRBSD_8_BASE:1.4
	cvs-200507211800:1.1.1.1
	cvs-200504262050:1.1.1.1
	openbsd:1.1.1;
locks; strict;
comment	@# @;


1.9
date	2013.08.06.19.27.17;	author tg;	state Exp;
branches;
next	1.8;
commitid	10052014E2214959440;

1.8
date	2010.12.19.17.17.49;	author tg;	state Exp;
branches;
next	1.7;
commitid	1004D0E3E2D1286B3DF;

1.7
date	2008.05.07.13.15.14;	author tg;	state Exp;
branches;
next	1.6;
commitid	1004821AB7510EE48FB;

1.6
date	2006.03.23.13.31.43;	author tg;	state Exp;
branches
	1.6.2.1;
next	1.5;
commitid	1004422A34223905633;

1.5
date	2006.03.23.13.20.21;	author tg;	state Exp;
branches;
next	1.4;
commitid	1004422A0AB5336630E;

1.4
date	2005.10.21.10.46.29;	author tg;	state Exp;
branches
	1.4.2.1;
next	1.3;
commitid	18994358c6e48907;

1.3
date	2005.03.29.02.19.36;	author tg;	state Exp;
branches;
next	1.2;

1.2
date	2005.03.13.15.11.40;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.02.05.17.24.17;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.6.2.1
date	2008.05.17.19.11.32;	author tg;	state Exp;
branches;
next	;
commitid	100482F2DC168C89AEA;

1.4.2.1
date	2006.03.30.19.27.27;	author tg;	state Exp;
branches;
next	;
commitid	100442C309C7183FA09;

1.1.1.1
date	2005.02.05.17.24.17;	author tg;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2006.03.23.13.08.41;	author tg;	state Exp;
branches;
next	;
commitid	10044229DEA33D36552;


desc
@@


1.9
log
@add _FFR_TLS_1 from
http://www.sendmail.org/~ca/email/tricks.html
@
text
@# $MirOS: src/gnu/usr.sbin/sendmail/Makefile.inc,v 1.8 2010/12/19 17:17:49 tg Exp $
# $OpenBSD: Makefile.inc,v 1.17 2006/02/04 09:46:23 mbalmer Exp $

.ifndef _MODSRC_GNU_USR_SBIN_SENDMAIL_MAKEFILE_INC
_MODSRC_GNU_USR_SBIN_SENDMAIL_MAKEFILE_INC=1

.include <bsd.own.mk>
SENDMAIL_WANT_LDAP?=	No
LOCALBASE?=		/usr/mpkg

.include <bsd.obj.mk>

.if (${MACHINE_ARCH} != "vax")
ENVDEF+=-DSM_OMIT_BOGUS_WARNINGS
.endif
ENVDEF+= -DNEWDB -DMAP_REGEX
ENVDEF+= -DNETINET6 -DNEEDSGETIPNODE -DSM_CONF_SHM
ENVDEF+=	-D_FFR_QUEUERETURN_DSN
ENVDEF+=	-D_FFR_TLS_1

.if defined(WANT_LIBSMDB)
LDADD+= -lsmdb
.if exists(${.CURDIR}/../libsmdb/${__objdir})
DPADD+= ${.CURDIR}/../libsmdb/${__objdir}/libsmdb.a
LDFLAGS+=-L${.CURDIR}/../libsmdb/${__objdir}
.else
DPADD+= ${.CURDIR}/../libsmdb/libsmdb.a
LDFLAGS+=-L${.CURDIR}/../libsmdb
.endif
.endif

.if defined(WANT_LIBSMUTIL)
LDADD+= -lsmutil
.if exists(${.CURDIR}/../libsmutil/${__objdir})
DPADD+= ${.CURDIR}/../libsmutil/${__objdir}/libsmutil.a
LDFLAGS+=-L${.CURDIR}/../libsmutil/${__objdir}
.else
DPADD+= ${.CURDIR}/../libsmutil/libsmutil.a
LDFLAGS+=-L${.CURDIR}/../libsmutil
.endif
.endif

.if defined(WANT_LIBSM)
LDADD+= -lsm
.if exists(${.CURDIR}/../libsm/${__objdir})
DPADD+= ${.CURDIR}/../libsm/${__objdir}/libsm.a
LDFLAGS+=-L${.CURDIR}/../libsm/${__objdir}
.else
DPADD+= ${.CURDIR}/../libsm/libsm.a
LDFLAGS+=-L${.CURDIR}/../libsm
.endif
.endif

.if ${SENDMAIL_WANT_LDAP:L} == "yes"
.if !defined(LIB) || (${LIB} != "milter")
ENVDEF+= -DLDAPMAP
LDADD+=-lldap -llber
CPPFLAGS+=	-I${LOCALBASE}/include
LDFLAGS+=	-L${LOCALBASE}/lib
.endif
.endif

CPPFLAGS+=	${ENVDEF} -I${.CURDIR}/../sendmail -I${.CURDIR}/../include
COPTS+=		-Wall

.endif
@


1.8
log
@merge newer sendmail; fix and correct; reduce upstream diffs; prep for deb
@
text
@d1 1
a1 1
# $MirOS: src/gnu/usr.sbin/sendmail/Makefile.inc,v 1.7 2008/05/07 13:15:14 tg Exp $
d19 1
@


1.7
log
@merge and reduce diffs against upstream
@
text
@d1 2
a2 2
# $MirOS: src/gnu/usr.sbin/sendmail/Makefile.inc,v 1.6 2006/03/23 13:31:43 tg Exp $
#	$OpenBSD: Makefile.inc,v 1.17 2006/02/04 09:46:23 mbalmer Exp $
@


1.6
log
@* Makefile.inc: use ${LOCALBASE} not /usr/local
* libmilter/Makefile: use ${DIRMODE} not hardcode 755
@
text
@d1 2
a2 2
# $MirOS: src/gnu/usr.sbin/sendmail/Makefile.inc,v 1.5 2006/03/23 13:20:21 tg Exp $
# $OpenBSD: Makefile.inc,v 1.17 2006/02/04 09:46:23 mbalmer Exp $
d13 2
a14 2
.if ${MACHINE_ARCH} != "vax"
ENVDEF+=	-DSM_OMIT_BOGUS_WARNINGS
d16 2
a17 2
ENVDEF+=	-DNEWDB -DMAP_REGEX
ENVDEF+=	-DNETINET6 -DNEEDSGETIPNODE -DSM_CONF_SHM
d21 8
a28 8
LDADD+=		-lsmdb
.  if exists(${.CURDIR}/../libsmdb/${__objdir})
DPADD+=		${.CURDIR}/../libsmdb/${__objdir}/libsmdb.a
LDFLAGS+=	-L${.CURDIR}/../libsmdb/${__objdir}
.  else
DPADD+=		${.CURDIR}/../libsmdb/libsmdb.a
LDFLAGS+=	-L${.CURDIR}/../libsmdb
.  endif
d32 8
a39 8
LDADD+=		-lsmutil
.  if exists(${.CURDIR}/../libsmutil/${__objdir})
DPADD+=		${.CURDIR}/../libsmutil/${__objdir}/libsmutil.a
LDFLAGS+=	-L${.CURDIR}/../libsmutil/${__objdir}
.  else
DPADD+=		${.CURDIR}/../libsmutil/libsmutil.a
LDFLAGS+=	-L${.CURDIR}/../libsmutil
.  endif
d43 8
a50 8
LDADD+=		-lsm
.  if exists(${.CURDIR}/../libsm/${__objdir})
DPADD+=		${.CURDIR}/../libsm/${__objdir}/libsm.a
LDFLAGS+=	-L${.CURDIR}/../libsm/${__objdir}
.  else
DPADD+=		${.CURDIR}/../libsm/libsm.a
LDFLAGS+=	-L${.CURDIR}/../libsm
.  endif
d54 3
a56 3
.  if !defined(LIB) || (${LIB} != "milter")
ENVDEF+=	-DLDAPMAP
LDADD+=		-lldap -llber
d59 1
a59 1
.  endif
@


1.6.2.1
log
@MFC sendmail update to 8.14.3

agreed bsiegert@@
@
text
@d1 2
a2 2
# $MirOS: src/gnu/usr.sbin/sendmail/Makefile.inc,v 1.7 2008/05/07 13:15:14 tg Exp $
#	$OpenBSD: Makefile.inc,v 1.17 2006/02/04 09:46:23 mbalmer Exp $
d13 2
a14 2
.if (${MACHINE_ARCH} != "vax")
ENVDEF+=-DSM_OMIT_BOGUS_WARNINGS
d16 2
a17 2
ENVDEF+= -DNEWDB -DMAP_REGEX
ENVDEF+= -DNETINET6 -DNEEDSGETIPNODE -DSM_CONF_SHM
d21 8
a28 8
LDADD+= -lsmdb
.if exists(${.CURDIR}/../libsmdb/${__objdir})
DPADD+= ${.CURDIR}/../libsmdb/${__objdir}/libsmdb.a
LDFLAGS+=-L${.CURDIR}/../libsmdb/${__objdir}
.else
DPADD+= ${.CURDIR}/../libsmdb/libsmdb.a
LDFLAGS+=-L${.CURDIR}/../libsmdb
.endif
d32 8
a39 8
LDADD+= -lsmutil
.if exists(${.CURDIR}/../libsmutil/${__objdir})
DPADD+= ${.CURDIR}/../libsmutil/${__objdir}/libsmutil.a
LDFLAGS+=-L${.CURDIR}/../libsmutil/${__objdir}
.else
DPADD+= ${.CURDIR}/../libsmutil/libsmutil.a
LDFLAGS+=-L${.CURDIR}/../libsmutil
.endif
d43 8
a50 8
LDADD+= -lsm
.if exists(${.CURDIR}/../libsm/${__objdir})
DPADD+= ${.CURDIR}/../libsm/${__objdir}/libsm.a
LDFLAGS+=-L${.CURDIR}/../libsm/${__objdir}
.else
DPADD+= ${.CURDIR}/../libsm/libsm.a
LDFLAGS+=-L${.CURDIR}/../libsm
.endif
d54 3
a56 3
.if !defined(LIB) || (${LIB} != "milter")
ENVDEF+= -DLDAPMAP
LDADD+=-lldap -llber
d59 1
a59 1
.endif
@


1.5
log
@fastmerge Sendmail 8.13.6
@
text
@d1 1
a1 1
# $MirOS: src/gnu/usr.sbin/sendmail/Makefile.inc,v 1.4 2005/10/21 10:46:29 tg Exp $
d9 1
d57 2
a58 2
CPPFLAGS+=	-I/usr/local/include
LDFLAGS+=	-L/usr/local/lib
@


1.4
log
@* perl, sendmail: merge OpenBSD import
* perl: fix DEBUG{LIBS,PROGS} by disabling
* all: fix use of CDIAGFLAGS+=, CFLAGS+= and COPTS+= [...]
@
text
@d1 2
a2 2
# $MirOS: src/gnu/usr.sbin/sendmail/Makefile.inc,v 1.3 2005/03/29 02:19:36 tg Exp $
# $OpenBSD: Makefile.inc,v 1.16 2004/06/24 03:59:23 millert Exp $
d53 1
d58 1
@


1.4.2.1
log
@MFC most of the recent sendmail updates to MirOS #8-stable
agreed bsiegert@@

This also changes the LOCALBASE stuff, links libmilter not
against LDAP, etc. but doesn't install the FreeBSD 6 confs
nor a shared libmilter in order to pass a no-files-diff:

tg@@maou:/usr/src/gnu/usr.sbin/sendmail $ sudo find / -ls | sort -k11 >~/x1
tg@@maou:/usr/src/gnu/usr.sbin/sendmail $ sudo make install
tg@@maou:/usr/src/gnu/usr.sbin/sendmail/cf/cf $ sudo make distribution
tg@@maou:/usr/src/gnu/usr.sbin/sendmail/cf/cf $ sudo find / -ls | sort -k11 | diff -u ~/x1 - | less

Note: files in /etc/mail/ are also changed, this affects the etc8.ngz set
on fresh installs and cannot(!) be automatically upgraded!
@
text
@d1 2
a2 2
# $MirOS: src/gnu/usr.sbin/sendmail/Makefile.inc,v 1.6 2006/03/23 13:31:43 tg Exp $
# $OpenBSD: Makefile.inc,v 1.17 2006/02/04 09:46:23 mbalmer Exp $
a8 1
LOCALBASE?=		/usr/mpkg
a52 1
.  if !defined(LIB) || (${LIB} != "milter")
d55 2
a56 3
CPPFLAGS+=	-I${LOCALBASE}/include
LDFLAGS+=	-L${LOCALBASE}/lib
.  endif
@


1.3
log
@time to die for a feature which has been disabled in MirOS
for a good two years, maybe longer, with nobody complaining

pf can do this functionality equally well, I think
@
text
@d1 1
a1 1
# $MirOS: src/gnu/usr.sbin/sendmail/Makefile.inc,v 1.2 2005/03/13 15:11:40 tg Exp $
d55 1
a55 1
CFLAGS+=	-I/usr/local/include
d60 1
a60 1
CFLAGS+=	-Wall
@


1.2
log
@merge sendmail diff against OpenBSD's idea of sendmail port
@
text
@d1 1
a1 1
# $MirOS$
a51 8
.if defined(WANT_LIBWRAP)
.  if ${TCP_WRAPPERS:L} == "yes"
ENVDEF+=	-DTCPWRAPPERS
DPADD+=		${LIBWRAP}
LDADD+=		-lwrap
.  endif
.endif

@


1.1
log
@Initial revision
@
text
@d1 5
a5 1
#	$OpenBSD: Makefile.inc,v 1.16 2004/06/24 03:59:23 millert Exp $
d8 2
d12 2
a13 7
.if (${MACHINE_ARCH} != "vax")
ENVDEF+=-DSM_OMIT_BOGUS_WARNINGS
.endif
ENVDEF+= -DNEWDB -DMAP_REGEX
ENVDEF+= -DNETINET6 -DNEEDSGETIPNODE -DSM_CONF_SHM
.if (${YP:L} == "yes")
ENVDEF+=-DNIS
d15 3
d20 8
a27 8
LDADD+= -lsmdb
.if exists(${.CURDIR}/../libsmdb/${__objdir})
DPADD+= ${.CURDIR}/../libsmdb/${__objdir}/libsmdb.a
LDFLAGS+=-L${.CURDIR}/../libsmdb/${__objdir}
.else
DPADD+= ${.CURDIR}/../libsmdb/libsmdb.a
LDFLAGS+=-L${.CURDIR}/../libsmdb
.endif
d31 8
a38 8
LDADD+= -lsmutil
.if exists(${.CURDIR}/../libsmutil/${__objdir})
DPADD+= ${.CURDIR}/../libsmutil/${__objdir}/libsmutil.a
LDFLAGS+=-L${.CURDIR}/../libsmutil/${__objdir}
.else
DPADD+= ${.CURDIR}/../libsmutil/libsmutil.a
LDFLAGS+=-L${.CURDIR}/../libsmutil
.endif
d42 8
a49 8
LDADD+= -lsm
.if exists(${.CURDIR}/../libsm/${__objdir})
DPADD+= ${.CURDIR}/../libsm/${__objdir}/libsm.a
LDFLAGS+=-L${.CURDIR}/../libsm/${__objdir}
.else
DPADD+= ${.CURDIR}/../libsm/libsm.a
LDFLAGS+=-L${.CURDIR}/../libsm
.endif
d53 12
a64 5
.if (${TCP_WRAPPERS:L} == "yes")
ENVDEF+=-DTCPWRAPPERS
DPADD+= ${LIBWRAP}
LDADD+= -lwrap
.endif
d67 3
a69 6
# To build with LDAP map support define WANT_LDAP in /etc/mk.conf (unsupported)
.if defined(WANT_LDAP)
ENVDEF+= -DLDAPMAP
LDADD+=-lldap -llber
CFLAGS+=-I/usr/local/include
LDFLAGS+=-L/usr/local/lib
a70 2

CFLAGS+=${ENVDEF} -I${.CURDIR}/../sendmail -I${.CURDIR}/../include
@


1.1.1.1
log
@Import the OpenBSD foundation of MirOS BSD
@
text
@@


1.1.1.2
log
@Update to Sendmail 8.13.6
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile.inc,v 1.17 2006/02/04 09:46:23 mbalmer Exp $
a57 1
.if !defined(LIB) || (${LIB} != "milter")
a62 1
.endif
@

