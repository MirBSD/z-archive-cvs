head	1.11;
access;
symbols
	sendmail-8_14_5-ERRATA-1:1.1.127.1
	mbsd-20101220_mergebase:1.11
	sendmail-8_14_5:1.1.127.1
	cvs-201107021500:1.1.1.4
	cvs-20101220:1.1.1.4
	mbsd-20101220:1.11.0.2
	cvs-201012191730:1.1.1.4
	sendmail-8_14_5_Beta0:1.1.127.1
	sendmail-8_14_3:1.1.127.1
	sendmail:1.1.127
	cvs-200812170000:1.1.1.3
	cvs-200805071200:1.1.1.3
	MIRBSD_10:1.7.0.2
	MIRBSD_10_BASE:1.7
	cvs-200803022030:1.1.1.3
	cvs-200707152000:1.1.1.3
	cvs-200704292000:1.1.1.3
	cvs-200702051700:1.1.1.3
	cvs-200609121900:1.1.1.2
	MIRBSD_9_BASE:1.4
	cvs-200606151800:1.1.1.2
	cvs-200603231300:1.1.1.2
	MIRBSD_8:1.2.0.2
	MIRBSD_8_BASE:1.2
	cvs-200507211800:1.1.1.1
	cvs-200504262050:1.1.1.1
	openbsd:1.1.1;
locks; strict;
comment	@# @;


1.11
date	2010.12.19.17.54.15;	author tg;	state Exp;
branches;
next	1.10;
commitid	1004D0E46D819D7E113;

1.10
date	2010.12.19.17.18.07;	author tg;	state Exp;
branches;
next	1.9;
commitid	1004D0E3E2D1286B3DF;

1.9
date	2009.09.12.20.33.08;	author tg;	state Exp;
branches;
next	1.8;
commitid	1004AAC05815D283208;

1.8
date	2008.05.07.13.15.20;	author tg;	state Exp;
branches;
next	1.7;
commitid	1004821AB7510EE48FB;

1.7
date	2007.05.17.17.27.50;	author tg;	state Exp;
branches
	1.7.2.1;
next	1.6;
commitid	100464C90AD021CA782;

1.6
date	2007.02.05.17.44.28;	author tg;	state Exp;
branches;
next	1.5;
commitid	10045C76D0F57AA9DD7;

1.5
date	2007.02.05.17.13.43;	author tg;	state Exp;
branches;
next	1.4;
commitid	10045C765DC5E008599;

1.4
date	2006.03.23.13.31.43;	author tg;	state Exp;
branches;
next	1.3;
commitid	1004422A34223905633;

1.3
date	2006.03.23.13.20.21;	author tg;	state Exp;
branches;
next	1.2;
commitid	1004422A0AB5336630E;

1.2
date	2005.03.13.15.11.45;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.02.05.17.24.22;	author tg;	state Exp;
branches
	1.1.1.1
	1.1.127.1;
next	;

1.7.2.1
date	2008.05.17.19.11.51;	author tg;	state Exp;
branches;
next	;
commitid	100482F2DC168C89AEA;

1.1.1.1
date	2005.02.05.17.24.22;	author tg;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2006.03.23.13.09.22;	author tg;	state Exp;
branches;
next	1.1.1.3;
commitid	10044229DEA33D36552;

1.1.1.3
date	2007.02.05.17.05.44;	author tg;	state Exp;
branches;
next	1.1.1.4;
commitid	10045C763C551AABAF7;

1.1.1.4
date	2010.12.19.17.39.39;	author tg;	state Exp;
branches;
next	;
commitid	1004D0E436269567D7C;

1.1.127.1
date	2010.12.19.14.45.52;	author tg;	state Exp;
branches;
next	;
commitid	1004D0E1A94384778FD;


desc
@@


1.11
log
@merge openbsd sendmail
@
text
@# $MirOS: src/gnu/usr.sbin/sendmail/libmilter/Makefile,v 1.10 2010/12/19 17:18:07 tg Exp $
# $OpenBSD: Makefile,v 1.12 2009/05/13 18:24:15 jakob Exp $

.include <bsd.own.mk>

LIB=		milter
LDFLAGS+=	-pthread
DPADD+=		${LIBPTHREAD}
HDRS=		mfapi.h milter.h mfdef.h
HDRSRC=		${.CURDIR}/../include/libmilter
HDRDST=		${DESTDIR}/usr/include/libmilter
DOCS=		api.html design.html figure1.jpg figure2.jpg index.html \
                installation.html other.html overview.html sample.html \
		smfi_addheader.html smfi_addrcpt.html smfi_addrcpt_par.html \
		smfi_chgfrom.html smfi_chgheader.html smfi_delrcpt.html \
		smfi_getpriv.html smfi_getsymval.html smfi_insheader.html \
		smfi_main.html smfi_opensocket.html smfi_progress.html \
		smfi_quarantine.html smfi_register.html smfi_replacebody.html \
		smfi_setbacklog.html smfi_setconn.html smfi_setdbg.html \
		smfi_setmlreply.html smfi_setpriv.html smfi_setreply.html \
		smfi_setsymlist.html smfi_settimeout.html smfi_stop.html \
		smfi_version.html xxfi_abort.html xxfi_body.html \
		xxfi_close.html xxfi_connect.html xxfi_data.html \
		xxfi_envfrom.html xxfi_envrcpt.html xxfi_eoh.html \
		xxfi_eom.html xxfi_header.html xxfi_helo.html \
		xxfi_negotiate.html xxfi_unknown.html
MDOCDIR=	${DESTDIR}${DOCDIR}/html/milter
SRCS=		main.c engine.c listener.c worker.c handler.c comm.c smfi.c \
		signal.c sm_gethost.c monitor.c errstring.c strl.c
CPPFLAGS+=	-D_FFR_MILTER_ROOT_UNSAFE -ULDAPMAP -pthread \
		-Dsm_snprintf=snprintf \
		-DSM_CONF_POLL
.PATH:		${.CURDIR}/../libsm

beforeinstall:
	cmp -s ${.CURDIR}/README ${DESTDIR}${SHAREDIR}/sendmail/README.milter \
	    || ${INSTALL} ${INSTALL_COPY} -o ${DOCOWN} -g ${DOCGRP} \
	    -m ${DOCMODE} ${.CURDIR}/README \
	    ${DESTDIR}${SHAREDIR}/sendmail/README.milter
	@@echo "installing ${DOCS} -> ${MDOCDIR}"
	@@test -d ${MDOCDIR} || mkdir -p ${MDOCDIR}
	@@-for i in ${DOCS}; do \
		cmp -s ${.CURDIR}/docs/$$i ${MDOCDIR}/$$i || \
		    ${INSTALL} ${INSTALL_COPY} -o ${DOCOWN} -g ${DOCGRP} \
		    -m ${DOCMODE} ${.CURDIR}/docs/$$i ${MDOCDIR} ; \
	done

.include <bsd.lib.mk>
@


1.10
log
@merge newer sendmail; fix and correct; reduce upstream diffs; prep for deb
@
text
@d1 2
a2 2
# $MirOS: src/gnu/usr.sbin/sendmail/libmilter/Makefile,v 1.9 2009/09/12 20:33:08 tg Exp $
# $OpenBSD: Makefile,v 1.11 2007/02/04 13:17:35 millert Exp $
d31 2
a32 1
		-Dsm_snprintf=snprintf
@


1.9
log
@this builds with -pthread so it must link with -pthread, which
implies LDADD+=-lpthread, thusly DPADD+=${LIBPTHREAD} too
@
text
@d1 2
a2 2
# $MirOS: src/gnu/usr.sbin/sendmail/libmilter/Makefile,v 1.8 2008/05/07 13:15:20 tg Exp $
#	$OpenBSD: Makefile,v 1.11 2007/02/04 13:17:35 millert Exp $
@


1.8
log
@merge and reduce diffs against upstream
@
text
@d1 1
a1 1
# $MirOS: src/gnu/usr.sbin/sendmail/libmilter/Makefile,v 1.7 2007/05/17 17:27:50 tg Exp $
d7 2
@


1.7
log
@use generic includes target
@
text
@d1 2
a2 2
# $MirOS: src/gnu/usr.sbin/sendmail/libmilter/Makefile,v 1.6 2007/02/05 17:44:28 tg Exp $
# $OpenBSD: Makefile,v 1.11 2007/02/04 13:17:35 millert Exp $
d11 1
a11 1
		installation.html other.html overview.html sample.html \
d42 1
a42 1
		    -m ${DOCMODE} ${.CURDIR}/docs/$$i ${MDOCDIR}; \
@


1.7.2.1
log
@MFC sendmail update to 8.14.3

agreed bsiegert@@
@
text
@d1 2
a2 2
# $MirOS: src/gnu/usr.sbin/sendmail/libmilter/Makefile,v 1.8 2008/05/07 13:15:20 tg Exp $
#	$OpenBSD: Makefile,v 1.11 2007/02/04 13:17:35 millert Exp $
d11 1
a11 1
                installation.html other.html overview.html sample.html \
d42 1
a42 1
		    -m ${DOCMODE} ${.CURDIR}/docs/$$i ${MDOCDIR} ; \
@


1.6
log
@sync list of docs
@
text
@d1 1
a1 1
# $MirOS: src/gnu/usr.sbin/sendmail/libmilter/Makefile,v 1.5 2007/02/05 17:13:43 tg Exp $
d8 2
a31 9
includes:
	${INSTALL} -d -o ${BINOWN} -g ${BINGRP} -m ${DIRMODE} \
	    ${DESTDIR}/usr/include/libmilter
.for _i in ${HDRS}
	${INSTALL} ${INSTALL_COPY} -o ${BINOWN} -g ${BINGRP} \
	    -m ${NONBINMODE} ${.CURDIR}/../include/libmilter/${_i} \
	    ${DESTDIR}/usr/include/libmilter/${_i}
.endfor

@


1.5
log
@merge
@
text
@d1 1
a1 1
# $MirOS: src/gnu/usr.sbin/sendmail/libmilter/Makefile,v 1.4 2006/03/23 13:31:43 tg Exp $
d10 13
a22 11
		smfi_addheader.html smfi_addrcpt.html smfi_chgheader.html \
		smfi_delrcpt.html smfi_getpriv.html smfi_getsymval.html \
		smfi_insheader.html smfi_main.html smfi_opensocket.html \
		smfi_progress.html smfi_quarantine.html smfi_register.html \
		smfi_replacebody.html smfi_setbacklog.html \
		smfi_setconn.html smfi_setdbg.html smfi_setmlreply.html \
		smfi_setpriv.html smfi_setreply.html smfi_settimeout.html \
		smfi_stop.html xxfi_abort.html xxfi_body.html \
		xxfi_close.html xxfi_connect.html xxfi_envfrom.html \
		xxfi_envrcpt.html xxfi_eoh.html xxfi_eom.html \
		xxfi_header.html xxfi_helo.html
@


1.4
log
@* Makefile.inc: use ${LOCALBASE} not /usr/local
* libmilter/Makefile: use ${DIRMODE} not hardcode 755
@
text
@d1 2
a2 2
# $MirOS: src/gnu/usr.sbin/sendmail/libmilter/Makefile,v 1.3 2006/03/23 13:20:21 tg Exp $
# $OpenBSD: Makefile,v 1.10 2005/10/12 18:54:56 deraadt Exp $
d22 2
a23 2
SRCS=		main.c engine.c listener.c handler.c comm.c smfi.c signal.c \
		sm_gethost.c errstring.c strl.c
@


1.3
log
@fastmerge Sendmail 8.13.6
@
text
@d1 1
a1 1
# $MirOS: src/gnu/usr.sbin/sendmail/libmilter/Makefile,v 1.2 2005/03/13 15:11:45 tg Exp $
d29 1
a29 1
	${INSTALL} -d -o ${BINOWN} -g ${BINGRP} -m 755 \
@


1.2
log
@merge sendmail diff against OpenBSD's idea of sendmail port
@
text
@d1 2
a2 2
# $MirOS$
# $OpenBSD: Makefile,v 1.9 2004/12/22 17:01:03 millert Exp $
a27 3
# Only build the .a version for now.
NOPIC=yes

@


1.1
log
@Initial revision
@
text
@d1 2
a2 1
#	$OpenBSD: Makefile,v 1.9 2004/12/22 17:01:03 millert Exp $
d9 12
a20 12
                installation.html other.html overview.html sample.html \
                smfi_addheader.html smfi_addrcpt.html smfi_chgheader.html \
                smfi_delrcpt.html smfi_getpriv.html smfi_getsymval.html \
                smfi_insheader.html smfi_main.html smfi_opensocket.html \
                smfi_progress.html smfi_quarantine.html smfi_register.html \
                smfi_replacebody.html smfi_setbacklog.html \
                smfi_setconn.html smfi_setdbg.html smfi_setmlreply.html \
                smfi_setpriv.html smfi_setreply.html smfi_settimeout.html \
                smfi_stop.html xxfi_abort.html xxfi_body.html \
                xxfi_close.html xxfi_connect.html xxfi_envfrom.html \
                xxfi_envrcpt.html xxfi_eoh.html xxfi_eom.html \
                xxfi_header.html xxfi_helo.html
d29 1
a29 1
NOPIC=1
d32 7
a38 9
	@@test -d ${DESTDIR}/usr/include/libmilter || \
	    mkdir -p ${DESTDIR}/usr/include/libmilter
	@@cd ${.CURDIR}/../include/libmilter; for i in $(HDRS); do \
	    j="cmp -s $$i ${DESTDIR}/usr/include/libmilter/$$i || \
		${INSTALL} ${INSTALL_COPY} -o ${BINOWN} -g ${BINGRP} -m 444 $$i \
		${DESTDIR}/usr/include/libmilter"; \
	    echo $$j; \
	    eval "$$j"; \
	done
d41 4
a44 3
	cmp -s ${.CURDIR}/README ${DESTDIR}${SHAREDIR}/sendmail/README.milter || \
	    ${INSTALL} ${INSTALL_COPY} -o ${BINOWN} -g ${BINGRP} -m 444 \
	    ${.CURDIR}/README ${DESTDIR}${SHAREDIR}/sendmail/README.milter
d46 1
a46 1
	@@test -d ${MDOCDIR} || mkdir ${MDOCDIR}
d50 1
a50 1
		    -m ${DOCMODE} ${.CURDIR}/docs/$$i ${MDOCDIR} ; \
@


1.1.127.1
log
@Import Sendmail 8.14.3, suitably stripped down by the not yet committed
contrib/samples/import-3rdpty,v 1.35; we have some new and renamed files
@
text
@d1 1
a1 1
#       $Id: Makefile,v 8.2 2006/05/23 21:55:55 ca Exp $
d3 1
a3 12
SHELL= /bin/sh
BUILD=   ./Build
OPTIONS= $(CONFIG) $(FLAGS)

all: FRC
	$(SHELL) $(BUILD) $(OPTIONS) $@@
check: FRC
	$(SHELL) $(BUILD) $(OPTIONS) $@@
clean: FRC
	$(SHELL) $(BUILD) $(OPTIONS) $@@
install: FRC
	$(SHELL) $(BUILD) $(OPTIONS) $@@
d5 21
a25 2
fresh: FRC
	$(SHELL) $(BUILD) $(OPTIONS) -c
d27 27
a53 1
FRC:
@


1.1.1.1
log
@Import the OpenBSD foundation of MirOS BSD
@
text
@@


1.1.1.2
log
@Update to Sendmail 8.13.6
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.10 2005/10/12 18:54:56 deraadt Exp $
d27 3
@


1.1.1.3
log
@Import Sendmail 8.14.0 via OpenBSD
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.11 2007/02/04 13:17:35 millert Exp $
d21 2
a22 2
SRCS=		main.c engine.c listener.c worker.c handler.c comm.c smfi.c \
		signal.c sm_gethost.c monitor.c errstring.c strl.c
@


1.1.1.4
log
@Import whatever OpenBSD did to sendmail 8.14.3 in the last two years
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.12 2009/05/13 18:24:15 jakob Exp $
d24 1
a24 2
		-Dsm_snprintf=snprintf \
		-DSM_CONF_POLL
@


