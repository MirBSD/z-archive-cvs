head	1.6;
access;
symbols
	sendmail-8_14_9:1.1.127.2
	sendmail-8_14_7:1.1.127.1
	sendmail-8_14_6:1.1.127.1
	sendmail-8_14_5-ERRATA-1:1.1.127.1
	mbsd-20101220_mergebase:1.4
	sendmail-8_14_5:1.1.127.1
	cvs-201107021500:1.1.1.5
	cvs-20101220:1.1.1.4
	mbsd-20101220:1.4.0.2
	cvs-201012191730:1.1.1.3
	sendmail-8_14_5_Beta0:1.1.127.1
	sendmail-8_14_3:1.1.127.1
	sendmail:1.1.127
	cvs-200812170000:1.1.1.2
	cvs-200805071200:1.1.1.2
	MIRBSD_10:1.1.1.1.0.4
	MIRBSD_10_BASE:1.1.1.1
	cvs-200803022030:1.1.1.1
	cvs-200707152000:1.1.1.1
	cvs-200704292000:1.1.1.1
	cvs-200702051700:1.1.1.1
	cvs-200609121900:1.1.1.1
	MIRBSD_9_BASE:1.1.1.1
	cvs-200606151800:1.1.1.1
	cvs-200603231300:1.1.1.1
	MIRBSD_8:1.1.1.1.0.2
	MIRBSD_8_BASE:1.1.1.1
	cvs-200507211800:1.1.1.1
	cvs-200504262050:1.1.1.1
	openbsd:1.1.1;
locks; strict;
comment	@.\" @;


1.6
date	2014.06.09.15.17.40;	author tg;	state Exp;
branches;
next	1.5;
commitid	1005395CFC65E5646F1;

1.5
date	2012.12.31.21.02.34;	author tg;	state Exp;
branches;
next	1.4;
commitid	10050E1FD6765F66D0C;

1.4
date	2010.12.19.17.54.17;	author tg;	state Exp;
branches;
next	1.3;
commitid	1004D0E46D819D7E113;

1.3
date	2008.05.07.13.15.23;	author tg;	state Exp;
branches;
next	1.2;
commitid	1004821AB7510EE48FB;

1.2
date	2008.05.07.11.57.05;	author tg;	state Exp;
branches;
next	1.1;
commitid	100482198DE5A7916C7;

1.1
date	2005.02.05.17.24.28;	author tg;	state Exp;
branches
	1.1.1.1
	1.1.127.1;
next	;

1.1.1.1
date	2005.02.05.17.24.28;	author tg;	state Exp;
branches
	1.1.1.1.4.1;
next	1.1.1.2;

1.1.1.2
date	2008.05.07.12.31.50;	author tg;	state Exp;
branches;
next	1.1.1.3;
commitid	1004821A13C1FC036E1;

1.1.1.3
date	2010.12.19.17.39.43;	author tg;	state Exp;
branches;
next	1.1.1.4;
commitid	1004D0E436269567D7C;

1.1.1.4
date	2011.07.02.15.00.31;	author tg;	state Exp;
branches;
next	1.1.1.5;
commitid	1004E0F31C5496AB95F;

1.1.1.5
date	2011.07.02.15.17.41;	author tg;	state Exp;
branches;
next	;
commitid	1004E0F36A10B5CA95B;

1.1.1.1.4.1
date	2008.05.17.19.11.59;	author tg;	state Exp;
branches;
next	;
commitid	100482F2DC168C89AEA;

1.1.127.1
date	2010.12.19.14.45.43;	author tg;	state Exp;
branches;
next	1.1.127.2;
commitid	1004D0E1A94384778FD;

1.1.127.2
date	2014.06.09.14.29.15;	author tg;	state Exp;
branches;
next	;
commitid	1005395C4CC1A6DB9EE;


desc
@@


1.6
log
@merge
@
text
@.\"	$OpenBSD: makemap.8,v 1.12 2010/09/23 14:51:57 jmc Exp $
.\"
.\" Copyright (c) 1998-2002 Sendmail, Inc. and its suppliers.
.\"	 All rights reserved.
.\" Copyright (c) 1988, 1991, 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" By using this file, you agree to the terms and conditions set
.\" forth in the LICENSE file which can be found at the top level of
.\" the sendmail distribution.
.\"
.\"
.\"     $Id: makemap.8,v 8.32 2013-11-22 20:51:52 ca Exp $
.\"
.Dd $Mdocdate: December 31 2012 $
.Dt MAKEMAP 8
.Os
.Sh NAME
.Nm makemap
.Nd create database maps for sendmail
.Sh SYNOPSIS
.Nm makemap
.Op Fl C Ar file
.Op Fl N
.Op Fl c Ar cachesize
.Op Fl D Ar commentchar
.Op Fl d
.Op Fl e
.Op Fl f
.Op Fl l
.Op Fl o
.Op Fl r
.Op Fl s
.Op Fl t Ar delim
.Op Fl u
.Op Fl v
.Ar maptype
.Ar mapname
.Sh DESCRIPTION
.Nm
creates the database maps used by the keyed map lookups in
.Xr sendmail 8 .
It reads input from the standard input
and outputs them to the indicated
.Ar mapname .
.Pp
Depending on how it is compiled,
.Nm
handles up to three different database formats,
selected using the
.Ar maptype
parameter.
They may be
.Bl -tag -width Fl
.It Li dbm
DBM format maps.
This requires the
.Xr ndbm 3
library.
.It Li btree
B-Tree format maps.
This requires the new Berkeley DB
library.
.It Li hash
Hash format maps.
This also requires the Berkeley DB
library.
.El
.Pp
In all cases,
.Nm
reads lines from the standard input consisting of two
words separated by whitespace.
The first is the database key,
the second is the value.
The value may contain
``%\fIn\fP''
strings to indicated parameter substitution.
Literal percents should be doubled
(``%%'').
Blank lines and lines beginning with ``#'' are ignored.
.Pp
Notice: do
.Em not
use
.Nm
to create the aliases data base, but
.Xr newaliases 8
which puts a special token into the data base that is required by
.Xr sendmail 8 .
.Pp
If the
.Li TrustedUser
option is set in the sendmail configuration file and
.Nm
is invoked as root, the generated files will be owned by
the specified
.Li TrustedUser .
.Ss Flags
.Bl -tag -width Fl
.It Fl C Ar file
Use the specified
.Xr sendmail 8
configuration
.Ar file
for looking up the
.Li TrustedUser
option.
.It Fl N
Include the null byte that terminates strings
in the map.
This must match the
.Fl N
flag in the sendmail.cf
.Dq K
line.
.It Fl c
Use the specified hash and B-Tree cache size.
.It Fl D
Use to specify the character to use to indicate a comment (which is ignored)
instead of the default of
.Sq # .
.It Fl d
Allow duplicate keys in the map.
This is only allowed on B-Tree format maps.
If two identical keys are read,
they will both be inserted into the map.
.It Fl e
Allow empty value (right hand side).
.It Fl f
Normally all upper case letters in the key
are folded to lower case.
This flag disables that behaviour.
This is intended to mesh with the
.Fl f
flag in the
.Dq K
line in sendmail.cf.
The value is never case folded.
.It Fl l
List supported map types.
.It Fl o
Append to an old file.
This allows you to augment an existing file.
.It Fl r
Allow replacement of existing keys.
Normally
.Nm
complains if you repeat a key,
and does not do the insert.
.It Fl s
Ignore safety checks on maps being created.
This includes checking for hard or symbolic
links in world writable directories.
.It Fl t
Use the specified delimiter instead of white space
(also for dumping a map).
.It Fl u
dump (unmap) the content of the database to standard output.
.It Fl v
Verbosely print what it is doing.
.El
.Sh SEE ALSO
.Xr editmap 8 ,
.Xr newaliases 8 ,
.Xr sendmail 8
.Sh HISTORY
The
.Nm
command appeared in
.Bx 4.4 .
@


1.5
log
@merge sendmail 8.14.6
@
text
@d13 1
a13 1
.\"     $Id: makemap.8,v 8.31 2008/05/02 23:07:48 ca Exp $
d15 1
a15 1
.Dd $Mdocdate: December 19 2010 $
@


1.4
log
@merge openbsd sendmail
@
text
@d4 1
a4 1
.\"	All rights reserved.
@


1.3
log
@merge and reduce diffs against upstream
@
text
@d1 2
d13 1
a13 1
.\"     $Sendmail: makemap.8,v 8.31 2008/05/02 23:07:48 ca Exp $
d15 1
a15 1
.Dd May 2, 2008
@


1.2
log
@update to sendmail 8.14.3 (which has been on my TODO for 4 days *shames*),
a hah-I-knew-it! update for a bug I reported in IRC… (which seems lost, as
only DFBSD, OBSD etc. are credited for finding):

Sendmail, Inc., and the Sendmail Consortium announce the availability
of sendmail 8.14.3. This version fixes some bugs:

o the MTA accessed storage after it free()d it. This was a regression
  introduced in 8.14.2, but the bug only showed up on a few operating
  systems.
o ruleset processing: the function cataddr() could cause the
  addition of the BlankSub character between some tokens when it
  should not happen and thus failures in rule matching.  It seems
  that none of the default rules were affected by this bug and hence
  the problem did not show up for default configurations.
o the libmilter state engine did not deal correctly with milters
  that requested the omission of protocol steps during the negotiation
  callback.

A complete list of changes can be found in the release notes […]
@
text
@d13 1
a13 1
.Dd $Mdocdate$
@


1.1
log
@Initial revision
@
text
@d11 1
a11 1
.\"     $Sendmail: makemap.8,v 8.30 2002/06/27 23:41:04 gshapiro Exp $
d13 1
a13 1
.Dd October 10, 2001
d154 2
a155 1
Use the specified delimiter instead of white space.
@


1.1.127.1
log
@Import Sendmail 8.14.3, suitably stripped down by the not yet committed
contrib/samples/import-3rdpty,v 1.35; we have some new and renamed files
@
text
@d2 1
a2 1
.\"	 All rights reserved.
d11 1
a11 1
.\"     $Id: makemap.8,v 8.31 2008/05/02 23:07:48 ca Exp $
d13 26
a38 28
.TH MAKEMAP 8 "$Date: 2008/05/02 23:07:48 $"
.SH NAME
makemap
\- create database maps for sendmail
.SH SYNOPSIS
.B makemap
.RB [ \-C
.IR file ]
.RB [ \-N ]
.RB [ \-c
.IR cachesize ]
.RB [ \-d ]
.RB [ \-D
.IR commentchar ]
.RB [ \-e ]
.RB [ \-f ]
.RB [ \-l ]
.RB [ \-o ]
.RB [ \-r ]
.RB [ \-s ]
.RB [ \-t
.IR delim ]
.RB [ \-u ]
.RB [ \-v ]
.I 
maptype mapnam
.SH DESCRIPTION
.B Makemap
d40 1
a40 1
sendmail(8).  
d43 2
a44 2
.I mapname.
.PP
d46 2
a47 2
.B makemap
handles up to three different database formats, 
d49 2
a50 2
.I maptype
parameter.  
d52 5
a56 5
.TP
dbm
DBM format maps.  
This requires the 
ndbm(3) 
d58 3
a60 4
.TP
btree
B-Tree format maps.  
This requires the new Berkeley DB 
d62 3
a64 4
.TP
hash
Hash format maps.  
This also requires the Berkeley DB 
d66 2
a67 1
.PP
d69 9
a77 9
.B makemap
reads lines from the standard input consisting of two 
words separated by white space.  
The first is the database key, 
the second is the value.  
The value may contain 
``%\fIn\fP'' 
strings to indicate parameter substitution.  
Literal percents should be doubled 
d80 1
a80 1
.PP
d82 1
a82 1
.B not
d84 1
a84 1
.B makemap
d86 1
a86 1
.B newaliases
d88 2
a89 2
.B sendmail.
.PP
d91 1
a91 1
.I TrustedUser
d93 2
a94 2
.B makemap
is invoked as root, the generated files will be owned by 
d96 4
a99 4
.IR TrustedUser.
.SS Flags
.TP  
.B \-C
d101 15
a115 10
.B sendmail
configuration file for looking up the TrustedUser option.
.TP 
.B \-N
Include the null byte that terminates strings 
in the map.  
This must match the \-N flag in the sendmail.cf 
``K'' line.
.TP
.B \-c
d117 1
a117 2
.TP
.B \-D
d119 6
a124 6
instead of the default of '#'.
.TP
.B \-d
Allow duplicate keys in the map.  
This is only allowed on B-Tree format maps.  
If two identical keys are read, 
d126 1
a126 2
.TP
.B \-e
d128 9
a136 9
.TP
.B \-f
Normally all upper case letters in the key 
are folded to lower case.  
This flag disables that behaviour.  
This is intended to mesh with the 
\-f flag in the 
.B K 
line in sendmail.cf.  
d138 1
a138 2
.TP
.B \-l
d140 2
a141 3
.TP
.B \-o
Append to an old file.  
d143 2
a144 3
.TP
.B \-r
Allow replacement of existing keys.  
d146 2
a147 2
.B makemap
complains if you repeat a key, 
d149 3
a151 4
.TP
.B \-s
Ignore safety checks on maps being created.  
This includes checking for hard or symbolic 
d153 3
a155 6
.TP
.B \-t
Use the specified delimiter instead of white space
(also for dumping a map).
.TP
.B \-u
d157 1
a157 2
.TP
.B \-v
d159 6
a164 3
.SH SEE ALSO
sendmail(8), newaliases(1)
.SH HISTORY
d166 3
a168 3
.B makemap
command appeared in 
4.4BSD.
@


1.1.127.2
log
@Import sendmail 8.14.9
@
text
@d1 1
a1 1
.\" Copyright (c) 1998-2002 Proofpoint, Inc. and its suppliers.
d11 1
a11 1
.\"     $Id: makemap.8,v 8.32 2013-11-22 20:51:52 ca Exp $
d13 1
a13 1
.TH MAKEMAP 8 "$Date: 2013-11-22 20:51:52 $"
@


1.1.1.1
log
@Import the OpenBSD foundation of MirOS BSD
@
text
@@


1.1.1.1.4.1
log
@MFC sendmail update to 8.14.3

agreed bsiegert@@
@
text
@d11 1
a11 1
.\"     $Sendmail: makemap.8,v 8.31 2008/05/02 23:07:48 ca Exp $
d13 1
a13 1
.Dd May 2, 2008
d154 1
a154 2
Use the specified delimiter instead of white space
(also for dumping a map).
@


1.1.1.2
log
@OpenBSD finally has upgraded their sendmail, too…
@
text
@d11 1
a11 1
.\"     $Sendmail: makemap.8,v 8.31 2008/05/02 23:07:48 ca Exp $
d13 1
a13 1
.Dd May 2, 2008
d154 1
a154 2
Use the specified delimiter instead of white space
(also for dumping a map).
@


1.1.1.3
log
@Import whatever OpenBSD did to sendmail 8.14.3 in the last two years
@
text
@a0 2
.\"	$OpenBSD: makemap.8,v 1.12 2010/09/23 14:51:57 jmc Exp $
.\"
d13 1
a13 1
.Dd $Mdocdate: September 23 2010 $
@


1.1.1.4
log
@Replace “$Sendmail: ” with “$Id: ” (the latter is used by upstream)
@
text
@d13 1
a13 1
.\"     $Id: makemap.8,v 8.31 2008/05/02 23:07:48 ca Exp $
d15 1
a15 1
.Dd $Mdocdate: December 19 2010 $
@


1.1.1.5
log
@Import OpenBSD’s sendmail 8.14.5, RCS IDs properly sedded back
@
text
@d15 1
a15 1
.Dd $Mdocdate: September 23 2010 $
@


