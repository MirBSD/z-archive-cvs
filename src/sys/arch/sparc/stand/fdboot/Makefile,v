head	1.5;
access;
symbols;
locks; strict;
comment	@# @;


1.5
date	2010.01.16.20.56.08;	author tg;	state Exp;
branches;
next	1.4;
commitid	1004B5227F669D8B3E6;

1.4
date	2010.01.10.12.55.22;	author tg;	state Exp;
branches;
next	1.3;
commitid	1004B49CE4755206B66;

1.3
date	2009.04.17.18.57.09;	author tg;	state Exp;
branches;
next	1.2;
commitid	10049E8D11A2584B057;

1.2
date	2008.10.21.18.51.00;	author tg;	state Exp;
branches;
next	1.1;
commitid	10048FE24A97E59C6EE;

1.1
date	2008.07.13.19.42.40;	author tg;	state Exp;
branches;
next	;
commitid	100487A5AB509C87D3D;


desc
@@


1.5
log
@add ustarfs to the floppy bootloader (untested)
@
text
@# $MirOS: src/sys/arch/sparc/stand/fdboot/Makefile,v 1.4 2010/01/10 12:55:22 tg Exp $

SMALL_BOOT=	Yes
BOOTLDR_PATH?=	${.CURDIR}/../boot
CPPFLAGS+=	-DUSE_USTARFS

.PATH: ${BOOTLDR_PATH}

# This gets installed under a different name
realinstall:
	${INSTALL} ${INSTALL_COPY} ${INSTALL_STRIP} -o ${BINOWN} -g ${BINGRP} \
	    -m ${BINMODE} ${PROG} ${DESTDIR}${BINDIR}/boot.fd

.include "${BOOTLDR_PATH}/Makefile"

SRCS+=		strerr.c
${PROG}.elf:	strerr.o
@


1.4
log
@install the floppy bootloaders too, to simplify things
@
text
@d1 1
a1 1
# $MirOS: src/sys/arch/sparc/stand/fdboot/Makefile,v 1.3 2009/04/17 18:57:09 tg Exp $
d5 1
@


1.3
log
@make fdboot smaller
@
text
@d1 1
a1 1
# $MirOS: src/sys/arch/sparc/stand/fdboot/Makefile,v 1.2 2008/10/21 18:51:00 tg Exp $
d8 4
a11 2
# This doesn't get installed
install:
@


1.2
log
@strip locals but not globals from the various bootloader stuffs,
to enable using nm to find the __defkernel symbol in the sparc
second-stage bootloader, and shrink down the first-stage loaders
of both architectures.

The enlarged, symbol-table-enhanced sparc /boot works on my SS20.

Before:

-r-xr-xr-x   1 root  bin    - 38752 Oct 18 13:28 boot*
-r-xr-xr-x   1 root  bin    - 40440 Oct 18 13:28 bootxx*
-r--r--r--   1 root  bin    - 30634 Oct 18 13:07 bootxx.sh

-r--r--r--   1 root  bin    -  7394 Oct 17 00:07 bootxx.sh

After:

-r-xr-xr-x   1 root  bin    - 76254 Oct 21 18:40 boot*
-r-xr-xr-x   1 root  bin    - 40233 Oct 21 18:40 bootxx*
-rw-r--r--   1 tg    wsrc   - 25167 Oct 21 18:40 bxinst

-rw-r--r--   1 tg    wsrc   -  7293 Oct 21 18:38 bxinst
@
text
@d1 1
a1 1
# $MirOS: src/sys/arch/sparc/stand/fdboot/Makefile,v 1.1 2008/07/13 19:42:40 tg Exp $
d12 3
@


1.1
log
@like with i386, provide a 4.2FFS-only floppy boot loader, to make them fit
@
text
@d1 1
a1 1
# $MirOS$
a2 1
CPPFLAGS+=	-DSMALL_BOOT
d4 1
a4 1
BOOTLDR_PATH=	${.CURDIR}/../boot
@

