head	1.9;
access;
symbols
	tg-beforemerge-ksrc10:1.1.1.1
	cvs-200808011000:1.1.1.1
	MIRBSD_10:1.8.0.2
	MIRBSD_10_BASE:1.8
	MIRBSD_9_BASE:1.4
	MIRBSD_8:1.4.0.2
	MIRBSD_8_BASE:1.4
	cvs-200507032030:1.1.1.1
	cvs-200505050030:1.1.1.1
	cvs-200504291700:1.1.1.1
	openbsd:1.1.1;
locks; strict;
comment	@# @;


1.9
date	2008.08.01.15.43.46;	author tg;	state dead;
branches;
next	1.8;
commitid	10048932F424C3503E1;

1.8
date	2007.05.10.13.09.22;	author tg;	state Exp;
branches;
next	1.7;
commitid	1004643195847EA64E6;

1.7
date	2007.03.02.03.13.26;	author tg;	state Exp;
branches;
next	1.6;
commitid	10045E7958604F58BEB;

1.6
date	2006.10.15.01.35.54;	author tg;	state Exp;
branches;
next	1.5;
commitid	1004531907179DB61BE;

1.5
date	2006.08.19.12.59.53;	author tg;	state Exp;
branches;
next	1.4;
commitid	10044E70B533B58C0BB;

1.4
date	2005.07.07.12.46.12;	author tg;	state Exp;
branches;
next	1.3;
commitid	136b42cd2408bf6f;

1.3
date	2005.07.07.12.27.28;	author tg;	state Exp;
branches;
next	1.2;
commitid	63f442cd1fb827f1;

1.2
date	2005.03.06.21.27.08;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.02.05.17.27.29;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.02.05.17.27.29;	author tg;	state Exp;
branches;
next	;


desc
@@


1.9
log
@switch i386 bootloader to kern zlib
@
text
@# $MirOS: src/sys/arch/i386/stand/libz/Makefile,v 1.8 2007/05/10 13:09:22 tg Exp $

.include <bsd.own.mk>

# This is needed for libz in the boot loader
S=		${.CURDIR}/../../../..
CPPFLAGS+=	${SACFLAGS:M-[DI]*} -I${S}/lib/libsa
COPTS+=		${SACFLAGS:N-[DI]*} ${DEBUGFLAGS}
CPPFLAGS+=	-DZCONST=const

# This is used to build a small libz
CPPFLAGS+=	-DSLOW -DSMALL -DNOBYFOUR -DNO_GZIP
CPPFLAGS+=	-DDYNAMIC_CRC_TABLE -DBUILDFIXED

LIB=		z
SRCS=		crc32.c infback.c inffast.c inflate.c inftrees.c
.PATH: ${BSDSRCDIR}/lib/libz

NOPIC=		Yes
DEBUGLIBS=	No

install:

.include <bsd.lib.mk>
@


1.8
log
@• fix missing ZCONST
• fix floppy ramdisk not fitting (probably due to whirlpool etc. addition)
• fix symlink'd manpages (XFree86®) missing from the htman set (the MLINKS
  from base are hardlink'd)

not a full sync, but close
@
text
@d1 1
a1 1
# $MirOS: src/sys/arch/i386/stand/libz/Makefile,v 1.7 2007/03/02 03:13:26 tg Exp $
@


1.7
log
@• make the kernel use the adler32() stuff in src/kern, whose sources
  live in the z part but that, logically, more belongs to the c part
• export adler32 (over <sys/systm.h> -> libkern -> <libckern.h>) and
  the rnd_bootpool (via <sys/systm.h> directly) to all of the kernel
• adler32 for the kernel moves to libkern
• adler32 for the i386 bootloader moves to libsa
• adler32 for the sparc bootloader moves to libkern
• userland libz is not affected (yet); make depend still pulls it in

tested by building a GENERIC, a bsd.rd with it, a cdrom9.fs with the
new bootloader (i386), qemu'ing that
@
text
@d1 1
a1 1
# $MirOS: src/sys/arch/i386/stand/libz/Makefile,v 1.6 2006/10/15 01:35:54 tg Exp $
d9 1
@


1.6
log
@* add -fno-omit-frame-pointer to boot blocks too -> unbreaks
* add COPTS and CFLAGS and CPPFLAGS correctly and in correct order
@
text
@d1 1
a1 1
# $MirOS: src/sys/arch/i386/stand/libz/Makefile,v 1.5 2006/08/19 12:59:53 tg Exp $
d15 1
a15 1
SRCS=		adler32.S crc32.c infback.c inffast.c inflate.c inftrees.c
@


1.5
log
@shrink even more by using my own assembly version of adler32(3)
@
text
@d1 1
a1 1
# $MirOS: src/sys/arch/i386/stand/libz/Makefile,v 1.4 2005/07/07 12:46:12 tg Exp $
d7 2
a8 2
CFLAGS+=	${SACFLAGS} ${DEBUGFLAGS}
CPPFLAGS+=	-I${S}/lib/libsa
@


1.4
log
@* regenerate headers at depend time
* do not include inffixed tables into bootloader, shaves off another ~2 kB
@
text
@d1 1
a1 1
# $MirOS: src/sys/arch/i386/stand/libz/Makefile,v 1.3 2005/07/07 12:27:28 tg Exp $
d15 1
a15 1
SRCS=		adler32.c crc32.c infback.c inffast.c inflate.c inftrees.c
@


1.3
log
@unify libz use (make bootloader use base libz sources)
simplify defines
add more RCS IDs
shrink code
@
text
@d1 1
a1 1
# $MirOS$
d11 2
a12 1
CPPFLAGS+=	-DSLOW -DSMALL -DNOBYFOUR -DNO_GZIP -DDYNAMIC_CRC_TABLE
@


1.2
log
@* merge src/sys/
  (at least the better part of it)
* revert IPv6 networking to OpenBSD, since
  I didn't get IPV4_MAPPED addresses working :(
@
text
@a1 2
# $OpenBSD: Makefile,v 1.11 2003/12/18 02:27:13 millert Exp $
# $NetBSD: Makefile,v 1.2 1997/01/22 01:36:30 cgd Exp $
d3 3
d7 14
a20 3
ZDST=		${.OBJDIR}
SADIR=		${.CURDIR}/..
CPPFLAGS=	${SACFLAGS} -I${S}/lib/libsa ${DEBUGFLAGS} -Dzmemcpy=memmove
d22 1
a22 2
.PATH:		${S}/lib/libz
.include "${S}/lib/libz/Makefile"
@


1.1
log
@Initial revision
@
text
@d1 3
a3 2
#	$OpenBSD: Makefile,v 1.11 2003/12/18 02:27:13 millert Exp $
#	$NetBSD: Makefile,v 1.2 1997/01/22 01:36:30 cgd Exp $
d5 4
a8 5
S=${.CURDIR}/../../../..
ZDST=${.OBJDIR}
SADIR=${.CURDIR}/..

.PATH: ${S}/lib/libz
d10 1
a11 1
CFLAGS+=${SACFLAGS} -I${S}/lib/libsa ${DEBUGFLAGS}
@


1.1.1.1
log
@Import the OpenBSD foundation of MirOS BSD
@
text
@@
