head	1.14;
access;
symbols
	tg-use_ldscript:1.12.0.2
	MIRBSD_10:1.6.0.2
	MIRBSD_10_BASE:1.6
	MIRBSD_9_BASE:1.2;
locks; strict;
comment	@# @;


1.14
date	2010.01.10.19.21.36;	author tg;	state Exp;
branches;
next	1.13;
commitid	1004B4A28CB0F23DD4D;

1.13
date	2010.01.10.12.55.21;	author tg;	state Exp;
branches;
next	1.12;
commitid	1004B49CE4755206B66;

1.12
date	2009.02.01.16.16.31;	author tg;	state Exp;
branches;
next	1.11;
commitid	1004985CAF60EA15845;

1.11
date	2009.01.10.22.18.52;	author tg;	state Exp;
branches;
next	1.10;
commitid	10049691EDB67E0F5CA;

1.10
date	2009.01.10.13.41.18;	author tg;	state Exp;
branches;
next	1.9;
commitid	1004968A59443A02B58;

1.9
date	2009.01.10.13.28.10;	author tg;	state Exp;
branches;
next	1.8;
commitid	1004968A28021806C56;

1.8
date	2009.01.02.16.38.37;	author tg;	state Exp;
branches;
next	1.7;
commitid	100495E430D546F7076;

1.7
date	2008.08.01.15.43.46;	author tg;	state Exp;
branches;
next	1.6;
commitid	10048932F424C3503E1;

1.6
date	2007.05.24.21.38.05;	author tg;	state Exp;
branches;
next	1.5;
commitid	100465605D344E11D22;

1.5
date	2007.03.18.04.46.21;	author tg;	state Exp;
branches;
next	1.4;
commitid	10045FCC4347FA0AC5C;

1.4
date	2006.08.19.14.20.29;	author tg;	state Exp;
branches;
next	1.3;
commitid	10044E71E3D359AC2FA;

1.3
date	2006.08.19.12.45.47;	author tg;	state Exp;
branches;
next	1.2;
commitid	10044E7080820F3E8BE;

1.2
date	2006.05.15.20.47.40;	author tg;	state Exp;
branches;
next	1.1;
commitid	1004468E8FB2983A48D;

1.1
date	2006.05.15.20.47.06;	author tg;	state Exp;
branches;
next	;
commitid	1004468E8C548985FB8;


desc
@@


1.14
log
@new ustarfs for the bootloader (fdboot only ATM, since boot’s too huge)
@
text
@# $MirOS: src/sys/arch/i386/stand/fdboot/Makefile,v 1.13 2010/01/10 12:55:21 tg Exp $

#BOOTSELECT_HOOK=yes
BOOTLDR_PATH=	${.CURDIR}/../boot
NOMAN=		yes
SMALL_BOOT=	Yes
CPPFLAGS+=	-DUSE_USTARFS

# This gets installed under a different name
realinstall:
	${INSTALL} ${INSTALL_COPY} ${INSTALL_STRIP} -o ${BINOWN} -g ${BINGRP} \
	    -m ${BINMODE} ${PROG} ${DESTDIR}${BINDIR}/boot.fd

.PATH: ${BOOTLDR_PATH}
.include "${BOOTLDR_PATH}/Makefile"

SRCS+=		strerr.c
${PROG}:	strerr.o

.PATH: ${.CURDIR}/../libsa
LIBSA_FLAGS=	-I${.CURDIR}/../libsa -I${S}/stand/boot -I${S}/lib \
		-D__INTERNAL_LIBSA_CREAD \
		-DHEAP_LIMIT=${HEAP_LIMIT}
SRCS+=		biosdev.c cmd_i386.c debug.c dev_i386.c diskprobe.c gidt.S
${PROG}:	biosdev.o cmd_i386.o debug.o dev_i386.o diskprobe.o gidt.o
CFLAGS_biosdev.o+=	${LIBSA_FLAGS}
CFLAGS_cmd_i386.o+=	${LIBSA_FLAGS}
CFLAGS_debug.o+=	${LIBSA_FLAGS}
CFLAGS_debug_i386.o+=	${LIBSA_FLAGS}
CFLAGS_dev_i386.o+=	${LIBSA_FLAGS}
CFLAGS_diskprobe.o+=	${LIBSA_FLAGS}
CFLAGS_gidt.o+=		${LIBSA_FLAGS}
@


1.13
log
@install the floppy bootloaders too, to simplify things
@
text
@d1 1
a1 1
# $MirOS: src/sys/arch/i386/stand/fdboot/Makefile,v 1.12 2009/02/01 16:16:31 tg Exp $
d7 1
@


1.12
log
@small boot announce as such
@
text
@d1 1
a1 1
# $MirOS: src/sys/arch/i386/stand/fdboot/Makefile,v 1.11 2009/01/10 22:18:52 tg Exp $
d8 4
a11 2
# This doesn't get installed
install:
@


1.11
log
@more work towards unifying devices (and network)
@
text
@d1 1
a1 1
# $MirOS: src/sys/arch/i386/stand/fdboot/Makefile,v 1.10 2009/01/10 13:41:18 tg Exp $
a3 1
CPPFLAGS+=	-DSMALL_BOOT
@


1.10
log
@new memory layout, part 1
@
text
@d1 1
a1 1
# $MirOS: src/sys/arch/i386/stand/fdboot/Makefile,v 1.9 2009/01/10 13:28:10 tg Exp $
d7 1
@


1.9
log
@no LINKADDR
@
text
@d1 1
a1 1
# $MirOS: src/sys/arch/i386/stand/fdboot/Makefile,v 1.8 2009/01/02 16:38:37 tg Exp $
d20 1
a20 1
		-DHEAP_LIMIT=0x90000
@


1.8
log
@make fdboot smaller again, by ifdeffing out the bootbuf part which
isn’t called from the ifdeffed cmd_i386.c anyway
@
text
@d1 1
a1 1
# $MirOS: src/sys/arch/i386/stand/fdboot/Makefile,v 1.7 2008/08/01 15:43:46 tg Exp $
d20 1
a20 1
		-DLINKADDR=0x40120 -DHEAP_LIMIT=0x90000
@


1.7
log
@switch i386 bootloader to kern zlib
@
text
@d1 1
a1 1
# $MirOS: src/sys/arch/i386/stand/fdboot/Makefile,v 1.6 2007/05/24 21:38:05 tg Exp $
d21 2
a22 4
#SRCS+=		biosdev.c cmd_i386.c dev_i386.c diskprobe.c
#${PROG}:	biosdev.o cmd_i386.o dev_i386.o diskprobe.o
SRCS+=		biosdev.c cmd_i386.c debug.c dev_i386.c diskprobe.c
${PROG}:	biosdev.o cmd_i386.o debug.o dev_i386.o diskprobe.o
d29 1
@


1.6
log
@shrink fdboot to <32 KiB, yay!
@
text
@d1 1
a1 1
# $MirOS: src/sys/arch/i386/stand/fdboot/Makefile,v 1.5 2007/03/18 04:46:21 tg Exp $
d19 1
a19 1
		-I${BSDSRCDIR}/lib/libz -D__INTERNAL_LIBSA_CREAD \
@


1.5
log
@no "Nothing to do here for now..." any more
@
text
@d1 1
a1 1
# $MirOS: src/sys/arch/i386/stand/fdboot/Makefile,v 1.4 2006/08/19 14:20:29 tg Exp $
d21 4
a24 2
SRCS+=		biosdev.c cmd_i386.c dev_i386.c diskprobe.c
${PROG}:	biosdev.o cmd_i386.o dev_i386.o diskprobe.o
d27 2
@


1.4
log
@attempt to shrink fdboot even more
@
text
@d1 1
a1 1
# $MirOS: src/sys/arch/i386/stand/fdboot/Makefile,v 1.3 2006/08/19 12:45:47 tg Exp $
d8 1
a9 1
	# This doesn't get installed
@


1.3
log
@attempt at shrinking the floppy
@
text
@d1 1
a1 1
# $MirOS: src/sys/arch/i386/stand/fdboot/Makefile,v 1.2 2006/05/15 20:47:40 tg Exp $
d4 1
a4 1
CPPFLAGS+=	-DFFS_ONLY -DSMALL_BOOT
d13 14
@


1.2
log
@don't let fdboot, liveboot build boot's man page
@
text
@d1 1
a1 1
# $MirOS: src/sys/arch/i386/stand/fdboot/Makefile,v 1.1 2006/05/15 20:47:06 tg Exp $
d4 1
a4 1
CPPFLAGS+=	-DFFS_ONLY
@


1.1
log
@save us almost 3 kB of code on the boot floppy
which won't ever be used as "no emulation" image
@
text
@d1 1
a1 1
# $MirOS: src/sys/arch/i386/stand/liveboot/Makefile,v 1.2 2006/04/06 10:58:15 tg Exp $
d6 1
@

