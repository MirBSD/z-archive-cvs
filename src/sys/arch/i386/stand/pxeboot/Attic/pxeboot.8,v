head	1.6;
access;
symbols
	tg-beforemerge-ksrc10:1.1.1.3
	cvs-200808011000:1.1.1.3
	MIRBSD_10:1.4.0.2
	MIRBSD_10_BASE:1.4
	MIRBSD_9_BASE:1.3
	MIRBSD_8:1.3.0.2
	MIRBSD_8_BASE:1.3
	cvs-200507032030:1.1.1.2
	cvs-200505050030:1.1.1.2
	cvs-200504291700:1.1.1.2
	openbsd:1.1.1;
locks; strict;
comment	@.\" @;


1.6
date	2009.01.20.21.11.28;	author tg;	state dead;
branches;
next	1.5;
commitid	10049763E0E7BAFFE5D;

1.5
date	2008.08.01.11.25.01;	author tg;	state Exp;
branches;
next	1.4;
commitid	1004892F2924667C00D;

1.4
date	2006.10.13.19.18.03;	author tg;	state Exp;
branches;
next	1.3;
commitid	100452FE67757921301;

1.3
date	2005.04.29.18.35.00;	author tg;	state Exp;
branches;
next	1.2;

1.2
date	2005.03.06.21.27.09;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.02.05.17.27.29;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2005.02.05.17.27.29;	author tg;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2005.04.29.17.05.50;	author tg;	state Exp;
branches;
next	1.1.1.3;

1.1.1.3
date	2008.08.01.10.28.38;	author tg;	state Exp;
branches;
next	;
commitid	1004892E54805BE97AB;


desc
@@


1.6
log
@WTF we have a manpage!
@
text
@.\"	$MirOS: src/sys/arch/i386/stand/pxeboot/pxeboot.8,v 1.5 2008/08/01 11:25:01 tg Exp $
.\"	$OpenBSD: pxeboot.8,v 1.8 2007/05/31 19:20:03 jmc Exp $
.\" Copyright (c) 2004 Tom Cosgrove
.\" Copyright (c) 2003 Matthias Drochner
.\" Copyright (c) 1999 Doug White
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.Dd $Mdocdate: August 1 2008 $
.Dt PXEBOOT 8 i386
.Os
.Sh NAME
.Nm pxeboot
.Nd
i386-specific second-stage PXE bootstrap
.Sh DESCRIPTION
.Nm
is a modified version of the i386 second-stage bootstrap program,
.Xr boot 8 ,
configured to run under Intel's Preboot Execution Environment (PXE).
PXE is a form of smart boot ROM, built into many Ethernet cards from Intel,
3Com, and other manufacturers.
.Pp
The computer's PXE boot ROM contacts a DHCP server by broadcasting a request
on the network.
It gets an IP address from the DHCP server,
then it is told the name of the boot program to download \(em
in this case, the boot program is
.Nm .
The ROM downloads the boot program using TFTP, then executes it.
.Pp
The
.Nm
boot program will look for an
.Pa /boot.cfg
configuration
file on the TFTP server.
If it finds one, it processes the commands within it.
.Pa boot.cfg
processing can be skipped by holding down either Control key as
.Nm
starts.
.Pp
.Nm
then sits in a loop,
processing commands given by the user.
It accepts all the commands accepted by
.Xr boot 8 .
.Pp
If no commands are given for a short time,
.Nm
will then attempt to load the
.Ox
kernel
.Pa bsd
via TFTP.
It may be told to boot an alternative kernel,
either by commands in the
.Pa boot.cfg
file,
or by commands typed by the user at the
.Ic boot\*(Gt
prompt.
.Nm
can be used for
.Xr diskless 8
setups or to load the
.Pa bsd.rd
install kernel
for network installs.
.Pp
To prepare a server to support network booting,
the
.Xr dhcpd 8
and
.Xr tftpd 8
services should be enabled and configured.
It may help to use the
.Fl s
option with
.Xr tftpd 8 ,
to avoid confusion between files for the server's system
and files for the client system
(note that
.Fl s
is set by default in
.Ox ) .
.Xr ftpd 8
or
.Xr httpd 8
should be enabled, depending on how the install sets will be made available.
.Pp
.Nm
and the kernel should be copied into the TFTP server's root directory
(typically
.Pa /tftpboot ) .
A
.Pa boot.cfg
file may be created if required
(e.g.\&
.Pa /tftpboot/boot.cfg ) .
.Pp
A sample configuration file for
.Xr dhcpd 8
might be as follows:
.Bd -literal -offset indent
option domain-name "example.com";
option routers 10.0.0.1;
option subnet-mask 255.255.255.0;
option broadcast-address 10.0.0.255;
option domain-name-servers 10.0.0.1;
server-name "DHCPserver";
server-identifier 10.0.0.1;

default-lease-time 120;
max-lease-time 120;

subnet 10.0.0.0 netmask 255.255.255.0 {
    filename "pxeboot";
    range 10.0.0.10 10.0.0.254;
}
.Ed
.Pp
See
.Xr dhcpd 8
and
.Xr dhcpd.conf 5
for more information.
.Sh FILES
.Bl -tag -width /usr/mdec/pxebootxx -compact
.It Pa /usr/mdec/pxeboot
PXE-specific second-stage bootstrap
.It Pa /boot.cfg
.Nm
configuration file (read from TFTP server)
.It Pa /etc/dhcpd.conf
DHCPD configuration file
.It Pa /tftpboot
Default root directory for
.Xr tftpd 8
.El
.Sh EXAMPLES
Boot the install kernel:
.Pp
.Dl boot\*(Gt bsd.rd
.Pp
The same thing:
.Pp
.Dl boot\*(Gt boot tftp:bsd.rd
.Sh SEE ALSO
.Xr dhcpd.conf 5 ,
.Xr boot 8 ,
.Xr boot_i386 8 ,
.Xr dhcpd 8 ,
.Xr diskless 8 ,
.Xr httpd 8 ,
.Xr tftpd 8
.Rs
.%T Preboot Execution Environment (PXE) Specification
.%N Version 2.1
.%D September 20, 1999
.%A Intel Corporation
.Re
.Sh HISTORY
The
.Nm
command first appeared in
.Ox 3.5 .
@


1.5
log
@merge and reduce diff to obsd
XXX not yet tested
@
text
@d1 1
a1 1
.\"	$MirOS: src/sys/arch/i386/stand/pxeboot/pxeboot.8,v 1.4 2006/10/13 19:18:03 tg Exp $
@


1.4
log
@move /etc/boot.cfg and friends to /
agreed bsiegert@@
@
text
@d1 2
a2 2
.\"	$MirOS: src/sys/arch/i386/stand/pxeboot/pxeboot.8,v 1.3 2005/04/29 18:35:00 tg Exp $
.\"	$OpenBSD: pxeboot.8,v 1.4 2004/12/04 00:46:58 jmc Exp $
d29 1
a29 1
.Dd March 18, 2004
d59 4
d82 1
a82 1
.Ic boot>
d84 4
a87 2
At this time,
it is expected that pxeboot will be used to load the
d89 2
a90 3
install kernel,
for network installs,
although this is not the default kernel.
d92 1
a92 1
To prepare a server to support network installs,
d103 2
a104 2
and files for the client system.
(Note that
d107 1
a107 1
OpenBSD.)
d165 1
a165 1
.Dl boot> bsd.rd
d169 1
a169 1
.Dl boot> boot tftp:bsd.rd
d175 1
@


1.3
log
@(tentative) merge, more to come
@
text
@d1 1
a1 1
.\"	$MirOS: src/sys/arch/i386/stand/pxeboot/pxeboot.8,v 1.2 2005/03/06 21:27:09 tg Exp $
d55 1
a55 1
.Pa /etc/boot.cfg
d116 1
a116 1
.Pa /tftpboot/etc/boot.cfg ) .
d148 1
a148 1
.It Pa /etc/boot.cfg
@


1.2
log
@* merge src/sys/
  (at least the better part of it)
* revert IPv6 networking to OpenBSD, since
  I didn't get IPV4_MAPPED addresses working :(
@
text
@d1 2
a2 3
.\"	$MirOS$
.\"	$OpenBSD: pxeboot.8,v 1.3 2004/03/21 22:19:57 tom Exp $
.\"
d151 2
@


1.1
log
@Initial revision
@
text
@d1 1
d3 1
d56 1
a56 1
.Pa /etc/boot.conf
d76 1
a76 1
.Pa boot.conf
d114 1
a114 1
.Pa boot.conf
d117 1
a117 1
.Pa /tftpboot/etc/boot.conf ) .
d149 1
a149 1
.It Pa /etc/boot.conf
@


1.1.1.1
log
@Import the OpenBSD foundation of MirOS BSD
@
text
@@


1.1.1.2
log
@improve my Frankenstein OS (*wink* you know who you are) further
sans wchar_t of course

this is the essence of reading >1200 commit messages which suck
due to not having the new format of ours...
@
text
@d1 1
a1 1
.\"	$OpenBSD: pxeboot.8,v 1.4 2004/12/04 00:46:58 jmc Exp $
a149 2
.It Pa /etc/dhcpd.conf
DHCPD configuration file
@


1.1.1.3
log
@import bootloader-related pieces from openbsd, as first part of the
aspired 4.4 mergeâ€¦ and something else
@
text
@d1 1
a1 1
.\"	$OpenBSD: pxeboot.8,v 1.8 2007/05/31 19:20:03 jmc Exp $
d28 1
a28 1
.Dd $Mdocdate: May 31 2007 $
a57 4
.Pa boot.conf
processing can be skipped by holding down either Control key as
.Nm
starts.
d77 1
a77 1
.Ic boot\*(Gt
d79 2
a80 4
.Nm
can be used for
.Xr diskless 8
setups or to load the
d82 3
a84 2
install kernel
for network installs.
d86 1
a86 1
To prepare a server to support network booting,
d97 2
a98 2
and files for the client system
(note that
d101 1
a101 1
.Ox ) .
d159 1
a159 1
.Dl boot\*(Gt bsd.rd
d163 1
a163 1
.Dl boot\*(Gt boot tftp:bsd.rd
a168 1
.Xr diskless 8 ,
@


