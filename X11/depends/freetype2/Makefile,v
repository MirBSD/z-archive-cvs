head	1.18;
access;
symbols
	MIRBSD_10_BASE:1.7;
locks; strict;
comment	@# @;


1.18
date	2017.04.15.21.47.03;	author tg;	state Exp;
branches;
next	1.17;
commitid	10058F294F2374F163C;

1.17
date	2017.04.15.20.50.56;	author tg;	state Exp;
branches;
next	1.16;
commitid	10058F287C5353F6977;

1.16
date	2017.04.15.20.24.00;	author tg;	state Exp;
branches;
next	1.15;
commitid	10058F2817964C4C57A;

1.15
date	2017.04.15.20.04.21;	author tg;	state Exp;
branches;
next	1.14;
commitid	10058F27CD16F31BDDA;

1.14
date	2014.11.26.19.29.30;	author tg;	state Exp;
branches;
next	1.13;
commitid	10054762A213E06B080;

1.13
date	2013.09.10.20.20.50;	author tg;	state Exp;
branches;
next	1.12;
commitid	100522F7F3A20F05540;

1.12
date	2013.09.10.19.44.36;	author tg;	state Exp;
branches;
next	1.11;
commitid	100522F76AA4D5C54CA;

1.11
date	2013.09.10.19.39.29;	author tg;	state Exp;
branches;
next	1.10;
commitid	100522F75893D9B51B6;

1.10
date	2013.08.06.20.16.12;	author tg;	state Exp;
branches;
next	1.9;
commitid	100520159A3440E23C2;

1.9
date	2013.08.06.19.07.53;	author tg;	state Exp;
branches;
next	1.8;
commitid	1005201499728BBF8FB;

1.8
date	2008.06.14.01.52.53;	author tg;	state Exp;
branches;
next	1.7;
commitid	1004853244C7566CFE9;

1.7
date	2008.02.29.11.10.41;	author bsiegert;	state Exp;
branches;
next	1.6;
commitid	10047C7E818588F5B80;

1.6
date	2006.10.16.19.38.00;	author tg;	state Exp;
branches;
next	1.5;
commitid	1004533DFA70BFDF298;

1.5
date	2006.10.15.19.22.24;	author tg;	state Exp;
branches;
next	1.4;
commitid	10045328A5E2DFE5A91;

1.4
date	2006.07.02.23.47.36;	author tg;	state Exp;
branches;
next	1.3;
commitid	10044A85B2E3F84BE8C;

1.3
date	2006.06.29.20.57.31;	author tg;	state Exp;
branches;
next	1.2;
commitid	10044A43EA43D270785;

1.2
date	2006.06.29.20.11.14;	author tg;	state Exp;
branches;
next	1.1;
commitid	10044A433F0373AB0E3;

1.1
date	2006.06.29.19.36.16;	author tg;	state Exp;
branches;
next	;
commitid	10044A42BB948269A5A;


desc
@@


1.18
log
@fix includes installation
@
text
@# $MirOS: X11/depends/freetype2/Makefile,v 1.17 2017/04/15 20:50:56 tg Exp $
#-
# Note: also change X11/xc/lib/font/FreeType/module/Imakefile,v

.include "../Makefile.inc"
.include <bsd.own.mk>

SHLIB_VERSION=		12.0
SUBST_VARS+=		-e 's!@@X11BASE@@!${X11BASE}!g'
SUBST_VARS+=		-e 's!@@ft_version@@!2.7.1!g'

all: prereq
prereq: freetype-config freetype2.pc

freetype-config: freetype-config.in
	sed ${SUBST_VARS} <$> >$@@

freetype2.pc: freetype2.in
	sed ${SUBST_VARS} <$> >$@@

FT2_DIR=		${.CURDIR}/../../xc/extras/freetype2

CPPFLAGS+=		-I${FT2_DIR}/include
CPPFLAGS+=		-DFT2_BUILD_LIBRARY
CPPFLAGS+=		-DMBSD_BUILD
CPPFLAGS+=		-DFT_CONFIG_OPTION_SUBPIXEL_RENDERING
CPPFLAGS+=		-DFT_CONFIG_OPTION_SYSTEM_ZLIB
CPPFLAGS+=		-DHAVE_UNISTD_H
CPPFLAGS+=		-DHAVE_FCNTL_H
CPPFLAGS+=		-DHAVE_STDINT_H

.PATH:			${FT2_DIR}/builds/unix
.PATH:			${FT2_DIR}/docs

.for module in autofit base bdf bzip2 cache cff cid gzip lzw \
    pcf pfr psaux pshinter psnames raster sfnt smooth \
    truetype type1 type42 winfonts
.PATH:			${FT2_DIR}/src/${module}
.endfor

LIB=			freetype
LDADD+=			-lpng -lz -lm
DPADD+=			${LIBPNG} ${LIBZ} ${LIBM}

  MAN+=			freetype-config.1

  SRCS+=		afangles.c
  SRCS+=		afblue.c
  SRCS+=		afcjk.c
  SRCS+=		afdummy.c
  SRCS+=		afglobal.c
  SRCS+=		afhints.c
  SRCS+=		afindic.c
  SRCS+=		aflatin.c
  SRCS+=		afloader.c
  SRCS+=		afmodule.c
  SRCS+=		afmparse.c
  SRCS+=		afpic.c
  SRCS+=		afranges.c
  SRCS+=		afshaper.c
  SRCS+=		afwarp.c
  SRCS+=		basepic.c
  SRCS+=		bdfdrivr.c
  SRCS+=		bdflib.c
  SRCS+=		cf2arrst.c
  SRCS+=		cf2blues.c
  SRCS+=		cf2error.c
  SRCS+=		cf2font.c
  SRCS+=		cf2ft.c
  SRCS+=		cf2hints.c
  SRCS+=		cf2intrp.c
  SRCS+=		cf2read.c
  SRCS+=		cf2stack.c
  SRCS+=		cffcmap.c
  SRCS+=		cffdrivr.c
  SRCS+=		cffgload.c
  SRCS+=		cffload.c
  SRCS+=		cffobjs.c
  SRCS+=		cffparse.c
  SRCS+=		cffpic.c
  SRCS+=		cidgload.c
  SRCS+=		cidload.c
  SRCS+=		cidobjs.c
  SRCS+=		cidparse.c
  SRCS+=		cidriver.c
  SRCS+=		ftadvanc.c
  SRCS+=		ftbbox.c
  SRCS+=		ftbdf.c
  SRCS+=		ftbitmap.c
  SRCS+=		ftbzip2.c
  SRCS+=		ftcalc.c
  SRCS+=		ftcbasic.c
  SRCS+=		ftccache.c
  SRCS+=		ftccmap.c
  SRCS+=		ftcglyph.c
  SRCS+=		ftcid.c
  SRCS+=		ftcimage.c
  SRCS+=		ftcmanag.c
  SRCS+=		ftcmru.c
  SRCS+=		ftcsbits.c
  SRCS+=		ftdbgmem.c
  SRCS+=		ftdebug.c
  SRCS+=		ftfntfmt.c
  SRCS+=		ftfstype.c
  SRCS+=		ftgasp.c
  SRCS+=		ftgloadr.c
  SRCS+=		ftglyph.c
  SRCS+=		ftgrays.c
  SRCS+=		ftgxval.c
  SRCS+=		ftgzip.c
  SRCS+=		fthash.c
  SRCS+=		ftinit.c
  SRCS+=		ftlcdfil.c
  SRCS+=		ftlzw.c
  SRCS+=		ftmm.c
  SRCS+=		ftobjs.c
  SRCS+=		ftotval.c
  SRCS+=		ftoutln.c
  SRCS+=		ftpatent.c
  SRCS+=		ftpfr.c
  SRCS+=		ftpic.c
  SRCS+=		ftraster.c
  SRCS+=		ftrend1.c
  SRCS+=		ftrfork.c
  SRCS+=		ftsmooth.c
  SRCS+=		ftsnames.c
  SRCS+=		ftspic.c
  SRCS+=		ftstream.c
  SRCS+=		ftstroke.c
  SRCS+=		ftsynth.c
  SRCS+=		ftsystem.c
  SRCS+=		fttrigon.c
  SRCS+=		fttype1.c
  SRCS+=		ftutil.c
  SRCS+=		ftwinfnt.c
  SRCS+=		pcfdrivr.c
  SRCS+=		pcfread.c
  SRCS+=		pcfutil.c
  SRCS+=		pfrcmap.c
  SRCS+=		pfrdrivr.c
  SRCS+=		pfrgload.c
  SRCS+=		pfrload.c
  SRCS+=		pfrobjs.c
  SRCS+=		pfrsbit.c
  SRCS+=		pngshim.c
  SRCS+=		psauxmod.c
  SRCS+=		psconv.c
  SRCS+=		pshalgo.c
  SRCS+=		pshglob.c
  SRCS+=		pshmod.c
  SRCS+=		pshpic.c
  SRCS+=		pshrec.c
  SRCS+=		psmodule.c
  SRCS+=		psobjs.c
  SRCS+=		pspic.c
  SRCS+=		rastpic.c
  SRCS+=		sfdriver.c
  SRCS+=		sfntpic.c
  SRCS+=		sfobjs.c
  SRCS+=		t1afm.c
  SRCS+=		t1cmap.c
  SRCS+=		t1decode.c
  SRCS+=		t1driver.c
  SRCS+=		t1gload.c
  SRCS+=		t1load.c
  SRCS+=		t1objs.c
  SRCS+=		t1parse.c
  SRCS+=		t42drivr.c
  SRCS+=		t42objs.c
  SRCS+=		t42parse.c
  SRCS+=		ttbdf.c
  SRCS+=		ttcmap.c
  SRCS+=		ttdriver.c
  SRCS+=		ttgload.c
  SRCS+=		ttgxvar.c
  SRCS+=		ttinterp.c
  SRCS+=		ttkern.c
  SRCS+=		ttload.c
  SRCS+=		ttmtx.c
  SRCS+=		ttobjs.c
  SRCS+=		ttpic.c
  SRCS+=		ttpload.c
  SRCS+=		ttpost.c
  SRCS+=		ttsbit.c
  SRCS+=		ttsubpix.c
  SRCS+=		winfnt.c

  INCS+=		config/ftconfig.h
  INCS+=		config/ftheader.h
  INCS+=		config/ftmodule.h
  INCS+=		config/ftoption.h
  INCS+=		config/ftstdlib.h
  INCS+=		freetype.h
  INCS+=		ftadvanc.h
  INCS+=		ftautoh.h
  INCS+=		ftbbox.h
  INCS+=		ftbdf.h
  INCS+=		ftbitmap.h
  INCS+=		ftbzip2.h
  INCS+=		ftcache.h
  INCS+=		ftcffdrv.h
  INCS+=		ftchapters.h
  INCS+=		ftcid.h
  INCS+=		fterrdef.h
  INCS+=		fterrors.h
  INCS+=		ftfntfmt.h
  INCS+=		ftgasp.h
  INCS+=		ftglyph.h
  INCS+=		ftgxval.h
  INCS+=		ftgzip.h
  INCS+=		ftimage.h
  INCS+=		ftincrem.h
  INCS+=		ftlcdfil.h
  INCS+=		ftlist.h
  INCS+=		ftlzw.h
  INCS+=		ftmac.h
  INCS+=		ftmm.h
  INCS+=		ftmodapi.h
  INCS+=		ftmoderr.h
  INCS+=		ftotval.h
  INCS+=		ftoutln.h
  INCS+=		ftpfr.h
  INCS+=		ftrender.h
  INCS+=		ftsizes.h
  INCS+=		ftsnames.h
  INCS+=		ftstroke.h
  INCS+=		ftsynth.h
  INCS+=		ftsystem.h
  INCS+=		fttrigon.h
  INCS+=		ftttdrv.h
  INCS+=		fttypes.h
  INCS+=		ftwinfnt.h
  INCS+=		t1tables.h
  INCS+=		ttnameid.h
  INCS+=		tttables.h
  INCS+=		tttags.h
  INCS+=		ttunpat.h

beforeinstall:
	@@mkdir -p ${DESTDIR}${X11BASE}/include/freetype2/freetype/config
.for _i in ${INCS}
	${INSTALL} ${INSTALL_COPY} -o ${BINOWN} -g ${BINGRP} -m ${NONBINMODE} \
	    ${FT2_DIR}/include/freetype/${_i} \
	    ${DESTDIR}${X11BASE}/include/freetype2/freetype/${_i}
.endfor
	${INSTALL} ${INSTALL_COPY} -o ${BINOWN} -g ${BINGRP} -m ${NONBINMODE} \
	    ${FT2_DIR}/include/ft2build.h \
	    ${DESTDIR}${X11BASE}/include/freetype2/ft2build.h
	${INSTALL} ${INSTALL_COPY} -o ${BINOWN} -g ${BINGRP} -m ${BINMODE} \
	    freetype-config ${DESTDIR}${BINDIR}/
	${INSTALL} ${INSTALL_COPY} -o ${BINOWN} -g ${BINGRP} -m ${SHAREMODE} \
	    freetype2.pc ${DESTDIR}${X11BASE}/lib/pkgconfig/

.include <bsd.lib.mk>
@


1.17
log
@modules and files that are actually used
@
text
@d1 1
a1 1
# $MirOS: X11/depends/freetype2/Makefile,v 1.14 2014/11/26 19:29:30 tg Exp $
d247 1
a247 1
	    ${FT2_DIR}/builds/unix/ft2unix.h \
@


1.16
log
@next round
@
text
@d35 3
a37 3
.for module in autofit base bdf bzip2 cache cff cid gxvalid gzip lzw \
    otvalid pcf pfr psaux pshinter psnames raster sfnt smooth \
    tools truetype type1 type42 winfonts
a46 2
  SRCS+=		ftsystem.c
  SRCS+=		ftinit.c
d48 1
a54 1
# SRCS+=		aflatin2.c
d58 3
d62 1
d65 9
d80 1
a86 1
  SRCS+=		ftapi.c
d90 1
d102 2
d111 2
d121 1
d127 1
d131 1
a135 31
  SRCS+=		ftxf86.c
  SRCS+=		gxvbsln.c
  SRCS+=		gxvcommn.c
  SRCS+=		gxvfeat.c
  SRCS+=		gxvjust.c
  SRCS+=		gxvkern.c
  SRCS+=		gxvlcar.c
  SRCS+=		gxvmod.c
  SRCS+=		gxvmort.c
  SRCS+=		gxvmort0.c
  SRCS+=		gxvmort1.c
  SRCS+=		gxvmort2.c
  SRCS+=		gxvmort4.c
  SRCS+=		gxvmort5.c
  SRCS+=		gxvmorx.c
  SRCS+=		gxvmorx0.c
  SRCS+=		gxvmorx1.c
  SRCS+=		gxvmorx2.c
  SRCS+=		gxvmorx4.c
  SRCS+=		gxvmorx5.c
  SRCS+=		gxvopbd.c
  SRCS+=		gxvprop.c
  SRCS+=		gxvtrak.c
  SRCS+=		otvbase.c
  SRCS+=		otvcommn.c
  SRCS+=		otvgdef.c
  SRCS+=		otvgpos.c
  SRCS+=		otvgsub.c
  SRCS+=		otvjstf.c
  SRCS+=		otvmath.c
  SRCS+=		otvmod.c
d145 1
d151 1
d155 2
d158 1
d181 1
d185 1
@


1.15
log
@first part of merge; I’m going to guess a new major is needed
@
text
@d28 3
d35 2
a36 2
.for module in autofit autohint base bdf cache cff cid gxvalid gzip lzw \
    otlayout otvalid pcf pfr psaux pshinter psnames raster sfnt smooth \
d42 2
a43 2
LDADD+=			-lz
DPADD+=			${LIBZ}
d200 1
d204 1
d206 1
d211 1
d218 1
a219 1
  INCS+=		ftlcdfil.h
d235 1
a237 1
  INCS+=		ftxf86.h
@


1.14
log
@remove MKC_USAP fully from the tree, we don’t deal with patents
@
text
@d1 1
a1 1
# $MirOS: X11/depends/freetype2/Makefile,v 1.13 2013/09/10 20:20:50 tg Exp $
d8 1
a8 1
SHLIB_VERSION=		11.3
d10 1
a10 1
SUBST_VARS+=		-e 's!@@ft_version@@!2.3.12!g'
d26 1
d30 1
a37 2
CPPFLAGS+=		-DTT_CONFIG_OPTION_BYTECODE_INTERPRETER

a38 1
NOMAN=			Yes
d42 2
@


1.13
log
@GNNNNNNNNNNNNNNNNNNNNN………
@
text
@d1 1
a1 1
# $MirOS: X11/depends/freetype2/Makefile,v 1.12 2013/09/10 19:44:36 tg Exp $
a35 1
.if ${MKC_USAP:L} != "yes"
a36 1
.endif
@


1.12
log
@this cannot ever have worked correctly, before! aieee!

link libfreetype against libz
@
text
@d1 3
a3 1
# $MirOS: X11/depends/freetype2/Makefile,v 1.11 2013/09/10 19:39:29 tg Exp $
@


1.11
log
@good catch! nuke dead zlib code copy that wasn’t quite
@
text
@d1 1
a1 1
# $MirOS: X11/depends/freetype2/Makefile,v 1.10 2013/08/06 20:16:12 tg Exp $
d40 2
@


1.10
log
@fully merge the update
@
text
@d1 1
a1 1
# $MirOS: X11/depends/freetype2/Makefile,v 1.9 2013/08/06 19:07:53 tg Exp $
d24 1
@


1.9
log
@remove the LT_VERSION nōnsense and fixup version
@
text
@d1 1
a1 1
# $MirOS: X11/depends/freetype2/Makefile,v 1.8 2008/06/14 01:52:53 tg Exp $
d6 1
a6 1
SHLIB_VERSION=		11.2
d8 1
a8 1
SUBST_VARS+=		-e 's!@@ft_version@@!2.3.6!g'
d10 2
a11 1
all: freetype-config freetype2.pc
d67 1
d83 1
a92 1
  SRCS+=		ftnames.c
d102 1
d192 1
@


1.8
log
@In commit 10048518F42341D79C8, Benny forgot that the Imakefile is not used,
but we have to add new sources, new header files, etc. here, as well as up-
date the upstream LT version in the comment (take its middle part into ours
too) and CHECK THE nm(1) OUTPUT and *manually* adjust *our* LT version…
@
text
@d1 1
a1 1
# $MirOS: X11/depends/freetype2/Makefile,v 1.7 2008/02/29 11:10:41 bsiegert Exp $
d6 1
a6 12
# This is the one from the freetype project
#LT_VERSION=		9:17:3
# This is bumped like we need it
LT_VERSION=		13:17:2

FT_VERSION=		${LT_VERSION:S/:/./g}
LT_CURRENT=		${FT_VERSION:R:R}
LT_REVISION=		${FT_VERSION:R:E}
LT_AGE=			${FT_VERSION:E}
SHLIB_MAJOR!=		print $$((${LT_CURRENT} - ${LT_AGE}))
SHLIB_MINOR=		${LT_AGE}

d8 1
a8 1
SUBST_VARS+=		-e 's!@@ft_version@@!${FT_VERSION}!g'
@


1.7
log
@Adapt the Makefile here, too. How many points of this will I have to touch?

This commit was sponsored by university WLAN during a talk :D
@
text
@d1 1
a1 1
# $MirOS: X11/depends/freetype2/Makefile,v 1.6 2006/10/16 19:38:00 tg Exp $
d7 1
a7 1
#LT_VERSION=		9:16:3
d9 1
a9 1
LT_VERSION=		12:16:1
d59 1
a59 1
#  SRCS+=		aflatin2.c
d86 1
d147 1
d205 1
@


1.6
log
@fix the permissions and directories issues
@
text
@d1 1
a1 1
# $MirOS: X11/depends/freetype2/Makefile,v 1.4 2006/07/02 23:47:36 tg Exp $
d7 1
a7 1
#LT_VERSION=		9:10:3
d9 1
a9 1
LT_VERSION=		11:10:0
d57 1
d59 1
d91 1
d97 1
d104 1
d205 1
d212 1
@


1.5
log
@kludge: create /usr/X11R6/bin before installing freetype2, which
is the first thing ever installed anyway

build broke on system which didn't yet have X11 installed otherwise
@
text
@d231 1
a231 2
	@@mkdir -p ${DESTDIR}${X11BASE}/{bin,lib/pkgconfig} \
	    ${DESTDIR}${X11BASE}/include/freetype2/freetype/config
@


1.4
log
@fix DESTDIR install
@
text
@d1 1
a1 1
# $MirOS: X11/depends/freetype2/Makefile,v 1.3 2006/06/29 20:57:31 tg Exp $
d231 1
a231 1
	@@mkdir -p ${DESTDIR}${X11BASE}/lib/pkgconfig \
@


1.3
log
@* finish building
* bump major after nm'ing (although not strictly required)

note: we now have a pkgconfig file ;)

xterm -fa Gentium and xterm -fa Unifont both now work
@
text
@d1 1
a1 1
# $MirOS: X11/depends/freetype2/Makefile,v 1.2 2006/06/29 20:11:14 tg Exp $
d231 2
a232 2
	@@mkdir -p ${X11BASE}/lib/pkgconfig \
	    ${X11BASE}/include/freetype2/freetype/config
d236 1
a236 1
	    ${X11BASE}/include/freetype2/freetype/${_i}
d240 1
a240 1
	    ${X11BASE}/include/freetype2/ft2build.h
d242 1
a242 1
	    freetype-config ${BINDIR}/
d244 1
a244 1
	    freetype2.pc ${X11BASE}/lib/pkgconfig/
@


1.2
log
@try to get everything ready
@
text
@d1 1
a1 1
# $MirOS: X11/depends/freetype2/Makefile,v 1.1 2006/06/29 19:36:16 tg Exp $
d9 1
a9 1
LT_VERSION=		11:10:1
d32 4
d50 2
@


1.1
log
@add stub for building freetype2 with bsd make,
including fake-libtool ;)
@
text
@d1 9
a9 1
# $MirOS$
a10 1
LT_VERSION=		9:10:3
d29 212
@

