head	1.5;
access;
symbols
	MIRBSD_10_BASE:1.5
	MIRBSD_9_BASE:1.5
	MIRBSD_8:1.3.0.2
	MIRBSD_8_BASE:1.3
	xf-4_5_0:1.1.103.1
	xwindow:1.1.103;
locks; strict;
comment	@# @;


1.5
date	2006.06.24.14.58.54;	author bsiegert;	state Exp;
branches;
next	1.4;
commitid	100449D525A7F84544E;

1.4
date	2006.04.05.21.41.46;	author tg;	state Exp;
branches;
next	1.3;
commitid	100443439A63227108D;

1.3
date	2005.07.01.14.26.33;	author tg;	state Exp;
branches;
next	1.2;
commitid	18042c552a592e5;

1.2
date	2005.03.20.21.24.34;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.03.18.10.51.55;	author tg;	state Exp;
branches
	1.1.103.1;
next	;

1.1.103.1
date	2005.03.18.10.51.55;	author tg;	state Exp;
branches;
next	;


desc
@@


1.5
log
@Add our fabulous logo to the default xdm login screen and remove the tiled
background. Work done for the showcase at FROSCON.

This is my first X11 commit, and untested for good measure. Let's hope
it works.
@
text
@XCOMM $MirOS: X11/xc/programs/xdm/config/Imakefile,v 1.4 2006/04/05 21:41:46 tg Exp $
XCOMM $Xorg: Imakefile,v 1.4 2000/08/17 19:54:17 cpqbld Exp $




XCOMM $XFree86: xc/programs/xdm/config/Imakefile,v 1.17 2004/06/08 00:11:13 dawes Exp $

SERVERSTYPE = XdmServersType

all:: Xservers.ws xdm-config Xservers Xresources

#if (defined(i386Architecture) || defined(AMD64Architecture)) && defined(MirBSDArchitecture)
DEFAULTVT=vt07
#else
#if (defined(i386Architecture) || defined(AMD64Architecture)) && (defined(KNetBSDArchitecture) || defined(KOpenBSDArchitecture))
DEFAULTVT=vt05
#endif
#endif

#if defined(LinuxDistribution) && (LinuxDistribution == LinuxDebian)
DEFAULTVT=vt7
#endif

#ifndef XdmPixmap
# define XdmPixmap XFree86.xpm
# define XdmbwPixmap XFree86bw.xpm
# define MirOSPixmap MirOS.xpm
#endif

CHOOSERPATH = $(XDMDIR)/chooser

XPM_DEFINES=-DXPM -DBITMAPDIR=$(XDMDIR)/pixmaps -DXDM_PIXMAP=MirOSPixmap\ @@@@\
	-DXDM_BWPIXMAP=XdmbwPixmap

XDMLOGDIR = $(LOGDIRECTORY)
#ifdef VarRunDirectory
XDMPIDDIR = $(VARRUNDIR)
#else
XDMPIDDIR = $(XDMDIR)
#endif

#if defined(OpenBSDArchitecture) || defined(NetBSDArchitecture) || defined(FreeBSDArchitecture) || defined(DarwinArchitecture)
SU = "su -m"
#else
SU = su
#endif

#if GnuCpp
XRDB = $(BINDIR)/xrdb -undef
#else
XRDB = $(BINDIR)/xrdb
#endif

CppFileTarget(Xservers.ws,Xserv.ws.cpp,-DBINDIR=$(BINDIR) -DDEFAULTVT=$(DEFAULTVT),NullParameter)
CppFileTarget(xdm-config,xdm-conf.cpp,-DXDMDIR=$(XDMDIR) -DXDMAUTHDIR=$(XDMDIR) -DXDMLOGDIR=$(XDMLOGDIR) -DXDMPIDDIR=$(XDMPIDDIR) -DXRDB="$(XRDB)" -DSU=$(SU) -DCHOOSERPATH=$(CHOOSERPATH),NullParameter)
CppFileTarget(Xresources,Xres.cpp,$(XPM_DEFINES),NullParameter)

LinkFile(Xservers,Xservers.$(SERVERSTYPE))

#if InstallXdmConfig
InstallNonExecFile(xdm-config,$(XDMDIR))
InstallNonExecFile(Xresources,$(XDMDIR))
InstallNonExecFile(Xservers,$(XDMDIR))
InstallNonExecFile(Xaccess,$(XDMDIR))
InstallNamedProg(Xsession,Xsession,$(XDMDIR))
InstallNamedProg(GiveConsole,GiveConsole,$(XDMDIR))
InstallNamedProg(Startup_0,Startup_0,$(XDMDIR))
InstallNamedProg(TakeConsole,TakeConsole,$(XDMDIR))
InstallNamedProg(Xsetup_0,Xsetup_0,$(XDMDIR))
InstallNamedProg(Xwilling,Xwilling,$(XDMDIR))
#else
InstallNonExecFileNoClobber(xdm-config,$(XDMDIR))
InstallNonExecFileNoClobber(Xresources,$(XDMDIR))
InstallNonExecFileNoClobber(Xservers,$(XDMDIR))
InstallNonExecFileNoClobber(Xaccess,$(XDMDIR))
InstallNamedProgNoClobber(Xsession,Xsession,$(XDMDIR))
InstallNamedProgNoClobber(GiveConsole,GiveConsole,$(XDMDIR))
InstallNamedProgNoClobber(Startup_0,Startup_0,$(XDMDIR))
InstallNamedProgNoClobber(TakeConsole,TakeConsole,$(XDMDIR))
InstallNamedProgNoClobber(Xsetup_0,Xsetup_0,$(XDMDIR))
InstallNamedProgNoClobber(Xwilling,Xwilling,$(XDMDIR))
#endif

#if InstallXdmConfig
InstallNonExecFile(XdmPixmap,$(XDMDIR)/pixmaps)
InstallNonExecFile(XdmbwPixmap,$(XDMDIR)/pixmaps)
InstallNonExecFile(MirOSPixmap,$(XDMDIR)/pixmaps)
#else
InstallNonExecFileNoClobber(XdmPixmap,$(XDMDIR)/pixmaps)
InstallNonExecFileNoClobber(XdmbwPixmap,$(XDMDIR)/pixmaps)
InstallNonExecFileNoClobber(MirOSPixmap,$(XDMDIR)/pixmaps)
#endif

#ifdef SequentArchitecture

CppFileTarget(windows.sh,windows.sh.cpp,"-DBINDIR=$(BINDIR)" "-DXDMDIR=$(XDMDIR)",NullParameter)

InstallNamedProg(windows.sh,windows,/etc/init.d)
InstallNamedProg(system.xsession.sequent,.xsession,$(ADMINBASEDIR))
InstallNamedNonExec(system.Xdefaults.sequent,.Xresources,$(ADMINBASEDIR))
InstallNamedNonExec(system.Xdefaults.sequent,system.Xdefaults,$(LIBDIR))

/* force a hard link from S81windows to windows */

MakeDirectories(install,/etc/rc2.d)
install::
        $(RM) $(DESTDIR)/etc/rc2.d/S81windows
        ln $(DESTDIR)/etc/init.d/windows $(DESTDIR)/etc/rc2.d/S81windows
        AddToPrototype f /etc/rc2.d/S81windows 0555 bin bin

clean::
        $(RM) windows.sh

#endif /* SequentArchitecture */
@


1.4
log
@On MirOS and SuSE, we run our X servers on Ctrl-Alt-F7 ;)
@
text
@d1 1
a1 1
XCOMM $MirOS: X11/xc/programs/xdm/config/Imakefile,v 1.3 2005/07/01 14:26:33 tg Exp $
d28 1
d33 1
a33 1
XPM_DEFINES=-DXPM -DBITMAPDIR=$(XDMDIR)/pixmaps -DXDM_PIXMAP=XdmPixmap\ @@@@\
d88 1
d92 1
@


1.3
log
@pass -undef to xrdb where needed.
From: Matthieu Herrb <matthieu@@cvs.openbsd.org>
@
text
@d1 1
a1 1
XCOMM $MirOS: X11/xc/programs/xdm/config/Imakefile,v 1.2 2005/03/20 21:24:34 tg Exp $
d13 3
d19 1
@


1.2
log
@Startup_0 needs to be installed too
@
text
@d1 1
a1 1
XCOMM $MirOS$
d44 6
d51 1
a51 1
CppFileTarget(xdm-config,xdm-conf.cpp,-DXDMDIR=$(XDMDIR) -DXDMAUTHDIR=$(XDMDIR) -DXDMLOGDIR=$(XDMLOGDIR) -DXDMPIDDIR=$(XDMPIDDIR) -DSU=$(SU) -DCHOOSERPATH=$(CHOOSERPATH),NullParameter)
@


1.1
log
@Initial revision
@
text
@d1 1
d57 1
d68 1
@


1.1.103.1
log
@Import XFree86 4.5.0 directly from vendor anoncvs, -rxf-4_5_0 xc
at anoncvs@@anoncvs.xfree86.org:/cvs (ssh)
@
text
@@
