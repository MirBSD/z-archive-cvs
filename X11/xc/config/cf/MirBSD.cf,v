head	1.35;
access;
symbols
	MIRBSD_10_BASE:1.23
	MIRBSD_9_BASE:1.13
	MIRBSD_8:1.8.0.2
	MIRBSD_8_BASE:1.8;
locks; strict;
comment	@# @;


1.35
date	2017.04.19.22.55.26;	author tg;	state Exp;
branches;
next	1.34;
commitid	10058F7EAEC4A7C6F3E;

1.34
date	2017.04.19.22.42.45;	author tg;	state Exp;
branches;
next	1.33;
commitid	10058F7E7D423E1B645;

1.33
date	2014.02.09.21.40.08;	author tg;	state Exp;
branches;
next	1.32;
commitid	10052F7F5C22E156140;

1.32
date	2008.11.22.13.16.48;	author tg;	state Exp;
branches;
next	1.31;
commitid	1004928064B491FCDBF;

1.31
date	2008.11.22.07.57.21;	author tg;	state Exp;
branches;
next	1.30;
commitid	1004927BB6746950FB5;

1.30
date	2008.11.22.07.49.13;	author tg;	state Exp;
branches;
next	1.29;
commitid	1004927B99078B7EED6;

1.29
date	2008.11.22.06.36.10;	author tg;	state Exp;
branches;
next	1.28;
commitid	1004927A85C47AF432A;

1.28
date	2008.11.20.00.30.56;	author tg;	state Exp;
branches;
next	1.27;
commitid	1004924AFC366C89226;

1.27
date	2008.11.19.02.32.24;	author tg;	state Exp;
branches;
next	1.26;
commitid	10049237AB04F8BB825;

1.26
date	2008.11.18.20.41.09;	author tg;	state Exp;
branches;
next	1.25;
commitid	1004923287308527755;

1.25
date	2008.06.14.13.39.01;	author tg;	state Exp;
branches;
next	1.24;
commitid	1004853C9E50D00F288;

1.24
date	2008.06.14.01.33.01;	author tg;	state Exp;
branches;
next	1.23;
commitid	10048531F5507E03ED1;

1.23
date	2008.03.06.18.00.56;	author tg;	state Exp;
branches;
next	1.22;
commitid	10047D0315F4D8D295D;

1.22
date	2007.09.02.16.53.34;	author tg;	state Exp;
branches;
next	1.21;
commitid	10046DAEA987DDDEF6E;

1.21
date	2007.08.24.14.31.51;	author tg;	state Exp;
branches;
next	1.20;
commitid	10046CEEBC8127361EF;

1.20
date	2007.08.17.09.50.20;	author tg;	state Exp;
branches;
next	1.19;
commitid	10046C56F0C48FCCAF5;

1.19
date	2007.08.17.09.41.43;	author tg;	state Exp;
branches;
next	1.18;
commitid	10046C56D1544A29E1C;

1.18
date	2007.08.15.23.49.52;	author tg;	state Exp;
branches;
next	1.17;
commitid	10046C391297D7F5B4C;

1.17
date	2007.08.15.20.00.21;	author tg;	state Exp;
branches;
next	1.16;
commitid	10046C35B56074DC9D1;

1.16
date	2007.08.15.01.38.18;	author tg;	state Exp;
branches;
next	1.15;
commitid	10046C258CA521DBB1F;

1.15
date	2007.02.11.02.18.00;	author tg;	state Exp;
branches;
next	1.14;
commitid	10045CE7CEE33A17CEA;

1.14
date	2006.12.20.16.39.24;	author tg;	state Exp;
branches;
next	1.13;
commitid	100458967105E0F3CE2;

1.13
date	2006.06.02.21.19.50;	author tg;	state Exp;
branches;
next	1.12;
commitid	1004480AB8220C7B835;

1.12
date	2006.06.02.12.12.12;	author tg;	state Exp;
branches;
next	1.11;
commitid	10044802B122F606B76;

1.11
date	2006.04.11.19.03.54;	author tg;	state Exp;
branches;
next	1.10;
commitid	100443BFDAB4A5A3FA6;

1.10
date	2006.04.11.01.25.09;	author tg;	state Exp;
branches;
next	1.9;
commitid	100443B057E1EDB0AE6;

1.9
date	2005.12.30.00.15.37;	author tg;	state Exp;
branches;
next	1.8;
commitid	10043B47C394E5F4DA2;

1.8
date	2005.04.16.18.12.22;	author tg;	state Exp;
branches;
next	1.7;

1.7
date	2005.04.16.03.27.06;	author tg;	state Exp;
branches;
next	1.6;

1.6
date	2005.03.28.20.50.25;	author tg;	state Exp;
branches;
next	1.5;

1.5
date	2005.03.27.22.31.25;	author tg;	state Exp;
branches;
next	1.4;

1.4
date	2005.03.23.20.36.13;	author tg;	state Exp;
branches;
next	1.3;

1.3
date	2005.03.23.19.48.19;	author tg;	state Exp;
branches;
next	1.2;

1.2
date	2005.03.20.18.13.18;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.03.19.17.19.20;	author tg;	state Exp;
branches;
next	;


desc
@@


1.35
log
@drop shadowfb from sparc again, we only need shadow there, apparently
@
text
@XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.32 2008/11/22 13:16:48 tg Exp $
XCOMM platform:	$OpenBSD: OpenBSD.cf,v 1.140 2004/10/10 14:47:28 matthieu Exp $
XCOMM platform:	$XFree86: xc/config/cf/OpenBSD.cf,v 3.79 2003/01/12 17:03:23 herrb Exp $

#ifndef	OSMajorVersion
#define	OSMajorVersion		DefaultOSMajorVersion
#endif
#ifndef	OSMinorVersion
#define	OSMinorVersion		DefaultOSMinorVersion
#endif
#ifndef	OSTeenyVersion
#define	OSTeenyVersion		DefaultOSTeenyVersion
#endif

#define	XFree86CustomVersion	"for MirOS BSD"
#undef	MirBSDArchitecture
#undef	CppArchitecture
#undef	CppELF

#ifdef	i386Architecture
#define	MirBSDArchitecture	i386
#define	CppArchitectureCCCP	-D__i386__ -D__i386
#define	CppArchitecturePCC	-D__i386__ -D__i386 -Di386
#endif

#ifdef	SparcArchitecture
#define	MirBSDArchitecture	sparc
#define	CppArchitectureCCCP	-D__sparc__ -D__sparc
#define	CppArchitecturePCC	-D__sparc__ -D__sparc -Dsparc
#endif

#ifndef	MirBSDArchitecture
#error	Unknown architecture!
#endif

#ifndef	UseElfFormat
#  define UseElfFormat		YES
#endif

#if UseElfFormat
#define	CppELF			-D__ELF__
#else
#define	CppELF			/**/
#endif

#ifndef	OSBinaryType
# if UseElfFormat
#  define OSBinaryType		[ELF]
# else
#  define OSBinaryType		/**/
# endif
#endif

#ifndef	OSVendor
#define	OSVendor		/**/
#endif

#ifndef	OSName
#define	OSName			DefaultOSName OSBinaryType
#endif

XCOMM operating system:  OSName (OSMajorVersion./**/OSMinorVersion./**/OSTeenyVersion)

#if 0	/* trouble with LinkRule not including LdPreLib */
#define	MirBSDWlBegin		-Wl,--start-group
#define	MirBSDWlEnd		-Wl,--end-group
#else
#define	MirBSDWlBegin		/**/
#define	MirBSDWlEnd		/**/
#endif

#ifdef Ports
#define	BinDir			${LOCALBASE}/bin
#define	LibDir			${LOCALBASE}/lib/X11
#define	UsrLibDir		${LOCALBASE}/lib
#define	ManDirectoryRoot	${LOCALBASE}/man
#define	XpmLibDir		/usr/X11R6/lib
#define	XpmIncDir		/usr/X11R6/include
#define	ConfigDir		/usr/X11R6/lib/X11/config
#define	IncRoot			${LOCALBASE}/include
#define	TopXInclude		-I/usr/X11R6/include
#define	ImakeCmd		imake -DPorts
#define	DocDir			${LOCALBASE}/share/doc
#define	BuildHtmlManPages	NO
#define	LdPreLib		MirBSDWlBegin -L/usr/X11R6/lib -L${LOCALBASE}/lib
#else
# if !defined(UseInstalled)
#define	LdPreLib		MirBSDWlBegin -L$(BUILDLIBDIR)
# else
#define	LdPreLib		MirBSDWlBegin -L$(USRLIBDIR)
# endif
#endif
#define	LdPostLib		MirBSDWlEnd -Wl,-O2

/*
 * C library features
 */
#define	HasPoll			YES
#define	HasNdbm			YES
#define	HasPutenv		YES
#define	HasSnprintf		YES
#define	HasAsprintf		YES
#define	HasStrlcat		YES
#define	HasBSD44Sockets		YES
#define	Malloc0ReturnsNull	NO
#define	SetTtyGroup		YES
#define	DBMLibrary		/**/
#define	HasLibCrypt		NO
#define	HasShm			YES
#define	HasWChar32		NO
#define	HasMkstemp		YES
#define	HasSetProcTitle		YES
#define	HasZlib			YES
#define	HasLibpng		YES
#define	HasExpat		YES
#define	HasKrbIV		NO
#define	HasKrb5			NO
#define	HasUsableFileMmap	YES
#define	HasShadowPasswd		NO
#define	IPv6SocketsAlsoIPv4	NO

#define	HasArc4Random		YES

#define	HasNCurses		YES
#define	NCursesLibName		-lcurses
#undef	TermcapLibrary
#define	TermcapLibrary		-lcurses

#define	HasVarRun		YES
#define	HasVarDb		YES
#define	VarLibDir		VarDbDirectory

#define	InstallXloadSetGID	NO

#define	HasIssetugid		YES
#define	HasMktemp		YES
#define	HasGetIfAddrs		YES
#define	HasSetUserContext	YES
#define	HasBSDAuth		YES
#define	HasGetpeereid		YES
#define	HasApmKqueue		YES
#define	HasLibUsbHid		YES
#define	UsbHidLib 		-lusbhid

/*
 * Compiler Features
 */
#define	HasGcc3			YES
#define	GccUsesGas		YES
#define	UseGas			YES

#ifndef	HasGccStackProtector
# ifdef __SSP__
#define	HasGccStackProtector	YES
# else
#define	HasGccStackProtector	NO
# endif
#endif

#define	UseGnuMalloc		NO

#define	NeedConstPrototypes	YES
#define	NeedFunctionPrototypes	YES
#define	NeedNestedPrototypes	YES
#define	NeedVarargsPrototypes	YES
#define	NeedWidePrototypes	NO

#define	MkdirHierCmd		mkdir -p

#if OSMajorVersion > 10 || (OSMajorVersion == 10 && OSTeenyVersion >= 164)
#define	MirBSD_Reiser_CCCP
#undef MirBSD_pcc_cpp
#endif

#if defined(MirBSD_Reiser_CCCP) || defined(MirBSD_pcc_cpp)
#ifdef MirBSD_pcc_cpp
#define	MirBSD_CppDefines	StandardCppOptions StandardDefines -D__STDC_HOSTED__ -D__MirBSD__ -D__OpenBSD__ -D__unix__ -D__STDC_ISO_10646__=200009L -D__WCHAR_MAX__=65535U '-D__WCHAR_TYPE__=short unsigned int' '-D__WINT_TYPE__=unsigned int' CppArchitecturePCC CppELF
#define	MirBSD_CppUndef		/* nothing */		/* pcc cpp */
#define	StandardCppOptions	-t
#else
#define	MirBSD_CppDefines	StandardCppOptions StandardDefines -DUNIXCPP -D__MirBSD__ -D__OpenBSD__ -D__unix__ -D__STDC_ISO_10646__=200009L -D__WCHAR_MAX__=65535U '-D__WCHAR_TYPE__=short unsigned int' '-D__WINT_TYPE__=unsigned int' CppArchitectureCCCP CppELF
#define	MirBSD_CppUndef		-undef			/* Reiser CCCP */
#define	StandardCppOptions	/* nothing */
#endif
#define	CppCmd			/usr/libexec/cpp MirBSD_CppDefines
#define	GnuCpp			NO
#define	CPPAsmOptions		/**/
#else
#define	MirBSD_CppUndef		-undef			/* GNU cpp */
#define	StandardCppOptions	-traditional
#ifndef	CppCmd
#define	CppCmd			/usr/bin/mcpp
#endif
#define	GnuCpp			YES
#endif
#define	StandardCppDefines	$(CPPFLAGS)
#define	ModuleCppCmd		CppCmd
#define	PreProcessCmd		CppCmd
#define	RawCppCmd		CppCmd MirBSD_CppUndef
#define	PreIncDir		DefaultGccIncludeDir
#define	DependFlags		-D__IN_MKDEP

#define	ModuleCcCmd		${CC}

#ifndef	AsCmd
#define	AsCmd			${CC} -c -x assembler
#endif

#define	HasCplusplus		NO
#define	CplusplusCmd		false

#if defined(UseInstalled)
#  define DefaultCCOptions	$(COPTS)
#else
#  define DefaultCCOptions	GccWarningOptions $(COPTS)
#endif

#define	GccGasOption		-DGCCUSESGAS
#if UseElfFormat
# define AsmDefines		-DUSE_GAS
#else
# define AsmDefines		-DUSE_GAS -D__AOUT__
#endif

#if OSMajorVersion > 8 || (OSMajorVersion == 8 && OSTeenyVersion >= 168)
# define XawI18nDefines		-DHAS_WCHAR_H -DHAS_WCTYPE_H -DNO_WIDEC_H \
				-DHAS_ISW_FUNCS -D'iswalnum(c)=iswalnum(c)'
#else
# define XawI18nDefines		-DUSE_XWCHAR_STRING -DUSE_XMBTOWC
#endif

#define	AdmDir			/var/log

#define	HasFlex			YES
#define	DontRebuildGperfOutput	YES

#ifndef	UseRpath
#define	UseRpath		UseElfFormat
#endif

/*
 * Make & install Features
 */

#define	HasBsdMake		YES

#define	StripInstalledPrograms	YES
#define	BuildCIDFonts		NO
#define	BuildCyrillicFonts	YES
#define	BuildBethMarduthoFonts	YES
#define	BuildEthiopicFonts	YES
#define	Build9x18UntruncFont	YES
#ifdef notyet
#define	DerivedUCSFonts		NO
#endif
#define	TruncateUCSFonts	NO
#define	GzipFontCompression	YES
#define	GzipCmd			gzip -n9
#define	MakeLocalFontDir	YES
#define	DefaultUserPath		/bin:/usr/bin:/usr/local/bin:$(BINDIR)
#define	DefaultSystemPath	/sbin:/usr/sbin:/bin:/usr/bin:$(BINDIR)

#define	InstUidFlags		-m 4555
#undef	InstallCmd
#define	InstallCmd 		/usr/bin/install

#ifndef	ExtraFilesToClean
# define ExtraFilesToClean	*.core
#endif

#define	BuildRman		NO
#define	BuildHtmlManPages	NO

/*
 * Documentation formatting
 */
#define	NeqnCmd			neqn
#define	NroffCmd		nrcon -e
#define	Nroff8Cmd		nrcon -8
#define	EqnCmd 			eqn -Tps
#define	HasGroff		NO

#ifndef	HasCookieMaker
#  define HasCookieMaker	YES
#  define MkCookieCmd		'/usr/sbin/openssl rand -hex 16'
#endif


/*
 * Man pages need to be formatted when installed, so override the default
 * imake rules.
 */
#define	ManSuffix	1
#define	FileManSuffix	5
#define	ManSourcePath	$(MANPATH)/cat

#define	InstallManPageLongBase(file,destdir,dest)			@@@@\
all:: file.0								@@@@\
									@@@@\
file.0:: file.$(MANNEWSUFFIX)						@@@@\
	@@if [ -f file.$(MANNEWSUFFIX) ]; \				@@@@\
	then \								@@@@\
	cat file.$(MANNEWSUFFIX) | $(NEQN) | $(TBL) | \			@@@@\
		$(NROFF) $(MANMACROS) | $(COL) > file.0; \		@@@@\
	fi 								@@@@\
									@@@@\
install.man::								@@@@\
	MakeDir($(DESTDIR)destdir)					@@@@\
	-@@if [ -f file.0 ]; \						@@@@\
	then \								@@@@\
	$(INSTALL) -c $(INSTMANFLAGS) file.0 $(DESTDIR)destdir/dest.0; \@@@@\
	fi								@@@@\
									@@@@\
clean::									@@@@\
	RemoveFile(file.0)

#define	InstallManPageLong(file,destdir,dest)				@@@@\
BuildInstallHtmlManPage(file,dest,$(MANSUFFIX))				@@@@\
									@@@@\
CppManTarget(file, $(EXTRAMANDEFS))					@@@@\
									@@@@\
InstallManPageLongBase(file,destdir,dest)

#define	InstallGenManPageLong(file,destdir,dest,suffix)			@@@@\
BuildInstallHtmlManPage(file,dest,suffix)				@@@@\
									@@@@\
CppManTarget(file, $(EXTRAMANDEFS))					@@@@\
									@@@@\
InstallManPageLongBase(file,destdir,dest)

#define	InstallMultipleMan(list,dest)					@@@@\
install.man:: 								@@@@\
	MakeDir($(DESTDIR)dest)						@@@@\
	case '${MFLAGS}' in *[i]*) set +e;; esac; \			@@@@\
	for i in list; do \						@@@@\
	(MNAME=`echo $$i | cut -f1 -d.`; \				@@@@\
	set -x; \							@@@@\
	cat $$i | $(NEQN) | $(TBL) | \					@@@@\
		$(NROFF) $(MANMACROS) | $(COL) > $${MNAME}.0; \		@@@@\
	$(INSTALL) -c $(INSTMANFLAGS) $${MNAME}.0 \			@@@@\
			$(DESTDIR)dest/$${MNAME}.0; \			@@@@\
	$(RM) $${MNAME}.0); \						@@@@\
	done

#define	InstallMultipleManSuffix(list,dest,suff)			@@@@\
install.man:: 								@@@@\
	MakeDir($(DESTDIR)dest)						@@@@\
	case '${MFLAGS}' in *[i]*) set +e;; esac; \			@@@@\
	for i in list; do \						@@@@\
	(set -x; \							@@@@\
	cat $$i.suff | $(NEQN) | $(TBL) | \				@@@@\
		$(NROFF) $(MANMACROS) | $(COL) > $$i.0; \		@@@@\
	$(INSTALL) -c $(INSTMANFLAGS) $$i.0	\			@@@@\
		$(DESTDIR)dest/$$i.0; \					@@@@\
	$(RM) $$i.0 ); \						@@@@\
	done

#define	InstallManPageAliasesBase(file,destdir,aliases)			@@@@\
install.man:: 								@@@@\
	@@case '${MFLAGS}' in *[i]*) set +e;; esac; \			@@@@\
	for i in aliases; do \						@@@@\
		(set -x; \						@@@@\
		$(RM) $(DESTDIR)destdir/$$i.0;\  			@@@@\
		(cd $(DESTDIR)/destdir; $(LN) file.0 $$i.0);\ 		@@@@\
		); \							@@@@\
	done

#define	InstallManPageAliases(file,destdir,aliases)			@@@@\
InstallHtmlManPageAliases(file,aliases,$(MANSUFFIX))			@@@@\
									@@@@\
InstallManPageAliasesBase(file,destdir,aliases)

#define	InstallGenManPageAliases(file,destdir,suffix,aliases)		@@@@\
InstallHtmlManPageAliases(file,aliases,suffix)				@@@@\
									@@@@\
InstallManPageAliasesBase(file,destdir,aliases)


/*
 * InstallFontAliases - generate rules to install font aliases
 *                      databases without comments for X11R5 servers
 */
#ifndef	InstallFontAliasesNoComment
#define	InstallFontAliasesNoComment(dest)				@@@@\
install::								@@@@\
	$(RM) _fonts.alias 						@@@@\
	sed -e '/^!/d' -e '/^$$/d' < fonts.alias > _fonts.alias		@@@@\
	MakeDir($(DESTDIR)dest)						@@@@\
	$(INSTALL) $(INSTALLFLAGS) $(INSTALLDATFLAGS) _fonts.alias \	@@@@\
	$(DESTDIR)dest/fonts.alias					@@@@\
	$(RM) _fonts.alias
#endif /* InstallFontAliasesNoComment */

/*
 * MirOS BSD specific Imake Config files
 */
#ifndef	LocalConfigFiles
#define	LocalConfigFiles OpenBSDLib.rules
#endif
#define	ShLibIncludeFile <bsdLib.tmpl>

/*
 * Architecture specific sections - put all architecture dependent
 * options and setting here into the correct section
 */


/*
 * Definitions for the i386 architecture
 */
#ifdef	i386Architecture

# ifndef DoLoadableServer
#  define DoLoadableServer		YES
# endif

/* DRI works, DRM not. DRI blanks the screen if no suitable
 * DRM is found, so enabling it right now would be pointless. */
# ifndef BuildXF86DRI
#  define BuildXF86DRI			NO
# endif
# ifndef BuildXF86DRM
#  define BuildXF86DRM			NO
# endif
# ifndef BuildXF86OldDRMCompat
#  define BuildXF86OldDRMCompat		NO
# endif

/* To use the NetBSD Aperture driver */
# ifndef HasNetBSDApertureDriver
#  define HasNetBSDApertureDriver	YES
# endif

# ifndef HasMTRRSupport
#   define HasMTRRSupport		YES
# endif

#  ifndef HasAgpGart
#   define HasAgpGart			YES
#  endif

# define ServerOSDefines		XFree86ServerOSDefines
# define ServerExtraSysLibs		-li386
# define ServerExtraDefines		GccGasOption XFree86ServerDefines
# ifndef XFree86ConsoleDefines
#   define XFree86ConsoleDefines	-DWSCONS_SUPPORT -DPCVT_SUPPORT
# endif

# define JoystickSupport		NO

/* Support for USB Mice */
# ifndef UsbMouseSupport
#   define UsbMouseSupport		YES
# endif

/* Usb Tablets */
# ifndef OSXInputDrivers
#  if HasLibUsbHid
#   define OSXInputDrivers		usbtablet
#  endif
# endif

/* No MMX support in OpenBSD/a.out gas */
# ifndef HasMMXSupport
#   define HasMMXSupport		UseElfFormat
# endif

/* for DRI */
# ifndef HasX86Support
#  define HasX86Support			UseElfFormat
# endif

# include <xfree86.cf>

#endif /* i386Architecture */


/*
 * Definitions for the sparc architecture
 */
#ifdef SparcArchitecture

#  define XF86Server		YES

#  ifndef Xsun24Server
#   define Xsun24Server		NO
#  endif
#  ifndef XsunServer
#   define XsunServer		NO
#  endif
#  ifndef XsunMonoServer
#   define XsunMonoServer	NO
#  endif
#  ifndef DoLoadableServer
#    define DoLoadableServer	YES
#  endif

/* 1bpp module */
# ifndef XF1Bpp
#  define XF1Bpp		YES
# endif
/* 4bpp module */
# ifndef XF4Bpp
#  define XF4Bpp		YES
# endif

#  define XF86CardDrivers	wsfb
#  define XFree86ConsoleDefines	-DWSCONS_SUPPORT
#  define BuildXInputExt	YES
#  define ServerOSDefines	XFree86ServerOSDefines -DDDXOSINIT
#  define ServerExtraDefines	GccGasOption XFree86ServerDefines


# define XkbServerDefines	-DXKB_ALWAYS_USES_SOFT_REPEAT

# include <xfree86.cf>

#endif /* SparcArchitecture */

/* End or architecture specific section */

/*
 * Generic settings for all architectures
 * which can be overridden by architecture specific sections above
 */

#ifndef StandardDefines
# define StandardDefines		-DCSRG_BASED $(CPPFLAGS)
#endif

#if !defined(OptimizedCDebugFlags)
# define OptimizedCDebugFlags		-O2
#endif

#ifndef	ServerOSDefines
#  define ServerOSDefines		/**/
#endif

#ifndef	ServerExtraDefines
#  define ServerExtraDefines		GccGasOption
#endif

#ifndef	ServerExtraSysLibs
#  define ServerExtraSysLibs		/**/
#endif

#ifndef	HasWeakSymbols
# define HasWeakSymbols			UseElfFormat
#endif

/*
 * Multi-thread safe libs
 */
#if HasWeakSymbols == YES
#  define HasPosixThreads		YES
#  define ThreadedX			YES
#  define SystemMTDefines		-D_REENTRANT
#  define BuildThreadStubLibrary	YES
#  define NeedUIThrStubs		YES
#  define ThreadsCompileFlag		-pthread
#  define ThreadsLibraries		-pthread
#else
#  define ThreadedX			NO
#endif

/* Set this to YES when getpwuid_r is added to libc_r */
#define	HasThreadSafeAPI		NO

#ifndef	ExtraLibraries
# define ExtraLibraries			/**/
#endif

/* Dynamic loading of i18n modules in libX11 has too many problems for now */
#ifndef	BuildLoadableXlibI18n
#define	BuildLoadableXlibI18n		NO
#endif

#ifndef	DoLoadableServer
#define	DoLoadableServer		NO
#endif

#ifndef	XVirtualFramebufferServer
# undef BuildServer
# define BuildServer			YES
# define XVirtualFramebufferServer	YES
#endif

#ifndef	XnestServer
# undef BuildServer
# define BuildServer			YES
# define XnestServer			YES
#endif

#ifndef	BuildScreenSaverLibrary
# define BuildScreenSaverLibrary	YES
#endif

#ifndef	BuildXInputLib
# define BuildXInputLib			YES
#endif

#ifndef	BuildXFree86ConfigTools
# define BuildXFree86ConfigTools	NO
#endif

#ifndef	ForceNormalLib
# define ForceNormalLib			YES
#endif

#ifndef	CompressAllFonts
# define CompressAllFonts		YES
#endif

#ifndef	SharedLibXdmGreet
# define SharedLibXdmGreet		NO
#endif

/*
 * XFree86 uses its own (more portable) database routines to speed up
 * the RGB database lookups
 * However, if you want to use ndbm anyway, you can set that to NO in
 * host.def
 */
#ifndef	UseRgbTxt
# define UseRgbTxt			YES
#endif

#ifndef	HasXdmAuth
# define HasXdmAuth			YES
#endif

#ifndef	HasDlopen
# define HasDlopen			YES
#endif

#ifndef	DlLibrary
# define DlLibrary			/**/
#endif

#ifndef	GccWarningOptions
# define GccWarningOptions		-Wall -Wpointer-arith
#endif

#undef	CplusplusLibC
#define	CplusplusLibC			/* implied by $(CXX) */

/* This must come last */
#include <OpenBSDLib.rules>
@


1.34
log
@build and install the shadowfb and xf{1,4}bpp modules (the latter unbreaking
the server to some extent, while the former can at least be used by wsfb_drv)
on sparc as well
@
text
@a505 4
/* shadow fb module */
# ifndef XFShadowFB
#  define XFShadowFB		YES
# endif
@


1.33
log
@we do not have CXX any more

XXX override this in ports
@
text
@d498 13
@


1.32
log
@enable Reiser CCCP for #10uA4 and up‚Ä¶ I have yet to note any issues
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.31 2008/11/22 07:57:21 tg Exp $
d209 2
a210 2
#define	HasCplusplus		YES
#define	CplusplusCmd		c++ -static-libgcc
@


1.31
log
@work around Mesa Imakefile overriding $(STD_CPP_DEFINES)
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.30 2008/11/22 07:49:13 tg Exp $
d170 1
a170 1
#if 0 /* OSMajorVersion > 10 || (OSMajorVersion == 10 && OSTeenyVersion >= 164) */
@


1.30
log
@Reiser CCCP is definitively not ANSI
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.29 2008/11/22 06:36:10 tg Exp $
a175 1
#define	CppCmd			/usr/libexec/cpp
d177 3
a179 2
#define	RawCppCmd		/usr/libexec/cpp	/* pcc cpp */
#define	StandardCppDefines	StandardCppOptions StandardDefines -D__STDC_HOSTED__ -D__MirBSD__ -D__OpenBSD__ -D__unix__ -D__STDC_ISO_10646__=200009L $(CPPFLAGS) -D__WCHAR_MAX__=65535U '-D__WCHAR_TYPE__=short unsigned int' '-D__WINT_TYPE__=unsigned int' CppArchitecturePCC CppELF
d181 3
a183 2
#define	RawCppCmd		/usr/libexec/cpp -undef	/* Reiser CCCP */
#define	StandardCppDefines	StandardCppOptions StandardDefines -DUNIXCPP -D__MirBSD__ -D__OpenBSD__ -D__unix__ -D__STDC_ISO_10646__=200009L $(CPPFLAGS) -D__WCHAR_MAX__=65535U '-D__WCHAR_TYPE__=short unsigned int' '-D__WINT_TYPE__=unsigned int' CppArchitectureCCCP CppELF
d185 1
d189 2
d192 1
a192 1
#define	CppCmd			/usr/bin/mcpp		/* GNU cpp */
a193 2
#define	StandardCppOptions	-traditional
#define	StandardCppDefines	$(CPPFLAGS)
d196 2
d199 1
@


1.29
log
@add some hooks to use either Reiser CCCP or pcc cpp or GNU cpp‚Ä¶
no change for now in the default setting
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.28 2008/11/20 00:30:56 tg Exp $
d182 1
a182 1
#define	StandardCppDefines	StandardCppOptions StandardDefines -D__STDC_HOSTED__ -D__MirBSD__ -D__OpenBSD__ -D__unix__ -D__STDC_ISO_10646__=200009L $(CPPFLAGS) -D__WCHAR_MAX__=65535U '-D__WCHAR_TYPE__=short unsigned int' '-D__WINT_TYPE__=unsigned int' CppArchitectureCCCP CppELF
@


1.28
log
@disable pcc-cpp for now, until it is unbroken
cf. Message-ID: <Pine.BSM.4.64L.0811190306420.30897@@herc.mirbsd.org>
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.27 2008/11/19 02:32:24 tg Exp $
d22 2
a23 1
#define	CppArchitecture		-D__i386__ -D__i386 -Di386
d28 2
a29 1
#define	CppArchitecture		-D__sparc__ -D__sparc -Dsparc
d171 5
d177 7
a183 2
#define	RawCppCmd		/usr/libexec/cpp
#define	StandardCppDefines	StandardCppOptions StandardDefines -D__STDC_HOSTED__ -D__MirBSD__ -D__OpenBSD__ -D__unix__ -D__STDC_ISO_10646__=200009L $(CPPFLAGS) -D__WCHAR_MAX__=65535U '-D__WCHAR_TYPE__=short unsigned int' '-D__WINT_TYPE__=unsigned int' CppArchitecture CppELF
d188 1
a188 1
#define	CppCmd			/usr/bin/cpp
@


1.27
log
@in addition to us needing more defines (i386/sparc, ELF, wchar stuff),
there is neither a -$ nor a -undef option, still, with pcc-cpp‚Ä¶

tested to compile now, at least
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.26 2008/11/18 20:41:09 tg Exp $
d168 1
a168 1
#if OSMajorVersion > 10 || (OSMajorVersion == 10 && OSTeenyVersion >= 164)
@


1.26
log
@use pcc-cpp for #10uA4 onwards
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.25 2008/06/14 13:39:01 tg Exp $
d17 2
d22 1
d27 1
d38 6
d170 2
a171 1
#define	StandardCppDefines	StandardCppOptions StandardDefines -D__MirBSD__ -D__OpenBSD__ -D__unix__ $(CPPFLAGS)
d173 1
@


1.25
log
@do not use X11‚Äôs gccmakedepend, as it cannot handle the xlock situation,
with different source files of same name in different directories, maybe
due to .depend handling or pathname stripping
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.24 2008/06/14 01:33:01 tg Exp $
a138 1
#define	GnuCpp			YES
d158 5
d168 2
@


1.24
log
@‚Ä¢ define HasGcc3 and UseGccMakeDepend, to avoid building X‚Äôs own
  makedepend command, which emits bogus warnings for our flex(1)
  skeleton (side effect: ${CC} must now be defined)
‚Ä¢ whitespace cleanup while here (must‚Äôve been vi* users in here‚Ä¶
  I ‚ô• ^Ov feature of jupp), but only some
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.23 2008/03/06 18:00:56 tg Exp $
a165 1
#define	UseGccMakeDepend	YES
@


1.23
log
@prevent some weird warnings during makedepend phase
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.22 2007/09/02 16:53:34 tg Exp $
d87 2
a88 2
#define	HasNdbm         	YES
#define	HasPutenv       	YES
d92 1
a92 1
#define	HasBSD44Sockets 	YES
d94 1
a94 1
#define	SetTtyGroup     	YES
d97 1
a97 1
#define	HasShm          	YES
d136 1
d160 1
a160 1
#define	CppCmd          	/usr/bin/cpp
d164 1
a164 1
#define	PreProcessCmd   	CppCmd
d166 1
d181 1
a181 1
#  define DefaultCCOptions 	GccWarningOptions $(COPTS)
d184 1
a184 1
#define	GccGasOption 		-DGCCUSESGAS
d234 1
a234 1
# define ExtraFilesToClean 	*.core
d273 1
a273 1
install.man::                                                           @@@@\
d297 1
a297 1
#define	InstallMultipleMan(list,dest)                                   @@@@\
d301 1
a301 1
	for i in list; do \                                             @@@@\
d311 1
a311 1
#define	InstallMultipleManSuffix(list,dest,suff)                        @@@@\
d315 1
a315 1
	for i in list; do \                                             @@@@\
d326 2
a327 2
	@@case '${MFLAGS}' in *[i]*) set +e;; esac; \                    @@@@\
	for i in aliases; do \                                          @@@@\
d405 1
a405 1
#   define HasAgpGart   		YES
d465 1
a465 1
#  define XFree86ConsoleDefines -DWSCONS_SUPPORT
d493 1
a493 1
#  define ServerOSDefines 		/**/
@


1.22
log
@do not cripple the *-iso10646-1 fonts
(this should not affect the packaging lists)
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.21 2007/08/24 14:31:51 tg Exp $
d60 1
a60 2
#ifdef	Ports

a72 1

d165 1
@


1.21
log
@revert the ‚Äúunicode only‚Äù change for the release, as fonts.alias stuff were
not the only issues; ports (e.g. GTK+1 apps) have trouble with it as well ‚Äì
according to bsiegert@@ who says he‚Äôs going to fix these later
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.20 2007/08/17 09:50:20 tg Exp $
d220 1
a221 1
#endif
@


1.20
log
@remove a few ‚Äúdo not build X feature‚Äù since more modern wsfb driver seems
to need them
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.19 2007/08/17 09:41:43 tg Exp $
d218 1
d221 1
@


1.19
log
@I‚Äôve wanted to do this for a long time‚Ä¶
‚Ä¢ do not truncate unicode fonts (i.e. make sure they include all chars)
‚Ä¢ do not build truncated subfonts (since the master fonts have all chars,
  and the X11 font libraries can do automatic charset conversion)

ok bsiegert@@
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.18 2007/08/15 23:49:52 tg Exp $
a445 3
# define BuildXF86MiscExt	NO
# define BuildMITMiscExt	NO

a469 5
# define BuildXF86VidModeExt	NO
# define BuildXF86DGA		NO
# ifndef BuildXInputExt
#  define BuildXInputExt	NO
# endif
@


1.18
log
@disable -Wl,-( and -Wl,-) for now, until all LinkRule""s are fixed.
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.17 2007/08/15 20:00:21 tg Exp $
d110 1
a110 1
#define IPv6SocketsAlsoIPv4	NO
d112 1
a112 1
#define HasArc4Random		YES
d170 2
a171 2
#ifndef AsCmd
#define AsCmd			${CC} -c -x assembler
d202 2
a203 2
#ifndef UseRpath
#define UseRpath		UseElfFormat
d217 3
a219 1
#define Build9x18UntruncFont	YES
d363 1
a363 1
#define ShLibIncludeFile <bsdLib.tmpl>
@


1.17
log
@use -Wl,-( -Wl,-) and -Wl,-O2 ‚Äì just like with bsd make
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.16 2007/08/15 01:38:18 tg Exp $
d52 8
d75 1
a75 1
#define	LdPreLib		-Wl,--start-group -L/usr/X11R6/lib -L${LOCALBASE}/lib
d78 1
a78 1
#define	LdPreLib		-Wl,--start-group -L$(BUILDLIBDIR)
d80 1
a80 1
#define	LdPreLib		-Wl,--start-group -L$(USRLIBDIR)
d83 1
a83 1
#define	LdPostLib		-Wl,--end-group -Wl,-O2
@


1.16
log
@part II (untested):
‚Ä¢ all ELF archs have weak symbols
‚Ä¢ $(COPTS) cleanup ‚Äì hopefully‚Ä¶
‚Ä¢ all MirBSD architectures are ELF
‚Ä¢ we don't have macppc, and if we had, it‚Äôd always have signed chars
‚Ä¢ -fno-strength-reduce is default on MirBSD
‚Ä¢ ‚Ä¶ besides, we (try to) honour copts anyway‚Ä¶
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.15 2007/02/11 02:18:00 tg Exp $
a57 1
#define	LdPreLib		-L/usr/X11R6/lib -L${LOCALBASE}/lib
d67 7
d75 1
a396 1
# define LdPostLib			/**/
@


1.15
log
@do *not* strip chars >U+3200 from the 9x18 font so that uxterm default 9x18+18x18ko has the broadest range of chars possible; if you want to save RAM use other fonts
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.14 2006/12/20 16:39:24 tg Exp $
a29 1
/* UseElfFormat defaults to YES if __ELF__ set */
a30 2
# ifdef __ELF__
#  undef __ELF__		/* other imake files shouldn't care */
a31 3
# else
#  define UseElfFormat		NO
# endif
d165 1
a165 5
#  ifdef  PpcArchitecture
#    define DefaultCCOptions	-fsigned-char GccWarningOptions
#  else
#    define DefaultCCOptions 	GccWarningOptions
#  endif
a374 2
# define HasWeakSymbols			YES

a387 4
# ifndef DefaultGcc2i386Opt
#   define DefaultGcc2i386Opt		-O2 GccAliasingArgs $(COPTS)
# endif
# define OptimizedCDebugFlags		DefaultGcc2i386Opt
a432 2
#  define HasWeakSymbols	YES

d494 1
a494 1
# define HasWeakSymbols			NO
@


1.14
log
@the "cookie maker" in _at least_ startx(1) was damaged. Ts ts, OpenBSD.
use openssltool(1) rand -hex, because it also uses arandom here, and
doesn't require pipes, only one fork, is shell insensitive, and doesn't
require more quoting. speed isn't too important.
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.13 2006/06/02 21:19:50 tg Exp $
d212 1
@


1.13
log
@make X11 build again and quell a warning while here
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.12 2006/06/02 12:12:12 tg Exp $
d240 1
a240 2
#  define MkCookieCmd \
	'dd if=/dev/arandom bs=16 count=1 2>/dev/null | hexdump -e \\"%08x\\"'
@


1.12
log
@after verifying that base, X and gcc still build...
* enable I18N in X, depending on OS patchlevel (not tested yet)
* our wchars are obviously 16 bit not 32 bit
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.11 2006/04/11 19:03:54 tg Exp $
d185 1
a185 1
#if OSMajorVersion > 8 || (OSMajorVersion == 8 && OSTeenyVersion >= 168
@


1.11
log
@don't "build" the (empty) CID fonts
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.10 2006/04/11 01:25:09 tg Exp $
d91 1
a91 1
#define	HasWChar32		YES
d185 6
a190 1
#define	XawI18nDefines		-DUSE_XWCHAR_STRING -DUSE_XMBTOWC
@


1.10
log
@(not yet in the new snapshot I'm building) use gzip -n9 to further reduce size
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.9 2005/12/30 00:15:37 tg Exp $
d203 1
@


1.9
log
@rpath

"makes sense" bsiegert@@
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.8 2005/04/16 18:12:22 tg Exp $
d207 1
@


1.8
log
@honour CPPFLAGS and add these to the Standard{,Cpp}Defines
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.7 2005/04/16 03:27:06 tg Exp $
d192 4
@


1.7
log
@use "nrcon -e" instead of plain "nrcon" for non-Japanese
manual pages (japanese are already using "nrcon -8" thus
the new \N parsing benefit reaches them as well)

Fixes
|         Section  N'34'SectionNameN'34'
|         String      a string enclosed in double quote marks (N'34')
|     If an option name is prefixed with N'34'NoN'34', then the
and similar unreadabilities in manual pages.
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.6 2005/03/28 20:50:25 tg Exp $
d155 1
a155 1
#define	StandardCppDefines	/**/
d481 1
a481 1
# define StandardDefines		-DCSRG_BASED
@


1.6
log
@reinstate the ability to install the X sets without the gcc set
by adding -static-libgcc to the C++ compiler's options
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.5 2005/03/27 22:31:25 tg Exp $
d222 1
a222 1
#define	NroffCmd		nrcon
d283 2
a284 2
	cat $$i | $(NEQN) | $(TBL) | $(NROFF) $(MANMACROS) \		@@@@\
		| $(COL) > $${MNAME}.0; \				@@@@\
d296 2
a297 2
	cat $$i.suff | $(NEQN) | $(TBL) | $(NROFF) $(MANMACROS) \	@@@@\
		| $(COL) > $$i.0; \					@@@@\
@


1.5
log
@enable C++ for XFree86Æ since it doesn't break the build,
and xlock -nolock -mode cage even WORKS! (despite glxtest
not working)
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.4 2005/03/23 20:36:13 tg Exp $
d166 1
a166 1
#define	CplusplusCmd		c++
@


1.4
log
@prepare
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.3 2005/03/23 19:48:19 tg Exp $
d159 2
a164 5
/* no C++ in base, override with CXX from ports */
#undef	HasCplusplus
#ifndef	PortsWithCXX
#define	HasCplusplus		NO
#else
d166 1
a166 2
#endif
/* #define	CplusplusCmd		c++ */
@


1.3
log
@hopefully fix "CC is recursive" problem

you must still give CC as make parameter, though
(unless you're installing a "cc" in your path)

as long as X11 honours $CC, it's okay this way
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.2 2005/03/20 18:13:18 tg Exp $
d170 1
@


1.2
log
@try better this time
also, use /usr/bin/cpp (which calls /usr/libexec/cpp (Reiser CCCP)
or /usr/bin/mcpp (GNU GCC) depending on which exists)
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS: X11/xc/config/cf/MirBSD.cf,v 1.1 2005/03/19 17:19:20 tg Exp $
a158 3
#ifndef	CcCmd
#define	CcCmd 			${CC}
#endif
d160 1
a160 1
#define AsCmd			CcCmd -c -x assembler
@


1.1
log
@merge as much diff of old as possible
@
text
@d1 1
a1 1
XCOMM platform:	$MirOS$
a16 1
#undef	UseElfFormat
a18 1
#define	UseElfFormat		YES	/* safer to override this here */
a22 1
#define	UseElfFormat		YES	/* safer to override this here */
d30 10
a94 1
#if OSMajorVersion > 7 || (OSMajorVersion == 7 && OSTeenyVersion >= 161)
a95 4
#else
#define	HasLibpng		NO
#endif
#if OSMajorVersion >= 8
a96 3
#else
#define	HasExpat		NO
#endif
d134 3
d138 1
d152 1
a152 1
#define	CppCmd          	/usr/libexec/cpp
d185 4
a188 12
#define	AsmDefines 		-DUSE_GAS

/* UseElfFormat defaults to YES if __ELF__ set */
#ifndef	UseElfFormat
# ifdef __ELF__
#  undef __ELF__			/* other imake files shouldn't care */
#  define UseElfFormat	YES
#  define AsmDefines	-DUSE_GAS
# else
#  define UseElfFormat	NO
#  define AsmDefines	-DUSE_GAS -D__AOUT__
# endif
a190 2
#define	GccGasOption 		-DGCCUSESGAS

d213 1
a213 1
#define	InstUidFlags		-m 4755
a226 1
#if OSMajorVersion > 7 || (OSMajorVersion == 7 && OSTeenyVersion >= 154)
d228 2
a229 5
#define	NroffCmd		nroff -Tcrt
#else
#define	NeqnCmd			eqn
#define	NroffCmd		nroff
#endif
a231 5
#if OSMajorVersion > 7 || (OSMajorVersion == 7 && OSTeenyVersion >= 198)
#define	Nroff8Cmd		nrcon -8
#else
#define	Nroff8Cmd		NroffCmd
#endif
d349 1
a349 2
#define	LocalConfigFiles \
	OpenBSDLib.rules MirBSDLib.tmpl
d351 1
a351 1
#define ShLibIncludeFile <MirBSDLib.tmpl>
a386 1
/* OpenBSD 2.7 and later have support for setting MTRRs */
@

