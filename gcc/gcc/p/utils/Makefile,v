head	1.9;
access;
symbols
	MIRBSD_10_BASE:1.8
	MIRBSD_9_BASE:1.6
	gpc-20060325:1.1.111.3
	MIRBSD_8:1.4.0.2
	MIRBSD_8_BASE:1.4
	gpc-20051116:1.1.111.2
	gpc-20050217:1.1.111.1
	gpc:1.1.111;
locks; strict;
comment	@# @;


1.9
date	2017.04.03.02.37.02;	author tg;	state Exp;
branches;
next	1.8;
commitid	10058E1B5250AF477B9;

1.8
date	2007.05.19.01.18.31;	author tg;	state Exp;
branches;
next	1.7;
commitid	100464E50415A4F2B05;

1.7
date	2006.09.20.23.04.07;	author tg;	state Exp;
branches;
next	1.6;
commitid	1004511C8F916EAB17A;

1.6
date	2006.03.31.03.16.58;	author tg;	state Exp;
branches;
next	1.5;
commitid	100442C9F0D2D8D21E8;

1.5
date	2006.03.27.11.59.05;	author tg;	state Exp;
branches;
next	1.4;
commitid	1004427D394409B84F7;

1.4
date	2005.11.20.12.28.15;	author tg;	state Exp;
branches;
next	1.3;
commitid	207543806be95a50;

1.3
date	2005.03.28.02.09.46;	author tg;	state Exp;
branches;
next	1.2;

1.2
date	2005.03.28.00.05.06;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.03.27.23.24.52;	author tg;	state Exp;
branches
	1.1.111.1;
next	;

1.1.111.1
date	2005.03.27.23.24.52;	author tg;	state Exp;
branches;
next	1.1.111.2;

1.1.111.2
date	2005.11.20.12.18.45;	author tg;	state Exp;
branches;
next	1.1.111.3;
commitid	3462438069a7b269;

1.1.111.3
date	2006.03.27.11.51.08;	author tg;	state Exp;
branches;
next	;
commitid	1004427D1B80A0FD957;


desc
@@


1.9
log
@break Makefiles enough to make C and Pascal compile with mirmake ipv gmake
(cross only C)
@
text
@# $MirOS: gcc/gcc/p/utils/Makefile,v 1.8 2007/05/19 01:18:31 tg Exp $
# Makefile for the GNU Pascal utilities
#
# Copyright (C) 2002-2006 Free Software Foundation, Inc.
#
# Author: Frank Heckenbach <frank@@pascal.gnu.de>
#
# This file is part of GNU Pascal.
#
# GNU Pascal is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2, or (at your option)
# any later version.
#
# GNU Pascal is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with GNU Pascal; see the file COPYING. If not, write to the
# Free Software Foundation, 59 Temple Place - Suite 330, Boston, MA
# 02111-1307, USA.

# Variables to override
PC=gpc
CFLAGS=-O2 -g
PFLAGS=
UTILS_WARN=-W -Wall -Wmissing-prototypes -Wmissing-declarations
GCC_DIR=ERROR--GCC_DIR-MUST-BE-SET
exeext=
prefix=/usr/local
bindir=$(prefix)/bin
man1dir=$(prefix)/man/man1
INSTALL_PROGRAM=install -m 755
INSTALL_DATA=install -m 644
BUILD=unknown
HOST=unknown

srcdir=$(GCC_DIR)/p/utils
VPATH=$(srcdir)

# Internal variables
PFLAGS1=--executable-path=. --unit-path=$(GCC_DIR)/p/rts --unit-path=$(GCC_DIR)/p/units
EXE=binobj$(exeext) gpidump$(exeext)
EXE2=binobj gpidump
PC_WITH_FLAGS=$(PC) --automake --executable-file-name $(UTILS_WARN) ${CFLAGS:N-Wno-long-long} $(PFLAGS) $(PFLAGS1)

all: $(EXE)

binobj$(exeext): binobj.pas
	$(PC_WITH_FLAGS) "${.ALLSRC:M*.pas}"

gpidump$(exeext): gpidump.pas tree.inc
	$(PC_WITH_FLAGS) -I. -I "$(GCC_DIR)/p" "${.ALLSRC:M*.pas}"

tree.inc: $(GCC_DIR)/version.c $(GCC_DIR)/tree.def $(GCC_DIR)/p/p-tree.def $(GCC_DIR)/p/module.c
	$(SHELL) "$(srcdir)/mk-t-inc" "$(GCC_DIR)" "$@@"

install:
	for f in $(EXE); do \
	  rm -f $(bindir)/"$$f"; \
	  $(INSTALL_PROGRAM) "$$f" "$(bindir)/$$f"; \
	  chmod a+x $(bindir)/"$$f"; \
	done

clean:
	rm -f *.o *.i *.s *.gpi *.gpd $(EXE) $(EXE2) $(DOC) tree.inc
@


1.8
log
@• revive Ada (but not the Lovelace one)
• make all subsystems ignore our special CFLAGS, even if they're C-only
@
text
@d1 1
a1 1
# $MirOS: gcc/gcc/p/utils/Makefile,v 1.7 2006/09/20 23:04:07 tg Exp $
d47 1
a47 1
PC_WITH_FLAGS=$(PC) --automake --executable-file-name $(UTILS_WARN) $(CFLAGS) $(PFLAGS) $(PFLAGS1)
d52 1
a52 1
	$(PC_WITH_FLAGS) "$<"
d55 1
a55 1
	$(PC_WITH_FLAGS) -I. -I "$(GCC_DIR)/p" "$<"
@


1.7
log
@-Wbounded is C only
@
text
@d1 1
a1 1
# $MirOS: gcc/gcc/p/utils/Makefile,v 1.6 2006/03/31 03:16:58 tg Exp $
d47 1
a47 1
PC_WITH_FLAGS=$(PC) --automake --executable-file-name $(UTILS_WARN) $(subst -std=gnu99,,$(subst -Wformat,,$(subst -Wbounded,,$(CFLAGS)))) $(PFLAGS) $(PFLAGS1)
@


1.6
log
@That's what I get for running an alpha version of GNU pascal...
@
text
@d1 1
a1 1
# $MirOS: gcc/gcc/p/utils/Makefile,v 1.5 2006/03/27 11:59:05 tg Exp $
d47 1
a47 1
PC_WITH_FLAGS=$(PC) --automake --executable-file-name $(UTILS_WARN) $(subst -std=gnu99,,$(subst -Wformat,,$(CFLAGS))) $(PFLAGS) $(PFLAGS1)
@


1.5
log
@merge
@
text
@d1 1
a1 1
# $MirOS: gcc/gcc/p/utils/Makefile,v 1.4 2005/11/20 12:28:15 tg Exp $
d47 1
a47 1
PC_WITH_FLAGS=$(PC) --automake --executable-file-name $(UTILS_WARN) $(subst -Wformat,,$(CFLAGS)) $(PFLAGS) $(PFLAGS1)
@


1.4
log
@merge gcc/p/ part of newer GNU Pascal
@
text
@d1 1
a1 1
# $MirOS: gcc/gcc/p/utils/Makefile,v 1.3 2005/03/28 02:09:46 tg Exp $
d4 1
a4 1
# Copyright (C) 2002-2005 Free Software Foundation, Inc.
d47 1
a47 1
PC_WITH_FLAGS=$(PC) --automake --executable-file-name $(UTILS_WARN) $(subst -Wformat,,$(CFLAGS)) $(PFLAGS) $(PFLAGS1) `cat needed-options`
d51 1
a51 7
# The Pascal source is not used, but we have to provide any.
# `-x Preprocessed-Pascal /dev/null' works as well, except on mingw.
needed-options: binobj.pas $(GCC_DIR)/p/p-version.h
	$(PC) $(UTILS_WARN) $(subst -Wformat,,$(CFLAGS)) $(PFLAGS) $(PFLAGS1) --print-needed-options "$<" 2> "$@@" || true
	if grep '^[^-]' "$@@" > /dev/null; then echo "needed-options: `cat "$@@"`" >&2; rm -f "$@@"; false; else true; fi

binobj$(exeext): binobj.pas needed-options
d54 1
a54 1
gpidump$(exeext): gpidump.pas tree.inc needed-options
d68 1
a68 1
	rm -f *.o *.i *.s *.gpi *.gpd $(EXE) $(EXE2) $(DOC) tree.inc needed-options
@


1.3
log
@some ^$(^) and associated fuckup
@
text
@d1 1
a1 1
# $MirOS: gcc/gcc/p/utils/Makefile,v 1.2 2005/03/28 00:05:06 tg Exp $
d53 1
a53 1
needed-options: binobj.pas $(GCC_DIR)/p/version.h
@


1.2
log
@usual cleanup here, too
@
text
@d1 1
a1 1
# $MirOS$
d47 1
a47 1
PC_WITH_FLAGS=$(PC) --automake --executable-file-name $(UTILS_WARN) $(CFLAGS) $(PFLAGS) $(PFLAGS1) `cat needed-options`
d54 1
a54 1
	$(PC) $(UTILS_WARN) $(CFLAGS) $(PFLAGS) $(PFLAGS1) --print-needed-options "$<" 2> "$@@" || true
@


1.1
log
@Initial revision
@
text
@d1 1
a46 1
DOC=binobj.1 gpidump.1
d49 1
a49 1
all: $(EXE) $(DOC)
a62 22
binobj.1: binobj
	[ -r no-man ] || if [ x"$(BUILD)" != x"$(HOST)" ]; then \
	  echo "*** cross-compiling; man pages for the GPC utilities will not be built" >&2; \
	  echo cross-compile > no-man; \
	elif help2man --version > /dev/null 2>&1; then \
	  help2man -N ./"$<" > "$@@" || { rm -f "$@@"; false; } \
	else \
	  echo "*** help2man not found; man pages for the GPC utilities will not be built" >&2; \
	  echo no-help2man > no-man; \
	fi

gpidump.1: gpidump
	[ -r no-man ] || if [ x"$(BUILD)" != x"$(HOST)" ]; then \
	  echo "*** cross-compiling; man pages for the GPC utilities will not be built" >&2; \
	  echo cross-compile > no-man; \
	elif help2man --version > /dev/null 2>&1; then \
	  help2man -N ./"$<" > "$@@" || { rm -f "$@@"; false; } \
	else \
	  echo "*** help2man not found; man pages for the GPC utilities will not be built" >&2; \
	  echo no-help2man > no-man; \
	fi

d64 1
a64 1
	"$(srcdir)/mk-t-inc" "$(GCC_DIR)" "$@@"
d66 1
a66 1
install: $(EXE) $(DOC)
a71 7
	for f in $(DOC); do \
	  if [ -r "$$f" ]; then \
	    rm -f $(man1dir)/"$$f"; \
	    $(INSTALL_DATA) "$$f" "$(man1dir)/$$f"; \
	    chmod a-x $(man1dir)/"$$f"; \
	  fi; \
	done
@


1.1.111.1
log
@pretty much stripped down version of the current GNU Pascal Alpha
- no docs
- no GPL'd units (to keep the RTL free)
@
text
@@


1.1.111.2
log
@Update to gpc-20051116 with the following diffs applied:
Message-ID: <E1EcXkX-0004mi-00@@hera.math.uni.wroc.pl>
Message-ID: <E1Ed6ro-00056J-00@@hera.math.uni.wroc.pl>
@
text
@d53 1
a53 1
needed-options: binobj.pas $(GCC_DIR)/p/p-version.h
@


1.1.111.3
log
@Update gcc/p/ to gpc-20060325
@
text
@d3 1
a3 1
# Copyright (C) 2002-2006 Free Software Foundation, Inc.
d47 1
a47 1
PC_WITH_FLAGS=$(PC) --automake --executable-file-name $(UTILS_WARN) $(CFLAGS) $(PFLAGS) $(PFLAGS1)
d51 7
a57 1
binobj$(exeext): binobj.pas
d60 1
a60 1
gpidump$(exeext): gpidump.pas tree.inc
d103 1
a103 1
	rm -f *.o *.i *.s *.gpi *.gpd $(EXE) $(EXE2) $(DOC) tree.inc
@


