head	1.5;
access;
symbols
	MIRBSD_10_BASE:1.5
	MIRBSD_9_BASE:1.5
	GPC_gcc-3_4_6_gpc-20060325:1.1.101.1
	GPC_gcc-3_4_6:1.1.101.1.0.2
	GPC_gcc-3_4_6_BASE:1.1.101.1
	GPC_gcc-3_4-20050823_gpc-20060325:1.1.101.1
	gcc-3_4_6:1.1.101.1
	MIRBSD_8:1.4.0.2
	MIRBSD_8_BASE:1.4
	gcc-3_4-20051206:1.1.101.1
	SSP_gcc-3_4-20051115_protector-3_4_4-1:1.1.101.1
	SSP_gcc-3_4-20051115_BASE:1.1.101.1
	SSP_gcc-3_4-20051115:1.1.101.1.0.8
	gcc-3_4-20051115:1.1.101.1
	GPC_gcc-3_4-20050823_gpc-20051116:1.1.101.1
	GPC_gcc-3_4-20050823_BASE:1.1.101.1
	GPC_gcc-3_4-20050823_gpc-20050217:1.1.101.1
	GPC_gcc-3_4-20050823:1.1.101.1.0.6
	gcc-3_4-20050823:1.1.101.1
	FSF:1.1.101;
locks; strict;
comment	@ * @;


1.5
date	2006.06.11.00.15.12;	author tg;	state Exp;
branches;
next	1.4;
commitid	100448B6089366B48DB;

1.4
date	2005.05.19.22.46.30;	author tg;	state Exp;
branches;
next	1.3;
commitid	58b6428d1750d0d7;

1.3
date	2005.05.19.22.11.55;	author tg;	state Exp;
branches;
next	1.2;
commitid	576e428d0f05abf7;

1.2
date	2005.05.14.17.43.42;	author tg;	state Exp;
branches;
next	1.1;
commitid	36d2428638ba72ae;

1.1
date	2005.03.21.12.04.44;	author tg;	state Exp;
branches
	1.1.101.1;
next	;

1.1.101.1
date	2005.03.21.12.04.44;	author tg;	state Exp;
branches;
next	;


desc
@@


1.5
log
@* bring the sparc kernel in shape to maybe cross-compile it
* add machine description for mirbsd-sparc to gcc
* fix including problem
@
text
@/* $MirOS: gcc/gcc/gthr-posix.c,v 1.4 2005/05/19 22:46:30 tg Exp $ */

/* POSIX threads dummy routines for systems without weak definitions.  */
/* Compile this one with gcc.  */
/* Copyright (C) 2003, 2005 Free Software Foundation, Inc.

This file is part of GCC.

GCC is free software; you can redistribute it and/or modify it under
the terms of the GNU General Public License as published by the Free
Software Foundation; either version 2, or (at your option) any later
version.

GCC is distributed in the hope that it will be useful, but WITHOUT ANY
WARRANTY; without even the implied warranty of MERCHANTABILITY or
FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
for more details.

You should have received a copy of the GNU General Public License
along with GCC; see the file COPYING.  If not, write to the Free
Software Foundation, 59 Temple Place - Suite 330, Boston, MA
02111-1307, USA.  */

/* As a special exception, if you link this library with other files,
   some of which are compiled with GCC, to produce an executable,
   this library does not by itself cause the resulting executable
   to be covered by the GNU General Public License.
   This exception does not however invalidate any other reasons why
   the executable file might be covered by the GNU General Public License.  */

/* pull in <pthread.h> via "gthr.h" */
#define _PTHREADS 1

#include "system.h"
#include "coretypes.h"
#include "tconfig.h"
#include "tm.h"
/* Define so we provide weak definitions of functions used by libobjc only.  */
#define _LIBOBJC_WEAK
#include "gthr.h"

__RCSID("$MirOS: gcc/gcc/gthr-posix.c,v 1.4 2005/05/19 22:46:30 tg Exp $");

int
pthread_once (pthread_once_t *once ATTRIBUTE_UNUSED,
	      void (*func) (void) ATTRIBUTE_UNUSED)
{
  return -1;
}

int
pthread_key_create (pthread_key_t *key ATTRIBUTE_UNUSED,
		    void (*dtor) (void *) ATTRIBUTE_UNUSED)
{
  return -1;
}

int
pthread_key_delete (pthread_key_t key ATTRIBUTE_UNUSED)
{
  return 0;
}

void *
pthread_getspecific (pthread_key_t key ATTRIBUTE_UNUSED)
{
  return 0;
}

int
pthread_setspecific (pthread_key_t key ATTRIBUTE_UNUSED,
		     const void *ptr ATTRIBUTE_UNUSED)
{
  return 0;
}

int
pthread_create (pthread_t *thread ATTRIBUTE_UNUSED,
		const pthread_attr_t *attr ATTRIBUTE_UNUSED,
		void *(*start_routine) (void *) ATTRIBUTE_UNUSED,
		void *arg ATTRIBUTE_UNUSED)
{
  return 0;
}

int
pthread_mutex_lock (pthread_mutex_t *mutex ATTRIBUTE_UNUSED)
{
  return 0;
}

int
pthread_mutex_trylock (pthread_mutex_t *mutex ATTRIBUTE_UNUSED)
{
  return 0;
}

int
pthread_mutex_unlock (pthread_mutex_t *mutex ATTRIBUTE_UNUSED)
{
  return 0;
}

int
pthread_cond_broadcast (pthread_cond_t *cond ATTRIBUTE_UNUSED)
{
  return 0;
}

int
pthread_cond_destroy (pthread_cond_t *cond ATTRIBUTE_UNUSED)
{
  return 0;
}

int
pthread_cond_init (pthread_cond_t *cond ATTRIBUTE_UNUSED,
		   const pthread_condattr_t *attr ATTRIBUTE_UNUSED)
{
  return 0;
}

int
pthread_cond_signal (pthread_cond_t *cond ATTRIBUTE_UNUSED)
{
  return 0;
}

int
pthread_cond_wait (pthread_cond_t *cond ATTRIBUTE_UNUSED,
		   pthread_mutex_t *mutex ATTRIBUTE_UNUSED)
{
  return 0;
}

void
pthread_exit (void *value_ptr ATTRIBUTE_UNUSED)
{
  _exit(0);
}

int
pthread_mutex_init (pthread_mutex_t *mutex ATTRIBUTE_UNUSED,
		    const pthread_mutexattr_t *attr ATTRIBUTE_UNUSED)
{
  return 0;
}

int
pthread_mutex_destroy (pthread_mutex_t *mutex ATTRIBUTE_UNUSED)
{
  return 0;
}

pthread_t
pthread_self (void)
{
  return (pthread_t) 0;
}

#ifdef _POSIX_THREAD_PRIORITY_SCHEDULING
int
sched_get_priority_max (int policy ATTRIBUTE_UNUSED)
{
  return 0;
}

int
sched_get_priority_min (int policy ATTRIBUTE_UNUSED)
{
  return 0;
}
#endif /* _POSIX_THREAD_PRIORITY_SCHEDULING */

int
sched_yield (void)
{
  return 0;
}

int
pthread_attr_destroy (pthread_attr_t *attr ATTRIBUTE_UNUSED)
{
  return 0;
}

int
pthread_attr_init (pthread_attr_t *attr ATTRIBUTE_UNUSED)
{
  return 0;
}

int
pthread_attr_setdetachstate (pthread_attr_t *attr ATTRIBUTE_UNUSED,
			     int detachstate ATTRIBUTE_UNUSED)
{
  return 0;
}

#ifdef _POSIX_THREAD_PRIORITY_SCHEDULING
int
pthread_getschedparam (pthread_t thread ATTRIBUTE_UNUSED,
		       int *policy ATTRIBUTE_UNUSED,
		       struct sched_param *param ATTRIBUTE_UNUSED)
{
  return 0;
}

int
pthread_setschedparam (pthread_t thread ATTRIBUTE_UNUSED,
		       int policy ATTRIBUTE_UNUSED,
		       const struct sched_param *param ATTRIBUTE_UNUSED)
{
  return 0;
}
#endif /* _POSIX_THREAD_PRIORITY_SCHEDULING */
@


1.4
log
@remove hack and fix deps
@
text
@d1 1
a1 1
/* $MirOS: gcc/gcc/gthr-posix.c,v 1.3 2005/05/19 22:11:55 tg Exp $ */
d31 3
d42 1
a42 1
__RCSID("$MirOS: gcc/gcc/gthr-posix.c,v 1.3 2005/05/19 22:11:55 tg Exp $");
@


1.3
log
@for now: deactivate some of these functions with #ifndef __MirBSD__

need a solution: weak symbols in libgcc_eh must be overridden by
the final symbols in libpthread, or only available to libgcc_eh
itself (unless libpthread is actually linked in)

probably gonna be via specs...
@
text
@d1 1
a1 1
/* $MirOS: gcc/gcc/gthr-posix.c,v 1.2 2005/05/14 17:43:42 tg Exp $ */
d39 1
a39 1
__RCSID("$MirOS: gcc/gcc/gthr-posix.c,v 1.2 2005/05/14 17:43:42 tg Exp $");
a47 1
#ifndef __MirBSD__
a81 1
#endif
a88 1
#ifndef __MirBSD__
a93 1
#endif
a100 1
#ifndef __MirBSD__
a213 1
#endif
@


1.2
log
@make it work

just that now:
 Program received signal SIGSEGV, Segmentation fault.
 0x051b7fd0 in pthread_stackseg_np () from /usr/lib/libpthread.so.8.0
the problem is just at a different place...
@
text
@d1 1
a1 1
/* $MirOS$ */
d39 1
a39 1
__RCSID("$MirOS$");
d48 1
d83 1
d91 1
d97 1
d105 1
d219 1
a219 1

@


1.1
log
@Initial revision
@
text
@d1 2
d5 1
a5 1
/* Copyright (C) 2003 Free Software Foundation, Inc.
d31 2
d39 2
d136 1
@


1.1.101.1
log
@Import the GNU Compiler Collection 3.4-stable
from gcc-3.4-20050318.tar.bz2 after having
* all top-level non-directories (files)
  - except config.if
and these directories completely:
* INSTALL
* boehm-gc/Mac_files
* boehm-gc/cord
* boehm-gc/doc
* boehm-gc/tests
* contrib
  - except texi2pod.pl
* gcc/f
* gcc/po
* gcc/testsuite
* gcc/treelang
* include
* intl
* libf2c
* libffi/testsuite
* libiberty
* libjava/testsuite
* libstdc++-v3/docs
* libstdc++-v3/po
* libstdc++-v3/scripts
* libstdc++-v3/testsuite
* maintainer-scripts
* zlib
removed before importing.
@
text
@@
