head	1.1;
access;
symbols
	MIRBSD_10_BASE:1.1
	MIRBSD_9_BASE:1.1
	MIRBSD_8:1.1.0.2
	MIRBSD_8_BASE:1.1;
locks; strict;
comment	@ * @;


1.1
date	2005.05.14.17.43.46;	author tg;	state Exp;
branches;
next	;
commitid	36d2428638ba72ae;


desc
@@


1.1
log
@make it work

just that now:
 Program received signal SIGSEGV, Segmentation fault.
 0x051b7fd0 in pthread_stackseg_np () from /usr/lib/libpthread.so.8.0
the problem is just at a different place...
@
text
@#include <pthread.h>
#include <gc.h>

struct intpair {
	int car;
	struct intpair *cdr;
};

struct intpair *cons(int car, struct intpair *cdr) {
	struct intpair *pair =
		(struct intpair*) GC_MALLOC(sizeof(struct intpair));
	pair->car = car;
	pair->cdr = cdr;
	return pair;
}

struct intpair *reverse_acc(const struct intpair *list, struct intpair *res) {
	return (list == NULL) ? res :
		reverse_acc(list->cdr, cons(list->car, res));
}

struct intpair *reverse(const struct intpair *list) {
	return reverse_acc(list, NULL);
}

int main(int argc, char **argv) {
	struct intpair *list = cons(1, cons(2, cons(3, cons(4, NULL))));
	list = reverse(list);
	list = reverse(list);
	list = reverse(list);
	list = reverse(list);
	return 0;
}
@
