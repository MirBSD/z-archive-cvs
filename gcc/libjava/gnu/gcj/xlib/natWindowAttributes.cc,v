head	1.1;
branch	1.1.101;
access;
symbols
	MIRBSD_10_BASE:1.1.101.1
	MIRBSD_9_BASE:1.1.101.1
	gcc-3_4_6:1.1.101.1
	MIRBSD_8:1.1.101.1.0.2
	MIRBSD_8_BASE:1.1.101.1
	gcc-3_4-20051206:1.1.101.1
	gcc-3_4-20051115:1.1.101.1
	gcc-3_4-20050823:1.1.101.1
	FSF:1.1.101;
locks; strict;
comment	@// @;


1.1
date	2005.03.21.12.07.40;	author tg;	state Exp;
branches
	1.1.101.1;
next	;

1.1.101.1
date	2005.03.21.12.07.40;	author tg;	state Exp;
branches;
next	;


desc
@@


1.1
log
@Initial revision
@
text
@/* Copyright (C) 2000  Free Software Foundation

   This file is part of libgcj.

This software is copyrighted work licensed under the terms of the
Libgcj License.  Please consult the file "LIBGCJ_LICENSE" for
details.  */

#include <X11/Xlib.h>

#include <gcj/cni.h>
#include <gnu/gcj/RawData.h>

#include <gnu/gcj/xlib/Display.h>
#include <gnu/gcj/xlib/Window.h>
#include <gnu/gcj/xlib/WindowAttributes.h>
#include <gnu/gcj/xlib/Pixmap.h>
#include <gnu/gcj/xlib/XException.h>
#include <gnu/gcj/xlib/Screen.h>
#include <gnu/gcj/xlib/Visual.h>


void gnu::gcj::xlib::WindowAttributes::initFromWindow(Window* from)
{
  display = from->getDisplay();
  ::Display* dpy = (::Display*) display->display;
  ::Window win = from->getXID();
  
  XWindowAttributes* attributesIn  = new XWindowAttributes;
  in = reinterpret_cast<gnu::gcj::RawData*>(attributesIn);

  Status status = XGetWindowAttributes(dpy, win, attributesIn);
  if ((status == BadDrawable) | (status == BadWindow))
    throw new XException(display, status);
}


void gnu::gcj::xlib::WindowAttributes::init(WindowAttributes* copyFrom)
{
  XSetWindowAttributes* attributes = new XSetWindowAttributes;

  if (copyFrom != 0)
    {
      XSetWindowAttributes* from = 
	(XSetWindowAttributes*) copyFrom->out;
      (*attributes) = (*from);
    } 
  
  out = reinterpret_cast<gnu::gcj::RawData*>(attributes);
}

void gnu::gcj::xlib::WindowAttributes::finalize()
{
  delete in; in = 0;
  delete out; out = 0;
}

void gnu::gcj::xlib::WindowAttributes::setBackground(jlong pixel)
{
  XSetWindowAttributes* attributes = (XSetWindowAttributes*) out;
  
  attributes->background_pixel = pixel;
  mask = mask | CWBackPixel;
}

void gnu::gcj::xlib::WindowAttributes::setBackground(Pixmap* pixmap)
{
  XSetWindowAttributes* attributes = (XSetWindowAttributes*) out;

  attributes->background_pixmap = pixmap->getXID();
  mask = mask | CWBackPixmap;
}

void gnu::gcj::xlib::WindowAttributes::setEventMask(jlong eventMask)
{
  XSetWindowAttributes* attributes = (XSetWindowAttributes*) out;

  attributes->event_mask = eventMask;
  mask = mask | CWEventMask;
}

gnu::gcj::xlib::Visual* gnu::gcj::xlib::WindowAttributes::getVisual()
{
  if (in == 0)
    return 0;

  XWindowAttributes* attributesIn = (XWindowAttributes*) in;

  gnu::gcj::RawData* screenRef =
    reinterpret_cast<gnu::gcj::RawData*>(attributesIn->screen);

  Screen* screen = new Screen(display, screenRef);

  gnu::gcj::RawData* visualRef =
    reinterpret_cast<gnu::gcj::RawData*>(attributesIn->visual);

  return new gnu::gcj::xlib::Visual(visualRef, screen, attributesIn->depth);
}


void gnu::gcj::xlib::WindowAttributes::apply(Window* window)
{
  ::Display* dpy = (::Display*) window->getDisplay()->display;
  ::Window win = window->getXID();
  XSetWindowAttributes* attributes = (XSetWindowAttributes*) out;
  
  XChangeWindowAttributes(dpy, win, mask, attributes);
}

@


1.1.101.1
log
@Import the GNU Compiler Collection 3.4-stable
from gcc-3.4-20050318.tar.bz2 after having
* all top-level non-directories (files)
  - except config.if
and these directories completely:
* INSTALL
* boehm-gc/Mac_files
* boehm-gc/cord
* boehm-gc/doc
* boehm-gc/tests
* contrib
  - except texi2pod.pl
* gcc/f
* gcc/po
* gcc/testsuite
* gcc/treelang
* include
* intl
* libf2c
* libffi/testsuite
* libiberty
* libjava/testsuite
* libstdc++-v3/docs
* libstdc++-v3/po
* libstdc++-v3/scripts
* libstdc++-v3/testsuite
* maintainer-scripts
* zlib
removed before importing.
@
text
@@
