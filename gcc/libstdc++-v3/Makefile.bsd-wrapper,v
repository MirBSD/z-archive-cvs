head	1.17;
access;
symbols
	MIRBSD_10_BASE:1.15
	MIRBSD_9_BASE:1.14
	MIRBSD_8:1.14.0.2
	MIRBSD_8_BASE:1.14;
locks; strict;
comment	@# @;


1.17
date	2009.12.12.19.40.43;	author tg;	state Exp;
branches;
next	1.16;
commitid	1004B23F1B9396598C0;

1.16
date	2008.12.26.16.01.21;	author tg;	state Exp;
branches;
next	1.15;
commitid	1004954FFC469B460F4;

1.15
date	2006.11.03.01.14.04;	author tg;	state Exp;
branches;
next	1.14;
commitid	100454A979B37CBAE99;

1.14
date	2005.12.17.06.04.19;	author tg;	state Exp;
branches;
next	1.13;
commitid	10043A3AA6F030C709E;

1.13
date	2005.11.22.17.55.24;	author tg;	state Exp;
branches;
next	1.12;
commitid	52b843835b5a18a8;

1.12
date	2005.07.07.20.31.11;	author tg;	state Exp;
branches;
next	1.11;
commitid	23ae42cd90ff8afe;

1.11
date	2005.07.06.22.47.27;	author tg;	state Exp;
branches;
next	1.10;
commitid	302642cc5f638fb0;

1.10
date	2005.07.06.18.48.09;	author tg;	state Exp;
branches;
next	1.9;
commitid	494942cc27676cb9;

1.9
date	2005.04.29.14.34.55;	author tg;	state Exp;
branches;
next	1.8;

1.8
date	2005.03.26.22.32.33;	author tg;	state Exp;
branches;
next	1.7;

1.7
date	2005.03.26.11.39.28;	author tg;	state Exp;
branches;
next	1.6;

1.6
date	2005.03.26.11.30.13;	author tg;	state Exp;
branches;
next	1.5;

1.5
date	2005.03.26.11.15.12;	author tg;	state Exp;
branches;
next	1.4;

1.4
date	2005.03.26.10.36.48;	author tg;	state Exp;
branches;
next	1.3;

1.3
date	2005.03.26.10.27.07;	author tg;	state Exp;
branches;
next	1.2;

1.2
date	2005.03.26.10.08.03;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2005.03.26.09.45.38;	author tg;	state Exp;
branches;
next	;


desc
@@


1.17
log
@attempt version-specific *includes* not just *libs* as well,
so that we don’t need to remove Objective-C support from base
@
text
@# $MirOS: gcc/libstdc++-v3/Makefile.bsd-wrapper,v 1.16 2008/12/26 16:01:21 tg Exp $

.include <bsd.own.mk>
.include "${GNUSYSTEM_AUX_DIR}/locations.mk"
.include "../Makefile.inc"

CFWRAP_NO_CXXCOM=defined

CXXOPTS?=	${COPTS}
CXXOPTS+=	-Wno-unused
NOMAN=		yes
# --enable-clocale=ieee_1003.1-2001 is broken although we'd probably
# support it: try 'fgrep -r _GLIBCXX_NUM_CATEGORIES .' once…
CFARGS+=	--enable-static ${CF_PIC} --prefix=${GCC_PREFIX} \
		--enable-fast-install --disable-libtool-lock \
		--disable-libstdcxx-pch --disable-nls --enable-c99 \
		--enable-long-long --disable-libstdcxx-debug \
		--enable-cxx-flags="${FSFCXXFLAGS:C/ *$//}" \
		--disable-symvers --enable-version-specific-runtime-libs
XARGS+=		LIBIBERTY_HDRS="${GNU_LIBIBERTY_INC}" \
		LIBIBERTY_SRC="${GNU_LIBIBERTY_SRC}" \
		SECTION_FLAGS= CXX="${CC}"
.if ${GCC_NATIVE:L} == "yes"
XARGS+=		libtool_VERSION=${LIBCXX_VER}
.endif
CLEANFILES+=	include libsupc++/cp-demangle.c src/atomicity.cc \
		src/basic_file.cc src/c++locale.cc src/codecvt_members.cc \
		src/collate_members.cc src/ctype_members.cc \
		src/messages_members.cc src/monetary_members.cc \
		src/numeric_members.cc src/time_members.cc

.if ${DEBUGLIBS:L} == "yes"
COPTS+=		-g
.endif

LIBFILES=	libstdc++.a libstdc++.la libsupc++.a libsupc++.la
.if ${NOPIC:L} == "no"
LIBFILES+=	libstdc++.so.${LIBCXX_REV}
.endif

.if ${GCC_NATIVE:L} == "yes"
post-install:
	cd ${DESTDIR}${GCC_PREFIX}/lib/gcc/${GCCTARGET}/${GCCVERSION} \
	    && chown -h ${LIBOWN}:${LIBGRP} ${LIBFILES} \
	    && chmod ${LIBMODE} ${LIBFILES}
.endif

.include <bsd.cfwrap.mk>
@


1.16
log
@tentatively move base-gcc to version-specific library directories, too

(the gxx includes stay, but the csu files move, so that we can use the
BSD licenced ones for pcc in /usr/lib later)
@
text
@d1 1
a1 1
# $MirOS: gcc/libstdc++-v3/Makefile.bsd-wrapper,v 1.15 2006/11/03 01:14:04 tg Exp $
d19 1
a19 2
		--disable-symvers --enable-version-specific-runtime-libs \
		--with-gxx-include-dir=${GCC_PREFIX}/include/gxx
@


1.15
log
@seems as if the <ctype.h> change hit us quite hard;
we can't cover as netbsd any more, and in addition
to that, the IEEE_1003.1-2001 locale is upstream broken
so we can't use it even if we probably fulfil it already,
which means two ABI changes. bump OS patchlevel here too,
but don't bump in base yet, I'll do that once HEAD is sort
of more stable again…
@
text
@d1 1
a1 1
# $MirOS: gcc/libstdc++-v3/Makefile.bsd-wrapper,v 1.14 2005/12/17 06:04:19 tg Exp $
d19 2
a20 1
		--disable-symvers --with-gxx-include-dir=${GCC_PREFIX}/include/gxx
d44 1
a44 1
	cd ${DESTDIR}${GCC_PREFIX}/lib \
@


1.14
log
@-g for libraries if DEBUGLIBS
@
text
@d1 1
a1 1
# $MirOS: gcc/libstdc++-v3/Makefile.bsd-wrapper,v 1.13 2005/11/22 17:55:24 tg Exp $
d12 2
@


1.13
log
@with quite little effort the gcc module can be made portable
Initial testing on Darwin; this only removes build failures,
testing will be done later
@
text
@d1 1
a1 1
# $MirOS: gcc/libstdc++-v3/Makefile.bsd-wrapper,v 1.12 2005/07/07 20:31:11 tg Exp $
d30 4
@


1.12
log
@regen and adapt for MirLibtool changes
@
text
@d1 1
a1 1
# $MirOS: gcc/libstdc++-v3/Makefile.bsd-wrapper,v 1.11 2005/07/06 22:47:27 tg Exp $
d5 1
d12 1
a12 1
CFARGS+=	--enable-static ${CF_PIC} --prefix=/usr \
d17 1
a17 1
		--disable-symvers --with-gxx-include-dir=/usr/include/gxx
d20 4
a23 2
		SECTION_FLAGS= CXX="${CC}" \
		libtool_VERSION=${LIBCXX_VER}
d35 1
d37 1
a37 1
	cd ${DESTDIR}/usr/lib \
d40 1
@


1.11
log
@I'm now content with it, and it still works, even with the new
version numbers. The symlinks' permissions are fixed now, too.

I still do not like, however, the idea of symlinks in /usr/lib
at all. It is not BSDish to me. We will have to rethink this.
@
text
@d1 1
a1 1
# $MirOS: gcc/libstdc++-v3/Makefile.bsd-wrapper,v 1.10 2005/07/06 18:48:09 tg Exp $
d29 1
a29 1
LIBFILES+=	libstdc++.so.${LIBCXX_REV} libstdc++.so.${LIBCXX_REV:R}
@


1.10
log
@I'll now try to compile this... permission fixing
and more version numbering stuff will follow later
@
text
@d1 1
a1 1
# $MirOS: gcc/libstdc++-v3/Makefile.bsd-wrapper,v 1.9 2005/04/29 14:34:55 tg Exp $
d29 1
a29 1
LIBFILES+=	libstdc++.so.${SHLIB_VERSION}
d32 1
a32 1
xxx-post-install:
d34 1
a34 1
	    && chown ${LIBOWN}:${LIBGRP} ${LIBFILES} \
@


1.9
log
@bump major (EH change in gcc)
@
text
@d1 1
a1 1
# $MirOS: gcc/libstdc++-v3/Makefile.bsd-wrapper,v 1.8 2005/03/26 22:32:33 tg Exp $
a7 2
SHLIB_VERSION?=	36.0

d20 1
a20 1
		libtool_VERSION=${SHLIB_VERSION:S/./:/}:0
d32 1
a32 1
post-install:
@


1.8
log
@use the C compiler as the C++ compiler, as the comments suggest
@
text
@d1 1
a1 1
# $MirOS: gcc/libstdc++-v3/Makefile.bsd-wrapper,v 1.7 2005/03/26 11:39:28 tg Exp $
d8 1
a8 1
SHLIB_VERSION?=	35.0
@


1.7
log
@Makefile.sub:
* +libstdc++-v3

libstdc++-v3/Makefile.bsd-wrapper:
* sync CLEANFILES

tyler@@, you owe me some belgian beer
@
text
@d1 1
a1 1
# $MirOS: gcc/libstdc++-v3/Makefile.bsd-wrapper,v 1.6 2005/03/26 11:30:13 tg Exp $
d6 2
d21 1
@


1.6
log
@mkinstalldirs, chown/chmod post-install
@
text
@d1 1
a1 1
# $MirOS: gcc/libstdc++-v3/Makefile.bsd-wrapper,v 1.5 2005/03/26 11:15:12 tg Exp $
d20 5
a24 1
CLEANFILES+=	include libsupc++/cp-demangle.c
@


1.5
log
@employ a shitload of evil hackery for
* 64 bit time_t
* libgcc
@
text
@d1 1
a1 1
# $MirOS: gcc/libstdc++-v3/Makefile.bsd-wrapper,v 1.4 2005/03/26 10:36:48 tg Exp $
d22 10
@


1.4
log
@pass our COPTS as CXXFLAGS, too
@
text
@d1 1
a1 1
# $MirOS: gcc/libstdc++-v3/Makefile.bsd-wrapper,v 1.3 2005/03/26 10:27:07 tg Exp $
d9 1
d20 1
a20 1
#CLEANFILES+=	config.h libtool stamp-h
@


1.3
log
@more config-ml.in
fix spelling
disable symbol versioning
@
text
@d1 1
a1 1
# $MirOS: gcc/libstdc++-v3/Makefile.bsd-wrapper,v 1.2 2005/03/26 10:08:03 tg Exp $
d8 1
d14 2
a15 1
		--with-gxx-include-dir=/usr/include/gxx --disable-symvers
@


1.2
log
@pull the demangler from our libiberty sources
@
text
@d1 1
a1 1
# $MirOS: gcc/libstdc++-v3/Makefile.bsd-wrapper,v 1.1 2005/03/26 09:45:38 tg Exp $
d13 1
a13 1
		--with-gxx-include-dir==/usr/include/gxx
@


1.1
log
@hack more on it
@
text
@d1 1
a1 1
# $MirOS: gcc/libobjc/Makefile.bsd-wrapper,v 1.1 2005/03/25 21:44:40 tg Exp $
d15 1
@

